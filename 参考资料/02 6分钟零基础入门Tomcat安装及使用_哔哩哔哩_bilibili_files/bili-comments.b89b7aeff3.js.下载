!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).BiliComments=e()}(this,(function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function e(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t,e,n,i,r,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,o){var a=t.apply(e,i);function s(t){n(a,r,o,s,l,"next",t)}function l(t){n(a,r,o,s,l,"throw",t)}s(void 0)}))}}function r(t,n,i){return n=d(n),function(t,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return e(t)}(t,h()?Reflect.construct(n,i||[],d(t).constructor):n.apply(t,i))}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,x(i.key),i)}}function s(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function c(t,e,n){return(e=x(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},u.apply(null,arguments)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function m(){m=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var o=e&&e.prototype instanceof y?e:y,a=Object.create(o.prototype),s=new I(i||[]);return r(a,"_invoke",{value:T(t,n,s)}),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p="suspendedStart",h="suspendedYield",f="executing",v="completed",b={};function y(){}function g(){}function w(){}var x={};c(x,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(R([])));_&&_!==n&&i.call(_,a)&&(x=_);var A=w.prototype=y.prototype=Object.create(x);function E(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(r,o,a,s){var l=d(t[r],t,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==typeof u&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(u).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,s)}))}s(l.arg)}var o;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return o=o?o.then(r,r):r()}})}function T(e,n,i){var r=p;return function(o,a){if(r===f)throw Error("Generator is already running");if(r===v){if("throw"===o)throw a;return{value:t,done:!0}}for(i.method=o,i.arg=a;;){var s=i.delegate;if(s){var l=S(s,i);if(l){if(l===b)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=f;var c=d(e,n,i);if("normal"===c.type){if(r=i.done?v:h,c.arg===b)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function S(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),b;var o=d(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,b;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,b):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function R(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(typeof e+" is not iterable")}return g.prototype=w,r(A,"constructor",{value:w,configurable:!0}),r(w,"constructor",{value:g,configurable:!0}),g.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},E(C.prototype),c(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var a=new C(u(t,n,i,r),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(A),c(A,l,"Generator"),c(A,a,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return s.type="throw",s.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;P(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:R(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),b}},e}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(t,e)||_(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function w(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function _(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}function A(t){var e="function"==typeof Map?new Map:void 0;return A=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(h())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(t.bind.apply(t,i));return n&&b(r,n.prototype),r}(t,arguments,d(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),b(n,t)},A(t)}("undefined"==typeof globalThis?"undefined":k(globalThis))<"u"?globalThis:("undefined"==typeof window?"undefined":k(window))<"u"?window:("undefined"==typeof global?"undefined":k(global))<"u"?global:("undefined"==typeof self?"undefined":k(self))<"u"&&self;var E={exports:{}};!function(t,e){!function(t){var e=function(){function t(t){var e=this;this.disposables=[],this.playing=!1,this.valid=!1,this.remove=!1,this.raf=0;var n=t.src,i=t.width,r=t.height,o=t.sizing,a=t.autoplay,s=t.loop,l=t.canvas||document.createElement("canvas");this.canvas=l,t.container&&(t.container.appendChild(l),this.remove=!0),this.initVideo(n,a,s),this.initWebgl(i,r,o),this.disposables.unshift((function(){e.playing&&e.pause(),e.raf&&window.cancelAnimationFrame(e.raf),e.remove&&e.canvas.parentElement&&e.canvas.parentElement.removeChild(e.canvas)}))}return Object.defineProperty(t.prototype,"currentTime",{get:function(){return this.video.currentTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.video.duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"src",{get:function(){return this.video.src},enumerable:!1,configurable:!0}),t.prototype.addEventListener=function(t,e,n){var i=this;this.video.addEventListener(t,e,n),this.disposables.push((function(){i.video.removeEventListener(t,e,n)}))},t.prototype.initVideo=function(t,e,n){var i=this,r=document.createElement("video");this.video=r,r.src=t,r.autoplay=e||!1,r.muted=!0,r.volume=0,r.muted=!0,r.loop=n||!1,r.style.display="none",r.crossOrigin="anonymous",r.setAttribute("type","video/mp4"),this.addEventListener("play",(function(){i.raf=window.requestAnimationFrame((function(){i.nextFrame()}))})),this.addEventListener("playing",(function(){i.valid=!0})),this.addEventListener("ended",(function(){i.playing=!1}))},t.prototype.nextFrame=function(){var t=this;this.playing&&(this.callWebglDraw(),this.raf=window.requestAnimationFrame((function(){t.nextFrame()})))},t.prototype.callWebglDraw=function(){var t=this.gl;this.valid&&(t.texImage2D(t.TEXTURE_2D,0,t.RGB,t.RGB,t.UNSIGNED_BYTE,this.video),t.drawArrays(t.TRIANGLE_STRIP,0,4))},t.prototype.dispose=function(){for(;this.disposables.length;)this.disposables.pop()()},t.prototype.play=function(){return this.playing=!0,this.valid=!1,this.video.play(),this},t.prototype.pause=function(){return this.playing=!1,this.video.pause(),this},t.prototype.reload=function(t){if(t)return this.video.src=t,this;console.warn("please set a valid src")},t.prototype.initWebgl=function(t,e,n){var i=1,r=[t,e];"raw"!==n&&(i=window.devicePixelRatio||1,r.forEach((function(t,e){r[e]=t*i})),"dpr-raw"===n&&(this.canvas.style.setProperty("transform","scale(".concat(1/i,")")),this.canvas.style.setProperty("transform-origin","left top"))),this.canvas.width=r[0],this.canvas.height=r[1];var o=this.canvas.getContext("webgl");this.gl=o,o.viewport(0,0,r[0],r[1]);var a=this.initShaderProgram(o);o.linkProgram(a),o.useProgram(a);var s=this.initBuffer(o);o.bindBuffer(o.ARRAY_BUFFER,s.position);var l=o.getAttribLocation(a,"a_position");o.enableVertexAttribArray(l),o.vertexAttribPointer(l,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,s.texture);var c=o.getAttribLocation(a,"a_texCoord");o.enableVertexAttribArray(c),o.vertexAttribPointer(c,2,o.FLOAT,!1,0,0);var u=this.initTexture(o);o.bindTexture(o.TEXTURE_2D,u);var d=o.getUniformLocation(a,"u_scale");return o.uniform2fv(d,[i,i]),o},t.prototype.createShader=function(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(i)),i},t.prototype.initShaderProgram=function(t){var e=this.createShader(t,t.VERTEX_SHADER,"\n          attribute vec2 a_position;\n          attribute vec2 a_texCoord;\n          varying vec2 v_texCoord;\n          uniform vec2 u_scale;\n          void main(void) {\n              gl_Position = vec4(a_position, 0.0, 1.0);\n              v_texCoord = a_texCoord;\n          }\n          "),n=this.createShader(t,t.FRAGMENT_SHADER,"\n          precision lowp float;\n          varying vec2 v_texCoord;\n          uniform sampler2D u_sampler;\n          void main(void) {\n              gl_FragColor = vec4(texture2D(u_sampler, v_texCoord).rgb, texture2D(u_sampler, v_texCoord+vec2(-0.5, 0)).r);\n          }\n          "),i=t.createProgram();return t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),i},t.prototype.initBuffer=function(t){var e=new Float32Array([-1,1,1,1,-1,-1,1,-1]),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW);var i=t.createBuffer(),r=new Float32Array([.5,1,1,1,.5,0,1,0]);return t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),{position:n,texture:i}},t.prototype.initTexture=function(t){var e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e},t}();t.create=function(t){return new e(t)},Object.defineProperty(t,"__esModule",{value:!0})}(e)}(0,E.exports);var C=E.exports,T=function(t){function e(){var t;return o(this,e),(t=r(this,e)).alphaVideo=null,t.attachShadow({mode:"open"}).innerHTML='\n      <style>\n        #wrap {\n          overflow: hidden;\n        }\n      </style>\n      <div id="wrap">\n        <canvas></canvas>\n      </div>\n    ',t}return p(e,t),s(e,[{key:"wrap",get:function(){return this.shadowRoot.querySelector("#wrap")}},{key:"canvas",get:function(){return this.shadowRoot.querySelector("canvas")}},{key:"connectedCallback",value:function(){var t=this,e=this.getAttribute("src"),n=this.getAttribute("width"),i=this.getAttribute("height"),r=null!==this.getAttribute("loop"),o=null!==this.getAttribute("autoplay");!e||!n||!i||(this.wrap.style.setProperty("width","".concat(n,"px")),this.wrap.style.setProperty("height","".concat(i,"px")),this.alphaVideo=C.create({src:e,canvas:this.canvas,width:Number(n),height:Number(i),sizing:"dpr-raw",loop:r}),this.alphaVideo.addEventListener("ended",(function(){t.dispatchEvent(new CustomEvent("ended"))})),o&&this.play())}},{key:"play",value:function(){var t;null==(t=this.alphaVideo)||t.play()}},{key:"disconnectedCallback",value:function(){this.alphaVideo&&(this.alphaVideo.dispose(),this.alphaVideo=null)}}])}(A(HTMLElement));customElements.get("bili-alpha-video")||customElements.define("bili-alpha-video",T);var S,O=!0,P=function(){return O&&(O="undefined"==typeof window),O},I=function(){var t,e,n,i;if(P())return!1;if(void 0!==S)return S;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return S=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var r=document.createElement("canvas");S=!!(null===(e=r.getContext)||void 0===e?void 0:e.call(r,"2d"))&&0===(null===(i=null===(n=r.toDataURL)||void 0===n?void 0:n.call(r,"image/webp"))||void 0===i?void 0:i.indexOf("data:image/webp"))}catch(t){S=!1}return S};P()||window.IntersectionObserver;var R=function(t){return function(t){return"number"==typeof t}(t)&&(0|t)===t};var j=/\.(jpeg|jpg|png|webp|gif|avif)$/,L=function(t){return!!function(t){return!!/\/bfs\//.test(t)}(t)&&!!function(t){var e;return(null===(e=t.match(j))||void 0===e?void 0:e[0])||null}(t)},M=function(t){return"number"!=typeof t||isNaN(t)?0:Math.floor(t)||0};function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}var N="bmgOnLoad",B="bmgOnError",z="__BMG_TRACKER_COLLECT_EXTS__",U=function(t){return"function"==typeof t},F="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},V={};Object.defineProperty(V,"__esModule",{value:!0});var H=!0,W=V.default=function(){return H&&(H="undefined"==typeof window),H},$={};Object.defineProperty($,"__esModule",{value:!0});var q=/\.(jpeg|jpg|png|webp|gif|avif)$/;$.default=function(t){var e;return(null===(e=t.match(q))||void 0===e?void 0:e[0])||null};!function(t){var e=F&&F.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseAvif=t.canUseAvif=t.setAvif=void 0;var n,i=e(V);t.setAvif=function(t){n=t},t.canUseAvif=function(){return!(0,i.default)()&&void 0!==n&&n},t.asyncCanUseAvif=function(){return new Promise((function(e){if((0,i.default)())return e(!1);if((0,t.canUseAvif)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setAvif)(!1),e(!1)},n.onload=function(){(0,t.setAvif)(!0),e(!0)},n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="}))}}({});!function(t){var e=F&&F.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseWebP=t.canUseWebP=t.setWebp=void 0;var n,i=e(V);t.setWebp=function(t){n=t},t.canUseWebP=function(){var t,e,r,o;if((0,i.default)())return!1;if(void 0!==n)return n;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return n=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var a=document.createElement("canvas");n=!!(null===(e=a.getContext)||void 0===e?void 0:e.call(a,"2d"))&&0===(null===(o=null===(r=a.toDataURL)||void 0===r?void 0:r.call(a,"image/webp"))||void 0===o?void 0:o.indexOf("data:image/webp"))}catch(t){n=!1}return n},t.asyncCanUseWebP=function(){return new Promise((function(e){if((0,i.default)())return e(!1);if((0,t.canUseWebP)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setWebp)(!1),e(!1)},n.onload=function(){(0,t.setWebp)(!0),e(!0)},n.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="}))}}({});var G=null;!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.commitLog=t.getSpmId=t.getSpmPrefix=void 0;var e=function(){return"undefined"==typeof window},n="";t.getSpmPrefix=function(){var t,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e())return"";if(n&&!i)return n;try{return n=(null===(t=document.querySelector("meta[name=spm_prefix]"))||void 0===t?void 0:t.content)||""}catch(i){return""}},t.getSpmId=function(e){if(!e)return"";var n=(0,t.getSpmPrefix)();return n?e.indexOf(n)>-1?e:"".concat(n,".").concat(e):""},t.commitLog=function(n,i,r,o){var a,s,l,c;if(!e()&&(window.reportConfig||window.MReporter)&&n&&i){var u=null;if(!u&&window.reportConfig)if(window.reportMsgObj)u=window.reportMsgObj;else{var d=window.reportConfig.msgObjects;u=window[d]||null}var p=i.indexOf("selfDef");if(p>-1)u&&(u[i.substring(p+8)]=r,null===(a=window.reportObserver)||void 0===a||a.forceCommit());else{var h=(0,t.getSpmPrefix)();if(h){var f="object"==D(r)?JSON.stringify(r):JSON.stringify({});if(window.MReporter)return i.indexOf(h)>-1&&(i=i.replace("".concat(h,"."),"")),void(null===(l=(s=window.MReporter)[n])||void 0===l||l.call(s,{evt:i,msg:f,target_url:o||""}));null===(c=window.reportObserver)||void 0===c||c.reportCustomData(n,{spm_id:(0,t.getSpmId)(i),msg:f,target_url:o||""})}}}}}({});var X="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Y={},Z={},Q={};Object.defineProperty(Q,"__esModule",{value:!0});var K=!0,J=Q.default=function(){return K&&(K="undefined"==typeof window),K};!function(t){var e=X&&X.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseAvif=t.canUseAvif=t.setAvif=void 0;var n,i=e(Q);t.setAvif=function(t){n=t};t.canUseAvif=function(){return!(0,i.default)()&&(void 0!==n&&n)};t.asyncCanUseAvif=function(){return new Promise((function(e){if((0,i.default)())return e(!1);if((0,t.canUseAvif)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setAvif)(!1),e(!1)},n.onload=function(){(0,t.setAvif)(!0),e(!0)},n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="}))}}(Z);var tt={};!function(t){var e=X&&X.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseWebP=t.canUseWebP=t.setWebp=void 0;var n,i=e(Q);t.setWebp=function(t){n=t};t.canUseWebP=function(){var t,e,r,o;if((0,i.default)())return!1;if(void 0!==n)return n;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return n=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var a=document.createElement("canvas");n=!!(null===(e=a.getContext)||void 0===e?void 0:e.call(a,"2d"))&&0===(null===(o=null===(r=a.toDataURL)||void 0===r?void 0:r.call(a,"image/webp"))||void 0===o?void 0:o.indexOf("data:image/webp"))}catch(t){n=!1}return n};t.asyncCanUseWebP=function(){return new Promise((function(e){if((0,i.default)())return e(!1);if((0,t.canUseWebP)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setWebp)(!1),e(!1)},n.onload=function(){(0,t.setWebp)(!0),e(!0)},n.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="}))}}(tt);var et={},nt=X&&X.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(et,"__esModule",{value:!0});var it=nt(Q);et.default=function(){return!(0,it.default)()&&!!window.HTMLPictureElement},function(t){var e=X&&X.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.autoDetectAll=t.autoDetect=t.canUseHtmlPictureElement=t.canUseWebP=t.setWebp=t.canUseAvif=t.setAvif=void 0;var n=Z;Object.defineProperty(t,"canUseAvif",{enumerable:!0,get:function(){return n.canUseAvif}}),Object.defineProperty(t,"setAvif",{enumerable:!0,get:function(){return n.setAvif}});var i=tt;Object.defineProperty(t,"canUseWebP",{enumerable:!0,get:function(){return i.canUseWebP}}),Object.defineProperty(t,"setWebp",{enumerable:!0,get:function(){return i.setWebp}});var r=e(et);t.canUseHtmlPictureElement=r.default;t.autoDetect=function(t){void 0===t&&(t=["webp"]);for(var e=0;e<t.length;e++){if("avif"===t[e]&&(0,n.canUseAvif)())return t[e];if("webp"===t[e]&&(0,i.canUseWebP)())return t[e]}return""};t.autoDetectAll=function(){return new Promise((function(t){Promise.all([(0,n.asyncCanUseAvif)(),(0,i.asyncCanUseWebP)()]).then((function(e){var n=e[0],i=e[1];t({avif:n,webp:i})}))}))}}(Y);var rt={},ot={};Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=function(t){return t?t.replace(/^http(s)?:/,""):""};var at={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.isInt=t.isNum=void 0;t.isNum=function(t){return"number"==typeof t};t.isInt=function(e){return(0,t.isNum)(e)&&(0|e)===e}}(at);var st={};Object.defineProperty(st,"__esModule",{value:!0});var lt=/\.(jpeg|jpg|png|webp|gif|avif)$/;st.default=function(t){var e;return(null===(e=t.match(lt))||void 0===e?void 0:e[0])||null},function(t){var e=X&&X.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBmgSrc=t.isSupportBmgFormat=void 0;var n=e(ot),i=e(Q),r=at,o=e(st);t.isSupportBmgFormat=function(t){return!!function(t){return!!/\/bfs\//.test(t)}(t)&&!!(0,o.default)(t)};var a=function(t){return"number"!=typeof t||isNaN(t)?0:Math.floor(t)||0};t.getBmgSrc=function(e,o){var s;if(void 0===o&&(o={c:!0}),"string"!=typeof e)return"";if(!(0,t.isSupportBmgFormat)(e))return e;if(e.indexOf("@")>-1){if(o.cache)return e;e=e.split("@")[0]}e=e.replace("pre-","");var l=o.dpr||((0,i.default)()?2:Math.floor(null!==(s=null===window||void 0===window?void 0:window.devicePixelRatio)&&void 0!==s?s:2)||1),c=[];o.w&&(0,r.isInt)(o.w)&&c.push("".concat(Math.floor(o.w*l),"w")),o.h&&(0,r.isInt)(o.h)&&c.push("".concat(Math.floor(o.h*l),"h")),o.e&&c.push("".concat(o.e,"e")),o.c&&c.push("1c"),o.a&&c.push("".concat([a(o.a.x),a(o.a.y),a(o.a.w)*l,a(o.a.h)*l].join("-"),"a")),o.p&&(0,r.isInt)(o.p)&&c.push("".concat(o.p,"p")),o.s&&c.push("1s"),o.q&&(0,r.isInt)(o.q)&&c.push("".concat(o.q,"q")),o.style&&c.push("!".concat(o.style));var u="";return o.ext&&["webp","avif"].includes(o.ext)&&(u=o.ext),0!==c.length||u?"".concat((0,n.default)(e),"@").concat(c.join("_")).concat(u?".".concat(u):""):e}}(rt);var ct,ut={};function dt(t){return dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dt(t)}Object.defineProperty(ut,"__esModule",{value:!0});var pt="__BMG_TRACKER_COLLECT_QUEUE__",ht="__BMG_TRACKER_COLLECT_EXTS__",ft="__BMG_TRACKER_COLLECT_MODE__",vt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==X?X:"undefined"!=typeof self?self:{},mt={};Object.defineProperty(mt,"__esModule",{value:!0});var bt=!0,yt=mt.default=function(){return bt&&(bt="undefined"==typeof window),bt},gt={};Object.defineProperty(gt,"__esModule",{value:!0});var wt=/\.(jpeg|jpg|png|webp|gif|avif)$/,xt=gt.default=function(t){var e;return(null===(e=t.match(wt))||void 0===e?void 0:e[0])||null},kt={};!function(t){var e=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseAvif=t.canUseAvif=t.setAvif=void 0;var n,i=e(mt);t.setAvif=function(t){n=t},t.canUseAvif=function(){return!(0,i.default)()&&void 0!==n&&n},t.asyncCanUseAvif=function(){return new Promise((function(e){if((0,i.default)())return e(!1);if((0,t.canUseAvif)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setAvif)(!1),e(!1)},n.onload=function(){(0,t.setAvif)(!0),e(!0)},n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="}))}}(kt);var _t={};!function(t){var e=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseWebP=t.canUseWebP=t.setWebp=void 0;var n,i=e(mt);t.setWebp=function(t){n=t},t.canUseWebP=function(){var t,e,r,o;if((0,i.default)())return!1;if(void 0!==n)return n;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return n=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var a=document.createElement("canvas");n=!!(null===(e=a.getContext)||void 0===e?void 0:e.call(a,"2d"))&&0===(null===(o=null===(r=a.toDataURL)||void 0===r?void 0:r.call(a,"image/webp"))||void 0===o?void 0:o.indexOf("data:image/webp"))}catch(t){n=!1}return n},t.asyncCanUseWebP=function(){return new Promise((function(e){if((0,i.default)())return e(!1);if((0,t.canUseWebP)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setWebp)(!1),e(!1)},n.onload=function(){(0,t.setWebp)(!0),e(!0)},n.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="}))}}(_t);var At="BMG_EXTS",Et=null,Ct=function(){if(Et)return Et;try{Et=(localStorage.getItem(At)||"").split(",")}catch(t){console.warn(t),Et=[]}return Et},Tt=function(t){if(void 0===t&&(t=!1),!window[ht]||t){var e=Ct();window[ht]={avif:e.includes("avif"),webp:e.includes("webp")}}},St=function(t){return function(e){switch(function(){var t=[],e=window[ht]||{avif:!1,webp:!1};e.avif&&t.push("avif"),e.webp&&t.push("webp");try{localStorage.setItem(At,t.join(","))}catch(t){console.warn(t)}}(),t){case"avif":kt.setAvif(e);break;case"webp":_t.setWebp(e)}}},Ot=function(t){var e;"object"!=dt(window[ht])&&Tt(),(null===(e=window[ht])||void 0===e?void 0:e[t])||(window[ht][t]=!0,St(t)(!0))},Pt=function(){return window[ft]};ut.collect=function(t,e,n){if(!yt()){var i=yt()?null:window.__BMG_TRACKER__||null;n=n||Pt();var r=(xt(t)||"").substring(1);if(["avif","webp"].indexOf(r)>-1&&Ot(r),"onlyext"!==n)if(i)i.collect(t,e);else if("nocache"!==n){var o={src:t,type:e,ts:Date.now()/1e3|0};Array.isArray(window[pt])?window[pt].push(o):window[pt]=[o]}}},ut.getCollectMode=Pt,ut.getLocalExtsState=Ct,ct=ut.getWindowExtsState=function(t){var e,n;return"avif"===t?(null===(e=window[ht])||void 0===e?void 0:e.avif)||!1:"webp"===t?(null===(n=window[ht])||void 0===n?void 0:n.webp)||!1:window[ht]||null},ut.initWindowExtsState=Tt,ut.setCollectMode=function(t){window[ft]=t},ut.updateExtState=St,ut.updateWindowExtsState=Ot;var It=new RegExp(function(t,e){return"".concat(t).concat(e,".hdslb.com")}("(s|i)","\\d")),Rt=function(t){if(J())return t||"";var e=window.__BMG_AF__;return(null==e?void 0:e.defDomain)?(e.defUpdated,e.defDomain):t||""},jt=function(t,e){var n;if(!e)return t;var i=(null===(n=t.match(It))||void 0===n?void 0:n[0])||"";return i&&i!==e?t.replace(It,e):t},Lt=function(t,e,n){var i="";return J()?rt.getBmgSrc((null==n?void 0:n.domain)?jt(t,n.domain):t,e):(i=ct("avif")?"avif":ct("webp")?"webp":Y.autoDetect(["avif","webp"]),rt.getBmgSrc(jt(t,Rt(null==n?void 0:n.domain)),Object.assign(Object.assign({},e),{ext:i})))},Mt=function(t,e,n){n=(null==n?void 0:n.filter(Boolean))||[];var i="img"===t?">":">".concat(n.length?n.join(""):"","</").concat(t,">");return"<".concat(t," ").concat(Object.keys(e).filter((function(t){return"string"==typeof e[t]})).map((function(t){return"".concat(t,'="').concat((n=e[t]||"")?n.replace(i||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,(function(t,e){return e?t:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[t]||""})):"",'"');var n,i})).join(" ")," ").concat(i)},Dt=function(t){return t?"".concat(t,"(this)"):""},Nt=function(t,e){return-1===t.indexOf("@")?"".concat(t,"@.").concat(e):(t=t.replace(new RegExp(".(avif|webp)$"),""),"".concat(t,".").concat(e))},Bt=function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return P()?"":n&&(null===(t=window[z])||void 0===t?void 0:t.avif)?"avif":(null===(e=window[z])||void 0===e?void 0:e.webp)?"webp":function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["webp"],e=0;e<t.length;e++){if("avif"===t[e]&&(P(),0))return t[e];if("webp"===t[e]&&I())return t[e]}return""}()},zt=function(t,e,n){var i,r,o=[],a="";e.class?(o.push(e.class),a=o.join(" ")):a="",t=jt(t,Rt(null==n?void 0:n.domain));var s=!!(null===(i=null==n?void 0:n.exts)||void 0===i?void 0:i.avif),l=!1!==(null===(r=null==n?void 0:n.exts)||void 0===r?void 0:r.webp),c=!(s||l),u=!!(null==n?void 0:n.performance),d=L(t)&&((null==n?void 0:n.tag)?"picture"===n.tag:!P()&&!!window.HTMLPictureElement),p=!W()&&U(window[N])&&U(window[B]),h={};if("object"===k(e.dataset))for(var f in e.dataset)h["data-".concat(f)]=e.dataset[f];var v=c?void 0:Bt(u&&s),m=!1;u&&(s&&"avif"===v||l&&"webp"===v||c&&""===v)&&(m=!0),!m&&d&&!0===(null==n?void 0:n.safe)&&(v=void 0);var b=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{c:!0};if("string"!=typeof t)return"";if(!L(t))return t;if(t.indexOf("@")>-1){if(n.cache)return t;t=t.split("@")[0]}t=t.replace("pre-","");var i=n.dpr||(P()?2:Math.floor(null!==(e=null===window||void 0===window?void 0:window.devicePixelRatio)&&void 0!==e?e:2)||1),r=[];n.w&&R(n.w)&&r.push("".concat(Math.floor(n.w*i),"w")),n.h&&R(n.h)&&r.push("".concat(Math.floor(n.h*i),"h")),n.e&&r.push("".concat(n.e,"e")),n.c&&r.push("1c"),n.a&&r.push("".concat([M(n.a.x),M(n.a.y),M(n.a.w)*i,M(n.a.h)*i].join("-"),"a")),n.p&&R(n.p)&&r.push("".concat(n.p,"p")),n.s&&r.push("1s"),n.q&&R(n.q)&&r.push("".concat(n.q,"q")),n.style&&r.push("!".concat(n.style));var o,a="";return n.ext&&["webp","avif"].includes(n.ext)&&(a=n.ext),0!==r.length||a?"".concat((o=t,o?o.replace(/^http(s)?:/,""):""),"@").concat(r.join("_")).concat(a?".".concat(a):""):t}(t,Object.assign({},e,{ext:v})),y=Mt("img",Object.assign({src:b,class:m||!d?a:null,alt:e.alt||null,loading:(null==e?void 0:e.loading)?"lazy":null,onload:p?Dt(N):Dt((null==n?void 0:n.onload)||"")||null,onerror:p?Dt(B):Dt((null==n?void 0:n.onerror)||"")||null,"data-onload":p&&(null==n?void 0:n.onload)||null,"data-onerror":p&&(null==n?void 0:n.onerror)||null},h));return m?y:d?Mt("picture",{class:a||null},[s&&Mt("source",{type:"image/avif",srcset:Nt(b,"avif")})||"",l&&Mt("source",{type:"image/webp",srcset:Nt(b,"webp")})||"",y]):y};"undefined"!=typeof window&&function(t){if(void 0===t&&(t=!1),!window[z]||t){var e=function(){if(G)return G;try{G=(localStorage.getItem("BMG_EXTS")||"").split(",")}catch(t){console.warn(t),G=[]}return G}();window[z]={avif:e.includes("avif"),webp:e.includes("webp")}}}();var Ut="onAvtSrcError",Ft={animationWebpSrc:0,maskImageStyle:0},Vt=function(t,e){Ft[t]=e?1:2},Ht=function(){return s((function t(e,n){o(this,t),this.payload=e,this.size=n,this.layers=[],this.id=e.group_id,this.createElement()}),[{key:"createElement",value:function(){this.el=document.createElement("div"),this.el.classList.add("layers")}},{key:"render",value:function(){var t=i(m().mark((function t(){var e=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all(this.payload.layers.filter((function(t){return!!t.visible})).map((function(t){return e.addLayer(t,e.size)})));case 3:return t.abrupt("return",this);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",Promise.reject(t.t0));case 9:case"end":return t.stop()}}),t,this,[[0,6]])})));return function(){return t.apply(this,arguments)}}()},{key:"addLayer",value:(t=i(m().mark((function t(e,n){var i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new qt(e,n).render();case 3:i=t.sent,this.layers.push(i),this.el.appendChild(i.el),t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",Promise.reject(t.t0));case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(e,n){return t.apply(this,arguments)})},{key:"removeLayer",value:function(t){var e=this.layers.findIndex((function(e){return e.id===t}));if(e>-1){var n=this.layers[e];this.el.removeChild(n.el),this.layers.splice(e,1)}}}]);var t}(),Wt=function(){return s((function t(e,n){switch(o(this,t),this.localSrcList=["//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local1.png","//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local2.png","//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local3.png","//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local4.png","//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local5.png","//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local6.jpeg"],this.type=e.res_type,this.createElement(),this.type){case 3:this.loadLocal(e.res_image.image_src.placeholder),this.load(e.res_image.image_src,n);break;case 4:this.play(e.res_animation.webp_src,n);break;case 5:this.draw(e.res_native_draw.draw_src.draw)}}),[{key:"createElement",value:function(){this.el=document.createElement("div"),this.el.classList.add("layer-res")}},{key:"registerHandler",value:function(){var t=window;t[Ut]||(t[Ut]=function(t){t.style.opacity="0"})}},{key:"setStyle",value:function(t,e){this.el.style[t]=e}},{key:"draw",value:function(t){var e,n=t.draw_type,i=t.fill_mode,r=t.color_config;1===n&&this.setStyle("borderRadius","50%"),1===i&&this.setStyle("backgroundColor",null==(e=null==r?void 0:r.day)?void 0:e.argb)}},{key:"play",value:(t=i(m().mark((function t(e,n){var i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.src_type,t.t0=i,t.next=1===t.t0?4:2===t.t0?11:3===t.t0?12:13;break;case 4:return t.prev=4,t.abrupt("return",(this.setStyle("background","url(".concat(Lt(e.remote.url,{w:Math.floor(n.width),h:Math.floor(n.height),c:!0,dpr:2}),") center / cover no-repeat")),!0));case 8:return t.prev=8,t.t1=t.catch(4),t.abrupt("return",Promise.reject(t.t1));case 11:return t.abrupt("return",(this.loadLocal(e.local),!0));case 12:return t.abrupt("return",(this.draw(e.draw),!0));case 13:return t.abrupt("return",!0);case 14:case"end":return t.stop()}}),t,this,[[4,8]])}))),function(e,n){return t.apply(this,arguments)})},{key:"load",value:function(t,e){switch(t.src_type){case 1:this.registerHandler(),this.el.innerHTML=zt(t.remote.url,{w:Math.floor(e.width),h:Math.floor(e.height),s:!0,c:!0,dpr:2},{onerror:Ut,exts:{avif:!0}});break;case 2:this.loadLocal(t.local);break;case 3:this.draw(t.draw)}}},{key:"loadLocal",value:function(t){var e=Math.floor(t)-1;e>-1&&this.localSrcList[e]&&this.setStyle("backgroundImage","url(".concat(this.localSrcList[e],")"))}}]);var t}(),$t=function(t,e){return new Promise((function(n,i){if(!t)return i();var r=new Image;r.crossOrigin="anonymous",r.src=t,r.onload=function(){if(!e)return n(t);e(r).then(n).catch(i)},r.onerror=function(){i()}}))},qt=function(){return s((function t(e,n){o(this,t),this.payload=e,this.size=n,this.id=e.layer_id,this.createElement()}),[{key:"createElement",value:function(){this.el=document.createElement("div"),this.el.classList.add("layer")}},{key:"render",value:(e=i(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.renderGeneralSpec(),t.next=4,this.renderResource();case 4:return this.renderTag(),this.renderMask(),t.abrupt("return",this);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",Promise.reject(t.t0));case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return e.apply(this,arguments)})},{key:"renderGeneralSpec",value:function(){var t=this.payload.general_spec;t.pos_spec&&(2===t.pos_spec.coordinate_pos?this.el.classList.add("center"):(this.el.style.left="".concat(t.pos_spec.axis_x*this.size.width,"px"),this.el.style.top="".concat(t.pos_spec.axis_y*this.size.height,"px"))),t.size_spec&&(this.size={width:t.size_spec.width*this.size.width,height:t.size_spec.height*this.size.height},this.el.style.width="".concat(this.size.width,"px"),this.el.style.height="".concat(this.size.height,"px")),t.render_spec&&"number"==typeof t.render_spec.opacity&&(this.el.style.opacity=String(t.render_spec.opacity))}},{key:"renderTag",value:function(){var t,e=null==(t=this.payload.layer_config)?void 0:t.tags;if(e)for(var n in e){var i=e[n],r=i.config_type,o=i.general_config;if(1===r&&o){var a=o.web_css_style;if(a)for(var s in a)this.el.style[s]=a[s]}}}},{key:"renderMask",value:(t=i(m().mark((function t(){var e,n,i,r,o,a;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=null==(e=this.payload.layer_config)?void 0:e.layer_mask){t.next=3;break}return t.abrupt("return");case 3:if(1!==(r=i.mask_src).src_type){t.next=18;break}t.t0=Ft.maskImageStyle,t.next=0===t.t0?8:2===t.t0?10:11;break;case 8:return Vt("maskImageStyle",!0),t.abrupt("break",11);case 10:throw new Error("Not support [maskImageStyle]");case 11:return o=Lt(r.remote.url,{w:Math.round(this.size.width),h:Math.round(this.size.height)}),t.next=14,$t(o);case 14:a=t.sent,this.resource.setStyle("-webkit-mask-image","url(".concat(a,")")),this.resource.setStyle("-webkit-mask-size","cover"),t.next=19;break;case 18:3===(null==r?void 0:r.src_type)&&1===(null==(n=r.draw)?void 0:n.draw_type)&&this.resource.setStyle("borderRadius","50%");case 19:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"renderResource",value:function(){this.resource=new Wt(this.payload.resource,this.size),this.el.appendChild(this.resource.el)}}]);var t,e}(),Gt=("undefined"==typeof globalThis?"undefined":k(globalThis))<"u"?globalThis:("undefined"==typeof window?"undefined":k(window))<"u"?window:("undefined"==typeof global?"undefined":k(global))<"u"?global:("undefined"==typeof self?"undefined":k(self))<"u"?self:{},Xt={},Yt={};Object.defineProperty(Yt,"__esModule",{value:!0});var Zt=!0;Yt.default=function(){return Zt&&(Zt=("undefined"==typeof window?"undefined":k(window))>"u"),Zt};var Qt=Gt&&Gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Xt,"__esModule",{value:!0});var Kt=Xt.unobserve=ne=Xt.observe=void 0,Jt=Qt(Yt),te=null;(0,Jt.default)()||window.IntersectionObserver;var ee=function(t,e){t.forEach((function(t){var e,n;null===(n=null===(e=t.target)||void 0===e?void 0:e.__i18r_callback__)||void 0===n||n.call(e,t)}))},ne=Xt.observe=function(t,e){(0,Jt.default)()||(te||(te=new IntersectionObserver(ee)),t.__i18r_callback__=e,te.observe(t))};Kt=Xt.unobserve=function(t){var e;te&&(null===(e=te.unobserve)||void 0===e||e.call(te,t),delete t.__i18r_callback__)};var ie=function(t){function e(){var t;return o(this,e),(t=r(this,e)).loaded=!1,t.size={width:0,height:0},t.config={baseSize:0,isFloat:!1,lazyload:!1},t.layers=[],t.attachShadow({mode:"open"}),t.shadowRoot&&(t.shadowRoot.innerHTML='\n        <style>\n          :host {\n            display: inline-block;\n            position: relative;\n            width: var(--avatar-width);\n            height: var(--avatar-height);\n          }\n          #canvas {\n            width: var(--avatar-canvas-width);\n            height: var(--avatar-canvas-height);\n            position: absolute;\n            left: 50%;\n            top: 50%;\n            transform: translate(-50%, -50%);\n            pointer-events: none;\n          }\n          .layers {\n            position: absolute;\n            left: 0;\n            right: 0;\n            top: 0;\n            bottom: 0;\n          }\n          .layer {\n            position: absolute;\n            isolation: isolate;\n            overflow: hidden;\n          }\n          .layer.center {\n            left: 50%;\n            top: 50%;\n            transform: translate(-50%, -50%);\n          }\n          .layer-res {\n            width: 100%;\n            height: 100%;\n            isolation: isolate;\n            overflow: hidden;\n            background-size: cover;\n            background-repeat: no-repeat;\n            background-position: center;\n          }\n          .layer-res picture {\n            display: inline-block;\n          }\n          .layer-res div,\n          .layer-res picture,\n          .layer-res img {\n            width: 100%;\n            height: 100%;\n          }\n        </style>\n        <div id="canvas"></div>\n      ',t.canvasElement=t.shadowRoot.querySelector("#canvas")),t}return p(e,t),s(e,[{key:"disconnectedCallback",value:function(){this.config.lazyload&&!this.loaded&&Kt(this.canvasElement),this.clearCanvas(),this.clearLayers(),this.loaded=!1}},{key:"load",value:function(t,e){var n={width:0,height:0};"number"==typeof e?(n.width=e,n.height=e):"object"==k(e)?("number"==typeof e.baseSize?(n.width=e.baseSize,n.height=e.baseSize):"object"==k(e.baseSize)?(n.width=e.baseSize.width,n.height=e.baseSize.height):console.warn("Not found 'baseSize' in Avatar Config"),this.config.isFloat=e.isFloat||!1,this.config.lazyload=e.lazyload||!1):console.warn("Not found 'baseSize' in Avatar Config"),this.size=v({},n),this.config.baseSize=n,this.initCanvas(t),this.renderLayers(t)}},{key:"renderLayers",value:function(t){var e,n=this;if(this.config.lazyload&&!this.loaded)return this.renderDefaultLayers(),void ne(this.canvasElement,(function(e){e.isIntersecting&&(n.loaded=!0,n.renderLayers(t),Kt(n.canvasElement))}));null!=(e=t.layers)&&e.length?this.renderNormalLayers(t):t.fallback_layers&&this.renderFallbackLayers(t.fallback_layers)}},{key:"initCanvas",value:function(t){var e=this.size.width*t.container_size.width,n=this.size.height*t.container_size.height;this.config.isFloat?(this.style.setProperty("--avatar-width","".concat(this.size.width,"px")),this.style.setProperty("--avatar-height","".concat(this.size.height,"px"))):(this.style.setProperty("--avatar-width",e+"px"),this.style.setProperty("--avatar-height",n+"px")),this.canvasElement.style.setProperty("--avatar-canvas-width",e+"px"),this.canvasElement.style.setProperty("--avatar-canvas-height",n+"px")}},{key:"renderDefaultLayers",value:(c=i(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.addLayerGroup({group_id:"",layers:[{layer_id:"",layer_config:{allow_over_paint:!1,is_critical:!0,layer_mask:null,tags:{AVATAR_LAYER:{config_type:0},GENERAL_CONFIG:{config_type:1,general_config:{web_css_style:{borderRadius:"50%"}}}}},general_spec:{pos_spec:{axis_x:.675,axis_y:.675,coordinate_pos:2},render_spec:{opacity:1},size_spec:{height:1,width:1}},visible:!0,resource:{res_type:3,res_image:{image_src:{src_type:2,placeholder:6,local:6}}}}],group_mask:null,is_critical_group:!0},this.size);case 2:this.renderCanvas();case 3:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"renderNormalLayers",value:(l=i(m().mark((function t(e){var n=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all(e.layers.map((function(t){return n.addLayerGroup(t,n.size)})));case 3:this.renderCanvas(),t.next=10;break;case 6:return t.prev=6,t.t0=t.catch(0),this.clearCanvas(),this.clearLayers(),this.renderFallbackLayers(e.fallback_layers),t.abrupt("return");case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return l.apply(this,arguments)})},{key:"renderFallbackLayers",value:(a=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.addLayerGroup(e,this.size);case 3:this.renderCanvas(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),this.clearCanvas(),this.clearLayers(),this.renderDefaultLayers();case 9:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return a.apply(this,arguments)})},{key:"clearCanvas",value:function(){var t=this;Array.from(this.canvasElement.children).forEach((function(e){t.canvasElement.removeChild(e)}))}},{key:"clearLayers",value:function(){this.layers=[]}},{key:"renderCanvas",value:function(){var t=this;this.clearCanvas(),this.layers.forEach((function(e){t.canvasElement.appendChild(e.el)}))}},{key:"addLayerGroup",value:(n=i(m().mark((function t(e,n){var i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Ht(e,n).render();case 3:i=t.sent,this.layers.push(i),t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",Promise.reject(t.t0));case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t,e){return n.apply(this,arguments)})}]);var n,a,l,c}(A(HTMLElement));customElements.get("bili-avatar")||customElements.define("bili-avatar",ie);var re=function(){function t(){o(this,t),this.disposables=[]}return s(t,[{key:"addEventListener",value:function(t,e,n,i){return this.add(function(t,e,n,i){return t.addEventListener(e,n,i),function(){!function(t,e,n,i){t.removeEventListener(e,n,i)}(t,e,n,i)}}(t,e,n,i))}},{key:"mutationObserve",value:function(t,e,n){var i=!1,r=new MutationObserver(e);return r.observe(t,n),function(){return function(t){i||(i=!0,t.disconnect())}(r)}}},{key:"requestAnimationFrame",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=requestAnimationFrame.apply(void 0,arguments);return this.add((function(){return cancelAnimationFrame(t)}))}))},{key:"nextFrame",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.requestAnimationFrame((function(){return t.requestAnimationFrame.apply(t,n)}))}},{key:"setTimeout",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=setTimeout.apply(void 0,arguments);return this.add((function(){return clearTimeout(t)}))}))},{key:"microTask",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i={current:!0};return function(t){"function"==typeof queueMicrotask?queueMicrotask(t):Promise.resolve().then(t).catch((function(t){return setTimeout((function(){throw t}))}))}((function(){i.current&&e[0]()})),this.add((function(){i.current=!1}))}},{key:"style",value:function(t,e,n){var i=t.style.getPropertyValue(e);return Object.assign(t.style,c({},e,n)),this.add((function(){Object.assign(t.style,c({},e,i))}))}},{key:"group",value:function(e){var n=new t;return e(n),this.add((function(){return n.dispose()}))}},{key:"add",value:function(t){var e=this;return this.disposables.push(t),function(){var n=e.disposables.indexOf(t);n>=0&&e.remove(n,1)}}},{key:"remove",value:function(t,e){var n,i=l(this.disposables.splice(t,null!=e?e:this.disposables.length));try{for(i.s();!(n=i.n()).done;){(0,n.value)()}}catch(t){i.e(t)}finally{i.f()}}},{key:"dispose",value:function(){this.remove(0)}}])}();("undefined"==typeof window?"undefined":k(window))<"u"&&(window.__BILI_POPPER_ZINDEX__||(window.__BILI_POPPER_ZINDEX__=1e3));var oe=function(t){function e(){var t;return o(this,e),(t=r(this,e)).disposables=new re,t.state={label:"",value:"",name:"",disabled:!1,checked:!1},t.attachShadow({mode:"open"}),t.shadowRoot&&(t.shadowRoot.innerHTML='\n        <style>\n          :host {\n            --bili-checkbox-size: 16px;\n            --bili-checkbox-font-size: 14px;\n            --bili-checkbox-border-width: 1px;\n            --bili-checkbox-border-radius: 2px;\n            --bili-checkbox-checked-color: var(--brand_blue);\n            --bili-checkbox-margin-inline-end: 8px;\n\n            display: inline-flex;\n            align-items: baseline;\n            padding: 0;\n            margin: 0;\n            cursor: pointer;\n            margin-inline-end: var(--bili-checkbox-margin-inline-end);\n          }\n          #input {\n            box-sizing: border-box;\n            margin: 0;\n            padding: 0;\n            list-style: none;\n            position: relative;\n            display: inline-block;\n            outline: none;\n            cursor: pointer;\n            align-self: center;\n            border-radius: var(--bili-checkbox-border-radius);\n            width: var(--bili-checkbox-size);\n            height: var(--bili-checkbox-size);\n          }\n          #input input {\n            bottom: 0;\n            left: 0;\n            margin: 0;\n            opacity: 0;\n            outline: none;\n            position: absolute;\n            right: 0;\n            top: 0;\n            z-index: -1;\n          }\n          #input #inner {\n            display: block;\n            background-color: var(--bg1_float);\n            border: 1px solid var(--text4);\n            border-radius: var(--bili-checkbox-border-radius);\n            box-sizing: border-box;\n            width: 100%;\n            height: 100%;\n            transition: all .3s ease-in-out;\n          }\n          #input #inner:hover {\n            border-color: var(--bili-checkbox-checked-color);\n          }\n          #input[checked] #inner {\n            border-color: var(--bili-checkbox-checked-color);\n            background-color: var(--bili-checkbox-checked-color);\n          }\n          #input[checked] #inner::after {\n            transform: rotate(45deg) scale(1) translate(-65%, -50%);\n            opacity: 1;\n          }\n          #input #inner::after {\n            content: "";\n            position: absolute;\n            top: 50%;\n            left: 25%;\n            display: table;\n            width: 4px;\n            height: 8px;\n            border: 2px solid var(--text_white);\n            opacity: 0;\n            border-top: 0;\n            border-left: 0;\n            transition: all .3s ease-in-out;\n            transform: rotate(45deg) scale(0) translate(-50%, -50%);\n          }\n          #label {\n            margin-left: 8px;\n            font-size: var(--bili-checkbox-font-size);\n            color: var(--text2);\n          }\n        </style>\n        <span id="input">\n          <input type="checkbox">\n          <span id="inner"></span>\n        </span>\n        <slot>\n          <span id="label"></span>\n        </slot>\n      '),t}return p(e,t),s(e,[{key:"connectedCallback",value:function(){var t=this;if(this.shadowRoot){var n=this.getAttribute("label");e.observedAttributes.forEach((function(e){var i=t.getAttribute(e);null!==i&&("value"===e&&!n&&t.updateAttribute("label",i),t.updateAttribute(e,i))})),this.shadowRoot&&this.disposables.addEventListener(this,"click",(function(){if(!t.state.disabled){t.state.checked=!t.state.checked,t.updateInput("checked",t.state.checked);var e={name:t.state.name,value:t.state.value,checked:t.state.checked},n=new CustomEvent("change",{detail:e});t.parentElement&&t.parentElement.isCheckboxGroup&&t.parentElement.onCheckboxChange(n),t.dispatchEvent(n)}}))}}},{key:"disconnectedCallback",value:function(){this.disposables.dispose()}},{key:"updateInput",value:function(t,e){var n,i,r=null==(n=this.shadowRoot)?void 0:n.querySelector("#input"),o=null==(i=this.shadowRoot)?void 0:i.querySelector("input");if(r&&o)switch(t){case"value":o.setAttribute(t,e);break;case"disabled":case"checked":e?(r.setAttribute(t,""),o.setAttribute(t,"")):(r.removeAttribute(t),o.removeAttribute(t))}}},{key:"updateLabel",value:function(t){var e,n=null==(e=this.shadowRoot)?void 0:e.querySelector("#label");n&&(n.textContent=t)}},{key:"updateAttribute",value:function(t,e){switch(t){case"name":this.state.name=e;break;case"label":this.updateLabel(e),this.state.label=e;break;case"value":this.updateInput(t,e),this.state[t]=e;break;case"disabled":case"checked":this.updateInput(t,"true"===e),this.state[t]="true"===e}}},{key:"attributeChangedCallback",value:function(t,e,n){this.updateAttribute(t,n)}}],[{key:"observedAttributes",get:function(){return["name","value","label","disabled","checked"]}}])}(A(HTMLElement));oe.elName="bili-checkbox";var ae=oe,se=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).isCheckboxGroup=!0,t.valueList=[],t}return p(e,t),s(e,[{key:"onCheckboxChange",value:function(t){var e=t.detail,n=e.value;if(e.checked){if(this.valueList.includes(n))return;return this.valueList.push(n),void this.dispatchEvent(new CustomEvent("change",{detail:w(this.valueList)}))}var i=this.valueList.indexOf(n);-1!==i&&(this.valueList.splice(i,1),this.dispatchEvent(new CustomEvent("change",{detail:w(this.valueList)})))}}])}(A(HTMLElement));se.elName="bili-checkbox-group",customElements.get(ae.elName)||(customElements.define(ae.elName,ae),customElements.define(se.elName,se));
/**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
var le,ce,ue=window,de=ue.ShadowRoot&&(void 0===ue.ShadyCSS||ue.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,pe=Symbol(),he=new WeakMap,fe=function(){return s((function t(e,n,i){if(o(this,t),this._$cssResult$=!0,i!==pe)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}),[{key:"styleSheet",get:function(){var t=this.o,e=this.t;if(de&&void 0===t){var n=void 0!==e&&1===e.length;n&&(t=he.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),n&&he.set(e,t))}return t}},{key:"toString",value:function(){return this.cssText}}])}(),ve=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r=1===t.length?t[0]:n.reduce((function(e,n,i){return e+function(t){if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")}(n)+t[i+1]}),t[0]);return new fe(r,t,pe)},me=de?function(t){return t}:function(t){return t instanceof CSSStyleSheet?function(t){var e,n="",i=l(t.cssRules);try{for(i.s();!(e=i.n()).done;){n+=e.value.cssText}}catch(t){i.e(t)}finally{i.f()}return function(t){return new fe("string"==typeof t?t:t+"",void 0,pe)}(n)}(t):t},be=window,ye=be.trustedTypes,ge=ye?ye.emptyScript:"",we=be.reactiveElementPolyfillSupport,xe={toAttribute:function(t,e){switch(e){case Boolean:t=t?ge:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute:function(t,e){var n=t;switch(e){case Boolean:n=null!==t;break;case Number:n=null===t?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch(t){n=null}}return n}},ke=function(t,e){return e!==t&&(e==e||t==t)},_e={attribute:!0,type:String,converter:xe,reflect:!1,hasChanged:ke},Ae="finalized",Ee=function(t){function e(){var t;return o(this,e),(t=r(this,e))._$Ei=new Map,t.isUpdatePending=!1,t.hasUpdated=!1,t._$El=null,t._$Eu(),t}return p(e,t),s(e,[{key:"_$Eu",value:function(){var t,e=this;this._$E_=new Promise((function(t){return e.enableUpdating=t})),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((function(t){return t(e)}))}},{key:"addController",value:function(t){var e,n;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(n=t.hostConnected)||void 0===n||n.call(t))}},{key:"removeController",value:function(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}},{key:"_$Eg",value:function(){var t=this;this.constructor.elementProperties.forEach((function(e,n){t.hasOwnProperty(n)&&(t._$Ei.set(n,t[n]),delete t[n])}))}},{key:"createRenderRoot",value:function(){var t,e=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return function(t,e){de?t.adoptedStyleSheets=e.map((function(t){return t instanceof CSSStyleSheet?t:t.styleSheet})):e.forEach((function(e){var n=document.createElement("style"),i=ue.litNonce;void 0!==i&&n.setAttribute("nonce",i),n.textContent=e.cssText,t.appendChild(n)}))}(e,this.constructor.elementStyles),e}},{key:"connectedCallback",value:function(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((function(t){var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}},{key:"enableUpdating",value:function(t){}},{key:"disconnectedCallback",value:function(){var t;null===(t=this._$ES)||void 0===t||t.forEach((function(t){var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}},{key:"attributeChangedCallback",value:function(t,e,n){this._$AK(t,n)}},{key:"_$EO",value:function(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_e,r=this.constructor._$Ep(t,i);if(void 0!==r&&!0===i.reflect){var o=(void 0!==(null===(n=i.converter)||void 0===n?void 0:n.toAttribute)?i.converter:xe).toAttribute(e,i.type);this._$El=t,null==o?this.removeAttribute(r):this.setAttribute(r,o),this._$El=null}}},{key:"_$AK",value:function(t,e){var n,i=this.constructor,r=i._$Ev.get(t);if(void 0!==r&&this._$El!==r){var o=i.getPropertyOptions(r),a="function"==typeof o.converter?{fromAttribute:o.converter}:void 0!==(null===(n=o.converter)||void 0===n?void 0:n.fromAttribute)?o.converter:xe;this._$El=r,this[r]=a.fromAttribute(e,o.type),this._$El=null}}},{key:"requestUpdate",value:function(t,e,n){var i=!0;void 0!==t&&(((n=n||this.constructor.getPropertyOptions(t)).hasChanged||ke)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===n.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,n))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}},{key:"_$Ej",value:(n=i(m().mark((function t(){var e;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isUpdatePending=!0,t.prev=1,t.next=4,this._$E_;case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),Promise.reject(t.t0);case 9:if(e=this.scheduleUpdate(),t.t1=null!=e,!t.t1){t.next=14;break}return t.next=14,e;case 14:return t.abrupt("return",!this.isUpdatePending);case 15:case"end":return t.stop()}}),t,this,[[1,6]])}))),function(){return n.apply(this,arguments)})},{key:"scheduleUpdate",value:function(){return this.performUpdate()}},{key:"performUpdate",value:function(){var t,e=this;if(this.isUpdatePending){this.hasUpdated,this._$Ei&&(this._$Ei.forEach((function(t,n){return e[n]=t})),this._$Ei=void 0);var n=!1,i=this._$AL;try{(n=this.shouldUpdate(i))?(this.willUpdate(i),null===(t=this._$ES)||void 0===t||t.forEach((function(t){var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(i)):this._$Ek()}catch(t){throw n=!1,this._$Ek(),t}n&&this._$AE(i)}}},{key:"willUpdate",value:function(t){}},{key:"_$AE",value:function(t){var e;null===(e=this._$ES)||void 0===e||e.forEach((function(t){var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}},{key:"_$Ek",value:function(){this._$AL=new Map,this.isUpdatePending=!1}},{key:"updateComplete",get:function(){return this.getUpdateComplete()}},{key:"getUpdateComplete",value:function(){return this._$E_}},{key:"shouldUpdate",value:function(t){return!0}},{key:"update",value:function(t){var e=this;void 0!==this._$EC&&(this._$EC.forEach((function(t,n){return e._$EO(n,e[n],t)})),this._$EC=void 0),this._$Ek()}},{key:"updated",value:function(t){}},{key:"firstUpdated",value:function(t){}}],[{key:"addInitializer",value:function(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}},{key:"observedAttributes",get:function(){var t=this;this.finalize();var e=[];return this.elementProperties.forEach((function(n,i){var r=t._$Ep(i,n);void 0!==r&&(t._$Ev.set(r,i),e.push(r))})),e}},{key:"createProperty",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_e;if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){var n="symbol"==k(t)?Symbol():"__"+t,i=this.getPropertyDescriptor(t,n,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}}},{key:"getPropertyDescriptor",value:function(t,e,n){return{get:function(){return this[e]},set:function(i){var r=this[t];this[e]=i,this.requestUpdate(t,r,n)},configurable:!0,enumerable:!0}}},{key:"getPropertyOptions",value:function(t){return this.elementProperties.get(t)||_e}},{key:"finalize",value:function(){if(this.hasOwnProperty(Ae))return!1;this[Ae]=!0;var t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=w(t.h)),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){var e,n=this.properties,i=l([].concat(w(Object.getOwnPropertyNames(n)),w(Object.getOwnPropertySymbols(n))));try{for(i.s();!(e=i.n()).done;){var r=e.value;this.createProperty(r,n[r])}}catch(t){i.e(t)}finally{i.f()}}return this.elementStyles=this.finalizeStyles(this.styles),!0}},{key:"finalizeStyles",value:function(t){var e=[];if(Array.isArray(t)){var n,i=l(new Set(t.flat(1/0).reverse()));try{for(i.s();!(n=i.n()).done;){var r=n.value;e.unshift(me(r))}}catch(t){i.e(t)}finally{i.f()}}else void 0!==t&&e.push(me(t));return e}},{key:"_$Ep",value:function(t,e){var n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}}]);var n}(A(HTMLElement));Ee[Ae]=!0,Ee.elementProperties=new Map,Ee.elementStyles=[],Ee.shadowRootOptions={mode:"open"},null==we||we({ReactiveElement:Ee}),(null!==(le=be.reactiveElementVersions)&&void 0!==le?le:be.reactiveElementVersions=[]).push("1.6.3");var Ce=window,Te=Ce.trustedTypes,Se=Te?Te.createPolicy("lit-html",{createHTML:function(t){return t}}):void 0,Oe="$lit$",Pe="lit$".concat((Math.random()+"").slice(9),"$"),Ie="?"+Pe,Re="<".concat(Ie,">"),je=document,Le=function(){return je.createComment("")},Me=function(t){return null===t||"object"!=k(t)&&"function"!=typeof t},De=Array.isArray,Ne=function(t){return De(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator])},Be="[ \t\n\f\r]",ze=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ue=/-->/g,Fe=/>/g,Ve=RegExp(">|".concat(Be,"(?:([^\\s\"'>=/]+)(").concat(Be,"*=").concat(Be,"*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)"),"g"),He=/'/g,We=/"/g,$e=/^(?:script|style|textarea|title)$/i,qe=function(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return{_$litType$:t,strings:e,values:i}}}(1),Ge=Symbol.for("lit-noChange"),Xe=Symbol.for("lit-nothing"),Ye=new WeakMap,Ze=je.createTreeWalker(je,129,null,!1);function Qe(t,e){if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==Se?Se.createHTML(e):e}var Ke=function(t,e){for(var n,i=t.length-1,r=[],o=2===e?"<svg>":"",a=ze,s=0;s<i;s++){for(var l=t[s],c=void 0,u=void 0,d=-1,p=0;p<l.length&&(a.lastIndex=p,null!==(u=a.exec(l)));)p=a.lastIndex,a===ze?"!--"===u[1]?a=Ue:void 0!==u[1]?a=Fe:void 0!==u[2]?($e.test(u[2])&&(n=RegExp("</"+u[2],"g")),a=Ve):void 0!==u[3]&&(a=Ve):a===Ve?">"===u[0]?(a=null!=n?n:ze,d=-1):void 0===u[1]?d=-2:(d=a.lastIndex-u[2].length,c=u[1],a=void 0===u[3]?Ve:'"'===u[3]?We:He):a===We||a===He?a=Ve:a===Ue||a===Fe?a=ze:(a=Ve,n=void 0);var h=a===Ve&&t[s+1].startsWith("/>")?" ":"";o+=a===ze?l+Re:d>=0?(r.push(c),l.slice(0,d)+Oe+l.slice(d)+Pe+h):l+Pe+(-2===d?(r.push(void 0),s):h)}return[Qe(t,o+(t[i]||"<?>")+(2===e?"</svg>":"")),r]},Je=function(){return s((function t(e,n){var i,r=e.strings,a=e._$litType$;o(this,t),this.parts=[];var s=0,c=0,u=r.length-1,d=this.parts,p=y(Ke(r,a),2),h=p[0],f=p[1];if(this.el=t.createElement(h,n),Ze.currentNode=this.el.content,2===a){var v=this.el.content,m=v.firstChild;m.remove(),v.append.apply(v,w(m.childNodes))}for(;null!==(i=Ze.nextNode())&&d.length<u;){if(1===i.nodeType){if(i.hasAttributes()){var b,g=[],x=l(i.getAttributeNames());try{for(x.s();!(b=x.n()).done;){var k=b.value;if(k.endsWith(Oe)||k.startsWith(Pe)){var _=f[c++];if(g.push(k),void 0!==_){var A=i.getAttribute(_.toLowerCase()+Oe).split(Pe),E=/([.?@])?(.*)/.exec(_);d.push({type:1,index:s,name:E[2],strings:A,ctor:"."===E[1]?on:"?"===E[1]?sn:"@"===E[1]?ln:rn})}else d.push({type:6,index:s})}}}catch(t){x.e(t)}finally{x.f()}for(var C=0,T=g;C<T.length;C++){var S=T[C];i.removeAttribute(S)}}if($e.test(i.tagName)){var O=i.textContent.split(Pe),P=O.length-1;if(P>0){i.textContent=Te?Te.emptyScript:"";for(var I=0;I<P;I++)i.append(O[I],Le()),Ze.nextNode(),d.push({type:2,index:++s});i.append(O[P],Le())}}}else if(8===i.nodeType)if(i.data===Ie)d.push({type:2,index:s});else for(var R=-1;-1!==(R=i.data.indexOf(Pe,R+1));)d.push({type:7,index:s}),R+=Pe.length-1;s++}}),null,[{key:"createElement",value:function(t,e){var n=je.createElement("template");return n.innerHTML=t,n}}])}();function tn(t,e){var n,i,r,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,s=arguments.length>3?arguments[3]:void 0;if(e===Ge)return e;var l=void 0!==s?null===(n=a._$Co)||void 0===n?void 0:n[s]:a._$Cl,c=Me(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(i=null==l?void 0:l._$AO)||void 0===i||i.call(l,!1),void 0===c?l=void 0:(l=new c(t))._$AT(t,a,s),void 0!==s?(null!==(r=(o=a)._$Co)&&void 0!==r?r:o._$Co=[])[s]=l:a._$Cl=l),void 0!==l&&(e=tn(t,l._$AS(t,e.values),l,s)),e}var en=function(){return s((function t(e,n){o(this,t),this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}),[{key:"parentNode",get:function(){return this._$AM.parentNode}},{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"u",value:function(t){var e,n=this._$AD,i=n.el.content,r=n.parts,o=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:je).importNode(i,!0);Ze.currentNode=o;for(var a=Ze.nextNode(),s=0,l=0,c=r[0];void 0!==c;){if(s===c.index){var u=void 0;2===c.type?u=new nn(a,a.nextSibling,this,t):1===c.type?u=new c.ctor(a,c.name,c.strings,this,t):6===c.type&&(u=new cn(a,this,t)),this._$AV.push(u),c=r[++l]}s!==(null==c?void 0:c.index)&&(a=Ze.nextNode(),s++)}return Ze.currentNode=je,o}},{key:"v",value:function(t){var e,n=0,i=l(this._$AV);try{for(i.s();!(e=i.n()).done;){var r=e.value;void 0!==r&&(void 0!==r.strings?(r._$AI(t,r,n),n+=r.strings.length-2):r._$AI(t[n])),n++}}catch(t){i.e(t)}finally{i.f()}}}])}(),nn=function(){function t(e,n,i,r){var a;o(this,t),this.type=2,this._$AH=Xe,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=i,this.options=r,this._$Cp=null===(a=null==r?void 0:r.isConnected)||void 0===a||a}return s(t,[{key:"_$AU",get:function(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cp}},{key:"parentNode",get:function(){var t=this._$AA.parentNode,e=this._$AM;return void 0!==e&&11===(null==t?void 0:t.nodeType)&&(t=e.parentNode),t}},{key:"startNode",get:function(){return this._$AA}},{key:"endNode",get:function(){return this._$AB}},{key:"_$AI",value:function(t){t=tn(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this),Me(t)?t===Xe||null==t||""===t?(this._$AH!==Xe&&this._$AR(),this._$AH=Xe):t!==this._$AH&&t!==Ge&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):Ne(t)?this.T(t):this._(t)}},{key:"k",value:function(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}},{key:"$",value:function(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}},{key:"_",value:function(t){this._$AH!==Xe&&Me(this._$AH)?this._$AA.nextSibling.data=t:this.$(je.createTextNode(t)),this._$AH=t}},{key:"g",value:function(t){var e,n=t.values,i=t._$litType$,r="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=Je.createElement(Qe(i.h,i.h[0]),this.options)),i);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===r)this._$AH.v(n);else{var o=new en(r,this),a=o.u(this.options);o.v(n),this.$(a),this._$AH=o}}},{key:"_$AC",value:function(t){var e=Ye.get(t.strings);return void 0===e&&Ye.set(t.strings,e=new Je(t)),e}},{key:"T",value:function(e){De(this._$AH)||(this._$AH=[],this._$AR());var n,i,r=this._$AH,o=0,a=l(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;o===r.length?r.push(n=new t(this.k(Le()),this.k(Le()),this,this.options)):n=r[o],n._$AI(s),o++}}catch(t){a.e(t)}finally{a.f()}o<r.length&&(this._$AR(n&&n._$AB.nextSibling,o),r.length=o)}},{key:"_$AR",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._$AA.nextSibling,n=arguments.length>1?arguments[1]:void 0;for(null===(t=this._$AP)||void 0===t||t.call(this,!1,!0,n);e&&e!==this._$AB;){var i=e.nextSibling;e.remove(),e=i}}},{key:"setConnected",value:function(t){var e;void 0===this._$AM&&(this._$Cp=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}])}(),rn=function(){return s((function t(e,n,i,r,a){o(this,t),this.type=1,this._$AH=Xe,this._$AN=void 0,this.element=e,this.name=n,this._$AM=r,this.options=a,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Xe}),[{key:"tagName",get:function(){return this.element.tagName}},{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"_$AI",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=this.strings,o=!1;if(void 0===r)t=tn(this,t,e,0),(o=!Me(t)||t!==this._$AH&&t!==Ge)&&(this._$AH=t);else{var a,s,l=t;for(t=r[0],a=0;a<r.length-1;a++)(s=tn(this,l[n+a],e,a))===Ge&&(s=this._$AH[a]),o||(o=!Me(s)||s!==this._$AH[a]),s===Xe?t=Xe:t!==Xe&&(t+=(null!=s?s:"")+r[a+1]),this._$AH[a]=s}o&&!i&&this.j(t)}},{key:"j",value:function(t){t===Xe?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}])}(),on=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).type=3,t}return p(e,t),s(e,[{key:"j",value:function(t){this.element[this.name]=t===Xe?void 0:t}}])}(rn),an=Te?Te.emptyScript:"",sn=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).type=4,t}return p(e,t),s(e,[{key:"j",value:function(t){t&&t!==Xe?this.element.setAttribute(this.name,an):this.element.removeAttribute(this.name)}}])}(rn),ln=function(t){function e(t,n,i,a,s){var l;return o(this,e),(l=r(this,e,[t,n,i,a,s])).type=5,l}return p(e,t),s(e,[{key:"_$AI",value:function(t){var e;if((t=null!==(e=tn(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,0))&&void 0!==e?e:Xe)!==Ge){var n=this._$AH,i=t===Xe&&n!==Xe||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,r=t!==Xe&&(n===Xe||i);i&&this.element.removeEventListener(this.name,this,n),r&&this.element.addEventListener(this.name,this,t),this._$AH=t}}},{key:"handleEvent",value:function(t){var e,n;"function"==typeof this._$AH?this._$AH.call(null!==(n=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==n?n:this.element,t):this._$AH.handleEvent(t)}}])}(rn),cn=function(){return s((function t(e,n,i){o(this,t),this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=i}),[{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"_$AI",value:function(t){tn(this,t)}}])}(),un={O:Oe,P:Pe,A:Ie,C:1,M:Ke,L:en,R:Ne,D:tn,I:nn,V:rn,H:sn,N:ln,U:on,F:cn},dn=Ce.litHtmlPolyfillSupport;null==dn||dn(Je,nn),(null!==(ce=Ce.litHtmlVersions)&&void 0!==ce?ce:Ce.litHtmlVersions=[]).push("2.8.0");var pn,hn,fn=function(t){function n(){var t;return o(this,n),(t=r(this,n,arguments)).renderOptions={host:e(t)},t._$Do=void 0,t}return p(n,t),s(n,[{key:"createRenderRoot",value:function(){var t,e,i=u(d(n.prototype),"createRenderRoot",this).call(this);return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=i.firstChild),i}},{key:"update",value:function(t){var e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),u(d(n.prototype),"update",this).call(this,t),this._$Do=function(t,e,n){var i,r,o=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:e,a=o._$litPart$;if(void 0===a){var s=null!==(r=null==n?void 0:n.renderBefore)&&void 0!==r?r:null;o._$litPart$=a=new nn(e.insertBefore(Le(),s),s,void 0,null!=n?n:{})}return a._$AI(t),a}(e,this.renderRoot,this.renderOptions)}},{key:"connectedCallback",value:function(){var t;u(d(n.prototype),"connectedCallback",this).call(this),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}},{key:"disconnectedCallback",value:function(){var t;u(d(n.prototype),"disconnectedCallback",this).call(this),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}},{key:"render",value:function(){return Ge}}])}(Ee);
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */fn.finalized=!0,fn._$litElement$=!0,null===(pn=globalThis.litElementHydrateSupport)||void 0===pn||pn.call(globalThis,{LitElement:fn});var vn=globalThis.litElementPolyfillSupport;null==vn||vn({LitElement:fn}),(null!==(hn=globalThis.litElementVersions)&&void 0!==hn?hn:globalThis.litElementVersions=[]).push("3.3.3");
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
var mn=function(t){return function(e){return"function"==typeof e?function(t,e){return customElements.define(t,e),e}(t,e):function(t,e){return{kind:e.kind,elements:e.elements,finisher:function(e){customElements.define(t,e)}}}(t,e)}},bn=function(t,e){return"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?v(v({},e),{},{finisher:function(n){n.createProperty(e.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer:function(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher:function(n){n.createProperty(e.key,t)}}},yn=function(t,e,n){e.constructor.createProperty(n,t)};
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */function gn(t){return function(e,n){return void 0!==n?yn(t,e,n):bn(t,e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */function wn(t){return gn(v(v({},t),{},{state:!0}))}
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */var xn,kn=function(t){var e=t.finisher,n=t.descriptor;return function(t,i){var r;if(void 0===i){var o=null!==(r=t.originalKey)&&void 0!==r?r:t.key,a=null!=n?{kind:"method",placement:"prototype",key:o,descriptor:n(t.key)}:v(v({},t),{},{key:o});return null!=e&&(a.finisher=function(t){e(t,o)}),a}var s=t.constructor;void 0!==n&&Object.defineProperty(t,i,n(i)),null==e||e(s,i)}};
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */function _n(t,e){return kn({descriptor:function(n){var i={get:function(){var e,n;return null!==(n=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==n?n:null},enumerable:!0,configurable:!0};if(e){var r="symbol"==k(n)?Symbol():"__"+n;i.get=function(){var e,n;return void 0===this[r]&&(this[r]=null!==(n=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==n?n:null),this[r]}}return i}})}
/**
   * @license
   * Copyright 2021 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */var An=null!=(null===(xn=window.HTMLSlotElement)||void 0===xn?void 0:xn.prototype.assignedElements)?function(t,e){return t.assignedElements(e)}:function(t,e){return t.assignedNodes(e).filter((function(t){return t.nodeType===Node.ELEMENT_NODE}))};var En=function(){return s((function t(){o(this,t),this.reset()}),[{key:"reset",value:function(t){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}}])}();function Cn(){return new En}function Tn(t){"function"==typeof queueMicrotask?queueMicrotask(t):Promise.resolve().then(t).catch((function(t){return setTimeout((function(){throw t}))}))}var Sn=function(){function t(){o(this,t),this.disposables=[]}return s(t,[{key:"addEventListener",value:function(t,e,n,i){return this.add(function(t,e,n,i){return t.addEventListener(e,n,i),function(){!function(t,e,n,i){t.removeEventListener(e,n,i)}(t,e,n,i)}}(t,e,n,i))}},{key:"mutationObserve",value:function(t,e,n){var i=!1,r=new MutationObserver(e);return r.observe(t,n),function(){return function(t){i||(i=!0,t.disconnect())}(r)}}},{key:"requestAnimationFrame",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=requestAnimationFrame.apply(void 0,arguments);return this.add((function(){return cancelAnimationFrame(t)}))}))},{key:"nextFrame",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.requestAnimationFrame((function(){return t.requestAnimationFrame.apply(t,n)}))}},{key:"setTimeout",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=setTimeout.apply(void 0,arguments);return this.add((function(){return clearTimeout(t)}))}))},{key:"microTask",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i={current:!0};return Tn((function(){i.current&&e[0]()})),this.add((function(){i.current=!1}))}},{key:"style",value:function(t,e,n){var i=t.style.getPropertyValue(e);return Object.assign(t.style,c({},e,n)),this.add((function(){Object.assign(t.style,c({},e,i))}))}},{key:"group",value:function(e){var n=new t;return e(n),this.add((function(){return n.dispose()}))}},{key:"add",value:function(t){var e=this;return this.disposables.push(t),function(){var n=e.disposables.indexOf(t);n>=0&&e.remove(n,1)}}},{key:"remove",value:function(t,e){var n,i=l(this.disposables.splice(t,null!=e?e:this.disposables.length));try{for(i.s();!(n=i.n()).done;){(0,n.value)()}}catch(t){i.e(t)}finally{i.f()}}},{key:"dispose",value:function(){this.remove(0)}}])}();function On(){return new Sn}function Pn(t,e){if(t in e){for(var n=e[t],i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return"function"==typeof n?n.apply(void 0,r):n}var a=new Error('Tried to handle "'.concat(t,'" but there is no handler defined. Only defined handlers are: ').concat(Object.keys(e).map((function(t){return'"'.concat(t,'"')})).join(", "),"."));throw Error.captureStackTrace&&Error.captureStackTrace(a,Pn),a}var In=("undefined"==typeof window?"undefined":k(window))<"u",Rn=1e3;function jn(){return In?window.__BILI_POPPER_ZINDEX__++:Rn}function Ln(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t&&i.length>0&&(e=t.classList).add.apply(e,i)}function Mn(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t&&i.length>0&&(e=t.classList).remove.apply(e,i)}function Dn(t,e,n,i){var r=n?"enter":"leave",o=On(),a=void 0!==i?function(t){var e={called:!1};return function(){if(!e.called)return e.called=!0,t.apply(void 0,arguments)}}(i):function(){};"enter"===r&&(t.removeAttribute("hidden"),t.style.display="");var s=Pn(r,{enter:function(){return e.enter},leave:function(){return e.leave}}),l=Pn(r,{enter:function(){return e.enterTo},leave:function(){return e.leaveTo}}),c=Pn(r,{enter:function(){return e.enterFrom},leave:function(){return e.leaveFrom}});return Mn.apply(void 0,[t].concat(w(e.base),w(e.enter),w(e.enterTo),w(e.enterFrom),w(e.leave),w(e.leaveFrom),w(e.leaveTo),w(e.entered))),Ln.apply(void 0,[t].concat(w(e.base),w(s),w(c))),o.nextFrame((function(){Mn.apply(void 0,[t].concat(w(e.base),w(s),w(c))),Ln.apply(void 0,[t].concat(w(e.base),w(s),w(l))),function(t,e){var n=On();if(!t)return n.dispose;var i=getComputedStyle(t),r=[i.transitionDuration,i.transitionDelay].map((function(t){var e=t.split(",").filter(Boolean).map((function(t){return t.includes("ms")?parseFloat(t):1e3*parseFloat(t)})).sort((function(t,e){return e-t})),n=y(e,1)[0];return void 0===n?0:n})),o=y(r,2),a=o[0]+o[1];if(0!==a){n.group((function(n){n.setTimeout((function(){e(),n.dispose()}),a),n.addEventListener(t,"transitionrun",(function(t){t.target===t.currentTarget&&n.dispose()}))}));var s=n.addEventListener(t,"transitionend",(function(t){t.target===t.currentTarget&&(e(),s())}))}else e();n.add((function(){return e()})),n.dispose}(t,(function(){return Mn.apply(void 0,[t].concat(w(e.base),w(s),w(l))),Ln.apply(void 0,[t].concat(w(e.base),w(e.entered))),a()}))})),o.dispose
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */}In&&(window.__BILI_POPPER_ZINDEX__||(window.__BILI_POPPER_ZINDEX__=Rn));var Nn,Bn,zn,Un,Fn=1,Vn=2,Hn=function(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return{_$litDirective$:t,values:n}}},Wn=function(){return s((function t(e){o(this,t)}),[{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"_$AT",value:function(t,e,n){this._$Ct=t,this._$AM=e,this._$Ci=n}},{key:"_$AS",value:function(t,e){return this.update(t,e)}},{key:"update",value:function(t,e){return this.render.apply(this,w(e))}}])}(),$n="important",qn=" !"+$n,Gn=Hn(function(t){function n(t){var i,a;if(o(this,n),i=r(this,n,[t]),t.type!==Fn||"style"!==t.name||(null===(a=t.strings)||void 0===a?void 0:a.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.");return e(i)}return p(n,t),s(n,[{key:"render",value:function(t){return Object.keys(t).reduce((function(e,n){var i=t[n];return null==i?e:e+"".concat(n=n.includes("-")?n:n.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase(),":").concat(i,";")}),"")}},{key:"update",value:function(t,e){var n=this,i=y(e,1)[0],r=t.element.style;if(void 0===this.ht){for(var o in this.ht=new Set,i)this.ht.add(o);return this.render(i)}for(var a in this.ht.forEach((function(t){null==i[t]&&(n.ht.delete(t),t.includes("-")?r.removeProperty(t):r[t]="")})),i){var s=i[a];if(null!=s){this.ht.add(a);var l="string"==typeof s&&s.endsWith(qn);a.includes("-")||l?r.setProperty(a,l?s.slice(0,-11):s,l?$n:""):r[a]=s}}return Ge}}])}(Wn)),Xn=Object.defineProperty,Yn=Object.getOwnPropertyDescriptor,Zn=function(t,e,n,i){for(var r,o=i>1?void 0:i?Yn(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Xn(e,n,o),o},Qn=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.eventId="cm_goods_common",t.sourceFrom="",t.contentOid="",t.spmIdFrom="",t.selectIds="",t.loaded=!1,t.url="",t.size={width:960,height:642},t}return p(e,t),s(e,[{key:"initUrl",value:function(){var t={eventId:this.eventId,selectIds:this.selectIds,show:!0,source:"2",source_from:this.sourceFrom,content_oid:this.contentOid,no_top:1};this.spmIdFrom&&(t.spm_id_from=this.spmIdFrom);var e=Object.entries(t).map((function(t){var e=y(t,2),n=e[0],i=e[1];return"".concat(n,"=").concat(i)}));this.url="".concat("//cm.bilibili.com/goods-plugin/pc#/goods-modal","?").concat(e.join("&"))}},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),this.initUrl(),this.disposables.addEventListener(window,"message",(function(e){try{if("string"==typeof e.data){var n=JSON.parse(e.data);if("object"!=k(n)||n.eventId!==t.eventId)return;var i=n.data;switch(n.type){case"on-ready":i.width&&i.height&&(t.size={width:i.width,height:i.height}),t.loaded=!0;break;case"close":t.dispatchEvent(new CustomEvent("cancel")),setTimeout((function(){t.remove()}),0);break;case"on-confirm":t.dispatchEvent(new CustomEvent("confirm",{detail:i}))}}}catch(t){}}))}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose()}},{key:"spinnerTemplate",value:function(){return qe(Nn||(Nn=g(['<div id="spinner">\n      <img width="24" height="24" src="//i0.hdslb.com/bfs/static/jinkela/long/gif/loading-blue.gif" />\n      <span>正在玩命加载…</span>\n    </div>'])))}},{key:"render",value:function(){return qe(Bn||(Bn=g(['\n      <div id="wrap">\n        <div\n          id="window"\n          style="','"\n        >\n          ',"\n        </div>\n        ","\n      </div>\n    "])),Gn({display:this.loaded?"flex":"",width:"".concat(this.size.width,"px"),height:"".concat(this.size.height,"px")}),this.url?qe(zn||(zn=g(['<iframe src="','"></iframe>'])),this.url):"",this.loaded?"":this.spinnerTemplate())}}])}(fn);Qn.styles=ve(Un||(Un=g(["\n    #wrap {\n      min-height: 100px;\n      min-width: 100px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #window {\n      width: 960px;\n      height: 642px;\n      display: none;\n      border-radius: 8px;\n      overflow: hidden;\n    }\n    iframe {\n      width: 100%;\n      height: 100%;\n      border: none;\n    }\n    #spinner {\n      padding: 20px 0;\n      width: 100%;\n      text-align: center;\n      font-size: 14px;\n      color: var(--text3);\n    }\n    #spinner img {\n      margin-right: 8px;\n      vertical-align: bottom;\n    }\n  "]))),Zn([gn({type:String,attribute:"event-id"})],Qn.prototype,"eventId",2),Zn([gn({type:String,attribute:"source-from"})],Qn.prototype,"sourceFrom",2),Zn([gn({type:String,attribute:"content-oid"})],Qn.prototype,"contentOid",2),Zn([gn({type:String,attribute:"spm-id-from"})],Qn.prototype,"spmIdFrom",2),Zn([gn({type:String,attribute:"data-select-ids"})],Qn.prototype,"selectIds",2),Zn([wn()],Qn.prototype,"loaded",2),Zn([wn()],Qn.prototype,"url",2),Zn([wn()],Qn.prototype,"size",2),customElements.get("bili-cm-goods")||customElements.define("bili-cm-goods",Qn);var Kn,Jn=function(t){"undefined"!=typeof window&&window.__BILI_X_ENGINE_SCRIPT_CACHE__&&void 0!==window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]&&delete window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]},ti=function(t,e){if("undefined"==typeof window)return Promise.reject(new Error("window is not defined"));var n,i=t=t.replace(/^https?:\/\//,"//"),r=(n=i,"undefined"==typeof window?null:window.__BILI_X_ENGINE_SCRIPT_CACHE__&&window.__BILI_X_ENGINE_SCRIPT_CACHE__[n]||null);if(null!=r&&r.promise)return r.promise;var o=new Promise((function(n,i){var r=document.createElement("script");r.src=t,null!=e&&e.behavior&&r.setAttribute(e.behavior,""),r.onload=function(){var r=window;if(e.lib)return r[e.lib]?n(r[e.lib]):i(new Error('Failed to access library "'+e.lib+'" from '+t));n(null)},r.onerror=function(){i(new Error("Failed to load "+t)),document.head.removeChild(r)},document.head.appendChild(r)}));return function(t,e){"undefined"!=typeof window&&(window.__BILI_X_ENGINE_SCRIPT_CACHE__||(window.__BILI_X_ENGINE_SCRIPT_CACHE__={}),window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]=e)}(i,{promise:o,lib:null==e?void 0:e.lib}),o.then((function(){!1===(null==e?void 0:e.cache)&&Jn(i)})).catch((function(){!1===(null==e?void 0:e.cache)&&Jn(i)})),o},ei=function(t){return Promise.resolve(function(){try{return window.KvSDK?Promise.resolve(window.KvSDK):Promise.resolve(ti("//s1.hdslb.com/bfs/seed/jinkela/kv-sdk/index.js",{lib:"KvSDK"}))}catch(t){return Promise.reject(t)}}()).then((function(e){return new e(t)}))},ni=function(){try{var t=function(){return Promise.resolve(window.__BiliUser__.get())},e=function(){if(!window.__BiliUser__)return Promise.resolve(function(){try{return Promise.resolve(ti("//s1.hdslb.com/bfs/seed/jinkela/short/bili-user/index.js",{lib:"__BiliUser__"}))}catch(t){return Promise.reject(t)}}()).then((function(){}))}();return Promise.resolve(e&&e.then?e.then(t):t())}catch(t){return Promise.reject(t)}},ii=function(t){if(window.__BiliUser__){var e=window.__BiliUser__;return new Promise((function(n,i){e.quickLogin((function(t){0!==t.code?i():n()}),t)}))}return new Promise((function(e,n){function i(){Kn.showComponent(),Kn.addEventListener("success",(function(){e(),Kn.removeEventListener("success"),Kn.removeEventListener("cancel")})),Kn.addEventListener("cancel",(function(){n(),Kn.removeEventListener("success"),Kn.removeEventListener("cancel")}))}Kn?i():function(){try{return window.MiniLogin?Promise.resolve(window.MiniLogin):Promise.resolve(ti("//s1.hdslb.com/bfs/seed/jinkela/short/mini-login/miniLogin.umd.min.js",{lib:"MiniLogin"}))}catch(t){return Promise.reject(t)}}().then((function(e){if(!e)return n("MiniLogin is not found");Kn=new e(t),i()})).catch(n)}))};function ri(){return ri=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ri.apply(this,arguments)}var oi,ai,si,li,ci,ui,di,pi="",hi=function(){return pi||((pi=function(t){if("undefined"==typeof window)return"";var e=document.querySelector('meta[name="'+t+'"]');return null!=e&&e.content?e.content:""}("spm_prefix"))||"0.0")},fi=function(t){return Promise.resolve(function(){try{return window.ReporterPb?Promise.resolve(window.ReporterPb):Promise.resolve(ti("//s1.hdslb.com/bfs/seed/jinkela/short/reporter-pb/index.js",{lib:"ReporterPb"}))}catch(t){return Promise.reject(t)}}()).then((function(e){return new e(t)}))},vi=function(t,e,n,i){console.warn("["+("undefined"==typeof window?"Node":"Browser")+"]Miss reporter args: "+JSON.stringify({type:t,spm:e,data:n,options:i}))},mi=function(t){var e=window,n=hi(),i=e[t].report.bind(e[t]);return function(t,e,r,o){return"string"!=typeof e?e.prefix||(e=ri({},e,{prefix:n})):e.split(".").length<=3&&(e=n+"."+e),i(t,e,r,o)}},bi=function(t,e,n,i){var r=window.biliMirror,o=r.customReportPb,a=r.techReportPb,s="",l="";if("string"!=typeof e)l=[e.c,e.d,e.e].filter(Boolean).join("."),e.prefix&&(s=e.prefix);else{var c=e.split(".");isNaN(Number(c[0]))||isNaN(Number(c[1]))?l=e:(s=c.splice(0,2).join("."),l=c.join("."))}if("tech"===t){if(a)return void a({eventId:l,msg:n,otherSpmId:s})}else if(o)return void o({type:t,eventId:l,msg:n,otherSpmId:s});vi(t,e,n,i)},yi=function(t){if("undefined"==typeof window)return vi;var e=window,n="";function i(){var t=e[n];return!(null==t||!t.report)}return"string"==typeof(null==t?void 0:t.globalInst)&&(n=t.globalInst,i())?mi(n):!1!==(null==t?void 0:t.mirror)&&window.biliMirror?bi:(n="__biliMirrorPbInstance__",i()?mi(n):vi)},gi=function(t,e,n,i){return yi()(t,e,n,i)},wi=function(t){try{return window.Unios?Promise.resolve(window.Unios.request(t)):Promise.resolve(function(t){if(window.Unios)return Promise.resolve(window.Unios);var e=window.__LOAD_REQUEST_TYPE__||t||"web";return ti("//s1.hdslb.com/bfs/seed/jinkela/short/unios/"+e+".min.js",{lib:"Unios"})}()).then((function(){return window.Unios.request(t)}))}catch(t){return Promise.reject(t)}},xi="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ki={};function _i(){var t=window.__BILI_EMOJI_PICKER_DATA_TASK__;return t&&t instanceof Promise||(t=new Promise((function(t,e){wi({url:"//api.bilibili.com/x/emote/user/panel/web",params:{business:"reply"}}).then((function(n){if(0!==n.code||!n.data)return delete window.__BILI_EMOJI_PICKER_DATA_TASK__,e(new Error(n.message||"get emoji data error"));t(n.data)})).catch(e)})),window.__BILI_EMOJI_PICKER_DATA_TASK__=t),t}!function(t){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}Object.defineProperty(t,"__esModule",{value:!0});var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==xi?xi:"undefined"!=typeof self?self:{},i={},r={},o={};Object.defineProperty(o,"__esModule",{value:!0});var a=!0,s=o.default=function(){return a&&(a="undefined"==typeof window),a};!function(t){var e=n&&n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseAvif=t.canUseAvif=t.setAvif=void 0;var i,r=e(o);t.setAvif=function(t){i=t};t.canUseAvif=function(){return!(0,r.default)()&&(void 0!==i&&i)};t.asyncCanUseAvif=function(){return new Promise((function(e){if((0,r.default)())return e(!1);if((0,t.canUseAvif)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setAvif)(!1),e(!1)},n.onload=function(){(0,t.setAvif)(!0),e(!0)},n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="}))}}(r);var l={};!function(t){var e=n&&n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseWebP=t.canUseWebP=t.setWebp=void 0;var i,r=e(o);t.setWebp=function(t){i=t};t.canUseWebP=function(){var t,e,n,o;if((0,r.default)())return!1;if(void 0!==i)return i;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return i=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var a=document.createElement("canvas");i=!!(null===(e=a.getContext)||void 0===e?void 0:e.call(a,"2d"))&&0===(null===(o=null===(n=a.toDataURL)||void 0===n?void 0:n.call(a,"image/webp"))||void 0===o?void 0:o.indexOf("data:image/webp"))}catch(t){i=!1}return i};t.asyncCanUseWebP=function(){return new Promise((function(e){if((0,r.default)())return e(!1);if((0,t.canUseWebP)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setWebp)(!1),e(!1)},n.onload=function(){(0,t.setWebp)(!0),e(!0)},n.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="}))}}(l);var c={},u=n&&n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(c,"__esModule",{value:!0});var d=u(o);c.default=function(){return!(0,d.default)()&&!!window.HTMLPictureElement},function(t){var e=n&&n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.autoDetectAll=t.autoDetect=t.canUseHtmlPictureElement=t.canUseWebP=t.setWebp=t.canUseAvif=t.setAvif=void 0;var i=r;Object.defineProperty(t,"canUseAvif",{enumerable:!0,get:function(){return i.canUseAvif}}),Object.defineProperty(t,"setAvif",{enumerable:!0,get:function(){return i.setAvif}});var o=l;Object.defineProperty(t,"canUseWebP",{enumerable:!0,get:function(){return o.canUseWebP}}),Object.defineProperty(t,"setWebp",{enumerable:!0,get:function(){return o.setWebp}});var a=e(c);t.canUseHtmlPictureElement=a.default;t.autoDetect=function(t){void 0===t&&(t=["webp"]);for(var e=0;e<t.length;e++){if("avif"===t[e]&&(0,i.canUseAvif)())return t[e];if("webp"===t[e]&&(0,o.canUseWebP)())return t[e]}return""};t.autoDetectAll=function(){return new Promise((function(t){Promise.all([(0,i.asyncCanUseAvif)(),(0,o.asyncCanUseWebP)()]).then((function(e){var n=e[0],i=e[1];t({avif:n,webp:i})}))}))}}(i);var p={},h={};Object.defineProperty(h,"__esModule",{value:!0}),h.default=function(t){return t?t.replace(/^http(s)?:/,""):""};var f={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.isInt=t.isNum=void 0;t.isNum=function(t){return"number"==typeof t};t.isInt=function(e){return(0,t.isNum)(e)&&(0|e)===e}}(f);var v={};Object.defineProperty(v,"__esModule",{value:!0});var m=/\.(jpeg|jpg|png|webp|gif|avif)$/;v.default=function(t){var e;return(null===(e=t.match(m))||void 0===e?void 0:e[0])||null},function(t){var e=n&&n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBmgSrc=t.isSupportBmgFormat=void 0;var i=e(h),r=e(o),a=f,s=e(v);t.isSupportBmgFormat=function(t){return!!function(t){return!!/\/bfs\//.test(t)}(t)&&!!(0,s.default)(t)};var l=function(t){return"number"!=typeof t||isNaN(t)?0:Math.floor(t)||0};t.getBmgSrc=function(e,n){var o;if(void 0===n&&(n={c:!0}),"string"!=typeof e)return"";if(!(0,t.isSupportBmgFormat)(e))return e;if(e.indexOf("@")>-1){if(n.cache)return e;e=e.split("@")[0]}e=e.replace("pre-","");var s=n.dpr||((0,r.default)()?2:Math.floor(null!==(o=null===window||void 0===window?void 0:window.devicePixelRatio)&&void 0!==o?o:2)||1),c=[];n.w&&(0,a.isInt)(n.w)&&c.push("".concat(Math.floor(n.w*s),"w")),n.h&&(0,a.isInt)(n.h)&&c.push("".concat(Math.floor(n.h*s),"h")),n.e&&c.push("".concat(n.e,"e")),n.c&&c.push("1c"),n.a&&c.push("".concat([l(n.a.x),l(n.a.y),l(n.a.w)*s,l(n.a.h)*s].join("-"),"a")),n.p&&(0,a.isInt)(n.p)&&c.push("".concat(n.p,"p")),n.s&&c.push("1s"),n.q&&(0,a.isInt)(n.q)&&c.push("".concat(n.q,"q")),n.style&&c.push("!".concat(n.style));var u="";return n.ext&&["webp","avif"].includes(n.ext)&&(u=n.ext),0!==c.length||u?"".concat((0,i.default)(e),"@").concat(c.join("_")).concat(u?".".concat(u):""):e}}(p);var b,y={};function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}t.initWindowExtsState=void 0,t.getWindowExtsState=void 0,Object.defineProperty(y,"__esModule",{value:!0});var w="__BMG_TRACKER_COLLECT_QUEUE__",x="__BMG_TRACKER_COLLECT_EXTS__",k="__BMG_TRACKER_COLLECT_MODE__",_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{},A={};Object.defineProperty(A,"__esModule",{value:!0});var E=!0,C=A.default=function(){return E&&(E="undefined"==typeof window),E},T={};Object.defineProperty(T,"__esModule",{value:!0});var S=/\.(jpeg|jpg|png|webp|gif|avif)$/,O=T.default=function(t){var e;return(null===(e=t.match(S))||void 0===e?void 0:e[0])||null},P={};!function(t){var e=_&&_.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseAvif=t.canUseAvif=t.setAvif=void 0;var n,i=e(A);t.setAvif=function(t){n=t},t.canUseAvif=function(){return!(0,i.default)()&&void 0!==n&&n},t.asyncCanUseAvif=function(){return new Promise((function(e){if((0,i.default)())return e(!1);if((0,t.canUseAvif)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setAvif)(!1),e(!1)},n.onload=function(){(0,t.setAvif)(!0),e(!0)},n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="}))}}(P);var I={};!function(t){var e=_&&_.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseWebP=t.canUseWebP=t.setWebp=void 0;var n,i=e(A);t.setWebp=function(t){n=t},t.canUseWebP=function(){var t,e,r,o;if((0,i.default)())return!1;if(void 0!==n)return n;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return n=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var a=document.createElement("canvas");n=!!(null===(e=a.getContext)||void 0===e?void 0:e.call(a,"2d"))&&0===(null===(o=null===(r=a.toDataURL)||void 0===r?void 0:r.call(a,"image/webp"))||void 0===o?void 0:o.indexOf("data:image/webp"))}catch(t){n=!1}return n},t.asyncCanUseWebP=function(){return new Promise((function(e){if((0,i.default)())return e(!1);if((0,t.canUseWebP)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setWebp)(!1),e(!1)},n.onload=function(){(0,t.setWebp)(!0),e(!0)},n.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="}))}}(I);var R="BMG_EXTS",j=null,L=function(){if(j)return j;try{j=(localStorage.getItem(R)||"").split(",")}catch(t){console.warn(t),j=[]}return j},M=function(t){if(void 0===t&&(t=!1),!window[x]||t){var e=L();window[x]={avif:e.includes("avif"),webp:e.includes("webp")}}},D=function(t){return function(e){switch(function(){var t=[],e=window[x]||{avif:!1,webp:!1};e.avif&&t.push("avif"),e.webp&&t.push("webp");try{localStorage.setItem(R,t.join(","))}catch(t){console.warn(t)}}(),t){case"avif":P.setAvif(e);break;case"webp":I.setWebp(e)}}},N=function(t){var e;"object"!=g(window[x])&&M(),(null===(e=window[x])||void 0===e?void 0:e[t])||(window[x][t]=!0,D(t)(!0))},B=function(){return window[k]};y.collect=function(t,e,n){if(!C()){var i=C()?null:window.__BMG_TRACKER__||null;n=n||B();var r=(O(t)||"").substring(1);if(["avif","webp"].indexOf(r)>-1&&N(r),"onlyext"!==n)if(i)i.collect(t,e);else if("nocache"!==n){var o={src:t,type:e,ts:Date.now()/1e3|0};Array.isArray(window[w])?window[w].push(o):window[w]=[o]}}},y.getCollectMode=B,y.getLocalExtsState=L,t.getWindowExtsState=y.getWindowExtsState=function(t){var e,n;return"avif"===t?(null===(e=window[x])||void 0===e?void 0:e.avif)||!1:"webp"===t?(null===(n=window[x])||void 0===n?void 0:n.webp)||!1:window[x]||null},t.initWindowExtsState=y.initWindowExtsState=M,y.setCollectMode=function(t){window[k]=t},y.updateExtState=D,b=y.updateWindowExtsState=N;var z=new RegExp(function(t,e){return"".concat(t).concat(e,".hdslb.com")}("(s|i)","\\d")),U=function(t){if(s())return t||"";var e=window.__BMG_AF__;return(null==e?void 0:e.defDomain)?(e.defUpdated,e.defDomain):t||""},F=function(t,e){var n;if(!e)return t;var i=(null===(n=t.match(z))||void 0===n?void 0:n[0])||"";return i&&i!==e?t.replace(z,e):t};t.autoDetectAllExts=function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise((function(r){var o=function(t){t.avif&&b("avif"),t.webp&&b("webp"),r(t)};if(s())o({avif:!1,webp:!1});else{if(n){var a=t.getWindowExtsState();if(a&&"object"===e(a))return void o({webp:a.webp||!1,avif:a.avif||!1})}if(t.initWindowExtsState(),t.getWindowExtsState("avif")||t.getWindowExtsState("webp"))return o(t.getWindowExtsState());i.autoDetectAll().then(o)}}))},t.getBmgSrcNext=function(e,n,r){var o="";return s()?p.getBmgSrc((null==r?void 0:r.domain)?F(e,r.domain):e,n):(o=t.getWindowExtsState("avif")?"avif":t.getWindowExtsState("webp")?"webp":i.autoDetect(["avif","webp"]),p.getBmgSrc(F(e,U(null==r?void 0:r.domain)),Object.assign(Object.assign({},n),{ext:o})))},t.getSrcDefDomain=U,t.replaceSrcDefDomain=F}(ki);var Ai=Object.defineProperty,Ei=Object.getOwnPropertyDescriptor,Ci=function(t,e,n,i){for(var r,o=i>1?void 0:i?Ei(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Ai(e,n,o),o},Ti=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).pageCount=5,t.packages=[],t.contentLoading=!1,t.currentIdx=0,t}return p(e,t),s(e,[{key:"currentPage",get:function(){return Math.floor(this.currentIdx/this.pageCount)}},{key:"isFirstPage",get:function(){return 0===this.currentPage}},{key:"isLastPage",get:function(){var t=Math.floor(this.packages.length/this.pageCount)+(this.packages.length%this.pageCount?1:0);return this.currentPage===t-1}},{key:"currentPackage",get:function(){return this.packages.length&&this.packages[this.currentIdx]||null}},{key:"connectedCallback",value:function(){u(d(e.prototype),"connectedCallback",this).call(this),this.initData()}},{key:"initData",value:(n=i(m().mark((function t(){var e,n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_i();case 3:e=t.sent,n=e.packages,this.packages=n,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.warn(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return n.apply(this,arguments)})},{key:"setTab",value:function(t){var e=this;if(!(t>this.packages.length-1||t<0)){this.contentLoading=!0,this.currentIdx=t;var n=Math.floor(t/this.pageCount);this.shadowRoot.querySelector("#tabs-track").style.setProperty("transform","translateX(".concat(100*-n,"%)")),window.setTimeout((function(){e.contentLoading=!1}),200)}}},{key:"handlePrev",value:function(){this.isFirstPage||this.setTab(this.currentPage*this.pageCount-1)}},{key:"handleNext",value:function(){this.isLastPage||this.setTab((this.currentPage+1)*this.pageCount)}},{key:"handleSelect",value:function(t){this.dispatchEvent(new CustomEvent("select",{detail:t}))}},{key:"emojiRenderer",value:function(t){var e=this,n=t.type,i=t.meta,r=t.text,o=t.url,a=t.gif_url,s=t.webp_url;if(4===n)return qe(oi||(oi=g(['<div\n        class="emoji text"\n        @click=',"\n      >\n        ","\n      </div>"])),(function(){e.handleSelect(t)}),r);var l=1===i.size?24:56,c=ki.getBmgSrcNext(s||a||o,{w:l,h:l,dpr:2});return qe(ai||(ai=g(['<div\n      class="emoji img"\n      style="height:','px"\n      @click=','\n    >\n      <img width="','" height="','" src="','" alt="','" />\n    </div>'])),l,(function(){e.handleSelect(t)}),l,l,c,r)}},{key:"contentTemplate",value:function(){var t=this;return qe(si||(si=g(['<div id="content">',"</div>"])),this.currentPackage.emote.map((function(e){return t.emojiRenderer(e)})))}},{key:"render",value:function(){var t=this;return qe(li||(li=g(['<div id="picker">\n      <div id="header">','</div>\n      <div id="body">','</div>\n      <div id="footer">\n        <div id="tabs">\n          <div\n            id="tabs-track"\n            style="','"\n          >\n            ','\n          </div>\n        </div>\n        <div id="nav">\n          <button\n            class="','"\n            @click=','\n          >\n            <bili-icon size="16" icon="BDC/arrow_back_left_line/3"></bili-icon>\n          </button>\n          <button\n            class="','"\n            @click=','\n          >\n            <bili-icon size="16" icon="BDC/arrow_forward_right_line/3"></bili-icon>\n          </button>\n        </div>\n      </div>\n    </div>'])),this.currentPackage?this.currentPackage.text:"表情",this.currentPackage&&!this.contentLoading?this.contentTemplate():qe(ci||(ci=g(['<div id="spinner">加载中...</div>']))),Gn({transform:"translateX(".concat(58*-this.currentPage*this.pageCount,"px)")}),this.packages.map((function(e,n){return qe(ui||(ui=g(['<div\n                class="','"\n                @click=','\n              >\n                <img\n                  width="22"\n                  height="22"\n                  src="','"\n                  alt="','"\n                />\n              </div>'])),t.currentIdx===n?"tab active":"tab",(function(){t.setTab(n)}),ki.getBmgSrcNext(e.url,{w:22,h:22}),e.text)})),this.isFirstPage?"disabled":"",(function(){t.handlePrev()}),this.isLastPage?"disabled":"",(function(){t.handleNext()}))}}]);var n}(fn);Ti.styles=ve(di||(di=g(["\n    :host {\n      --bili-emoji-picker-tab-count: 5;\n      --bili-emoji-picker-tab-width: 58px;\n      --bili-emoji-picker-nav-width: 73px;\n      --bili-emoji-picker-body-height: 196px;\n    }\n    #picker {\n      width: calc(var(--bili-emoji-picker-tab-width) * var(--bili-emoji-picker-tab-count) + var(--bili-emoji-picker-nav-width));\n      font-size: 12px;\n      color: var(--text2);\n      overflow: hidden;\n      background-color: var(--bg1);\n      border: 1px solid var(--graph_bg_thick);\n      border-radius: 8px;\n      box-sizing: border-box;\n    }\n\n    #header {\n      padding: 13px 15px 6px;\n      box-sizing: border-box;\n    }\n    #body {\n      height: var(--bili-emoji-picker-body-height);\n    }\n    #spinner {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      height: 100%;\n    }\n    #content {\n      height: 100%;\n      padding: 0 11px;\n      background-color: var(--bg1);\n      overflow: auto;\n    }\n    #content::-webkit-scrollbar {\n      width: 4px;\n      border-radius: 4px;\n      background-color: transparent;\n    }\n    #content::-webkit-scrollbar-thumb {\n      border-radius: 4px;\n      border-radius: 4px;\n      background-color: var(--graph_bg_thick);\n      transition: 0.3s ease-in-out;\n    }\n    #content::-webkit-scrollbar-track {\n      border-radius: 4px;\n      background-color: transparent;\n    }\n    #content .emoji {\n      display: inline-block;\n      border-radius: 4px;\n      cursor: pointer;\n    }\n    #content .emoji:hover {\n      background-color: var(--graph_bg_thick);\n    }\n    #content .emoji.img {\n      box-sizing: content-box;\n      padding: 4px;\n    }\n    #content .emoji.text {\n      padding: 5px 8px;\n      line-height: 22px;\n    }\n    #footer {\n      background-color: var(--bg3);\n      box-sizing: border-box;\n      height: 36px;\n      display: flex;\n    }\n    #tabs {\n      height: 100%;\n      width: calc(100% - var(--bili-emoji-picker-nav-width));\n      overflow: hidden;\n    }\n    #tabs-track {\n      transition: transform 0.3s ease-in-out;\n      transform: translateX(0);\n      display: flex;\n      flex-wrap: no-wrap;\n      height: 100%;\n    }\n    .tab {\n      height: 100%;\n      flex-shrink: 0;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: var(--bili-emoji-picker-tab-width);\n      height: 100%;\n      cursor: pointer;\n    }\n    .tab:hover {\n      background-color: var(--graph_bg_thick);\n    }\n    .tab.active {\n      background-color: var(--bg1);\n    }\n    #nav {\n      height: 100%;\n      width: var(--bili-emoji-picker-nav-width);\n      display: flex;\n      justify-content: space-evenly;\n      align-items: center;\n    }\n    #nav button {\n      width: 36px;\n      height: 100%;\n      color: var(--text2);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      outline: none;\n      border: none;\n      background-color: transparent;\n      cursor: pointer;\n      transition: color 0.2s;\n    }\n    #nav button.disabled {\n      color: var(--text4);\n    }\n  "]))),Ci([wn()],Ti.prototype,"packages",2),Ci([wn()],Ti.prototype,"contentLoading",2),Ci([wn()],Ti.prototype,"currentIdx",2),Ci([wn()],Ti.prototype,"currentPage",1),Ci([wn()],Ti.prototype,"isFirstPage",1),Ci([wn()],Ti.prototype,"isLastPage",1),Ci([wn()],Ti.prototype,"currentPackage",1),Ti=Ci([mn("bili-emoji-picker")],Ti);
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var Si=function(t,e){return(Si=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Oi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Si(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Pi(t,e){var n=t[0],i=t[1];return[n*Math.cos(e)-i*Math.sin(e),n*Math.sin(e)+i*Math.cos(e)]}function Ii(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++)if("number"!=typeof t[n])throw new Error("assertNumbers arguments["+n+"] is not a number. "+k(t[n])+" == typeof "+t[n]);return!0}var Ri=Math.PI;function ji(t,e,n){t.lArcFlag=0===t.lArcFlag?0:1,t.sweepFlag=0===t.sweepFlag?0:1;var i=t.rX,r=t.rY,o=t.x,a=t.y;i=Math.abs(t.rX),r=Math.abs(t.rY);var s=Pi([(e-o)/2,(n-a)/2],-t.xRot/180*Ri),l=s[0],c=s[1],u=Math.pow(l,2)/Math.pow(i,2)+Math.pow(c,2)/Math.pow(r,2);1<u&&(i*=Math.sqrt(u),r*=Math.sqrt(u)),t.rX=i,t.rY=r;var d=Math.pow(i,2)*Math.pow(c,2)+Math.pow(r,2)*Math.pow(l,2),p=(t.lArcFlag!==t.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(i,2)*Math.pow(r,2)-d)/d)),h=i*c/r*p,f=-r*l/i*p,v=Pi([h,f],t.xRot/180*Ri);t.cX=v[0]+(e+o)/2,t.cY=v[1]+(n+a)/2,t.phi1=Math.atan2((c-f)/r,(l-h)/i),t.phi2=Math.atan2((-c-f)/r,(-l-h)/i),0===t.sweepFlag&&t.phi2>t.phi1&&(t.phi2-=2*Ri),1===t.sweepFlag&&t.phi2<t.phi1&&(t.phi2+=2*Ri),t.phi1*=180/Ri,t.phi2*=180/Ri}function Li(t,e,n){Ii(t,e,n);var i=t*t+e*e-n*n;if(0>i)return[];if(0===i)return[[t*n/(t*t+e*e),e*n/(t*t+e*e)]];var r=Math.sqrt(i);return[[(t*n+e*r)/(t*t+e*e),(e*n-t*r)/(t*t+e*e)],[(t*n-e*r)/(t*t+e*e),(e*n+t*r)/(t*t+e*e)]]}var Mi,Di=Math.PI/180;function Ni(t,e,n){return(1-n)*t+n*e}function Bi(t,e,n,i){return t+Math.cos(i/180*Ri)*e+Math.sin(i/180*Ri)*n}function zi(t,e,n,i){var r=1e-6,o=e-t,a=n-e,s=3*o+3*(i-n)-6*a,l=6*(a-o),c=3*o;return Math.abs(s)<r?[-c/l]:function(t,e,n){void 0===n&&(n=1e-6);var i=t*t/4-e;if(i<-n)return[];if(i<=n)return[-t/2];var r=Math.sqrt(i);return[-t/2-r,-t/2+r]}(l/s,c/s,r)}function Ui(t,e,n,i,r){var o=1-r;return t*(o*o*o)+e*(3*o*o*r)+n*(3*o*r*r)+i*(r*r*r)}!function(t){function e(){return r((function(t,e,n){return t.relative&&(void 0!==t.x1&&(t.x1+=e),void 0!==t.y1&&(t.y1+=n),void 0!==t.x2&&(t.x2+=e),void 0!==t.y2&&(t.y2+=n),void 0!==t.x&&(t.x+=e),void 0!==t.y&&(t.y+=n),t.relative=!1),t}))}function n(){var t=NaN,e=NaN,n=NaN,i=NaN;return r((function(r,o,a){return r.type&qi.SMOOTH_CURVE_TO&&(r.type=qi.CURVE_TO,t=isNaN(t)?o:t,e=isNaN(e)?a:e,r.x1=r.relative?o-t:2*o-t,r.y1=r.relative?a-e:2*a-e),r.type&qi.CURVE_TO?(t=r.relative?o+r.x2:r.x2,e=r.relative?a+r.y2:r.y2):(t=NaN,e=NaN),r.type&qi.SMOOTH_QUAD_TO&&(r.type=qi.QUAD_TO,n=isNaN(n)?o:n,i=isNaN(i)?a:i,r.x1=r.relative?o-n:2*o-n,r.y1=r.relative?a-i:2*a-i),r.type&qi.QUAD_TO?(n=r.relative?o+r.x1:r.x1,i=r.relative?a+r.y1:r.y1):(n=NaN,i=NaN),r}))}function i(){var t=NaN,e=NaN;return r((function(n,i,r){if(n.type&qi.SMOOTH_QUAD_TO&&(n.type=qi.QUAD_TO,t=isNaN(t)?i:t,e=isNaN(e)?r:e,n.x1=n.relative?i-t:2*i-t,n.y1=n.relative?r-e:2*r-e),n.type&qi.QUAD_TO){t=n.relative?i+n.x1:n.x1,e=n.relative?r+n.y1:n.y1;var o=n.x1,a=n.y1;n.type=qi.CURVE_TO,n.x1=((n.relative?0:i)+2*o)/3,n.y1=((n.relative?0:r)+2*a)/3,n.x2=(n.x+2*o)/3,n.y2=(n.y+2*a)/3}else t=NaN,e=NaN;return n}))}function r(t){var e=0,n=0,i=NaN,r=NaN;return function(o){if(isNaN(i)&&!(o.type&qi.MOVE_TO))throw new Error("path must start with moveto");var a=t(o,e,n,i,r);return o.type&qi.CLOSE_PATH&&(e=i,n=r),void 0!==o.x&&(e=o.relative?e+o.x:o.x),void 0!==o.y&&(n=o.relative?n+o.y:o.y),o.type&qi.MOVE_TO&&(i=e,r=n),a}}function o(t,e,n,i,o,a){return Ii(t,e,n,i,o,a),r((function(r,s,l,c){var u=r.x1,d=r.x2,p=r.relative&&!isNaN(c),h=void 0!==r.x?r.x:p?0:s,f=void 0!==r.y?r.y:p?0:l;function v(t){return t*t}r.type&qi.HORIZ_LINE_TO&&0!==e&&(r.type=qi.LINE_TO,r.y=r.relative?0:l),r.type&qi.VERT_LINE_TO&&0!==n&&(r.type=qi.LINE_TO,r.x=r.relative?0:s),void 0!==r.x&&(r.x=r.x*t+f*n+(p?0:o)),void 0!==r.y&&(r.y=h*e+r.y*i+(p?0:a)),void 0!==r.x1&&(r.x1=r.x1*t+r.y1*n+(p?0:o)),void 0!==r.y1&&(r.y1=u*e+r.y1*i+(p?0:a)),void 0!==r.x2&&(r.x2=r.x2*t+r.y2*n+(p?0:o)),void 0!==r.y2&&(r.y2=d*e+r.y2*i+(p?0:a));var m=t*i-e*n;if(void 0!==r.xRot&&(1!==t||0!==e||0!==n||1!==i))if(0===m)delete r.rX,delete r.rY,delete r.xRot,delete r.lArcFlag,delete r.sweepFlag,r.type=qi.LINE_TO;else{var b=r.xRot*Math.PI/180,y=Math.sin(b),g=Math.cos(b),w=1/v(r.rX),x=1/v(r.rY),k=v(g)*w+v(y)*x,_=2*y*g*(w-x),A=v(y)*w+v(g)*x,E=k*i*i-_*e*i+A*e*e,C=_*(t*i+e*n)-2*(k*n*i+A*t*e),T=k*n*n-_*t*n+A*t*t,S=(Math.atan2(C,E-T)+Math.PI)%Math.PI/2,O=Math.sin(S),P=Math.cos(S);r.rX=Math.abs(m)/Math.sqrt(E*v(P)+C*O*P+T*v(O)),r.rY=Math.abs(m)/Math.sqrt(E*v(O)-C*O*P+T*v(P)),r.xRot=180*S/Math.PI}return void 0!==r.sweepFlag&&0>m&&(r.sweepFlag=+!r.sweepFlag),r}))}t.ROUND=function(t){function e(e){return Math.round(e*t)/t}return void 0===t&&(t=1e13),Ii(t),function(t){return void 0!==t.x1&&(t.x1=e(t.x1)),void 0!==t.y1&&(t.y1=e(t.y1)),void 0!==t.x2&&(t.x2=e(t.x2)),void 0!==t.y2&&(t.y2=e(t.y2)),void 0!==t.x&&(t.x=e(t.x)),void 0!==t.y&&(t.y=e(t.y)),void 0!==t.rX&&(t.rX=e(t.rX)),void 0!==t.rY&&(t.rY=e(t.rY)),t}},t.TO_ABS=e,t.TO_REL=function(){return r((function(t,e,n){return t.relative||(void 0!==t.x1&&(t.x1-=e),void 0!==t.y1&&(t.y1-=n),void 0!==t.x2&&(t.x2-=e),void 0!==t.y2&&(t.y2-=n),void 0!==t.x&&(t.x-=e),void 0!==t.y&&(t.y-=n),t.relative=!0),t}))},t.NORMALIZE_HVZ=function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),r((function(i,r,o,a,s){if(isNaN(a)&&!(i.type&qi.MOVE_TO))throw new Error("path must start with moveto");return e&&i.type&qi.HORIZ_LINE_TO&&(i.type=qi.LINE_TO,i.y=i.relative?0:o),n&&i.type&qi.VERT_LINE_TO&&(i.type=qi.LINE_TO,i.x=i.relative?0:r),t&&i.type&qi.CLOSE_PATH&&(i.type=qi.LINE_TO,i.x=i.relative?a-r:a,i.y=i.relative?s-o:s),i.type&qi.ARC&&(0===i.rX||0===i.rY)&&(i.type=qi.LINE_TO,delete i.rX,delete i.rY,delete i.xRot,delete i.lArcFlag,delete i.sweepFlag),i}))},t.NORMALIZE_ST=n,t.QT_TO_C=i,t.INFO=r,t.SANITIZE=function(t){void 0===t&&(t=0),Ii(t);var e=NaN,n=NaN,i=NaN,o=NaN;return r((function(r,a,s,l,c){var u=Math.abs,d=!1,p=0,h=0;if(r.type&qi.SMOOTH_CURVE_TO&&(p=isNaN(e)?0:a-e,h=isNaN(n)?0:s-n),r.type&(qi.CURVE_TO|qi.SMOOTH_CURVE_TO)?(e=r.relative?a+r.x2:r.x2,n=r.relative?s+r.y2:r.y2):(e=NaN,n=NaN),r.type&qi.SMOOTH_QUAD_TO?(i=isNaN(i)?a:2*a-i,o=isNaN(o)?s:2*s-o):r.type&qi.QUAD_TO?(i=r.relative?a+r.x1:r.x1,o=r.relative?s+r.y1:r.y2):(i=NaN,o=NaN),r.type&qi.LINE_COMMANDS||r.type&qi.ARC&&(0===r.rX||0===r.rY||!r.lArcFlag)||r.type&qi.CURVE_TO||r.type&qi.SMOOTH_CURVE_TO||r.type&qi.QUAD_TO||r.type&qi.SMOOTH_QUAD_TO){var f=void 0===r.x?0:r.relative?r.x:r.x-a,v=void 0===r.y?0:r.relative?r.y:r.y-s;p=isNaN(i)?void 0===r.x1?p:r.relative?r.x:r.x1-a:i-a,h=isNaN(o)?void 0===r.y1?h:r.relative?r.y:r.y1-s:o-s;var m=void 0===r.x2?0:r.relative?r.x:r.x2-a,b=void 0===r.y2?0:r.relative?r.y:r.y2-s;u(f)<=t&&u(v)<=t&&u(p)<=t&&u(h)<=t&&u(m)<=t&&u(b)<=t&&(d=!0)}return r.type&qi.CLOSE_PATH&&u(a-l)<=t&&u(s-c)<=t&&(d=!0),d?[]:r}))},t.MATRIX=o,t.ROTATE=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),Ii(t,e,n);var i=Math.sin(t),r=Math.cos(t);return o(r,i,-i,r,e-e*r+n*i,n-e*i-n*r)},t.TRANSLATE=function(t,e){return void 0===e&&(e=0),Ii(t,e),o(1,0,0,1,t,e)},t.SCALE=function(t,e){return void 0===e&&(e=t),Ii(t,e),o(t,0,0,e,0,0)},t.SKEW_X=function(t){return Ii(t),o(1,0,Math.atan(t),1,0,0)},t.SKEW_Y=function(t){return Ii(t),o(1,Math.atan(t),0,1,0,0)},t.X_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),Ii(t),o(-1,0,0,1,t,0)},t.Y_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),Ii(t),o(1,0,0,-1,0,t)},t.A_TO_C=function(){return r((function(t,e,n){return qi.ARC===t.type?function(t,e,n){var i,r,o,a;t.cX||ji(t,e,n);for(var s=Math.min(t.phi1,t.phi2),l=Math.max(t.phi1,t.phi2)-s,c=Math.ceil(l/90),u=new Array(c),d=e,p=n,h=0;h<c;h++){var f=Ni(t.phi1,t.phi2,h/c),v=Ni(t.phi1,t.phi2,(h+1)/c),m=v-f,b=4/3*Math.tan(m*Di/4),y=[Math.cos(f*Di)-b*Math.sin(f*Di),Math.sin(f*Di)+b*Math.cos(f*Di)],g=y[0],w=y[1],x=[Math.cos(v*Di),Math.sin(v*Di)],k=x[0],_=x[1],A=[k+b*Math.sin(v*Di),_-b*Math.cos(v*Di)],E=A[0],C=A[1];u[h]={relative:t.relative,type:qi.CURVE_TO};var T=function(e,n){var i=Pi([e*t.rX,n*t.rY],t.xRot),r=i[0],o=i[1];return[t.cX+r,t.cY+o]};i=T(g,w),u[h].x1=i[0],u[h].y1=i[1],r=T(E,C),u[h].x2=r[0],u[h].y2=r[1],o=T(k,_),u[h].x=o[0],u[h].y=o[1],t.relative&&(u[h].x1-=d,u[h].y1-=p,u[h].x2-=d,u[h].y2-=p,u[h].x-=d,u[h].y-=p),d=(a=[u[h].x,u[h].y])[0],p=a[1]}return u}(t,t.relative?0:e,t.relative?0:n):t}))},t.ANNOTATE_ARCS=function(){return r((function(t,e,n){return t.relative&&(e=0,n=0),qi.ARC===t.type&&ji(t,e,n),t}))},t.CLONE=function(){return function(t){var e={};for(var n in t)e[n]=t[n];return e}},t.CALCULATE_BOUNDS=function(){var t=e(),o=i(),a=n(),s=r((function(e,n,i){var r=a(o(t(function(t){var e={};for(var n in t)e[n]=t[n];return e}(e))));function l(t){t>s.maxX&&(s.maxX=t),t<s.minX&&(s.minX=t)}function c(t){t>s.maxY&&(s.maxY=t),t<s.minY&&(s.minY=t)}if(r.type&qi.DRAWING_COMMANDS&&(l(n),c(i)),r.type&qi.HORIZ_LINE_TO&&l(r.x),r.type&qi.VERT_LINE_TO&&c(r.y),r.type&qi.LINE_TO&&(l(r.x),c(r.y)),r.type&qi.CURVE_TO){l(r.x),c(r.y);for(var u=0,d=zi(n,r.x1,r.x2,r.x);u<d.length;u++)0<(T=d[u])&&1>T&&l(Ui(n,r.x1,r.x2,r.x,T));for(var p=0,h=zi(i,r.y1,r.y2,r.y);p<h.length;p++)0<(T=h[p])&&1>T&&c(Ui(i,r.y1,r.y2,r.y,T))}if(r.type&qi.ARC){l(r.x),c(r.y),ji(r,n,i);for(var f=r.xRot/180*Math.PI,v=Math.cos(f)*r.rX,m=Math.sin(f)*r.rX,b=-Math.sin(f)*r.rY,y=Math.cos(f)*r.rY,g=r.phi1<r.phi2?[r.phi1,r.phi2]:-180>r.phi2?[r.phi2+360,r.phi1+360]:[r.phi2,r.phi1],w=g[0],x=g[1],k=function(t){var e=t[0],n=t[1],i=180*Math.atan2(n,e)/Math.PI;return i<w?i+360:i},_=0,A=Li(b,-v,0).map(k);_<A.length;_++)(T=A[_])>w&&T<x&&l(Bi(r.cX,v,b,T));for(var E=0,C=Li(y,-m,0).map(k);E<C.length;E++){var T;(T=C[E])>w&&T<x&&c(Bi(r.cY,m,y,T))}}return e}));return s.minX=1/0,s.maxX=-1/0,s.minY=1/0,s.maxY=-1/0,s}}(Mi||(Mi={}));var Fi,Vi=function(){function t(){}return t.prototype.round=function(t){return this.transform(Mi.ROUND(t))},t.prototype.toAbs=function(){return this.transform(Mi.TO_ABS())},t.prototype.toRel=function(){return this.transform(Mi.TO_REL())},t.prototype.normalizeHVZ=function(t,e,n){return this.transform(Mi.NORMALIZE_HVZ(t,e,n))},t.prototype.normalizeST=function(){return this.transform(Mi.NORMALIZE_ST())},t.prototype.qtToC=function(){return this.transform(Mi.QT_TO_C())},t.prototype.aToC=function(){return this.transform(Mi.A_TO_C())},t.prototype.sanitize=function(t){return this.transform(Mi.SANITIZE(t))},t.prototype.translate=function(t,e){return this.transform(Mi.TRANSLATE(t,e))},t.prototype.scale=function(t,e){return this.transform(Mi.SCALE(t,e))},t.prototype.rotate=function(t,e,n){return this.transform(Mi.ROTATE(t,e,n))},t.prototype.matrix=function(t,e,n,i,r,o){return this.transform(Mi.MATRIX(t,e,n,i,r,o))},t.prototype.skewX=function(t){return this.transform(Mi.SKEW_X(t))},t.prototype.skewY=function(t){return this.transform(Mi.SKEW_Y(t))},t.prototype.xSymmetry=function(t){return this.transform(Mi.X_AXIS_SYMMETRY(t))},t.prototype.ySymmetry=function(t){return this.transform(Mi.Y_AXIS_SYMMETRY(t))},t.prototype.annotateArcs=function(){return this.transform(Mi.ANNOTATE_ARCS())},t}(),Hi=function(t){return" "===t||"\t"===t||"\r"===t||"\n"===t},Wi=function(t){return"0".charCodeAt(0)<=t.charCodeAt(0)&&t.charCodeAt(0)<="9".charCodeAt(0)},$i=function(t){function e(){var e=t.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return Oi(e,t),e.prototype.finish=function(t){if(void 0===t&&(t=[]),this.parse(" ",t),0!==this.curArgs.length||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return t},e.prototype.parse=function(t,e){var n=this;void 0===e&&(e=[]);for(var i=function(t){e.push(t),n.curArgs.length=0,n.canParseCommandOrComma=!0},r=0;r<t.length;r++){var o=t[r],a=!(this.curCommandType!==qi.ARC||3!==this.curArgs.length&&4!==this.curArgs.length||1!==this.curNumber.length||"0"!==this.curNumber&&"1"!==this.curNumber),s=Wi(o)&&("0"===this.curNumber&&"0"===o||a);if(!Wi(o)||s)if("e"!==o&&"E"!==o)if("-"!==o&&"+"!==o||!this.curNumberHasExp||this.curNumberHasExpDigits)if("."!==o||this.curNumberHasExp||this.curNumberHasDecimal||a){if(this.curNumber&&-1!==this.curCommandType){var l=Number(this.curNumber);if(isNaN(l))throw new SyntaxError("Invalid number ending at "+r);if(this.curCommandType===qi.ARC)if(0===this.curArgs.length||1===this.curArgs.length){if(0>l)throw new SyntaxError('Expected positive number, got "'+l+'" at index "'+r+'"')}else if((3===this.curArgs.length||4===this.curArgs.length)&&"0"!==this.curNumber&&"1"!==this.curNumber)throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+r+'"');this.curArgs.push(l),this.curArgs.length===Gi[this.curCommandType]&&(qi.HORIZ_LINE_TO===this.curCommandType?i({type:qi.HORIZ_LINE_TO,relative:this.curCommandRelative,x:l}):qi.VERT_LINE_TO===this.curCommandType?i({type:qi.VERT_LINE_TO,relative:this.curCommandRelative,y:l}):this.curCommandType===qi.MOVE_TO||this.curCommandType===qi.LINE_TO||this.curCommandType===qi.SMOOTH_QUAD_TO?(i({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),qi.MOVE_TO===this.curCommandType&&(this.curCommandType=qi.LINE_TO)):this.curCommandType===qi.CURVE_TO?i({type:qi.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===qi.SMOOTH_CURVE_TO?i({type:qi.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===qi.QUAD_TO?i({type:qi.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===qi.ARC&&i({type:qi.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!Hi(o))if(","===o&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if("+"!==o&&"-"!==o&&"."!==o)if(s)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(0!==this.curArgs.length)throw new SyntaxError("Unterminated command at index "+r+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+r+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,"z"!==o&&"Z"!==o)if("h"===o||"H"===o)this.curCommandType=qi.HORIZ_LINE_TO,this.curCommandRelative="h"===o;else if("v"===o||"V"===o)this.curCommandType=qi.VERT_LINE_TO,this.curCommandRelative="v"===o;else if("m"===o||"M"===o)this.curCommandType=qi.MOVE_TO,this.curCommandRelative="m"===o;else if("l"===o||"L"===o)this.curCommandType=qi.LINE_TO,this.curCommandRelative="l"===o;else if("c"===o||"C"===o)this.curCommandType=qi.CURVE_TO,this.curCommandRelative="c"===o;else if("s"===o||"S"===o)this.curCommandType=qi.SMOOTH_CURVE_TO,this.curCommandRelative="s"===o;else if("q"===o||"Q"===o)this.curCommandType=qi.QUAD_TO,this.curCommandRelative="q"===o;else if("t"===o||"T"===o)this.curCommandType=qi.SMOOTH_QUAD_TO,this.curCommandRelative="t"===o;else{if("a"!==o&&"A"!==o)throw new SyntaxError('Unexpected character "'+o+'" at index '+r+".");this.curCommandType=qi.ARC,this.curCommandRelative="a"===o}else e.push({type:qi.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal="."===o}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return e},e.prototype.transform=function(t){return Object.create(this,{parse:{value:function(e,n){void 0===n&&(n=[]);for(var i=0,r=Object.getPrototypeOf(this).parse.call(this,e);i<r.length;i++){var o=r[i],a=t(o);Array.isArray(a)?n.push.apply(n,a):n.push(a)}return n}}})},e}(Vi),qi=function(t){function e(n){var i=t.call(this)||this;return i.commands="string"==typeof n?e.parse(n):n,i}return Oi(e,t),e.prototype.encode=function(){return e.encode(this.commands)},e.prototype.getBounds=function(){var t=Mi.CALCULATE_BOUNDS();return this.transform(t),t},e.prototype.transform=function(t){for(var e=[],n=0,i=this.commands;n<i.length;n++){var r=t(i[n]);Array.isArray(r)?e.push.apply(e,r):e.push(r)}return this.commands=e,this},e.encode=function(t){return function(t){var e="";Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];if(i.type===qi.CLOSE_PATH)e+="z";else if(i.type===qi.HORIZ_LINE_TO)e+=(i.relative?"h":"H")+i.x;else if(i.type===qi.VERT_LINE_TO)e+=(i.relative?"v":"V")+i.y;else if(i.type===qi.MOVE_TO)e+=(i.relative?"m":"M")+i.x+" "+i.y;else if(i.type===qi.LINE_TO)e+=(i.relative?"l":"L")+i.x+" "+i.y;else if(i.type===qi.CURVE_TO)e+=(i.relative?"c":"C")+i.x1+" "+i.y1+" "+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===qi.SMOOTH_CURVE_TO)e+=(i.relative?"s":"S")+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===qi.QUAD_TO)e+=(i.relative?"q":"Q")+i.x1+" "+i.y1+" "+i.x+" "+i.y;else if(i.type===qi.SMOOTH_QUAD_TO)e+=(i.relative?"t":"T")+i.x+" "+i.y;else{if(i.type!==qi.ARC)throw new Error('Unexpected command type "'+i.type+'" at index '+n+".");e+=(i.relative?"a":"A")+i.rX+" "+i.rY+" "+i.xRot+" "+ +i.lArcFlag+" "+ +i.sweepFlag+" "+i.x+" "+i.y}}return e}(t)},e.parse=function(t){var e=new $i,n=[];return e.parse(t,n),e.finish(n),n},e.CLOSE_PATH=1,e.MOVE_TO=2,e.HORIZ_LINE_TO=4,e.VERT_LINE_TO=8,e.LINE_TO=16,e.CURVE_TO=32,e.SMOOTH_CURVE_TO=64,e.QUAD_TO=128,e.SMOOTH_QUAD_TO=256,e.ARC=512,e.LINE_COMMANDS=e.LINE_TO|e.HORIZ_LINE_TO|e.VERT_LINE_TO,e.DRAWING_COMMANDS=e.HORIZ_LINE_TO|e.VERT_LINE_TO|e.LINE_TO|e.CURVE_TO|e.SMOOTH_CURVE_TO|e.QUAD_TO|e.SMOOTH_QUAD_TO|e.ARC,e}(Vi),Gi=((Fi={})[qi.MOVE_TO]=2,Fi[qi.LINE_TO]=2,Fi[qi.HORIZ_LINE_TO]=1,Fi[qi.VERT_LINE_TO]=1,Fi[qi.CLOSE_PATH]=0,Fi[qi.QUAD_TO]=4,Fi[qi.SMOOTH_QUAD_TO]=2,Fi[qi.CURVE_TO]=6,Fi[qi.SMOOTH_CURVE_TO]=4,Fi[qi.ARC]=7,Fi),Xi={},Yi=function(t,e,n){var i=[];return t.commands.forEach((function(t,r){i.push(function(t,e,n){if(t.type!==e.type)throw new Error("Cannot diff between different command types");var i=t,r=e,o={};return["x","y","x1","y1","x2","y2"].forEach((function(t){void 0!==i[t]&&void 0!==r[t]&&(o[t]=(r[t]-i[t])*n)})),o}(t,e.commands[r],n))})),i},Zi=function(t,e,n){var i=e.max-e.min,r=n.max-n.min,o=(t-e.min)/i;return n.min+o*r},Qi=function(t,e,n){for(var i=t,r=0;r<e.length;r++){var o=e[r];if(r===e.length-1)return void(i[o]=n);i[o]||(i[o]={}),i=i[o]}},Ki=function(){var t=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","function"==typeof window.fetch?fetch(e).then((function(t){return t.json()})):new Promise((function(t,n){var i=new XMLHttpRequest;i.addEventListener("load",(function(){try{t(JSON.parse(i.responseText))}catch(t){n(t)}})),i.onerror=n,i.open("GET",e),i.send()})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ji=function(){var t=i(m().mark((function t(e){var n,i,r,o,a;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.category,i=e.url,r=e.json,o=null,r)if("string"==typeof r)try{o=JSON.parse(r)}catch(t){}else"object"==k(r)&&(o=r);if(o||!i){t.next=14;break}return t.prev=4,t.next=7,Ki(i);case 7:o=t.sent,t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(4),console.error(t.t0),t.abrupt("return");case 14:if(o){t.next=16;break}return t.abrupt("return");case 16:a=function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(i<=0)return e;for(var r in n)e[r]?e[r]=t(e[r],n[r],i-1):e[r]=n[r];return e},n?or[n]=a(or[n]||{},o,2):Object.keys(o).map((function(t){or[t]=a(or[t]||{},o[t],2)}));case 18:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}(),tr=[],er=function(){var t=i(m().mark((function t(e){var n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Promise.all(e.map(Ji)),tr.push(n),t.next=4,n;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),nr=function(){var t=i(m().mark((function t(e){var n,i,r,o,a,s,l,c,u,d,p,h,f,v,b,g,w,x;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(("undefined"==typeof window?"undefined":k(window))>"u")){t.next=2;break}return t.abrupt("return",Promise.resolve(null));case 2:if(f=e.icon.split("/"),v=y(f,3),b=v[0],g=v[1],w=v[2],b&&g&&w){t.next=5;break}throw new Error("SVGIconNext: invalid icon option");case 5:return t.prev=5,t.next=8,Promise.all(tr);case 8:t.next=12;break;case 10:t.prev=10,t.t0=t.catch(5);case 12:if(null==(i=null==(n=or[b])?void 0:n[g])||!i[w]){t.next=14;break}return t.abrupt("return",null==(o=null==(r=or[b])?void 0:r[g])?void 0:o[w]);case 14:if(null==(s=null==(a=Xi[b])?void 0:a[g])||!s[w]){t.next=16;break}return t.abrupt("return",null==(c=null==(l=Xi[b])?void 0:l[g])?void 0:c[w]);case 16:return t.prev=16,x=Ki("//i0.hdslb.com/bfs/svg-next/".concat(b,"/").concat(g,"/v").concat(w,".json")),Qi(Xi,f,x),t.t1=Qi,t.t2=or,t.t3=f,t.next=24,null==(d=null==(u=Xi[b])?void 0:u[g])?void 0:d[w];case 24:t.t4=t.sent,(0,t.t1)(t.t2,t.t3,t.t4),t.next=31;break;case 28:throw t.prev=28,t.t5=t.catch(16),Qi(Xi,f,null),new Error("SVGIconNext: fetch icon config failed");case 31:return t.abrupt("return",null==(h=null==(p=or[b])?void 0:p[g])?void 0:h[w]);case 32:case"end":return t.stop()}}),t,null,[[5,10],[16,28]])})));return function(e){return t.apply(this,arguments)}}(),ir=function(t,e){var n;if(!t.palette)return"currentColor";if(Array.isArray(t.palette))return t.palette;var i=null==(n=null==e?void 0:e.palettes)?void 0:n.find((function(e){return e.name===t.palette}));return i?i.value:t.palette},rr=function(t,e){var n,i;if(!e)return[];var r=function(t){var e=[24,24];return Array.isArray(t.size)?(e[0]=t.size[0],e[1]=t.size[1]):"number"==typeof t.size&&!Number.isNaN(e)&&(e[0]=t.size,e[1]=t.size),e}(t),o=e.default.map((function(t){return new qi(t).toAbs()})),a=(null==(n=e.axes)?void 0:n.map((function(t){return{min:t.min.map((function(t){return new qi(t).toAbs()})),max:t.max.map((function(t){return new qi(t).toAbs()}))}})))||[];return null!=(i=e.axes)&&i.length?o.map((function(n,i){var o=e.axes.map((function(e,o){var s=a[o].min[i],l=a[o].max[i];if(!s||!l||[s,l].some((function(t){return t.commands.length!==n.commands.length})))return[];var c=function(){var n,i=null==(n=t.axes)?void 0:n[e.name];return i?"stroke"===e.name?i/(r[0]/24):i:e.value.default}(),u=0;if(c<e.value.default){var d={min:e.value.min,max:e.value.default};u=Zi(c,d,{min:-1,max:0})}else{var p={min:e.value.default,max:e.value.max};u=Zi(c,p,{min:0,max:1})}return Yi(n,u<0?s:l,Math.abs(u))}));return function(t,e){var n,i=new qi(t.encode()),r=l(e);try{var o=function(){var t=n.value;0!==t.length&&i.commands.forEach((function(e,n){Object.keys(t[n]).forEach((function(i){e[i]=e[i]+t[n][i]}))}))};for(r.s();!(n=r.n()).done;)o()}catch(t){r.e(t)}finally{r.f()}return i}(n,o).scale(r[0]/24,r[1]/24).encode()})):o.map((function(t){return new qi(t.encode()).scale(r[0]/24,r[1]/24).encode()}))},or={};("undefined"==typeof window?"undefined":k(window))<"u"&&(window.__SVG_ICON_NEXT_CACHE__&&(or=window.__SVG_ICON_NEXT_CACHE__),window.__SVG_ICON_NEXT_PRELOAD_PACKS__||(window.__SVG_ICON_NEXT_PRELOAD_PACKS__=er));var ar=function(t){function e(){var t;return o(this,e),(t=r(this,e)).axes=null,t.palette="",t.width="",t.height="",t.attachShadow({mode:"open"}),t.shadowRoot&&(t.shadowRoot.innerHTML='\n        <style>\n          :host {\n            display: inline-flex;\n            align-items: center;\n          }\n        </style>\n        <svg\n          id="icon"\n          xmlns="http://www.w3.org/2000/svg"\n          xmlns:xlink="http://www.w3.org/1999/xlink"\n        ></svg>\n      '),t}return p(e,t),s(e,[{key:"connectedCallback",value:function(){if(this.shadowRoot){var t=this.getAttribute("icon");t&&this.updateSvg(t)}}},{key:"disconnectedCallback",value:function(){this.palette="",this.axes={}}},{key:"getSVGIconOptions",value:function(t){return{icon:t,size:[Number(this.width),Number(this.height)],axes:this.axes||{},palette:this.palette}}},{key:"initSize",value:function(){var t="24",e="24",n=this.getAttribute("size")||"";if(n){var i=n.split(",");return 2===i.length?(t=i[0],e=i[1]):t=e=i[0],this.width=t,void(this.height=e)}var r=this.getAttribute("width"),o=this.getAttribute("height");r&&o&&(t=r,e=o),this.width=t,this.height=e}},{key:"updateSvg",value:(n=i(m().mark((function t(e){var n,i,r,o,a,s,l=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.shadowRoot){t.next=2;break}return t.abrupt("return");case 2:if(n=this.shadowRoot.querySelector("#icon")){t.next=5;break}return t.abrupt("return");case 5:return this.initSize(),n.setAttribute("width",this.width),n.setAttribute("height",this.height),n.setAttribute("viewBox","0 0 ".concat(this.width," ").concat(this.height)),i=this.getSVGIconOptions(e),t.next=9,nr(i);case 9:if(r=t.sent){t.next=12;break}return t.abrupt("return");case 12:null!=(o=rr(i,r))&&o.length&&(null!=(a=ir(i,r))&&a.length&&(this.palette=a),s=o.map((function(t,e){return'\n                    <path\n                        d="'.concat(t,'"\n                        fill="').concat("string"==typeof l.palette?l.palette:l.palette[e]||"",'"\n                    ></path>\n                ')})).join(""),n.innerHTML=s);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"attributeChangedCallback",value:function(t,e,n){if("icon"===t)n&&n!==e&&this.updateSvg(n)}}],[{key:"observedAttributes",get:function(){return["icon"]}}]);var n}(A(HTMLElement));ar.elName="bili-icon",customElements.get(ar.elName)||customElements.define(ar.elName,ar);var sr=function(t){function e(){var t;o(this,e),(t=r(this,e)).disposables=On(),t.deferred=Cn(),t.onConfirm=null,t.onCancel=null,t.final=null;var n=t.attachShadow({mode:"open"}),i=document.createElement("template");i.innerHTML='\n        <style>\n            :host {\n              position: fixed;\n              bottom: 0;\n              left: 0;\n              right: 0;\n              top: 0;\n            }\n            #mask {\n              position: absolute;\n              bottom: 0;\n              left: 0;\n              right: 0;\n              top: 0;\n              background-color: rgba(0, 0, 0, 0.5);\n            }\n            #wrap {\n              position: absolute;\n              bottom: 0;\n              left: 0;\n              right: 0;\n              top: 0;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n            }\n            #dialog {\n              -webkit-font-smoothing: antialiased;\n              background-color: var(--bg1);\n              border-radius: 8px;\n              box-sizing: border-box;\n              font-family: PingFang SC,HarmonyOS_Regular,Helvetica Neue,Microsoft YaHei,sans-serif!important;\n              font-weight: 400;\n              overflow: hidden;\n              padding-bottom: 24px!important;\n              padding: 16px;\n              position: relative;\n              width: 320px;\n              transform-origin: center center;\n            }\n            #close {\n                color: var(--text2);\n                cursor: pointer;\n                height: 22px;\n                position: absolute;\n                right: 16px;\n                top: 16px;\n                width: 22px;\n            }\n            #title {\n                color: var(--text1);\n                font-size: 16px;\n                font-weight: 600;\n                margin-top: 16px;\n                margin-bottom: 10px;\n                text-align: center;\n                padding: 0 16px;\n            }\n            #message {\n                color: var(--text2);\n                font-size: 14px;\n                margin-bottom: 14px;\n                text-align: center;\n                padding: 0 16px 10px;\n                white-space: pre-wrap;\n            }\n            #action {\n                align-items: center;\n                display: flex;\n                justify-content: center;\n                padding-right: 12px;\n            }\n            #action button {\n                -webkit-font-smoothing: antialiased;\n                border: 1px solid var(--brand_blue);\n                border-radius: 6px;\n                box-sizing: border-box;\n                cursor: pointer;\n                font-family: PingFang SC,HarmonyOS_Regular,Helvetica Neue,Microsoft YaHei,sans-serif!important;\n                font-weight: 400;\n                height: 32px;\n                outline: none;\n                transition: all .2s;\n                width: 130px;\n                margin-left: 12px;\n            }\n            #action button#cancel {\n                background-color: var(--bg1);\n                border-color: var(--line_regular);\n                color: var(--text1);\n            }\n            #action button#confirm {\n                background-color: var(--brand_blue);\n                border-color: var(--brand_blue);\n                color: var(--text_white);\n            }\n        </style>\n        <div id="mask"></div>\n        <div id="wrap">\n          <div \n              role="dialog" \n              id="dialog"\n          >\n              <div id="close"><bili-icon icon="BDC/xmark_close_line/1" size="22"></bili-icon></div>\n              <div id="title"></div>\n              <div id="message"></div>\n              <div id="action">\n                  <button id="cancel"></button>\n                  <button id="confirm"></button>\n              </div>\n          </div>\n        </div>\n    ';var a=document.importNode(i.content,!0);return n.appendChild(a),t}return p(e,t),s(e,[{key:"getEl",value:function(t){var e;return null==(e=this.shadowRoot)?void 0:e.querySelector("#".concat(t))}},{key:"connectedCallback",value:function(){var t=this;this.disposables.addEventListener(this.getEl("close"),"click",(function(){t.handleActionEvent("cancel")})),this.disposables.addEventListener(this.getEl("cancel"),"click",(function(){t.handleActionEvent("cancel")})),this.disposables.addEventListener(this.getEl("confirm"),"click",(function(){t.handleActionEvent("confirm")}))}},{key:"disconnectedCallback",value:function(){this.disposables.dispose()}},{key:"handleActionEvent",value:(l=i(m().mark((function t(e){var n,i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i="cancel"===e?this.onCancel:this.onConfirm)){t.next=6;break}return t.next=4,i(this.hide.bind(this));case 4:t.next=8;break;case 6:return t.next=8,this.hide();case 8:null==(n=this.final)||n.call(this);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"handleText",value:function(t,e){this.getEl(t).textContent=e,""===e&&this.handleVisible(t,!1)}},{key:"doTransition",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,r=this.getEl(t);r.style.transition="all ".concat(i,"ms linear"),r.style.opacity="var(--bili-modal-opacity, ".concat(e?"0":"1",")"),"dialog"===t&&(r.style.transform="var(--bili-modal-transform, scale(1))"),e&&(r.style.display="block"),setTimeout((function(){r.style.setProperty("--bili-modal-opacity",e?"1":"0"),"dialog"===t&&r.style.setProperty("--bili-modal-transform",e?"scale(1)":"scale(.8)"),setTimeout((function(){e||(r.style.display="none","mask"===t&&n.handleVisible("",!1)),r.style.removeProperty("transition"),r.style.removeProperty("opacity"),r.style.removeProperty("--bili-modal-opacity"),n.deferred.resolve(!0)}),i+20)}),0)}},{key:"handleVisible",value:function(t,e,n){var i=""===t?this:this.getEl(t);n?"mask"!==t&&"dialog"!==t||this.doTransition(t,e):i.style.display=e?"block":"none"}},{key:"handleAction",value:function(t,e){var n=this;if(!1!==e&&""!==e){this.handleVisible(t,!0);var r=function(){var t=i(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.hide();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),o="cancel"===t?"取消":"确定";k(e)>"u"?e={text:o,click:r}:"string"==typeof e?e={text:e,click:r}:"function"==typeof e&&(e={text:o,click:e});var a=e;this.handleText(t,a.text),this["cancel"===t?"onCancel":"onConfirm"]=a.click}else this.handleVisible(t,!1)}},{key:"show",value:(a=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.deferred=Cn(),this.final=e.final||null,this.handleVisible("mask",!1!==e.mask,!0),this.handleVisible("dialog",!0),this.handleVisible("",!0),this.style.setProperty("z-index",String(e.zIndex||jn()),"important"),this.handleText("title",e.title||""),this.handleText("message",e.message||""),this.handleAction("cancel",e.cancel),this.handleAction("confirm",e.confirm),t.next=12,this.deferred.promise;case 12:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"hide",value:(n=i(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.deferred=Cn(),this.handleVisible("dialog",!1,!0),"block"===this.getEl("mask").style.display?this.handleVisible("mask",!1,!0):this.handleVisible("",!1),t.next=5,this.deferred.promise;case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]);var n,a,l}(A(HTMLElement));customElements.get("bili-modal")||customElements.define("bili-modal",sr);var lr=333,cr="cubic-bezier(0.4, 0, 0.22, 1)",ur=function(t){function e(){var t;return o(this,e),(t=r(this,e)).visible=!1,t.disposables=On(),t.imgs=[],t.isOpening=!1,t.isZoomIn=!1,t.isZooming=!1,t.isOpen=!1,t.isClosing=!1,t.currIndex=0,t.removeSelfByClose=!1,t.isZoomInDragging=!1,t.zoomInDragPos=null,t.zoomInOffset={x:0,y:0},t.viewportRect={w:0,h:0,x:0,y:0},t.attachShadow({mode:"open"}),t.render(),t}return p(e,t),s(e,[{key:"shadowRootQuerySelector",value:function(t){return this.shadowRoot.querySelector(t)}},{key:"container",get:function(){return this.shadowRootQuerySelector("#container")}},{key:"item",get:function(){return this.shadowRootQuerySelector("#container #item")}},{key:"zoomWrap",get:function(){return this.shadowRootQuerySelector("#container #item #zoom-wrap")}},{key:"currImgEl",get:function(){return this.shadowRootQuerySelector("#container #item #zoom-wrap img")}},{key:"spinner",get:function(){return this.shadowRootQuerySelector("#container #spinner")}},{key:"thumb",get:function(){return this.shadowRootQuerySelector("#wrap #thumb")}},{key:"currImg",get:function(){return this.imgs[this.currIndex]}},{key:"connectedCallback",value:(y=i(m().mark((function t(){var e=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Tn((function(){e.initEvents()}));case 1:case"end":return t.stop()}}),t)}))),function(){return y.apply(this,arguments)})},{key:"timeoutPromise",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(n){t.disposables.setTimeout((function(){n(!0)}),e)}))}},{key:"initEvents",value:function(){var t=this;if(this.shadowRoot){var e=this.shadowRoot.querySelector("#close"),n=this.shadowRoot.querySelector("#prev"),r=this.shadowRoot.querySelector("#next");this.disposables.addEventListener(e,"click",(function(){t.close()})),this.disposables.addEventListener(n,"click",(function(){t.prev()})),this.disposables.addEventListener(r,"click",(function(){t.next()})),this.disposables.addEventListener(this.thumb,"click",(function(e){if(e.target instanceof HTMLElement){var n,i=null!==(n=e.target.dataset.index)&&void 0!==n?n:t.currIndex;i!==t.currIndex&&t.goTo(Number(i))}})),this.disposables.addEventListener(this.zoomWrap,"click",(function(e){if(!t.isZoomInDragging)if(t.isZoomIn)t.zoomTo();else{var n=t.zoomWrap.getBoundingClientRect(),i=n.left,r=n.top;t.zoomTo({x:e.clientX-i,y:e.clientY-r})}}));var o=function(e){t.isOpen&&e.preventDefault()};this.disposables.addEventListener(this,"touchmove",o,{passive:!1}),this.disposables.addEventListener(this.container,"click",(function(e){if(e.target===t.item){if(t.isZoomIn||t.isZooming)return;t.close()}})),this.disposables.addEventListener(this.zoomWrap,"wheel",(function(e){o(e),t.isZoomIn&&!t.isZooming&&t.scrollZoomWrap(e.deltaX,e.deltaY)}),{passive:!0}),this.disposables.addEventListener(this.zoomWrap,"mousedown",(function(e){!t.isZoomIn||t.isZooming||(t.isZoomInDragging=!0,t.zoomInDragPos={x:e.clientX,y:e.clientY,isOrigin:!0})})),this.disposables.addEventListener(this.zoomWrap,"mousemove",(function(e){if(t.isZoomIn&&!t.isZooming&&t.zoomInDragPos){var n=t.zoomInDragPos.x-e.clientX,i=t.zoomInDragPos.y-e.clientY;t.scrollZoomWrap(n,i),t.zoomInDragPos={x:e.clientX,y:e.clientY,isOrigin:!1}}})),this.disposables.addEventListener(this.zoomWrap,"mouseup",i(m().mark((function e(){var n;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isZoomIn||t.isZooming){e.next=11;break}if(t.zoomInDragPos){e.next=4;break}return t.isZoomInDragging=!1,e.abrupt("return");case 4:if(null==(n=t.zoomInDragPos)||!n.isOrigin){e.next=7;break}return t.zoomInDragPos=null,t.isZoomInDragging=!1,e.abrupt("return");case 7:return t.zoomInDragPos=null,e.next=10,t.timeoutPromise(300);case 10:t.isZoomInDragging=!1;case 11:case"end":return e.stop()}}),e)})))),this.disposables.addEventListener(document,"keydown",(function(e){var n=function(){e.stopPropagation(),e.preventDefault()};if(t.isOpen)switch(e.key){case"Escape":t.close(),n();break;case"ArrowLeft":t.prev(),n();break;case"ArrowRight":t.next(),n()}})),this.disposables.addEventListener(window,"resize",function(t,e,n){var i,r=n||{},o=r.noTrailing,a=void 0!==o&&o,s=r.noLeading,l=void 0!==s&&s,c=r.debounceMode,u=void 0===c?void 0:c,d=!1,p=0;function h(){i&&clearTimeout(i)}function f(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var s=this,c=Date.now()-p;function f(){p=Date.now(),e.apply(s,r)}function v(){i=void 0}d||(l||!u||i||f(),h(),void 0===u&&c>t?l?(p=Date.now(),a||(i=setTimeout(u?v:f,t))):f():!0!==a&&(i=setTimeout(u?v:f,void 0===u?t-c:t)))}return f.cancel=function(t){var e=(t||{}).upcomingOnly,n=void 0!==e&&e;h(),d=!n},f}(10,(function(){t.getViewportRect(),!t.isZooming&&!t.isZoomInDragging&&t.currImg&&(delete t.currImg.zoom,t.calculateImgZoom(),t.animateToOpenState(!1))})))}}},{key:"disconnectedCallback",value:function(){this.disposables.dispose(),this.isOpen=!1}},{key:"getViewportRect",value:function(){var t=this.container;if(t){var e=t.getBoundingClientRect(),n=e.width,i=e.height,r=e.x,o=e.y;this.viewportRect.w=n,this.viewportRect.h=i,this.viewportRect.x=r,this.viewportRect.y=o}}},{key:"setTransitionStyle",value:function(t,e,n,i){t.style.setProperty("transition",e?"".concat(e," ").concat(n,"ms ").concat(i||cr):"none")}},{key:"removeTransitionStyle",value:function(t){t.style.removeProperty("transition")}},{key:"animateTo",value:(b=i(m().mark((function t(e,n,i){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.timeoutPromise();case 2:return this.setTransitionStyle(e,n,lr),t.next=5,this.timeoutPromise(30);case 5:e.style.setProperty(n,i);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return b.apply(this,arguments)})},{key:"initialize",value:(f=i(m().mark((function t(e){var n,i,r,o,a,s,l,c;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=function(){return new Error("bili photoswipe open options error")},i=e.gallery,r=e.children,o=e.dataSource,a=e.index,s=e.appendToEl,!i||!r){t.next=12;break}if(l=document.querySelector(i)){t.next=6;break}return t.abrupt("return",Promise.reject(n()));case 6:if((c=Array.from(l.querySelectorAll(r)||[])).length){t.next=9;break}return t.abrupt("return",Promise.reject(n()));case 9:this.imgs=Array.from(c).map((function(t){var e=t.dataset;return{src:e.pswpSrc||"",width:Number(e.pswpWidth)||0,height:Number(e.pswpHeight)||0,thumbEl:t,thumbCropped:null!==e.cropped}})),t.next=17;break;case 12:if(null==o||!o.length){t.next=16;break}this.imgs=o.map((function(t){return v({},t)})),t.next=17;break;case 16:return t.abrupt("return",Promise.reject(n()));case 17:if("number"==typeof a&&a>=0&&a<this.imgs.length&&(this.currIndex=0|a),t.t0=s||!this.parentElement,!t.t0){t.next=24;break}return this.removeSelfByClose=!0,(s||document.body).appendChild(this),t.next=24,this.timeoutPromise();case 24:this.getViewportRect(),this.setAttribute("visible",""),this.style.setProperty("z-index",String(1e4+jn())),this.setThumb();case 28:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"setThumb",value:function(){if(1!==this.imgs.length){this.thumb.innerHTML=this.imgs.map((function(t,e){return function(t,e){return'\n        <div class="thumb-item" data-index="'.concat(e,'"><img src="').concat(t,'"></div>\n      ')}("".concat(t.src,"@96w_96h_1c.webp"),e)})).join(""),this.updateThumbActive()}else this.thumb.style.display="none"}},{key:"updateThumbActive",value:function(){if(1!==this.imgs.length){var t=this.thumb.querySelector(".thumb-item.active");t&&t.classList.remove("active");var e=this.thumb.children[this.currIndex];e&&e.classList.add("active")}}},{key:"getCurrImgOpenData",value:function(){var t=this.currImg,e=t.src,n=t.width,i=t.height,r=t.zoom;return{src:e,width:this.isZoomIn?n:(null==r?void 0:r.width)||n,height:this.isZoomIn?i:(null==r?void 0:r.height)||i}}},{key:"animateZoomWrapToOpenState",value:(h=i(m().mark((function t(e,n){var i,r,o,a,s;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.getCurrImgOpenData(),r=i.width,o=i.height,a=(this.viewportRect.w-r)/2,s=o>=this.viewportRect.h?0:(this.viewportRect.h-o)/2,e?this.animateTo(this.zoomWrap,"transform",this.getTransform(a,s,n)):(this.removeTransitionStyle(this.zoomWrap),this.zoomWrap.style.setProperty("transform",this.getTransform(a,s,n))),t.next=4,this.timeoutPromise(30+(e?lr:0));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)})},{key:"animateToOpenState",value:(d=i(m().mark((function t(e){var n,i,r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.getCurrImgOpenData(),i=n.width,r=n.height,e?(this.animateTo(this.container,"transform",this.getTransform(0,0)),this.animateTo(this.item,"transform","none"),this.animateZoomWrapToOpenState(e,1)):(this.animateZoomWrapToOpenState(e,1),this.currImgEl&&this.setElementSize(this.currImgEl,i,r)),t.next=4,this.timeoutPromise(30+(e?lr:0));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"animateToClosedState",value:(u=i(m().mark((function t(e){var n,i,r,o,a,s,l;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this.currImg).thumbEl){t.next=3;break}return t.abrupt("return");case 3:if((i=n.thumbCropped?this.getCroppedBoundsByElement(n.thumbEl,n.width,n.height):this.getBoundsByElement(n.thumbEl)).innerRect){t.next=6;break}return t.abrupt("return");case 6:return r=this.getCurrImgOpenData().width,o=-this.viewportRect.w+(i.x-i.innerRect.x)+i.innerRect.w,a=-this.viewportRect.h+(i.y-i.innerRect.y)+i.innerRect.h,s=this.viewportRect.w-i.innerRect.w,l=this.viewportRect.h-i.innerRect.h,this.zoomWrap.style.setProperty("transform-origin","0 0"),e?(this.animateTo(this.container,"transform",this.getTransform(o,a)),this.animateTo(this.item,"transform",this.getTransform(s,l)),this.animateTo(this.zoomWrap,"transform",this.getTransform(i.innerRect.x,i.innerRect.y,i.w/r))):(this.container.style.setProperty("transform",this.getTransform(o,a)),this.item.style.setProperty("transform",this.getTransform(s,l)),this.zoomWrap.style.setProperty("transform",this.getTransform(i.innerRect.x,i.innerRect.y,i.w/r))),t.next=11,this.timeoutPromise(30+(e?lr:0));case 11:this.zoomWrap.classList.add("opend");case 12:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"open",value:(c=i(m().mark((function t(e){var n,i,r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.visible){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.initialize(e);case 4:if(this.triggerEvent("before-open"),this.visible=!0,n=this.calculateImgZoom(),i=n.src,!n.thumbEl){t.next=22;break}return this.isOpening=!0,this.appendPlaceholderEl(),r=this.loadImg(i),t.next=12,this.animateToClosedState(!1);case 12:return t.next=14,this.animateToOpenState(!0);case 14:return t.t0=this,t.next=17,r;case 17:t.t1=t.sent,t.t0.appendImgEl.call(t.t0,t.t1),this.isOpening=!1,t.next=25;break;case 22:return this.appendImgEl(),t.next=25,this.animateToOpenState(!1);case 25:this.isOpen=!0,this.triggerEvent("after-open");case 26:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"close",value:(l=i(m().mark((function t(){var e;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.visible&&!this.isOpening&&!this.isClosing){t.next=2;break}return t.abrupt("return");case 2:if(this.isClosing=!0,this.visible=!1,this.triggerEvent("before-close"),this.removeAttribute("visible"),e=this.currImg.thumbEl,t.t0=e,!t.t0){t.next=8;break}return t.next=8,this.animateToClosedState(!0);case 8:this.imgs=[],this.triggerEvent("after-close"),this.removeSelfByClose&&this.parentElement&&this.parentElement.removeChild(this),this.removeSelfByClose=!1,this.isOpen=!1;case 13:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"triggerEvent",value:function(t){this.dispatchEvent(new CustomEvent(t))}},{key:"prev",value:function(){this.triggerEvent("prev"),this.goTo(this.currIndex-1)}},{key:"next",value:function(){this.triggerEvent("next"),this.goTo(this.currIndex+1)}},{key:"clearZoomState",value:function(){this.zoomInOffset.x=0,this.zoomInOffset.y=0,this.isZoomIn=!1,this.zoomWrap.classList.remove("zoom-in"),this.zoomWrap.classList.add("zoom-out")}},{key:"goTo",value:(a=i(m().mark((function t(e){var n,i,r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e<0||e>this.imgs.length-1)){t.next=2;break}return t.abrupt("return");case 2:if(this.currIndex=e,this.updateThumbActive(),this.isZoomIn&&this.clearZoomState(),n=this.calculateImgZoom(),i=n.src,r=n.thumbEl,this.animateToOpenState(!1),t.prev=5,!r){t.next=15;break}return this.appendPlaceholderEl(),t.t0=this,t.next=11,this.loadImg(i);case 11:t.t1=t.sent,t.t0.appendImgEl.call(t.t0,t.t1),t.next=23;break;case 15:return this.removeImgFromContent(),this.spinner.classList.add("visible"),t.t2=this,t.next=20,this.loadImg(i);case 20:t.t3=t.sent,t.t2.appendImgEl.call(t.t2,t.t3),this.spinner.classList.remove("visible");case 23:t.next=28;break;case 25:t.prev=25,t.t4=t.catch(5),console.log(t.t4);case 28:case"end":return t.stop()}}),t,this,[[5,25]])}))),function(t){return a.apply(this,arguments)})},{key:"scrollZoomWrap",value:function(t,e){var n=this.currImg,i=n.width,r=n.height;n.zoom&&(i<this.viewportRect.w&&r<this.viewportRect.h||(this.zoomInOffset.x=i>this.viewportRect.w?-Math.max(0,Math.min(-this.zoomInOffset.x+t,i-this.viewportRect.w)):(this.viewportRect.w-i)/2,this.zoomInOffset.y=r>this.viewportRect.h?-Math.max(0,Math.min(-this.zoomInOffset.y+e,r-this.viewportRect.h)):(this.viewportRect.h-r)/2,this.zoomWrap.style.setProperty("transform",this.getTransform(this.zoomInOffset.x,this.zoomInOffset.y,1))))}},{key:"zoomTo",value:(n=i(m().mark((function t(e){var n,i,r,o,a,s;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.currImg,i=n.width,r=n.height,(o=n.zoom)&&!this.isZooming){t.next=3;break}return t.abrupt("return");case 3:if(!this.isZoomIn){t.next=12;break}return this.isZooming=!0,this.clearZoomState(),t.next=8,this.animateZoomWrapToOpenState(!0,o.width/i);case 8:return t.next=10,this.animateToOpenState(!1);case 10:return this.isZooming=!1,t.abrupt("return");case 12:return this.isZooming=!0,this.isZoomIn=!0,this.zoomWrap.classList.remove("zoom-out"),this.zoomWrap.classList.add("zoom-in"),a=(this.viewportRect.w-i)/2,s=0,i>this.viewportRect.w&&(a=-((null==e?void 0:e.x)||0)/o.width*(i-this.viewportRect.w)),r<this.viewportRect.h?s=(this.viewportRect.h-r)/2:null!=e&&e.y&&(s=-((null==e?void 0:e.y)||0)/o.height*(r-this.viewportRect.h)),this.zoomInOffset.x=a,this.zoomInOffset.y=s,t.next=20,this.animateTo(this.zoomWrap,"transform",this.getTransform(a,s,i/o.width));case 20:return t.next=22,this.timeoutPromise(363);case 22:this.removeTransitionStyle(this.zoomWrap),this.setElementSize(this.currImgEl,i,r),this.zoomWrap.style.setProperty("transform",this.getTransform(a,s,1)),this.isZooming=!1;case 26:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"loadImg",value:function(t,e){return new Promise((function(n,i){var r=e||new Image;r.onload=function(){n(r)},r.onerror=function(){i(new Error("load img error"))},r.src=t}))}},{key:"calculateImgZoom",value:function(t){var e;if((t=null!==(e=t)&&void 0!==e?e:this.currIndex)>=this.imgs.length||t<0)throw new Error("index out of range");if(this.imgs[t].zoom)return this.imgs[t];var n=this.imgs[t],i=n.width,r=n.height,o=!1,a=i/r,s=this.viewportRect.w/this.viewportRect.h;if(a>s)i>this.viewportRect.w&&(r=(i=this.viewportRect.w)/a,o=!0);else if(a<s)r>this.viewportRect.h&&(i=(r=this.viewportRect.h)*a,o=!0);else{var l=Math.min(this.viewportRect.w,this.viewportRect.h);l<i&&(o=!0,i=r=l)}return o&&(this.imgs[t].zoom={width:Math.round(i),height:Math.round(r)}),this.imgs[t]}},{key:"getBoundsByElement",value:function(t){var e=t.getBoundingClientRect();return{x:e.left,y:e.top,w:e.width}}},{key:"getCroppedBoundsByElement",value:function(t,e,n){var i=t.getBoundingClientRect(),r=i.width/e,o=i.height/n,a=r>o?r:o,s=(i.width-e*a)/2,l=(i.height-n*a)/2;return{x:i.left+s,y:i.top+l,w:e*a,innerRect:{w:i.width,h:i.height,x:s,y:l}}}},{key:"getTransform",value:function(t,e,n){var i="translate3d(".concat(t,"px, ").concat(e,"px, 0px)");return"number"==typeof n&&(i+=" scale3d(".concat(n,", ").concat(n,", 1)")),i}},{key:"appendImgToContent",value:function(t){var e=this.zoomWrap.querySelector("img");e?this.zoomWrap.replaceChild(t,e):this.zoomWrap.appendChild(t)}},{key:"removeImgFromContent",value:function(){var t=this.zoomWrap.querySelector("img");t&&this.zoomWrap.removeChild(t)}},{key:"appendPlaceholderEl",value:function(){var t=this.currImg.thumbEl;if(t){var e=t.querySelector("img"),n=null==e?void 0:e.getAttribute("src");if(n){var i=new Image;i.alt="",i.src=n,i.setAttribute("role","presentation"),i.setAttribute("aria-hidden","true"),this.setElementSize(i,250),i.style.setProperty("width","250px"),i.style.setProperty("height","auto"),i.style.transformOrigin="0 0",i.style.transform=this.getTransform(0,0,this.getCurrImgOpenData().width/250),this.appendImgToContent(i)}}}},{key:"setElementSize",value:function(t,e,n){t.style.setProperty("width","".concat(e,"px")),t.style.setProperty("height",n?"".concat(n,"px"):"auto")}},{key:"appendImgEl",value:function(t){var e=this.getCurrImgOpenData(),n=e.src,i=e.width,r=e.height;t||((t=new Image).src=n),this.setElementSize(t,i,r),this.appendImgToContent(t),this.currImg.zoom&&this.zoomWrap.classList.add("zoom-out"),this.zoomWrap.classList.contains("opend")||this.zoomWrap.classList.add("opend")}},{key:"render",value:function(){this.shadowRoot&&(this.shadowRoot.innerHTML="\n      <style>\n        :host {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n        }\n        #bg {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          background: #000;\n        }\n        :host([visible]) .ui-visible {\n          opacity: .8;\n          pointer-events: auto;\n        }\n        :host([visible]) #thumb.ui-visible {\n          opacity: 1;\n          pointer-events: auto;\n        }\n        .ui-visible {\n          opacity: 0.005;\n          will-change: opacity;\n          transition: opacity ".concat(lr,"ms ease;\n          pointer-events: none;\n        }\n        #wrap,\n        #wrap #container,\n        #wrap #container #item,\n        #wrap #container #zoom-wrap {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n        }\n        #wrap button {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          position: absolute;\n          z-index: 2;\n          width: 42px;\n          height: 42px;\n          border-radius: 50%;\n          color: var(--text_white);\n          background: rgba(0,0,0,.58);\n          transition-function: ").concat(cr,';\n          cursor: pointer;\n          outline: none;\n          border: none;\n        }\n        button.top {\n          top: 16px;\n        }\n        button.left {\n          left: 16px;\n        }\n        button.right {\n          right: 16px;\n        }\n        button.middle {\n          top: 50%;\n        }\n        button#prev {\n          transform: translateY(-50%);\n        }\n        button#next {\n          transform: translateY(-50%) rotate(180deg);\n        }\n        #wrap button:hover {\n          color: var(--brand_pink);\n        }\n        #wrap #container,\n        #wrap #item {\n          overflow: hidden;\n        }\n        #wrap #container #zoom-wrap.opend {\n          width: auto;\n          height: auto;\n        }\n        #zoom-wrap img {\n          max-width: none;\n          -webkit-user-drag: none;\n        }\n        #zoom-wrap.zoom-out {\n          cursor: zoom-in;\n        }\n        #zoom-wrap.zoom-in {\n          cursor: move;\n          cursor: -webkit-grab;\n          cursor: -moz-grab;\n          cursor: grab;\n        }\n        #spinner {\n          position: absolute;\n          left: 50%;\n          top: 50%;\n          transform: translate(-50%, -50%);\n          padding: 20px 0;\n          width: 100%;\n          text-align: center;\n          font-size: 14px;\n          color: var(--text3);\n          pointer-events: none;\n          display: none;\n        }\n        #spinner.visible {\n          display: block;\n        }\n        #spinner img {\n          margin-right: 8px;\n          vertical-align: bottom;\n        }\n        #thumb {\n          display: flex;\n          align-items: center;\n          position: absolute;\n          left: 50%;\n          bottom: 30px;\n          z-index: 2;\n          padding: 6px 10px;\n          border-radius: 8px;\n          background: rgba(24,25,28,.8);\n          backdrop-filter: blur(20px);\n          transform: translate(-50%);\n        }\n        #thumb .thumb-item {\n          width: 54px;\n          height: 54px;\n          padding: 1px;\n          border: 2px solid transparent;\n          border-radius: 8px;\n          transition: .3s;\n          cursor: pointer;\n          box-sizing: border-box;\n        }\n        #thumb .thumb-item img {\n          width: 100%;\n          height: 100%;\n          border-radius: 6px;\n          -webkit-user-drag: none;\n          pointer-events: none;\n        }\n        #thumb .thumb-item.active {\n          border-color: var(--brand_pink);\n        }\n      </style>\n      <div id="bg" class="ui-visible"></div>\n      <section id="wrap" aria-roledescription="carousel">\n        <div id="container">\n          <div id="item">\n            <div id="zoom-wrap"></div>\n          </div>\n          <div id="spinner">\n            <img width="24" height="24" src="//s1.hdslb.com/bfs/static/jinkela/long/gif/loading-blue.gif" />\n            <span>正在玩命加载…</span>\n          </div>\n        </div>\n        <button id="close" class="right top ui-visible"><bili-icon icon="BDC/xmark_close_line/1" size="20"></bili-icon></button>\n        <button id="prev" class="left middle ui-visible"><bili-icon icon="BDC/arrow_back_left_line/3" size="20"></bili-icon></button>\n        <button id="next" class="right middle ui-visible"><bili-icon icon="BDC/arrow_back_left_line/3" size="20"></bili-icon></button>\n        <div id="thumb" class="ui-visible"></div>\n      </section>\n    '))}}]);var n,a,l,c,u,d,h,f,b,y}(A(HTMLElement));customElements.get("bili-photoswipe")||customElements.define("bili-photoswipe",ur);var dr="top",pr="bottom",hr="right",fr="left",vr="auto",mr=[dr,pr,hr,fr],br="start",yr="end",gr="clippingParents",wr="viewport",xr="popper",kr="reference",_r=mr.reduce((function(t,e){return t.concat([e+"-"+br,e+"-"+yr])}),[]),Ar=[].concat(mr,[vr]).reduce((function(t,e){return t.concat([e,e+"-"+br,e+"-"+yr])}),[]),Er=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Cr(t){return t?(t.nodeName||"").toLowerCase():null}function Tr(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Sr(t){return t instanceof Tr(t).Element||t instanceof Element}function Or(t){return t instanceof Tr(t).HTMLElement||t instanceof HTMLElement}function Pr(t){return"undefined"!=typeof ShadowRoot&&(t instanceof Tr(t).ShadowRoot||t instanceof ShadowRoot)}var Ir={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var n=e.styles[t]||{},i=e.attributes[t]||{},r=e.elements[t];Or(r)&&Cr(r)&&(Object.assign(r.style,n),Object.keys(i).forEach((function(t){var e=i[t];!1===e?r.removeAttribute(t):r.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach((function(t){var i=e.elements[t],r=e.attributes[t]||{},o=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:n[t]).reduce((function(t,e){return t[e]="",t}),{});Or(i)&&Cr(i)&&(Object.assign(i.style,o),Object.keys(r).forEach((function(t){i.removeAttribute(t)})))}))}},requires:["computeStyles"]};function Rr(t){return t.split("-")[0]}var jr=Math.max,Lr=Math.min,Mr=Math.round;function Dr(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function Nr(){return!/^((?!chrome|android).)*safari/i.test(Dr())}function Br(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=t.getBoundingClientRect(),r=1,o=1;e&&Or(t)&&(r=t.offsetWidth>0&&Mr(i.width)/t.offsetWidth||1,o=t.offsetHeight>0&&Mr(i.height)/t.offsetHeight||1);var a=(Sr(t)?Tr(t):window).visualViewport,s=!Nr()&&n,l=(i.left+(s&&a?a.offsetLeft:0))/r,c=(i.top+(s&&a?a.offsetTop:0))/o,u=i.width/r,d=i.height/o;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l,x:l,y:c}}function zr(t){var e=Br(t),n=t.offsetWidth,i=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:i}}function Ur(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Pr(n)){var i=e;do{if(i&&t.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Fr(t){return Tr(t).getComputedStyle(t)}function Vr(t){return["table","td","th"].indexOf(Cr(t))>=0}function Hr(t){return((Sr(t)?t.ownerDocument:t.document)||window.document).documentElement}function Wr(t){return"html"===Cr(t)?t:t.assignedSlot||t.parentNode||(Pr(t)?t.host:null)||Hr(t)}function $r(t){return Or(t)&&"fixed"!==Fr(t).position?t.offsetParent:null}function qr(t){for(var e=Tr(t),n=$r(t);n&&Vr(n)&&"static"===Fr(n).position;)n=$r(n);return n&&("html"===Cr(n)||"body"===Cr(n)&&"static"===Fr(n).position)?e:n||function(t){var e=/firefox/i.test(Dr());if(/Trident/i.test(Dr())&&Or(t)&&"fixed"===Fr(t).position)return null;var n=Wr(t);for(Pr(n)&&(n=n.host);Or(n)&&["html","body"].indexOf(Cr(n))<0;){var i=Fr(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||e&&"filter"===i.willChange||e&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(t)||e}function Gr(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Xr(t,e,n){return jr(t,Lr(e,n))}function Yr(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function Zr(t,e){return e.reduce((function(e,n){return e[n]=t,e}),{})}var Qr={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,n=t.state,i=t.name,r=t.options,o=n.elements.arrow,a=n.modifiersData.popperOffsets,s=Rr(n.placement),l=Gr(s),c=[fr,hr].indexOf(s)>=0?"height":"width";if(o&&a){var u=function(t,e){return Yr("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:Zr(t,mr))}(r.padding,n),d=zr(o),p="y"===l?dr:fr,h="y"===l?pr:hr,f=n.rects.reference[c]+n.rects.reference[l]-a[l]-n.rects.popper[c],v=a[l]-n.rects.reference[l],m=qr(o),b=m?"y"===l?m.clientHeight||0:m.clientWidth||0:0,y=f/2-v/2,g=u[p],w=b-d[c]-u[h],x=b/2-d[c]/2+y,k=Xr(g,x,w),_=l;n.modifiersData[i]=((e={})[_]=k,e.centerOffset=k-x,e)}},effect:function(t){var e=t.state,n=t.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!=typeof i||(i=e.elements.popper.querySelector(i)))&&Ur(e.elements.popper,i)&&(e.elements.arrow=i)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Kr(t){return t.split("-")[1]}var Jr={top:"auto",right:"auto",bottom:"auto",left:"auto"};function to(t){var e,n=t.popper,i=t.popperRect,r=t.placement,o=t.variation,a=t.offsets,s=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,p=a.x,h=void 0===p?0:p,f=a.y,v=void 0===f?0:f,m="function"==typeof u?u({x:h,y:v}):{x:h,y:v};h=m.x,v=m.y;var b=a.hasOwnProperty("x"),y=a.hasOwnProperty("y"),g=fr,w=dr,x=window;if(c){var k=qr(n),_="clientHeight",A="clientWidth";if(k===Tr(n)&&"static"!==Fr(k=Hr(n)).position&&"absolute"===s&&(_="scrollHeight",A="scrollWidth"),r===dr||(r===fr||r===hr)&&o===yr)w=pr,v-=(d&&k===x&&x.visualViewport?x.visualViewport.height:k[_])-i.height,v*=l?1:-1;if(r===fr||(r===dr||r===pr)&&o===yr)g=hr,h-=(d&&k===x&&x.visualViewport?x.visualViewport.width:k[A])-i.width,h*=l?1:-1}var E,C=Object.assign({position:s},c&&Jr),T=!0===u?function(t,e){var n=t.x,i=t.y,r=e.devicePixelRatio||1;return{x:Mr(n*r)/r||0,y:Mr(i*r)/r||0}}({x:h,y:v},Tr(n)):{x:h,y:v};return h=T.x,v=T.y,l?Object.assign({},C,((E={})[w]=y?"0":"",E[g]=b?"0":"",E.transform=(x.devicePixelRatio||1)<=1?"translate("+h+"px, "+v+"px)":"translate3d("+h+"px, "+v+"px, 0)",E)):Object.assign({},C,((e={})[w]=y?v+"px":"",e[g]=b?h+"px":"",e.transform="",e))}var eo={passive:!0};var no={left:"right",right:"left",bottom:"top",top:"bottom"};function io(t){return t.replace(/left|right|bottom|top/g,(function(t){return no[t]}))}var ro={start:"end",end:"start"};function oo(t){return t.replace(/start|end/g,(function(t){return ro[t]}))}function ao(t){var e=Tr(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function so(t){return Br(Hr(t)).left+ao(t).scrollLeft}function lo(t){var e=Fr(t),n=e.overflow,i=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function co(t){return["html","body","#document"].indexOf(Cr(t))>=0?t.ownerDocument.body:Or(t)&&lo(t)?t:co(Wr(t))}function uo(t,e){var n;void 0===e&&(e=[]);var i=co(t),r=i===(null==(n=t.ownerDocument)?void 0:n.body),o=Tr(i),a=r?[o].concat(o.visualViewport||[],lo(i)?i:[]):i,s=e.concat(a);return r?s:s.concat(uo(Wr(a)))}function po(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function ho(t,e,n){return e===wr?po(function(t,e){var n=Tr(t),i=Hr(t),r=n.visualViewport,o=i.clientWidth,a=i.clientHeight,s=0,l=0;if(r){o=r.width,a=r.height;var c=Nr();(c||!c&&"fixed"===e)&&(s=r.offsetLeft,l=r.offsetTop)}return{width:o,height:a,x:s+so(t),y:l}}(t,n)):Sr(e)?function(t,e){var n=Br(t,!1,"fixed"===e);return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}(e,n):po(function(t){var e,n=Hr(t),i=ao(t),r=null==(e=t.ownerDocument)?void 0:e.body,o=jr(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=jr(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),s=-i.scrollLeft+so(t),l=-i.scrollTop;return"rtl"===Fr(r||n).direction&&(s+=jr(n.clientWidth,r?r.clientWidth:0)-o),{width:o,height:a,x:s,y:l}}(Hr(t)))}function fo(t,e,n,i){var r="clippingParents"===e?function(t){var e=uo(Wr(t)),n=["absolute","fixed"].indexOf(Fr(t).position)>=0&&Or(t)?qr(t):t;return Sr(n)?e.filter((function(t){return Sr(t)&&Ur(t,n)&&"body"!==Cr(t)})):[]}(t):[].concat(e),o=[].concat(r,[n]),a=o[0],s=o.reduce((function(e,n){var r=ho(t,n,i);return e.top=jr(r.top,e.top),e.right=Lr(r.right,e.right),e.bottom=Lr(r.bottom,e.bottom),e.left=jr(r.left,e.left),e}),ho(t,a,i));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function vo(t){var e,n=t.reference,i=t.element,r=t.placement,o=r?Rr(r):null,a=r?Kr(r):null,s=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(o){case dr:e={x:s,y:n.y-i.height};break;case pr:e={x:s,y:n.y+n.height};break;case hr:e={x:n.x+n.width,y:l};break;case fr:e={x:n.x-i.width,y:l};break;default:e={x:n.x,y:n.y}}var c=o?Gr(o):null;if(null!=c){var u="y"===c?"height":"width";switch(a){case br:e[c]=e[c]-(n[u]/2-i[u]/2);break;case yr:e[c]=e[c]+(n[u]/2-i[u]/2)}}return e}function mo(t,e){void 0===e&&(e={});var n=e,i=n.placement,r=void 0===i?t.placement:i,o=n.strategy,a=void 0===o?t.strategy:o,s=n.boundary,l=void 0===s?gr:s,c=n.rootBoundary,u=void 0===c?wr:c,d=n.elementContext,p=void 0===d?xr:d,h=n.altBoundary,f=void 0!==h&&h,v=n.padding,m=void 0===v?0:v,b=Yr("number"!=typeof m?m:Zr(m,mr)),y=p===xr?kr:xr,g=t.rects.popper,w=t.elements[f?y:p],x=fo(Sr(w)?w:w.contextElement||Hr(t.elements.popper),l,u,a),k=Br(t.elements.reference),_=vo({reference:k,element:g,strategy:"absolute",placement:r}),A=po(Object.assign({},g,_)),E=p===xr?A:k,C={top:x.top-E.top+b.top,bottom:E.bottom-x.bottom+b.bottom,left:x.left-E.left+b.left,right:E.right-x.right+b.right},T=t.modifiersData.offset;if(p===xr&&T){var S=T[r];Object.keys(C).forEach((function(t){var e=[hr,pr].indexOf(t)>=0?1:-1,n=[dr,pr].indexOf(t)>=0?"y":"x";C[t]+=S[n]*e}))}return C}function bo(t,e){void 0===e&&(e={});var n=e,i=n.placement,r=n.boundary,o=n.rootBoundary,a=n.padding,s=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?Ar:l,u=Kr(i),d=u?s?_r:_r.filter((function(t){return Kr(t)===u})):mr,p=d.filter((function(t){return c.indexOf(t)>=0}));0===p.length&&(p=d);var h=p.reduce((function(e,n){return e[n]=mo(t,{placement:n,boundary:r,rootBoundary:o,padding:a})[Rr(n)],e}),{});return Object.keys(h).sort((function(t,e){return h[t]-h[e]}))}var yo={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,i=t.name;if(!e.modifiersData[i]._skip){for(var r=n.mainAxis,o=void 0===r||r,a=n.altAxis,s=void 0===a||a,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,p=n.altBoundary,h=n.flipVariations,f=void 0===h||h,v=n.allowedAutoPlacements,m=e.options.placement,b=Rr(m),y=l||(b===m||!f?[io(m)]:function(t){if(Rr(t)===vr)return[];var e=io(t);return[oo(t),e,oo(e)]}(m)),g=[m].concat(y).reduce((function(t,n){return t.concat(Rr(n)===vr?bo(e,{placement:n,boundary:u,rootBoundary:d,padding:c,flipVariations:f,allowedAutoPlacements:v}):n)}),[]),w=e.rects.reference,x=e.rects.popper,k=new Map,_=!0,A=g[0],E=0;E<g.length;E++){var C=g[E],T=Rr(C),S=Kr(C)===br,O=[dr,pr].indexOf(T)>=0,P=O?"width":"height",I=mo(e,{placement:C,boundary:u,rootBoundary:d,altBoundary:p,padding:c}),R=O?S?hr:fr:S?pr:dr;w[P]>x[P]&&(R=io(R));var j=io(R),L=[];if(o&&L.push(I[T]<=0),s&&L.push(I[R]<=0,I[j]<=0),L.every((function(t){return t}))){A=C,_=!1;break}k.set(C,L)}if(_)for(var M=function(t){var e=g.find((function(e){var n=k.get(e);if(n)return n.slice(0,t).every((function(t){return t}))}));if(e)return A=e,"break"},D=f?3:1;D>0;D--){if("break"===M(D))break}e.placement!==A&&(e.modifiersData[i]._skip=!0,e.placement=A,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function go(t,e,n){return void 0===n&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function wo(t){return[dr,hr,pr,fr].some((function(e){return t[e]>=0}))}var xo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,n=t.options,i=t.name,r=n.offset,o=void 0===r?[0,0]:r,a=Ar.reduce((function(t,n){return t[n]=function(t,e,n){var i=Rr(t),r=[fr,dr].indexOf(i)>=0?-1:1,o="function"==typeof n?n(Object.assign({},e,{placement:t})):n,a=o[0],s=o[1];return a=a||0,s=(s||0)*r,[fr,hr].indexOf(i)>=0?{x:s,y:a}:{x:a,y:s}}(n,e.rects,o),t}),{}),s=a[e.placement],l=s.x,c=s.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[i]=a}};var ko={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,i=t.name,r=n.mainAxis,o=void 0===r||r,a=n.altAxis,s=void 0!==a&&a,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,p=n.tether,h=void 0===p||p,f=n.tetherOffset,v=void 0===f?0:f,m=mo(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),b=Rr(e.placement),y=Kr(e.placement),g=!y,w=Gr(b),x="x"===w?"y":"x",k=e.modifiersData.popperOffsets,_=e.rects.reference,A=e.rects.popper,E="function"==typeof v?v(Object.assign({},e.rects,{placement:e.placement})):v,C="number"==typeof E?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),T=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,S={x:0,y:0};if(k){if(o){var O,P="y"===w?dr:fr,I="y"===w?pr:hr,R="y"===w?"height":"width",j=k[w],L=j+m[P],M=j-m[I],D=h?-A[R]/2:0,N=y===br?_[R]:A[R],B=y===br?-A[R]:-_[R],z=e.elements.arrow,U=h&&z?zr(z):{width:0,height:0},F=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},V=F[P],H=F[I],W=Xr(0,_[R],U[R]),$=g?_[R]/2-D-W-V-C.mainAxis:N-W-V-C.mainAxis,q=g?-_[R]/2+D+W+H+C.mainAxis:B+W+H+C.mainAxis,G=e.elements.arrow&&qr(e.elements.arrow),X=G?"y"===w?G.clientTop||0:G.clientLeft||0:0,Y=null!=(O=null==T?void 0:T[w])?O:0,Z=j+q-Y,Q=Xr(h?Lr(L,j+$-Y-X):L,j,h?jr(M,Z):M);k[w]=Q,S[w]=Q-j}if(s){var K,J="x"===w?dr:fr,tt="x"===w?pr:hr,et=k[x],nt="y"===x?"height":"width",it=et+m[J],rt=et-m[tt],ot=-1!==[dr,fr].indexOf(b),at=null!=(K=null==T?void 0:T[x])?K:0,st=ot?it:et-_[nt]-A[nt]-at+C.altAxis,lt=ot?et+_[nt]+A[nt]-at-C.altAxis:rt,ct=h&&ot?function(t,e,n){var i=Xr(t,e,n);return i>n?n:i}(st,et,lt):Xr(h?st:it,et,h?lt:rt);k[x]=ct,S[x]=ct-et}e.modifiersData[i]=S}},requiresIfExists:["offset"]};function _o(t,e,n){void 0===n&&(n=!1);var i,r,o=Or(e),a=Or(e)&&function(t){var e=t.getBoundingClientRect(),n=Mr(e.width)/t.offsetWidth||1,i=Mr(e.height)/t.offsetHeight||1;return 1!==n||1!==i}(e),s=Hr(e),l=Br(t,a,n),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(o||!o&&!n)&&(("body"!==Cr(e)||lo(s))&&(c=(i=e)!==Tr(i)&&Or(i)?{scrollLeft:(r=i).scrollLeft,scrollTop:r.scrollTop}:ao(i)),Or(e)?((u=Br(e,!0)).x+=e.clientLeft,u.y+=e.clientTop):s&&(u.x=so(s))),{x:l.left+c.scrollLeft-u.x,y:l.top+c.scrollTop-u.y,width:l.width,height:l.height}}function Ao(t){var e=new Map,n=new Set,i=[];function r(t){n.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!n.has(t)){var i=e.get(t);i&&r(i)}})),i.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){n.has(t.name)||r(t)})),i}var Eo={placement:"bottom",modifiers:[],strategy:"absolute"};function Co(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function To(t){void 0===t&&(t={});var e=t,n=e.defaultModifiers,i=void 0===n?[]:n,r=e.defaultOptions,o=void 0===r?Eo:r;return function(t,e,n){void 0===n&&(n=o);var r,a,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},Eo,o),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},l=[],c=!1,u={state:s,setOptions:function(n){var r="function"==typeof n?n(s.options):n;d(),s.options=Object.assign({},o,s.options,r),s.scrollParents={reference:Sr(t)?uo(t):t.contextElement?uo(t.contextElement):[],popper:uo(e)};var a,c,p=function(t){var e=Ao(t);return Er.reduce((function(t,n){return t.concat(e.filter((function(t){return t.phase===n})))}),[])}((a=[].concat(i,s.options.modifiers),c=a.reduce((function(t,e){var n=t[e.name];return t[e.name]=n?Object.assign({},n,e,{options:Object.assign({},n.options,e.options),data:Object.assign({},n.data,e.data)}):e,t}),{}),Object.keys(c).map((function(t){return c[t]}))));return s.orderedModifiers=p.filter((function(t){return t.enabled})),s.orderedModifiers.forEach((function(t){var e=t.name,n=t.options,i=void 0===n?{}:n,r=t.effect;if("function"==typeof r){var o=r({state:s,name:e,instance:u,options:i}),a=function(){};l.push(o||a)}})),u.update()},forceUpdate:function(){if(!c){var t=s.elements,e=t.reference,n=t.popper;if(Co(e,n)){s.rects={reference:_o(e,qr(n),"fixed"===s.options.strategy),popper:zr(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(t){return s.modifiersData[t.name]=Object.assign({},t.data)}));for(var i=0;i<s.orderedModifiers.length;i++)if(!0!==s.reset){var r=s.orderedModifiers[i],o=r.fn,a=r.options,l=void 0===a?{}:a,d=r.name;"function"==typeof o&&(s=o({state:s,options:l,name:d,instance:u})||s)}else s.reset=!1,i=-1}}},update:(r=function(){return new Promise((function(t){u.forceUpdate(),t(s)}))},function(){return a||(a=new Promise((function(t){Promise.resolve().then((function(){a=void 0,t(r())}))}))),a}),destroy:function(){d(),c=!0}};if(!Co(t,e))return u;function d(){l.forEach((function(t){return t()})),l=[]}return u.setOptions(n).then((function(t){!c&&n.onFirstUpdate&&n.onFirstUpdate(t)})),u}}var So=To({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,n=t.instance,i=t.options,r=i.scroll,o=void 0===r||r,a=i.resize,s=void 0===a||a,l=Tr(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach((function(t){t.addEventListener("scroll",n.update,eo)})),s&&l.addEventListener("resize",n.update,eo),function(){o&&c.forEach((function(t){t.removeEventListener("scroll",n.update,eo)})),s&&l.removeEventListener("resize",n.update,eo)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,n=t.name;e.modifiersData[n]=vo({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,n=t.options,i=n.gpuAcceleration,r=void 0===i||i,o=n.adaptive,a=void 0===o||o,s=n.roundOffsets,l=void 0===s||s,c={placement:Rr(e.placement),variation:Kr(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,to(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,to(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},Ir,xo,yo,ko,Qr,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,n=t.name,i=e.rects.reference,r=e.rects.popper,o=e.modifiersData.preventOverflow,a=mo(e,{elementContext:"reference"}),s=mo(e,{altBoundary:!0}),l=go(a,i),c=go(s,r,o),u=wo(l),d=wo(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),Oo=function(t){function e(t){var n;return o(this,e),(n=r(this,e)).timer=null,k(t)<"u"&&n.reset(t),n}return p(e,t),s(e,[{key:"reset",value:function(t){var n=this;u(d(e.prototype),"reset",this).call(this),k(t)<"u"&&(this.timer=window.setTimeout((function(){n.resolve(!0),n.timer=null}),t))}},{key:"clear",value:function(){this.timer&&(window.clearTimeout(this.timer),this.timer=null,this.reject(new Error("User canceled")))}}])}(En),Po=function(t){function e(){var t;o(this,e),(t=r(this,e)).reference=null,t.transition="",t.disposables=On(),t.deferred=null,t.state="hidden",t.showDelay=0,t.hideDelay=0,t.zIndex=0;var n=t.attachShadow({mode:"open"}),i=document.createElement("template");i.innerHTML='\n      <style>\n        :host {\n        }\n      </style>\n      <div id="content">\n        <slot></slot>\n      </div>\n    ';var a=document.importNode(i.content,!0);return n.appendChild(a),t}return p(e,t),s(e,[{key:"setup",value:function(t,e){var n,i=this;if(this.reference)console.warn("This popover has been setuped");else if("string"==typeof t&&(this.parentElement&&(n=this.parentElement.querySelector(t)),n||(n=document.querySelector(t))),n){if(this.reference=n,this.popperInstance=So(n,this,{placement:(null==e?void 0:e.placement)||"bottom",modifiers:[{name:"offset",options:{offset:(null==e?void 0:e.offset)||[0,4]}}]}),null!=e&&e.zIndex&&(this.zIndex=e.zIndex),null!=e&&e.to){var r=null;(r="string"==typeof e.to?document.querySelector(e.to):e.to)?r.appendChild(this):console.warn("Popover config.to is not found:",e.to)}null!=e&&e.transition&&("string"==typeof(null==e?void 0:e.transition)?this.transition=null==e?void 0:e.transition:this.transition="bili-popover-transition");var o=(null==e?void 0:e.trigger)||"hover";null!=e&&e.delay?"number"==typeof e.delay?(this.showDelay=e.delay,this.hideDelay=e.delay):Array.isArray(e.delay)&&(this.showDelay=e.delay[0],this.hideDelay=e.delay[1]):"hover"===o&&(this.showDelay=100,this.hideDelay=200),"hover"===o?(this.disposables.addEventListener(n,"mouseenter",this.show.bind(this)),this.disposables.addEventListener(n,"mouseleave",this.hide.bind(this))):"click"===o&&this.disposables.addEventListener(n,"click",(function(){"block"!==i.style.display?i.show():i.hide()})),this.disposables.mutationObserve(n,(function(t){var e,r=l(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;if("childList"===o.type&&Array.from(o.removedNodes).includes(n)){i.parentElement&&i.parentElement.removeChild(i);break}}}catch(t){r.e(t)}finally{r.f()}}),{childList:!0})}else console.warn("reference is not found:",t)}},{key:"getTransitionTimingClass",value:function(t){return"".concat(this.transition,"-").concat(t)}},{key:"delay",value:function(t){return new Promise((function(e){return setTimeout(e,t)}))}},{key:"doTransition",value:function(t){var e=this;this.dispatchEvent(new CustomEvent(t?"before-enter":"before-leave"));var n=new Oo;return Dn(this,t?{base:[],enter:[],enterFrom:[this.getTransitionTimingClass("enter-from")],enterTo:[this.getTransitionTimingClass("enter-active")],leave:[],leaveFrom:[],leaveTo:[],entered:[]}:{base:[],enter:[],enterFrom:[],enterTo:[],leave:[],leaveFrom:[this.getTransitionTimingClass("leave-from")],leaveTo:[this.getTransitionTimingClass("leave-active")],entered:[]},t,(function(){e.dispatchEvent(new CustomEvent(t?"after-enter":"after-leave")),n.resolve(!0)})),this.deferred=n,n.promise}},{key:"showDeferred",value:(u=i(m().mark((function t(){var e;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.deferred)){t.next=12;break}if("showing"!==this.state&&"visible"!==this.state){t.next=4;break}return t.abrupt("return",(e.clear(),this.deferred=null,Promise.reject("popover is showing or visible")));case 4:if("hiding"!==this.state){t.next=11;break}return t.next=7,e.promise;case 7:return t.next=9,this.delay(0);case 9:t.next=12;break;case 11:e.clear();case 12:return e=this.deferred=new Oo(this.showDelay),t.next=15,e.promise;case 15:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"hideDeferred",value:(c=i(m().mark((function t(){var e;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.deferred)){t.next=10;break}if("hiding"!==this.state&&"hidden"!==this.state){t.next=4;break}return t.abrupt("return",(e.clear(),this.deferred=null,Promise.reject("popover is hiding or hidden")));case 4:if("showing"!==this.state){t.next=9;break}return t.next=7,e.promise;case 7:t.next=10;break;case 9:e.clear();case 10:return e=this.deferred=new Oo(this.hideDelay),t.next=13,e.promise;case 13:return t.abrupt("return",t.sent);case 14:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"toggle",value:function(t){if(this.popperInstance){var e="show"===t;Array.from(this.children).forEach((function(t){if(t instanceof HTMLElement){if(!e)return void t.style.removeProperty("display");t.style.setProperty("display","block","important")}})),e?(this.popperInstance.update(),this.style.setProperty("display","block","important"),this.style.setProperty("z-index",String(this.zIndex||jn()),"important")):this.style.removeProperty("display")}}},{key:"show",value:(a=i(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.popperInstance){t.next=17;break}return t.prev=1,t.next=4,this.showDeferred();case 4:t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(1),t.abrupt("return");case 9:if(this.state="showing",this.toggle("show"),t.t1=this.transition,!t.t1){t.next=15;break}return t.next=15,this.doTransition(!0);case 15:this.state="visible",this.deferred=null;case 17:case"end":return t.stop()}}),t,this,[[1,6]])}))),function(){return a.apply(this,arguments)})},{key:"hide",value:(n=i(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.popperInstance){t.next=17;break}return t.prev=1,t.next=4,this.hideDeferred();case 4:t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(1),t.abrupt("return");case 9:if(this.state="hiding",!this.transition){t.next=14;break}return t.next=12,this.doTransition(!1);case 12:t.next=16;break;case 14:if("block"===this.style.display){t.next=16;break}return t.abrupt("return");case 16:this.toggle("hide"),this.deferred=null;case 17:case"end":return t.stop()}}),t,this,[[1,6]])}))),function(){return n.apply(this,arguments)})},{key:"connectedCallback",value:function(){var t=this.getAttribute("reference");if(t){var e=this.getAttribute("placement"),n=this.getAttribute("trigger"),i=this.getAttribute("z-index"),r=this.getAttribute("transition"),o=this.getAttribute("delay"),a=this.getAttribute("to"),s={};if(e&&(s.placement=e),n&&["hover","click"].includes(n)?s.trigger=n:s.trigger="hover",i&&(s.zIndex=Number(i)),r&&(["1","true"].includes(r)?s.transition=!0:s.transition=r),a&&(s.to=a),o){var l=o.split(",");2===l.length?s.delay=[Number(l[0]),Number(l[1])]:s.delay=Number(l[0])}this.setup(t,s)}}},{key:"disconnectedCallback",value:function(){this.disposables.dispose(),this.popperInstance&&(this.popperInstance.destroy(),this.popperInstance=void 0),this.reference=null}}]);var n,a,c,u}(A(HTMLElement));customElements.get("bili-popover")||customElements.define("bili-popover",Po);var Io=function(t){function e(){var t;return o(this,e),(t=r(this,e)).disposables=On(),t.state={label:"",value:"",name:"",disabled:!1,checked:!1},t.attachShadow({mode:"open"}),t.shadowRoot&&(t.shadowRoot.innerHTML='\n        <style>\n          :host {\n            --bili-radio-size: 16px;\n            --bili-radio-font-size: 14px;\n            --bili-radio-border-width: 1px;\n            --bili-radio-checked-color: var(--brand_blue);\n            --bili-radio-margin-inline-end: 8px;\n\n            display: inline-flex;\n            align-items: baseline;\n            padding: 0;\n            margin: 0;\n            cursor: pointer;\n            margin-inline-end: var(--bili-radio-margin-inline-end);\n          }\n          #input {\n            box-sizing: border-box;\n            margin: 0;\n            padding: 0;\n            list-style: none;\n            position: relative;\n            display: inline-block;\n            outline: none;\n            cursor: pointer;\n            align-self: center;\n            border-radius: 50%;\n            width: var(--bili-radio-size);\n            height: var(--bili-radio-size);\n          }\n          #input input {\n            bottom: 0;\n            left: 0;\n            margin: 0;\n            opacity: 0;\n            outline: none;\n            position: absolute;\n            right: 0;\n            top: 0;\n            z-index: -1;\n          }\n          #input #inner {\n            display: block;\n            background-color: var(--bg1_float);\n            border: 1px solid var(--text4);\n            border-radius: 50%;\n            box-sizing: border-box;\n            width: 100%;\n            height: 100%;\n          }\n          #input[checked] #inner {\n            border-color: var(--bili-radio-checked-color);\n          }\n          #input[checked] #inner::after {\n            transform: translate(-50%,-50%) scale(1);\n          }\n          #input #inner::after {\n            width: 50%;\n            height: 50%;\n            background-color: var(--bili-radio-checked-color);\n            border-radius: 50%;\n            content: "";\n            left: 50%;\n            position: absolute;\n            top: 50%;\n            transform: translate(-50%,-50%) scale(0);\n            transition: transform .15s ease-in;\n          }\n          #label {\n            margin-left: 8px;\n            font-size: var(--bili-radio-font-size);\n            color: var(--text2);\n          }\n        </style>\n        <span id="input">\n          <input type="radio">\n          <span id="inner"></span>\n        </span>\n        <slot>\n          <span id="label"></span>\n        </slot>\n      '),t}return p(e,t),s(e,[{key:"connectedCallback",value:function(){var t=this;if(this.shadowRoot){var n=this.getAttribute("label");if(e.observedAttributes.forEach((function(e){var i=t.getAttribute(e);null!==i&&("value"===e&&!n&&t.updateAttribute("label",i),t.updateAttribute(e,i))})),this.shadowRoot&&this.disposables.addEventListener(this,"click",(function(){if(!t.state.disabled&&!t.state.checked)if(t.updateInput("checked",!0),t.state.name){var e={name:t.state.name,value:t.state.value},n=new CustomEvent("bili-radio-change",{detail:e});document.dispatchEvent(n)}else{var i=new CustomEvent("change",{detail:{value:t.state.value}});t.dispatchEvent(i)}})),this.state.name){var i=function(e){var n=e.detail;n&&n.name===t.state.name&&n.value!==t.state.value&&t.updateInput("checked",!1)};document.addEventListener("bili-radio-change",i),this.disposables.add((function(){document.removeEventListener("bili-radio-change",i)}))}}}},{key:"disconnectedCallback",value:function(){this.disposables.dispose()}},{key:"updateInput",value:function(t,e){var n,i,r=null==(n=this.shadowRoot)?void 0:n.querySelector("#input"),o=null==(i=this.shadowRoot)?void 0:i.querySelector("input");if(r&&o)switch(t){case"value":o.setAttribute(t,e);break;case"disabled":case"checked":e?(r.setAttribute(t,""),o.setAttribute(t,"")):(r.removeAttribute(t),o.removeAttribute(t))}}},{key:"updateLabel",value:function(t){var e,n=null==(e=this.shadowRoot)?void 0:e.querySelector("#label");n&&(n.textContent=t)}},{key:"updateAttribute",value:function(t,e){switch(t){case"name":this.state.name=e;break;case"label":this.updateLabel(e),this.state.label=e;break;case"value":this.updateInput(t,e),this.state[t]=e;break;case"disabled":case"checked":this.updateInput(t,"true"===e),this.state[t]="true"===e}}},{key:"attributeChangedCallback",value:function(t,e,n){this.updateAttribute(t,n)}}],[{key:"observedAttributes",get:function(){return["name","value","label","disabled","checked"]}}])}(A(HTMLElement));Io.elName="bili-radio";var Ro=Io;customElements.get(Ro.elName)||customElements.define(Ro.elName,Ro);var jo=function(){function t(){o(this,t),this.disposables=[]}return s(t,[{key:"addEventListener",value:function(t,e,n,i){return this.add(function(t,e,n,i){return t.addEventListener(e,n,i),function(){!function(t,e,n,i){t.removeEventListener(e,n,i)}(t,e,n,i)}}(t,e,n,i))}},{key:"mutationObserve",value:function(t,e,n){var i=!1,r=new MutationObserver(e);return r.observe(t,n),function(){return function(t){i||(i=!0,t.disconnect())}(r)}}},{key:"requestAnimationFrame",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=requestAnimationFrame.apply(void 0,arguments);return this.add((function(){return cancelAnimationFrame(t)}))}))},{key:"nextFrame",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.requestAnimationFrame((function(){return t.requestAnimationFrame.apply(t,n)}))}},{key:"setTimeout",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=setTimeout.apply(void 0,arguments);return this.add((function(){return clearTimeout(t)}))}))},{key:"microTask",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i={current:!0};return function(t){"function"==typeof queueMicrotask?queueMicrotask(t):Promise.resolve().then(t).catch((function(t){return setTimeout((function(){throw t}))}))}((function(){i.current&&e[0]()})),this.add((function(){i.current=!1}))}},{key:"style",value:function(t,e,n){var i=t.style.getPropertyValue(e);return Object.assign(t.style,c({},e,n)),this.add((function(){Object.assign(t.style,c({},e,i))}))}},{key:"group",value:function(e){var n=new t;return e(n),this.add((function(){return n.dispose()}))}},{key:"add",value:function(t){var e=this;return this.disposables.push(t),function(){var n=e.disposables.indexOf(t);n>=0&&e.remove(n,1)}}},{key:"remove",value:function(t,e){var n,i=l(this.disposables.splice(t,null!=e?e:this.disposables.length));try{for(i.s();!(n=i.n()).done;){(0,n.value)()}}catch(t){i.e(t)}finally{i.f()}}},{key:"dispose",value:function(){this.remove(0)}}])}();("undefined"==typeof window?"undefined":k(window))<"u"&&(window.__BILI_POPPER_ZINDEX__||(window.__BILI_POPPER_ZINDEX__=1e3));var Lo,Mo,Do,No,Bo,zo,Uo,Fo,Vo,Ho,Wo,$o,qo,Go=function(t){function e(){var t;return o(this,e),(t=r(this,e)).disposables=new jo,t.attachShadow({mode:"open"}),t.shadowRoot&&(t.shadowRoot.innerHTML='\n        <style>\n          :host {\n            --bili-rich-text-display: block;\n            --bili-rich-text-white-space: pre-line;\n            --bili-rich-text-word-break: break-word;\n            --bili-rich-text-icon-vertical-align: sub;\n            --bili-rich-text-link-color: var(--text_link, #008AC5);\n            --bili-rich-text-link-color-hover: var(--brand_blue, #00AEEC);\n            --icon-vertical-align: var(--bili-rich-text-icon-vertical-align);\n            color: var(--bili-rich-text-color, var(--text1, #18191C));\n            font-size: var(--bili-rich-text-font-size, 15px);\n            line-height: var(--bili-rich-text-line-height, 21px);\n            font-family: var(--bili-font-family);\n          }\n          #contents {\n            margin-block-start: 0;\n            margin-block-end: 0;\n            margin-inline-start: 0;\n            margin-inline-end: 0;\n            display: var(--bili-rich-text-display);\n            white-space: var(--bili-rich-text-white-space);\n            word-break: var(--bili-rich-text-word-break);\n            -webkit-font-smoothing: antialiased;\n          }\n          #contents a {\n            color: var(--bili-rich-text-link-color);\n            text-decoration: none;\n            background-color: transparent;\n            cursor: pointer;\n          }\n\n          #contents a:hover {\n            color: var(--bili-rich-text-link-color-hover);\n          }\n          \n          #contents a bili-icon {\n            vertical-align: var(--bili-rich-text-icon-vertical-align);\n          }\n          #contents img, #contents a i {\n            display: inline-block;\n            width: 1.2em;\n            height: 1.2em;\n            vertical-align: var(--bili-rich-text-icon-vertical-align);\n          }\n        </style>\n        <p id="contents"></p>\n      '),t}return p(e,t),s(e,[{key:"contentsElement",get:function(){return this.shadowRoot.querySelector("#contents")}},{key:"connectedCallback",value:function(){var t=this;this.disposables.addEventListener(this.contentsElement,"click",(function(e){var n=v({},e.target.dataset);0!==Object.keys(n).length&&t.dispatchEvent(new CustomEvent("text-click",{detail:n}))}))}},{key:"disconnectedCallback",value:function(){this.disposables.dispose()}},{key:"contents",get:function(){return this.shadowRoot.querySelector("#contents")}},{key:"styleMap",value:function(t){return t?Object.keys(t).reduce((function(e,n){return t[n]?e+"".concat(n,":").concat(t[n],";"):e}),""):""}},{key:"renderToString",value:function(t,e,n){var i="";return e&&(i=Object.keys(e||{}).reduce((function(t,n){return e[n]?t+" ".concat(n,'="').concat(e[n],'"'):t}),"")),"<".concat(t).concat(i).concat("img"===t?"/>":">".concat(n||"","</").concat(t,">"))}},{key:"setContents",value:function(t){var e=this,n=t.map((function(t){var n=v({style:e.styleMap(t.style)},t[t.tag]||{}),i=t.dataset;if(i){Object.assign(n,Object.keys(i).reduce((function(t,e){var n=i[e];return n&&(t["data-".concat(e)]=n),t}),{}))}var r="";return t.html?e.renderToString(t.tag,n,t.html):(n.text&&(n.icon&&(/^(https?:)?\/\//.test(n.icon)?r+=e.renderToString("img",{src:n.icon,loading:"lazy",style:"width:var(--icon-width);height:var(--icon-height);vertical-align:var(--icon-vertical-align);"}):r+=e.renderToString("i",{class:"holder "+n.icon}),delete n.icon),r+=n.text,delete n.text),e.renderToString(t.tag,n,r))})).join("");this.contents.innerHTML=n,setTimeout((function(){var t=Array.from(e.contents.getElementsByTagName("i"));if(t.length){var n=t[0].getBoundingClientRect().width.toString();t.forEach((function(t){var e=document.createElement("bili-icon");e.setAttribute("size",n),e.setAttribute("icon",t.classList[1]),t.parentElement.replaceChild(e,t)}))}}),0)}}])}(A(HTMLElement));Go.elName="bili-rich-text",customElements.get(Go.elName)||customElements.define(Go.elName,Go);var Xo=function(t){("undefined"==typeof window?"undefined":k(window))>"u"||window.__BILI_X_ENGINE_SCRIPT_CACHE__&&k(window.__BILI_X_ENGINE_SCRIPT_CACHE__[t])<"u"&&delete window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]},Yo=function(t,e){if(("undefined"==typeof window?"undefined":k(window))>"u")return Promise.reject(new Error("window is not defined"));var n=t=t.replace(/^https?:\/\//,"//"),i=function(t){return("undefined"==typeof window?"undefined":k(window))>"u"||!window.__BILI_X_ENGINE_SCRIPT_CACHE__?null:window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]||null}(n);if(null!=i&&i.promise)return i.promise;var r=new Promise((function(n,i){var r=document.createElement("script");r.src=t,null!=e&&e.behavior&&r.setAttribute(e.behavior,""),r.onload=function(){var r=window;if(e.lib)return r[e.lib]?n(r[e.lib]):i(new Error('Failed to access library "'+e.lib+'" from '+t));n(null)},r.onerror=function(){i(new Error("Failed to load "+t)),document.head.removeChild(r)},document.head.appendChild(r)}));return function(t,e){("undefined"==typeof window?"undefined":k(window))>"u"||(window.__BILI_X_ENGINE_SCRIPT_CACHE__||(window.__BILI_X_ENGINE_SCRIPT_CACHE__={}),window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]=e)}(n,{promise:r,lib:null==e?void 0:e.lib}),r.then((function(){!1===(null==e?void 0:e.cache)&&Xo(n)})).catch((function(){!1===(null==e?void 0:e.cache)&&Xo(n)})),r},Zo=function(){try{var t=function(){return Promise.resolve(window.__BiliUser__.get())},e=function(){if(!window.__BiliUser__)return Promise.resolve(function(){try{return Promise.resolve(Yo("//s1.hdslb.com/bfs/seed/jinkela/short/bili-user/index.js",{lib:"__BiliUser__"}))}catch(t){return Promise.reject(t)}}()).then((function(){}))}();return Promise.resolve(e&&e.then?e.then(t):t())}catch(t){return Promise.reject(t)}},Qo="",Ko=function(){return Qo||(Qo=function(t){if(("undefined"==typeof window?"undefined":k(window))>"u")return"";var e=document.querySelector('meta[name="'+t+'"]');return null!=e&&e.content?e.content:""}("spm_prefix"),Qo||"0.0")},Jo=function(t){try{return window.Unios?Promise.resolve(window.Unios.request(t)):Promise.resolve(function(t){if(window.Unios)return Promise.resolve(window.Unios);var e=window.__LOAD_REQUEST_TYPE__||t||"web";return Yo("//s1.hdslb.com/bfs/seed/jinkela/short/unios/"+e+".min.js",{lib:"Unios"})}()).then((function(){return window.Unios.request(t)}))}catch(t){return Promise.reject(t)}},ta=function(t,e,n){try{return window.BToast?Promise.resolve(window.BToast.show(t,e,n)):Promise.resolve(function(){try{return window.BToast?Promise.resolve(window.BToast):Promise.resolve(Yo("//s1.hdslb.com/bfs/seed/jinkela/short/webui/toast/index.js",{lib:"BToast"}))}catch(t){return Promise.reject(t)}}()).then((function(){return window.BToast.show(t,e,n)}))}catch(t){return Promise.reject(t)}};function ea(t){return new Promise((function(e,n){Jo({url:"//api.bilibili.com/x/web-interface/card",params:{mid:t,photo:"true"}}).then((function(t){if(0!==t.code||!t.data)return n(new Error(t.message||"get card data error"));e(t.data)})).catch(n)}))}var na="";function ia(){var t;return na||(na=(null==(t=document.querySelector("meta[name=spm_prefix]"))?void 0:t.getAttribute("content"))||"")}function ra(t){return new Promise((function(e,n){Jo({url:"//api.bilibili.com/x/relation/modify",method:"POST",data:{act:t.act,fid:t.fid,spmid:t.spmid||ia(),from_spmid:t.fromSpmid||"",re_src:0},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){if(0!==t.code)return n(new Error(t.message||"modify relation error"));e(t)})).catch(n)}))}function oa(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var aa="to top right";function sa(t,e){return"linear-gradient(".concat(t,",").concat(e,")")}function la(t,e){var n=(e=e||{}).theme||"",i=e.stringType||!1,r="",o="";if(function(t){return!(!t||"object"!=k(t)||k(t.render_scheme)>"u"||!t.colors_info||!t.colors_info.color||!Array.isArray(t.colors_info.color))}(t)){var a=t.render_scheme,s=t.colors_info.color;if(1!==a&&"Colorful"!==a||!s||0===s.length)return null;var l=function(t){var e=t.length,n=[],i=[],r=function(t,n){return"".concat(function(t){return"#"===t[0]?t:"#".concat(t)}(t)," ").concat(n/(e-1)*100,"%")};return t.forEach((function(t,e){n.push(r(t.color_day,e)),i.push(r(t.color_night,e))})),{light:sa(aa,n.join(",")),dark:sa(aa,i.join(","))}}(s);r=l.light,o=l.dark}if(r&&o){var c,u={base:{"background-clip":"text","-webkit-background-clip":"text","-webkit-text-fill-color":"transparent"},theme:{light:{"background-image":r},dark:{"background-image":o}}};if(["light","dark"].includes(n)){var d=Object.assign({},u.base,u.theme[n]);return i?function(t){var e=Object.keys(t);if(0===e.length)return"";var n="";return e.forEach((function(e){void 0!==t[e]&&(n+="".concat(e,":").concat(t[e],";"))})),n}(d):d}if(e.variable&&"string"==typeof e.variable&&/^--[a-z]/.test(e.variable))u.variable=(oa(c={},"".concat(e.variable,"-light"),r),oa(c,"".concat(e.variable,"-dark"),o),c);return u}return null}var ca=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.PAGE=1]="PAGE",t[t.IFRAME=2]="IFRAME",t[t.SITE=3]="SITE",t}({}),ua=!1;function da(t){return da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},da(t)}function pa(t){var e=function(t,e){if("object"!=da(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=da(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==da(e)?e:e+""}function ha(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,pa(i.key),i)}}function fa(t,e,n){return(e=pa(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var va=function(){function t(e){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),fa(this,"all",new Map),fa(this,"weakMap",new WeakMap),fa(this,"defaultEventTarget",void 0),e?e instanceof Element||e instanceof Document?this.defaultEventTarget=e:this.defaultEventTarget=document.querySelector(e)||document:this.defaultEventTarget=document,this.all.clear=function(){n.all.forEach((function(t,e){t.forEach((function(t){n.off(e,t)}))})),n.all.clear()}}return function(t,e,n){e&&ha(t.prototype,e),n&&ha(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"on",value:function(t,e,n){this.all.has(t)||this.all.set(t,[]),this.weakMap.has(e)||this.weakMap.set(e,[]);var i=(n||this.defaultEventTarget).addEventListener,r=function(n){e({sourceType:ca.PAGE,customEvent:n,event:t,payload:n.detail,samePage:!0,emitter:i})};this.all.get(t).push(e),this.weakMap.get(e).push(r),i(t,r)}},{key:"off",value:function(t,e,n){var i,r=this,o=(n||this.defaultEventTarget).removeEventListener;if(!e)return null===(i=this.all.get(t))||void 0===i||i.forEach((function(e){r.weakMap.get(e).forEach((function(e){o(t,e)}))})),void this.all.delete(t);this.weakMap.get(e).forEach((function(e){o(t,e)}))}},{key:"emit",value:function(t,e,n){var i=new CustomEvent(t,{detail:e}),r=(n||this.defaultEventTarget).dispatchEvent;r(i),r(new CustomEvent("*",{detail:e}))}}]),t}(),ma=function(){var t=null;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return!1===ua&&(ua=("undefined"==typeof window?"undefined":k(window))<"u"),ua?t||(t=new va(e)):(console.error("useEvent must be used in the browser environment"),null)}}(),ba=function(t){return t[t.DEFAULT=-1]="DEFAULT",t[t.NOT_FOLLOW=0]="NOT_FOLLOW",t[t.QUIET=1]="QUIET",t[t.ONE_WAY=2]="ONE_WAY",t[t.TWO_WAY=6]="TWO_WAY",t[t.BLOCK=128]="BLOCK",t}(ba||{}),ya=function(t){return t.OPEN_BOOKMARK="follow.openBookmark",t.TRIGGER_SETTING_BOOKMARK="follow.triggerSettingBookmark",t.TRIGGER_DELETE_BOOKMARK="follow.triggerDeleteBookmark",t.TRIGGER_REMOVE_FANS="follow.triggerRemoveFans",t.CREATED_USER_BOOKMARK="follow.createdUserBookmark",t.SET_USER_BOOKMARK="follow.setUserBookmark",t.REMOVED_USER_FANS="follow.removedUserFans",t.CHANGED_USER_RELATION="follow.changedUserRelation",t}(ya||{}),ga=Object.defineProperty,wa=Object.getOwnPropertyDescriptor,xa=function(t,e,n,i){for(var r,o=i>1?void 0:i?wa(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&ga(e,n,o),o},ka=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=Math.max(0,e),"number"!=typeof t&&(t=Number(t)),isNaN(t)?0:t>1e8?(t/1e8).toFixed(e)+"亿":t>1e4?(t/1e4).toFixed(e)+"万":t},_a=function(t){return"".concat("data-user-profile","-").concat(t)},Aa=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).event=ma(),t.userData=null,t.uid="",t.data=null,t.showSpinner=!1,t.isFollowing=!1,t.spmid=null,t.fromSpmid="",t.disposables=On(),t.cacheData={},t.showTimer=null,t.hideTimer=null,t.lastShowEl=null,t}return p(e,t),s(e,[{key:"backgroundImage",get:function(){var t;return ki.getBmgSrcNext((null==(t=this.data)?void 0:t.space.l_img)||"",{w:366,h:85,c:!0,dpr:2})}},{key:"faceSrc",get:function(){var t;return ki.getBmgSrcNext((null==(t=this.data)?void 0:t.card.face)||"//i0.hdslb.com/bfs/face/member/noface.jpg",{w:48,h:48,dpr:2})}},{key:"ovType",get:function(){var t,e,n,i;return null!==(t=null==(i=null==(n=null==(e=this.data)?void 0:e.card)?void 0:n.Official)?void 0:i.type)&&void 0!==t?t:-1}},{key:"ovText",get:function(){var t;return this.ovType>-1?"bilibili".concat(1===this.ovType?"机构":"个人","认证：").concat(null==(t=this.data)?void 0:t.card.Official.title):""}},{key:"name",get:function(){var t;return this.data?null==(t=this.data)?void 0:t.card.name:""}},{key:"nameRenderStyle",get:function(){var t,e,n;if(null==(e=null==(t=this.data)?void 0:t.card)||!e.name_render)return"";var i=la(null==(n=this.data)?void 0:n.card.name_render,{variable:"--name-render-bg"});return null!=i&&i.variable?i.variable:null}},{key:"nameStyle",get:function(){var t;if(null==(t=this.data)||!t.card)return null;if(this.nameRenderStyle)return this.nameRenderStyle;var e="",n=this.data.card.vip;return 1===n.status&&n.nickname_color&&(e=n.nickname_color),e?{color:e}:null}},{key:"gender",get:function(){var t="";return this.data&&["男","女"].includes(this.data.card.sex)&&(t="男"===this.data.card.sex?"male":"female"),t}},{key:"genderImg",get:function(){return ki.getBmgSrcNext("//i0.hdslb.com/bfs/seed/jinkela/short/webui/user-profile/img/gender_".concat(this.gender,".png"),{dpr:2})}},{key:"level",get:function(){var t={img:"",url:"//www.bilibili.com/html/help.html#k_5"};if(!this.data)return t;var e=this.data.card,n=e.is_senior_member,i=e.level_info.current_level;return t.img=Aa.getLevelImgSrc(i,!!n),t}},{key:"vipLabel",get:function(){var t,e,n=((null==(t=this.data)?void 0:t.card)||{}).vip;return n&&null!=(e=n.label)&&e.text?{img:n.label.img_label_uri_hans_static||"",text:n.label.text,style:{backgroundColor:n.label.bg_color,color:n.label.text_color}}:null}},{key:"stats",get:function(){var t,e,n,i,r;return[{key:"follow",count:String(ka((null==(e=null==(t=this.data)?void 0:t.card)?void 0:e.attention)||0)),url:this.getSpaceLink("follow"),label:"关注"},{key:"fans",count:String(ka((null==(i=null==(n=this.data)?void 0:n.card)?void 0:i.fans)||0)),url:this.getSpaceLink("fans"),label:"粉丝"},{key:"like",count:String(ka((null==(r=this.data)?void 0:r.like_num)||0)),label:"获赞"}]}},{key:"signText",get:function(){var t;return null==(t=this.data)?void 0:t.card.sign}},{key:"appendToParent",value:function(t){var e=document.body;if(t){var n=document.querySelector(t);n&&(e=n)}e.appendChild(this)}},{key:"setup",value:function(t){var e=this.disposables.addEventListener(t,"mouseenter",this.refMouseEnter.bind(this)),n=this.disposables.addEventListener(t,"mouseleave",this.refMouseLeave.bind(this));return function(){e(),n()}}},{key:"setPosition",value:function(t){var e=window.innerWidth,n=t.getBoundingClientRect(),i=n.width,r=n.bottom,o=n.left,a=n.top,s=o+i/2;e-s<366&&(s-=366),this.style.left="".concat(s,"px"),a>290?(this.style.top="",this.style.bottom="".concat(window.innerHeight-a,"px")):(this.style.bottom="",this.style.top="".concat(r,"px")),this.style.zIndex="".concat(jn())}},{key:"clearTimer",value:function(t){"show"!==t?this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null):this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null)}},{key:"refMouseEnter",value:function(t){var e=this,n=t.target;if(this.clearTimer("hide"),this.showTimer){if(this.lastShowEl===n)return;this.clearTimer("show")}this.lastShowEl=n,this.showTimer=window.setTimeout((function(){e.showTimer=null,e.show(n)}),300)}},{key:"hide",value:function(){var t=this;this.hideTimer=window.setTimeout((function(){t.visible(!1),t.lastShowEl=null,t.hideTimer=null}),300)}},{key:"refMouseLeave",value:function(t){t.target===this.lastShowEl&&(this.clearTimer("show"),this.hide())}},{key:"visible",value:function(t){this.style.display=t?"block":""}},{key:"show",value:(a=i(m().mark((function t(e){var n,i,r,o,a;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.parentElement||this.appendToParent(e.getAttribute(_a("parent"))||""),i=e.getAttribute(_a("id"))){t.next=5;break}return this.uid="",t.abrupt("return");case 5:if((r=e.getAttribute(_a("spmid-follow")))&&(this.spmid={follow:"".concat(Ko(),".").concat(r)}),this.uid=i,this.setPosition(e),this.visible(!0),t.prev=7,!(o=this.cacheData[i])){t.next=13;break}this.data=o,t.next=18;break;case 13:return this.showSpinner=!0,t.next=16,ea(i);case 16:a=t.sent,this.cacheData[i]=a,this.data=a;case 18:this.isFollowing=(null==(n=this.data)?void 0:n.following)||!1,t.next=24;break;case 21:t.prev=21,t.t0=t.catch(7),console.warn(t.t0.message);case 24:this.showSpinner=!1;case 25:case"end":return t.stop()}}),t,this,[[7,21]])}))),function(t){return a.apply(this,arguments)})},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),Zo().then((function(e){t.userData=e.data||null})),this.disposables.addEventListener(this,"mouseenter",(function(){t.clearTimer("hide")})),this.disposables.addEventListener(this,"mouseleave",(function(){t.hide()})),this.event.on(ya.CHANGED_USER_RELATION,(function(e){var n,i;if(e.payload){var r=e.payload,o=r.mineId,a=r.targetId,s=r.attribute;if(!o||null==(n=t.userData)||!n.mid||String(o)===String(t.userData.mid)){var l=[ba.ONE_WAY,ba.TWO_WAY,ba.QUIET].includes(s);t.uid===String(a)&&(t.isFollowing=l),(null==(i=t.data)?void 0:i.card.mid)===String(a)&&(t.data.following=l),t.cacheData[a]&&(t.cacheData[a].following=l)}}})),this.disposables.add((function(){t.event.off(ya.CHANGED_USER_RELATION)}));var n=/(?:\?|&)spm_id_from=([^&]+)/.exec(location.search),i=n?n[1]:null;i&&(this.fromSpmid=i)}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose(),this.cacheData={},this.lastShowEl=null,this.userData=null,this.spmid=null,this.fromSpmid=""}},{key:"handleJumpMsg",value:function(){window.open("https://message.bilibili.com/#/whisper/mid".concat(this.uid))}},{key:"getSpaceLink",value:function(t){if(!this.data)return"";var e="//space.bilibili.com/".concat(this.uid);switch(t){case"follow":return"".concat(e,"/fans/follow");case"fans":return"".concat(e,"/fans/fans");default:return e}}},{key:"handleFollow",value:(n=i(m().mark((function t(){var e;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ra({fid:this.uid,act:this.isFollowing?2:1,spmid:this.spmid?this.spmid.follow:"",fromSpmid:this.fromSpmid});case 3:this.isFollowing=!this.isFollowing,this.data&&(this.data.following=this.isFollowing),this.event.emit(ya.CHANGED_USER_RELATION,{mineId:(null==(e=this.userData)?void 0:e.mid)||"",targetId:this.uid,attribute:this.isFollowing?ba.ONE_WAY:ba.NOT_FOLLOW,preAttribute:this.isFollowing?ba.NOT_FOLLOW:ba.ONE_WAY}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),ta(t.t0.message||"操作失败，请稍后再试");case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return n.apply(this,arguments)})},{key:"ovIconTemplate",value:function(){return qe(Lo||(Lo=g(['<i id="ov-icon" class="ov-','"></i>'])),this.ovType)}},{key:"ovTemplate",value:function(){return qe(Mo||(Mo=g(['<div id="ov">\n      ',"\n      <span>","</span>\n    </div>"])),this.ovIconTemplate(),this.ovText)}},{key:"vipLabelTemplate",value:function(){return this.vipLabel?this.vipLabel.img?qe(Do||(Do=g(['<div id="vip"><img src="','" /></div>'])),this.vipLabel.img):qe(No||(No=g(['<div id="vip">\n      <label style="','"><span>',"</span></label>\n    </div>"])),Gn(this.vipLabel.style),this.vipLabel.text):""}},{key:"viewTemplate",value:function(){return qe(Bo||(Bo=g(['\n      <div id="view">\n        <div\n          id="bg"\n          style="','"\n        ></div>\n        <a href="','" target="_blank" id="avatar">\n          <img id="face" src="','" />\n          ','\n        </a>\n        <div id="body">\n          <div id="title">\n            <a id="name" class="','" style="','"\n              >',"</a\n            >\n            ","\n            ","\n            ",'\n          </div>\n          <div id="content">\n            <div id="stats">\n              ',"\n            </div>\n            ",'\n            <div id="sign">','</div>\n          </div>\n          <div id="action">\n            <button id="follow" class="','" @click=','>\n              <bili-icon icon="BDC/plus_add_line/2" size="16"></bili-icon>\n              <span>','</span>\n            </button>\n            <button id="chat" @click=',">发消息</button>\n          </div>\n        </div>\n      </div>\n    "])),Gn({backgroundImage:"url(".concat(this.backgroundImage,")")}),this.getSpaceLink(""),this.faceSrc,this.ovType>-1?this.ovIconTemplate():"",this.nameRenderStyle?"render-style":"",this.nameStyle?Gn(this.nameStyle):"",this.name,this.gender?qe(zo||(zo=g(['<div id="gender"><img width="16" height="16" src="','" /></div>'])),this.genderImg):"",this.level.img?qe(Uo||(Uo=g(['<a id="level" href="','" target="_blank"><img src="','" /></a>'])),this.level.url,this.level.img):"",this.vipLabelTemplate(),this.stats.map((function(t){return t.url?qe(Fo||(Fo=g(['<a id="','" href="','" target="_blank"><span>',"</span>","</a>"])),t.key,t.url,t.count,t.label):qe(Vo||(Vo=g(['<a id="','"><span>',"</span>","</a>"])),t.key,t.count,t.label)})),this.ovType>-1?this.ovTemplate():"",this.signText,this.isFollowing?"active":"",this.handleFollow,this.isFollowing?"已关注":"关注",this.handleJumpMsg)}},{key:"spinnerTemplate",value:function(){return qe(Ho||(Ho=g(['<div id="spinner">正在加载中...请稍候</div>'])))}},{key:"fallbackTemplate",value:function(){return qe(Wo||(Wo=g(['<div id="fallback">加载出错，请稍后再试</div>'])))}},{key:"render",value:function(){return qe($o||($o=g(['<div id="wrap">\n      ',"\n    </div>"])),this.showSpinner?this.spinnerTemplate():this.data?this.viewTemplate():this.fallbackTemplate())}}],[{key:"getLevelImgSrc",value:function(t,e){return"//i0.hdslb.com/bfs/seed/jinkela/short/webui/user-profile/img/level_".concat(e?"h":t,".svg")}}]);var n,a}(fn);Aa.styles=ve(qo||(qo=g(["\n    :host {\n      width: ","px;\n      display: none;\n      position: fixed;\n    }\n\n    #wrap {\n      background-color: var(--bg1_float);\n      border-radius: 8px;\n      box-shadow: 0 0 30px 2px rgba(0, 0, 0, 0.1);\n      color: var(--text3);\n      font-size: 12px;\n      width: 100%;\n      font-family: var(--bili-font-family);\n      -webkit-font-smoothing: antialiased;\n    }\n    #spinner {\n      padding: 12px;\n    }\n\n    #bg {\n      background-position: 50%;\n      background-repeat: no-repeat;\n      background-size: cover;\n      border-radius: 8px 8px 0 0;\n      height: ","px;\n      left: 0;\n      overflow: hidden;\n      position: absolute;\n      top: 0;\n      width: 366px;\n    }\n\n    #avatar {\n      border-radius: 50%;\n      height: 48px;\n      left: 10px;\n      position: absolute;\n      top: 95px;\n      width: 48px;\n    }\n\n    #avatar #face {\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n    }\n    #avatar #ov-icon {\n      background-color: var(--text_white);\n      background-position: 50%;\n      background-repeat: no-repeat;\n      background-size: cover;\n      border-radius: 50%;\n      height: 14px;\n      position: absolute;\n      right: 0;\n      top: 34px;\n      width: 14px;\n    }\n    #ov-icon.ov-0 {\n      background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAASZSURBVHgBxVptThNBGJ5Wo4FAgjGBSCSuMZHon5Z4AMoN4ATACVpOwHIC6gkoJ6A3KJygNDH+8Icu0YhUCU0wEAxmfZ/d2XZnZ/ZzpvVJhk1nttPn/ZyZdygxA3Bdd44e69Sq1F7w5xxvARzeetS61E5KpZLD/hdAmtoutY5bHF1qm9QsNimEiF+5ZnEwdkHGRDyK3TycSlle4po5Yr5vq3F9zNhtjz9PGbsfMPZ34I89oFB4TFM8ojZFU8yuUquxBDjU1rLESKoARH6THk0mBqQPkPz5nrGL5ohsVkAYCPFs1xdOBibcJiHaSdMkCsDNaUsDIP5jzyduAk+3kgSxSYi9uK/GChBLvk8a/27n13gaYJFFm4TZVI3GCqEUgMgjpx9JA992zGk9DvMNxpb2VSNbJMRhtFMSgAcsFpqRz8NlPm/4AToJTFOgv+74wT8CTL4SDWyVAF/oYQmdH1f8zDJJIMAhhIhTEmAl3FEOf+B+bwlfgdtMmjwAa3/difZWiaMd7hgKwF1HGGSXLTM+jwzzzo0L0Hj0m37SEFF3/b2Xh7AFbOG1O4eyTWz2yg6QR3YpCjnjgXwj+OAJwLUvquecvvjHYVqIkr/psdwAeVmRQysEFqgJw9D+5SHTQpQ8iBSNpX4z1gqBAHXhC9C+DubrsttcnzAtXEixsIo/Ze4+VWM/hkBdUgS+7hrSl+aswY1ggZr0Q0V9H+StlnpMNxXDhWQlrEMAM9pPIg/cGFhL5CRQhQAVoeu2y3IjC3kTm7/fx9EeCwJYQtfdGcuFNPKAqZVctmKlhDOc0HX6JLu2cLp6m8FimO9+kDx+tp3uZtjcVa/CPYOHysmyAOSXO9nexQ+LO8tikLnNlVkR4PCx3DFDCsii/RhAAFGsLKRw9Ls3EJQAyP9qZXtXwQ0uBCZzwktpboR8/OFl8jsI7LTdZx7yACwvwoEFRNtNV5gRpM2TlzwgH/o9AcS8ObPGtAErTlXjx3FIyksekOfsjccCSeTPNcoxs6vRni4EaIsv1fSzy3SMACCPA0oRBIUwESdlOiQjYo+F7vkG04KsKT3y3py1aA8O+E6wDog7uIU600LUArrkgUWp5uv5YTn0YZQ74UJFrQBTh9OdCfIoPcop1FO6JwB3I/HIA4mLxEJY+ybIeyVHSfutoMAV3krIVljMVar3ESyCJsgDOJrK2h+e8oXKHC8aiaxRXOoXTHu6wNlaPp7ukfbt4IOqtIj9sRiFn9YmVxcNoN6qO0Re2MOodqNUxY1s8F4dxef2cWCmptqqg5O0TZAE4MEhFiURD2+6+utDFsBt1Fv1bdWVk/I8QC+2WChQhkDd3jpQBZU+QPj5vrok4/t9WzWQdsVks2hQAyi7IMPoVu8CBIUwddoWgjaKLJd86/QgtSsu+QJBUIrJW0vyFksivtCIIw6f3+HeEIs816yIKiv2JWQpCIIKBGqrECh8zYqGRIA9zVQl7ZoVO+QN4/+KAJdyx4ur6AWGccAa1FquWXjE3dDFxdjBBdly/X/YKIqOLvFMMZBFGOYXibHa4UhnMTFeBrzBt8/4s803kVr4B9ZWrx2gQRFMAAAAAElFTkSuQmCC);\n    }\n    #ov-icon.ov-1 {\n      background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAT3SURBVHgBxVq9bxxFFH/3kVzwWY5FAUYK4iK7oEDyhhIh4VSkTEQaqnMKKpCCK2hQLqJKBUhQUeTcx0rKUBn/A/gsUSBxUS6iiJUmTnSX2Mbn5f3mZk+zs7MfNzN3/KTx6t7e7f7e18ybNy6RB4RhuMiXqzwCHu/J66IcEXpy7PHY5bFTKpV69H8BpHnc4rEd2mOXR5NHg2YFhfjz0C/uTl2RKRHXcWsSTqUiX5KWuU+j2Dai82JI3VdD2ntxQt3BkPpDov5JKO7NV0u0dJbHuTIt1ysULFQpOF/JeKPIlctFciRXASbf5MuPFE9IARDcenpM93hEZItiqVYWSjQv1IRiBhzwuMFKPMh6TqYC0p0tXQ6ym/8cCeI+cOWtM1mKtFiJ22m/TVUgjTws3mbyk1o8D/BI892aUMaAVCWMCjB5zOn3dfkvjw+9WT0N1985S19ePGe6tc5KbOrChAIyYbHQjGMe1v7ur1fUeTmkWWBlrkw/fFAXya8AOXFJT2yTAo/50lBlX3T6PMOc0iwRLFSEEho6rMAlVRDLGhn3DVWGsJk1eQDexrs1BMyxpQrGCsjQid18+OzYS8wjObc/WqBPzQmaintPje+/GY5qLwHVAy31W/tHp2KqdAXIr/MACq2aGjaTMx7Ifx19EApI6zf1H+4fuU2VKnmg2588FKM1R8PYC5EH1tS7sP7DZ/+SC3TyIIJSwwaGlX7shUiBm+pd19D5jOdylTyAWskFhlz4BH/KMnyC+MtOyBZI1K8MC1Hnpf0zga2kAmsII3hgLfYitpRt7IP8tytvGO89Grh5ACFkMOxVKBC3vqWlssgDPtYSwzMCKLCqSmwslUse+wMPxZ/BAw0o0FAl+4eTvSiPPNAd+KmhHg0SHlitkq7AcXFXo+jKIw98/OYZCj6spt7vD0O68/fr3DDD9zQsJp5a1NVRxVgEqCq1ytIKBm6LZbIANh+Gctcad7qvrZMcChyogiKklmolbzsykC+66pu4IYSgwLi6m6/AVZnPEaXu53/0M7/zDefGlZzqcxLyAAynoQcPdFTJSr1CPrBSz47OSckDb9cSzxQKPFElq+er5Aq4OssQ2KjYFIuGZ+4lPTBnlddU9Bku7RhsMzXs4k2xxlHAHnCdXZZTrA/ybctKd9QIS0THTpk3yUji31UpymEXGF7kRB5YTbYiscHvRb7eUe9cd1RADyFX8sD6hZouQrtzvKHBh/F6gBCy9QJcrbYIfZBHvWVoOwqjC6kMo5/Uu9hR2eTCct0veRjEYP121OBS1Up4oZn8YS4GcoX2QR7A3tpg/XGfNGZi2TSKHTD8zHP21pT7oWlAGBu2p7fZ+q3og6m1iL5obJe28edgZn3RCJgIfg3mdXGPyV9UBaYV5xppBd737895WeCKIqUvCk6XdWGClUyODVWGfIA1XNeHIsA7Ukr1G6Yjp6wDjhZp+QCgX+qja6dDTBqcsClrUCzuVeQdMbXIoAQ6d5hhfnPs3kWIGmEp03YqeaDIIR9Oa+6S4ZAvUgQnk5N6JFosYfEU4oj5DSbfznrOJMes26Q1AFSg5YGZCm2Z/cNTbg6EsWNWbJRQDqNcx4QQZJftqJCvef9XBIRUOF081w8wvAPe4NEO/UIQD5WDi6lDKrIejv5hwxbbrsS99EXCUY6s0WgFR6uyQfF8OZADsf1EXh/IItIJ/wGIiiU8ye7cIAAAAABJRU5ErkJggg==);\n    }\n\n    #body {\n      box-sizing: border-box;\n      padding: 97px 20px 16px 70px;\n    }\n\n    #title {\n      align-items: center;\n      display: flex;\n      height: 21px;\n      padding-bottom: 10px;\n    }\n    #title #name {\n      color: var(--text1);\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 700;\n    }\n    #title #name.render-style {\n      background-clip: text;\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n      background-image: var(--name-render-bg-light);\n    }\n    #title #name.render-style.dark {\n      background-image: var(--name-render-bg-dark);\n    }\n    #title #gender {\n      display: block;\n      height: 16px;\n      margin-left: 6px;\n      width: 16px;\n    }\n    #title #level {\n      margin-left: 6px;\n      margin-right: -2px;\n      display: flex;\n    }\n    #level img {\n      width: 30px;\n    }\n    #vip {\n      margin-left: 6px;\n    }\n    #vip img {\n      display: flex;\n      height: 20px;\n    }\n    #vip label {\n      background-color: var(--brand_pink);\n      border-radius: 2px;\n      box-sizing: border-box;\n      color: var(--text_white);\n      font-size: 12px;\n      font-weight: 400;\n      height: 16px;\n      line-height: 16px;\n      margin-left: 0;\n      max-width: 58px;\n      overflow: hidden;\n      white-space: nowrap;\n    }\n    #vip label span {\n      align-items: center;\n      display: inline-flex;\n      justify-content: center;\n      transform: scale(0.83);\n      transform-origin: center;\n    }\n\n    #content {\n    }\n    #content #stats {\n      align-items: center;\n      display: flex;\n      font-size: 12px;\n      padding-bottom: 10px;\n    }\n    #content #stats a {\n      color: var(--text3);\n      padding-right: 18px;\n      text-decoration: none;\n    }\n    #content #stats a span {\n      color: var(--text1);\n      display: inline-block;\n      margin-right: 3px;\n    }\n    #content #ov {\n      color: var(--text3);\n      font-size: 12px;\n      line-height: 17px;\n      margin-bottom: 10px;\n    }\n    #content #ov i {\n      background-position: 50%;\n      background-repeat: no-repeat;\n      background-size: cover;\n      display: inline-block;\n      height: 14px;\n      margin-right: 2px;\n      vertical-align: sub;\n      width: 14px;\n    }\n    #content sign {\n      -webkit-line-clamp: 2;\n      color: var(--text3);\n      display: -webkit-box;\n      line-height: 16px;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      word-break: break-all;\n    }\n    #action {\n      align-items: center;\n      display: flex;\n      margin-top: 16px;\n    }\n    #action button {\n      align-items: center;\n      border-radius: 3px;\n      border-style: solid;\n      border-width: 1px;\n      cursor: pointer;\n      display: flex;\n      font-size: 14px;\n      height: 30px;\n      justify-content: center;\n      transition: all 0.3s;\n      width: 100px;\n    }\n    #action button#follow {\n      color: var(--text_white);\n      border-color: var(--brand_blue);\n      background-color: var(--brand_blue);\n    }\n    #action button#follow bili-icon {\n      margin-right: 3px;\n    }\n    #action button#follow.active {\n      background-color: var(--graph_bg_thick);\n      border-color: var(--graph_bg_thick);\n      color: var(--text3);\n    }\n    #action button#follow.active bili-icon {\n      display: none;\n    }\n    #action button#follow.active:hover {\n      background-color: var(--graph_bg_regular);\n      border-color: var(--graph_bg_regular);\n    }\n    #action button#follow:hover {\n      background-color: #00b8f6;\n      border-color: #00b8f6;\n    }\n    #action button#chat {\n      background-color: transparent;\n      border-color: var(--text3);\n      color: var(--text2);\n      margin-left: 8px;\n    }\n  "])),366,85),xa([wn()],Aa.prototype,"uid",2),xa([wn()],Aa.prototype,"data",2),xa([wn()],Aa.prototype,"showSpinner",2),xa([wn()],Aa.prototype,"isFollowing",2),xa([wn()],Aa.prototype,"backgroundImage",1),xa([wn()],Aa.prototype,"faceSrc",1),xa([wn()],Aa.prototype,"ovType",1),xa([wn()],Aa.prototype,"ovText",1),xa([wn()],Aa.prototype,"name",1),xa([wn()],Aa.prototype,"nameRenderStyle",1),xa([wn()],Aa.prototype,"nameStyle",1),xa([wn()],Aa.prototype,"gender",1),xa([wn()],Aa.prototype,"genderImg",1),xa([wn()],Aa.prototype,"level",1),xa([wn()],Aa.prototype,"vipLabel",1),xa([wn()],Aa.prototype,"stats",1),xa([wn()],Aa.prototype,"signText",1),Aa=xa([mn("bili-user-profile")],Aa),customElements.get("bili-user-profile")||customElements.define("bili-user-profile",Aa),window.__WEB_UI_VERSION__="1.1.2";
/**
   * @license
   * Copyright 2018 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
var Ea=Hn(function(t){function n(t){var i,a;if(o(this,n),i=r(this,n,[t]),t.type!==Fn||"class"!==t.name||(null===(a=t.strings)||void 0===a?void 0:a.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.");return e(i)}return p(n,t),s(n,[{key:"render",value:function(t){return" "+Object.keys(t).filter((function(e){return t[e]})).join(" ")+" "}},{key:"update",value:function(t,e){var n,i,r=this,o=y(e,1)[0];if(void 0===this.it){for(var a in this.it=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((function(t){return""!==t})))),o)o[a]&&!(null===(n=this.nt)||void 0===n?void 0:n.has(a))&&this.it.add(a);return this.render(o)}var s=t.element.classList;for(var l in this.it.forEach((function(t){t in o||(s.remove(t),r.it.delete(t))})),o){var c=!!o[l];c===this.it.has(l)||(null===(i=this.nt)||void 0===i?void 0:i.has(l))||(c?(s.add(l),this.it.add(l)):(s.remove(l),this.it.delete(l)))}return Ge}}])}(Wn)),Ca=Symbol.for(""),Ta=function(t){if((null==t?void 0:t.r)===Ca)return null==t?void 0:t._$litStatic$},Sa=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return{_$litStatic$:n.reduce((function(e,n,i){return e+function(t){if(void 0!==t._$litStatic$)return t._$litStatic$;throw Error("Value passed to 'literal' function must be a 'literal' result: ".concat(t,". Use 'unsafeStatic' to pass non-literal values, but\n            take care to ensure page security."))}(n)+t[i+1]}),t[0]),r:Ca}},Oa=new Map,Pa=function(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(var o,a,s,l=i.length,c=[],u=[],d=0,p=!1;d<l;){for(s=e[d];d<l&&void 0!==(a=i[d],o=Ta(a));)s+=o+e[++d],p=!0;d!==l&&u.push(a),c.push(s),d++}if(d===l&&c.push(e[l]),p){var h=c.join("$$lit$$");void 0===(e=Oa.get(h))&&(c.raw=c,Oa.set(h,e=c)),i=u}return t.apply(void 0,[e].concat(w(i)))}}(qe),Ia=function(t){function n(t){var i;if(o(this,n),(i=r(this,n,[t])).et=Xe,t.type!==Vn)throw Error(i.constructor.directiveName+"() can only be used in child bindings");return e(i)}return p(n,t),s(n,[{key:"render",value:function(t){if(t===Xe||null==t)return this.ft=void 0,this.et=t;if(t===Ge)return t;if("string"!=typeof t)throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.et)return this.ft;this.et=t;var e=[t];return e.raw=e,this.ft={_$litType$:this.constructor.resultType,strings:e,values:[]}}}])}(Wn);
/**
   * @license
   * Copyright 2020 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */Ia.directiveName="unsafeHTML",Ia.resultType=1;var Ra,ja,La,Ma,Da,Na,Ba,za,Ua,Fa,Va,Ha,Wa,$a,qa,Ga,Xa,Ya,Za,Qa,Ka,Ja,ts,es,ns,is,rs,os,as,ss,ls,cs,us,ds,ps,hs,fs,vs,ms,bs,ys,gs,ws,xs,ks,_s,As,Es,Cs,Ts,Ss,Os,Ps,Is,Rs,js,Ls,Ms,Ds,Ns,Bs,zs,Us,Fs,Vs,Hs,Ws,$s,qs,Gs,Xs,Ys,Zs,Qs,Ks,Js,tl,el,nl,il,rl,ol,al,sl,ll,cl,ul,dl,pl,hl,fl,vl,ml,bl,yl,gl,wl,xl,kl,_l,Al,El,Cl,Tl,Sl,Ol,Pl,Il,Rl,jl,Ll,Ml,Dl,Nl,Bl,zl,Ul,Fl,Vl,Hl,Wl,$l,ql,Gl,Xl,Yl,Zl,Ql,Kl,Jl,tc,ec,nc,ic,rc,oc,ac,sc,lc,cc,uc,dc,pc,hc,fc,vc,mc,bc,yc,gc,wc,xc,kc=Hn(Ia),_c=un.I,Ac=function(){return document.createComment("")},Ec=function(t,e,n){var i,r=t._$AA.parentNode,o=void 0===e?t._$AB:e._$AA;if(void 0===n){var a=r.insertBefore(Ac(),o),s=r.insertBefore(Ac(),o);n=new _c(a,s,t,t.options)}else{var l,c=n._$AB.nextSibling,u=n._$AM,d=u!==t;if(d)null===(i=n._$AQ)||void 0===i||i.call(n,t),n._$AM=t,void 0!==n._$AP&&(l=t._$AU)!==u._$AU&&n._$AP(l);if(c!==o||d)for(var p=n._$AA;p!==c;){var h=p.nextSibling;r.insertBefore(p,o),p=h}}return n},Cc=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return t._$AI(e,n),t},Tc={},Sc=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tc;return t._$AH=e},Oc=function(t){var e;null===(e=t._$AP)||void 0===e||e.call(t,!1,!0);for(var n=t._$AA,i=t._$AB.nextSibling;n!==i;){var r=n.nextSibling;n.remove(),n=r}},Pc=function(t,e,n){for(var i=new Map,r=e;r<=n;r++)i.set(t[r],r);return i},Ic=Hn(function(t){function n(t){var i;if(o(this,n),i=r(this,n,[t]),t.type!==Vn)throw Error("repeat() can only be used in text expressions");return e(i)}return p(n,t),s(n,[{key:"ct",value:function(t,e,n){var i;void 0===n?n=e:void 0!==e&&(i=e);var r,o=[],a=[],s=0,c=l(t);try{for(c.s();!(r=c.n()).done;){var u=r.value;o[s]=i?i(u,s):s,a[s]=n(u,s),s++}}catch(t){c.e(t)}finally{c.f()}return{values:a,keys:o}}},{key:"render",value:function(t,e,n){return this.ct(t,e,n).values}},{key:"update",value:function(t,e){var n,i=y(e,3),r=i[0],o=i[1],a=i[2],s=function(t){return t._$AH}(t),l=this.ct(r,o,a),c=l.values,u=l.keys;if(!Array.isArray(s))return this.ut=u,c;for(var d,p,h=null!==(n=this.ut)&&void 0!==n?n:this.ut=[],f=[],v=0,m=s.length-1,b=0,g=c.length-1;v<=m&&b<=g;)if(null===s[v])v++;else if(null===s[m])m--;else if(h[v]===u[b])f[b]=Cc(s[v],c[b]),v++,b++;else if(h[m]===u[g])f[g]=Cc(s[m],c[g]),m--,g--;else if(h[v]===u[g])f[g]=Cc(s[v],c[g]),Ec(t,f[g+1],s[v]),v++,g--;else if(h[m]===u[b])f[b]=Cc(s[m],c[b]),Ec(t,s[v],s[m]),m--,b++;else if(void 0===d&&(d=Pc(u,b,g),p=Pc(h,v,m)),d.has(h[v]))if(d.has(h[m])){var w=p.get(u[b]),x=void 0!==w?s[w]:null;if(null===x){var k=Ec(t,s[v]);Cc(k,c[b]),f[b]=k}else f[b]=Cc(x,c[b]),Ec(t,s[v],x),s[w]=null;b++}else Oc(s[m]),m--;else Oc(s[v]),v++;for(;b<=g;){var _=Ec(t,f[g+1]);Cc(_,c[b]),f[b++]=_}for(;v<=m;){var A=s[v++];null!==A&&Oc(A)}return this.ut=u,Sc(t,f),Ge}}])}(Wn)),Rc=Object.defineProperty,jc=Object.getOwnPropertyDescriptor,Lc=function(t,e,n,i){for(var r,o=i>1?void 0:i?jc(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Rc(e,n,o),o},Mc=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disabled=!1,t.trailingIcon=!1,t.hasIcon=!1,t.href="",t.target="",t}return p(e,t),s(e,[{key:"name",get:function(){var t;return null!==(t=this.getAttribute("name"))&&void 0!==t?t:""},set:function(t){this.setAttribute("name",t)}},{key:"focus",value:function(){var t;null==(t=this.buttonElement)||t.focus()}},{key:"blur",value:function(){var t;null==(t=this.buttonElement)||t.blur()}},{key:"getRenderClasses",value:function(){return{"button--icon-leading":!this.trailingIcon&&this.hasIcon,"button--icon-trailing":this.trailingIcon&&this.hasIcon}}},{key:"render",value:function(){var t=this.disabled&&!this.href,e=this.href?Sa(Ra||(Ra=g(["a"]))):Sa(ja||(ja=g(["button"]))),n=this.ariaLabel,i=this.ariaHasPopup,r=this.ariaExpanded;return Pa(La||(La=g(["\n      <",'\n        class="button ','"\n        ?disabled=','\n        aria-label="','"\n        aria-haspopup="','"\n        aria-expanded="','"\n        href=',"\n        target=","\n      >","</",">"])),e,Ea(this.getRenderClasses()),t,n||Xe,i||Xe,r||Xe,this.href||Xe,this.target||Xe,this.renderContent(),e)}},{key:"handleSlotChange",value:function(){this.hasIcon=this.assignedIcons.length>0}},{key:"renderContent",value:function(){var t,e=qe(Ma||(Ma=g(['<slot name="icon" @slotchange="','"></slot>'])),this.handleSlotChange);return qe(Da||(Da=g(["\n      "," ",'\n      <span class="button__label"><slot></slot></span>\n      ',"\n    "])),null==(t=this.renderOutline)?void 0:t.call(this),this.trailingIcon?Xe:e,this.trailingIcon?e:Xe)}}])}(fn);
/**
   * @license
   * Copyright 2020 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */Mc.styles=ve(Na||(Na=g([""]))),Lc([gn()],Mc.prototype,"disabled",2),Lc([gn()],Mc.prototype,"trailingIcon",2),Lc([gn()],Mc.prototype,"hasIcon",2),Lc([gn()],Mc.prototype,"href",2),Lc([gn()],Mc.prototype,"target",2),Lc([_n(".button")],Mc.prototype,"buttonElement",2),Lc([function(t){var e=null!=t?t:{},n=e.slot,i=e.selector;return kn({descriptor:function(e){return{get:function(){var e,r="slot"+(n?"[name=".concat(n,"]"):":not([name])"),o=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(r),a=null!=o?An(o,t):[];return i?a.filter((function(t){return t.matches(i)})):a},enumerable:!0,configurable:!0}}})}({slot:"icon",flatten:!0})],Mc.prototype,"assignedIcons",2),Mc=Lc([mn("bili-button")],Mc);var Dc=Object.defineProperty,Nc=Object.getOwnPropertyDescriptor,Bc=function(t){function e(){return o(this,e),r(this,e,arguments)}return p(e,t),s(e)}(Mc);Bc.styles=ve(Ba||(Ba=g(['\n    :host {\n      display: inline-flex;\n      height: var(--_container-height);\n      outline: none;\n      font-family: var(--_label-text-font);\n      font-size: var(--_label-text-size);\n      line-height: var(--_label-text-line-height);\n      font-weight: var(--_label-text-weight);\n      -webkit-tap-highlight-color: transparent;\n      vertical-align: middle;\n    }\n    .button {\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      box-sizing: border-box;\n      border: none;\n      outline: none;\n      user-select: none;\n      appearance: none;\n      background: rgba(0, 0, 0, 0);\n      text-decoration: none;\n      inline-size: 100%;\n      position: relative;\n      z-index: 0;\n      height: 100%;\n      font: inherit;\n      color: var(--_label-text-color);\n      padding-inline-start: var(--_leading-space);\n      padding-inline-end: var(--_trailing-space);\n      cursor: pointer;\n    }\n    .button:not([disabled]):hover {\n      color: var(--_label-text-color-hover, var(--brand_blue));\n    }\n    .button::before {\n      background-color: var(--_container-color);\n      border-radius: inherit;\n      content: "";\n      inset: 0px;\n      position: absolute;\n    }\n  ']))),Bc=function(t,e,n,i){for(var r,o=i>1?void 0:i?Nc(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Dc(e,n,o),o}([mn("bili-text-button")],Bc);var zc="bili-comments-toast-container",Uc=function(){function t(){o(this,t);var e=document.querySelector(".".concat(zc));e||(e=document.createElement("div")).classList.add(zc),this.container=e,document.body.appendChild(this.container);var n=document.createElement("style");n.innerHTML="\n        .".concat(zc," {\n            position: fixed;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            pointer-events: none;\n            background-color: transparent;\n        }\n        .").concat("bili-comments-toast"," {\n            position: absolute;\n            left: 50%;\n            top: 50%;\n            transform: translate(-50%, -50%);\n            background-color: rgba(0, 0, 0, 0.8);\n            font-size: 14px;\n            color: #fff;\n            padding: 2px 6px;\n            border-radius: 2px;\n        }\n    "),document.head.appendChild(n)}return s(t,[{key:"show",value:function(t,e){var n=this;e=e||2e3;var i=document.createElement("div");i.classList.add("bili-comments-toast"),i.textContent=t,this.container.style.zIndex=jn().toString(),this.container.appendChild(i),setTimeout((function(){n.container.removeChild(i)}),e)}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}])}(),Fc=Uc.getInstance(),Vc=function(t){return"object"==k(t)&&"[object Object]"===Object.prototype.toString.call(t)},Hc=function(t){return t.replace(/[^\d]/g,"")},Wc=function(t){return new Promise((function(e){return setTimeout(e,t)}))},$c=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},qc=function(){return s((function t(){o(this,t)}),[{key:"request",value:(t=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,wi(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t}(),Gc=new qc,Xc=function(t){return JSON.stringify(t)},Yc=function(){var t=i(m().mark((function t(e,n,i){var r,o,a,s,l,c,u;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.request&&(r=e.request,o=r.method,a=r.data,"POST"===o&&Vc(a)&&((s=a).statistics||(l=(null==i?void 0:i.payload)||{active:!0,appId:100,platform:5},c=l.appId,u=l.platform,!1!==l.active&&(s.statistics=Xc({appId:c,platform:u}))))),t.next=3,n();case 3:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}(),Zc=function(t){return Gc.request({method:"POST",url:"/x/v2/reply/action",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"},chainProxy:function(t){return t.with(Yc)}})},Qc=function(t){return Gc.request({method:"POST",url:"/x/v2/reply/hate",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"},chainProxy:function(t){return t.with(Yc)}})},Kc=function(t){return Gc.request({method:"POST",url:"/x/v2/reply/del",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},Jc=function(t){return Gc.request({method:"POST",url:"/x/v2/reply/top",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},tu=function(t){return t[t.SELECT=1]="SELECT",t[t.UNSELECT=2]="UNSELECT",t[t.CLOSE=3]="CLOSE",t[t.OPEN=4]="OPEN",t}(tu||{}),eu=function(t){return Gc.request({method:"POST",url:"/x/v2/reply/subject/modify",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},nu=function(t){return Gc.request({method:"POST",url:"/x/v2/dm/subject/state/update",data:v(v({},t),{},{type:1}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},iu=function(t){return Gc.request({method:"POST",url:"/x/v2/reply/vote/do",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},ru=function(t){return Gc.request({url:"/x/v2/reply/report",method:"POST",data:v(v({},t),{},{gaia_source:"main_web"}),headers:{"Content-Type":"application/x-www-form-urlencoded"},chainProxy:function(t){return t.with(Yc)}})},ou=function(t){return Gc.request({url:"/x/relation/modify",method:"POST",data:v(v({},t),{},{gaia_source:"main_web"}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},au=function(t){return Gc.request({method:"POST",baseURL:"//cm.bilibili.com",url:"/commercialorder/api/web_api/v1/main_site/upper/comment/apply_remove",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})};var su=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.PAGE=1]="PAGE",t[t.IFRAME=2]="IFRAME",t[t.SITE=3]="SITE",t}({});var lu=!1;function cu(){return!1===lu&&(lu=("undefined"==typeof window?"undefined":k(window))<"u"),lu}var uu=function(){return!cu()};function du(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var pu="to top right";function hu(t,e){return"linear-gradient(".concat(t,",").concat(e,")")}function fu(t,e){var n=(e=e||{}).theme||"",i=e.stringType||!1,r="",o="";if(function(t){return!(!t||"object"!=k(t)||k(t.render_scheme)>"u"||!t.colors_info||!t.colors_info.color||!Array.isArray(t.colors_info.color))}(t)){var a=t.render_scheme,s=t.colors_info.color;if(1!==a&&"Colorful"!==a||!s||0===s.length)return null;var l=function(t){var e=t.length,n=[],i=[],r=function(t,n){return"".concat(function(t){return"#"===t[0]?t:"#".concat(t)}(t)," ").concat(n/(e-1)*100,"%")};return t.forEach((function(t,e){n.push(r(t.color_day,e)),i.push(r(t.color_night,e))})),{light:hu(pu,n.join(",")),dark:hu(pu,i.join(","))}}(s);r=l.light,o=l.dark}if(r&&o){var c,u={base:{"background-clip":"text","-webkit-background-clip":"text","-webkit-text-fill-color":"transparent"},theme:{light:{"background-image":r},dark:{"background-image":o}}};if(["light","dark"].includes(n)){var d=Object.assign({},u.base,u.theme[n]);return i?function(t){var e=Object.keys(t);if(0===e.length)return"";var n="";return e.forEach((function(e){void 0!==t[e]&&(n+="".concat(e,":").concat(t[e],";"))})),n}(d):d}if(e.variable&&"string"==typeof e.variable&&/^--[a-z]/.test(e.variable))u.variable=(du(c={},"".concat(e.variable,"-light"),r),du(c,"".concat(e.variable,"-dark"),o),c);return u}return null}function vu(t){return vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(t)}function mu(t){var e=function(t,e){if("object"!=vu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=vu(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==vu(e)?e:e+""}function bu(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,mu(i.key),i)}}function yu(t,e,n){return(e=mu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var gu=function(){function t(e){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),yu(this,"all",new Map),yu(this,"weakMap",new WeakMap),yu(this,"defaultEventTarget",void 0),e?e instanceof Element||e instanceof Document?this.defaultEventTarget=e:this.defaultEventTarget=document.querySelector(e)||document:this.defaultEventTarget=document,this.all.clear=function(){n.all.forEach((function(t,e){t.forEach((function(t){n.off(e,t)}))})),n.all.clear()}}return function(t,e,n){e&&bu(t.prototype,e),n&&bu(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"on",value:function(t,e,n){this.all.has(t)||this.all.set(t,[]),this.weakMap.has(e)||this.weakMap.set(e,[]);var i=(n||this.defaultEventTarget).addEventListener,r=function(n){e({sourceType:su.PAGE,customEvent:n,event:t,payload:n.detail,samePage:!0,emitter:i})};this.all.get(t).push(e),this.weakMap.get(e).push(r),i(t,r)}},{key:"off",value:function(t,e,n){var i,r=this,o=(n||this.defaultEventTarget).removeEventListener;if(!e)return null===(i=this.all.get(t))||void 0===i||i.forEach((function(e){r.weakMap.get(e).forEach((function(e){o(t,e)}))})),void this.all.delete(t);this.weakMap.get(e).forEach((function(e){o(t,e)}))}},{key:"emit",value:function(t,e,n){var i=new CustomEvent(t,{detail:e}),r=(n||this.defaultEventTarget).dispatchEvent;r(i),r(new CustomEvent("*",{detail:e}))}}]),t}(),wu=function(){var t=null;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return cu()?t||(t=new gu(e)):(console.error("useEvent must be used in the browser environment"),null)}}(),xu=function(t){return{all:t=t||new Map,on:function(e,n){var i=t.get(e);i?i.push(n):t.set(e,[n])},off:function(e,n){var i=t.get(e);i&&(n?i.splice(i.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var i=t.get(e);i&&i.slice().map((function(t){t(n)})),(i=t.get("*"))&&i.slice().map((function(t){t(e,n)}))}}}(),ku=wu(),_u="main",Au="reply",Eu=function(t,e){var n,i,r=window;if(null!=(n=window.reportConfig)&&n.msgObjects&&r[window.reportConfig.msgObjects]){var o=e||t;r[null==(i=r.reportConfig)?void 0:i.msgObjects][t]=o}else;},Cu=function(t,e,n){var i=v(v({},n),{},{spm_id:"".concat(hi(),".").concat(e,".").concat(t)});window.reportObserver&&window.reportObserver.reportCustomData&&window.reportObserver.reportCustomData("show"===t?"appear":t,i)},Tu=function(t,e,n,i){if(e="".concat((null==i?void 0:i.spmPrefix)||hi(),".").concat(e),null!=i&&i.flush){var r=yi({globalInst:"__biliMirrorPbInstance__"});if(r){switch(t){case"show":r("exposure",e,n,{flush:!0});break;case"click":r("click",e,n,{flush:!0});break;case"tech":r("tech",e,n,{flush:!0})}return}}switch(t){case"show":gi("exposure",e,n);break;case"click":gi("click",e,n);break;case"tech":gi("tech",e,n)}},Su=function(){var t=i(m().mark((function t(){var e,n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.biliMirror&&!window.__biliMirrorPbInstance__){t.next=2;break}return t.abrupt("return");case 2:return e=(null==window?void 0:window.__MIRROR_CONFIG__)||{},n={feature:{tech:!0},autoPv:!1,batch:!1},null!=e&&e.pbOptions&&(n=v(v(v({},n),e.pbOptions),{},{feature:v(v({},n.feature),e.pbOptions.feature)})),t.next=7,fi(n);case 7:window.__biliMirrorPbInstance__=t.sent;case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ou=function(t){return t.report_groups?t.report_groups.map((function(t){return{name:t.name,options:t.report_options}})):[]},Pu=Object.defineProperty,Iu=Object.getOwnPropertyDescriptor,Ru=function(t,e,n,i){for(var r,o=i>1?void 0:i?Iu(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Pu(e,n,o),o},ju=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).type="",t.oid="",t.rpid="",t.mid="",t.uname="",t.ordering="heat",t.appId=100,t.platform=5,t.maxInputLength=200,t.optionValue=-1,t.inputValue="",t.blockValue=!1,t.groups=[],t}return p(e,t),s(e,[{key:"isBiliPc",get:function(){return!(!this.appId||!this.platform)&&112===Number(this.appId)}},{key:"connectedCallback",value:function(){u(d(e.prototype),"connectedCallback",this).call(this);var t={oid:this.oid,type:this.type,rpid:this.rpid,mid:this.mid};this.isBiliPc||(Cu("show","comment-report-reason",t),Tu("show","comments.report.show",t)),this.initData()}},{key:"initData",value:(a=i(m().mark((function t(){var e,n,i,r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Gc.request({url:"/x/v2/reply/report/metadata"});case 3:if(n=t.sent,i=n.code,r=n.data,0===i&&null!=(e=null==r?void 0:r.report_groups)&&e.length){t.next=9;break}return this.groups=[{name:"违反法律法规",options:[{label:"违法违规",value:9},{label:"色情",value:2},{label:"低俗",value:10},{label:"赌博诈骗",value:12},{label:"违法信息外链",value:23}]},{name:"谣言类不实信息",options:[{label:"涉政谣言",value:19},{label:"虚假不实信息",value:22},{label:"涉社会事件谣言",value:20}]},{name:"侵犯个人权益",options:[{label:"人身攻击",value:7},{label:"侵犯隐私",value:15}]},{name:"有害社区环境",options:[{label:"垃圾广告",value:1},{label:"引战",value:4},{label:"剧透",value:5},{label:"刷屏",value:3},{label:"视频不相关",value:8},{label:"违规抽奖",value:18},{label:"青少年不良信息",value:17}]},{name:"",options:[{label:"其他",value:0}]}],t.abrupt("return");case 9:this.groups=Ou(r),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),this.groups=[{name:"违反法律法规",options:[{label:"违法违规",value:9},{label:"色情",value:2},{label:"低俗",value:10},{label:"赌博诈骗",value:12},{label:"违法信息外链",value:23}]},{name:"谣言类不实信息",options:[{label:"涉政谣言",value:19},{label:"虚假不实信息",value:22},{label:"涉社会事件谣言",value:20}]},{name:"侵犯个人权益",options:[{label:"人身攻击",value:7},{label:"侵犯隐私",value:15}]},{name:"有害社区环境",options:[{label:"垃圾广告",value:1},{label:"引战",value:4},{label:"剧透",value:5},{label:"刷屏",value:3},{label:"视频不相关",value:8},{label:"违规抽奖",value:18},{label:"青少年不良信息",value:17}]},{name:"",options:[{label:"其他",value:0}]}];case 15:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return a.apply(this,arguments)})},{key:"handleOptionChange",value:function(t){this.optionValue=parseInt(t.detail.value)}},{key:"handleInputChange",value:function(t){this.inputValue=t.target.value}},{key:"onBlockChange",value:function(t){this.blockValue=t.detail.checked}},{key:"handleHide",value:function(){this.dispatchEvent(new CustomEvent("hide"))}},{key:"handleCancel",value:function(){this.handleHide()}},{key:"handleConfirm",value:(n=i(m().mark((function t(){var e,n,i,r,o,a=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==this.optionValue){t.next=3;break}return Fc.show("请选择举报理由"),t.abrupt("return");case 3:if(0!==this.optionValue){t.next=10;break}if(this.inputValue){t.next=7;break}return Fc.show("请完善举报理由"),t.abrupt("return");case 7:if(!this.inputValue||!(this.inputValue.length<2||this.inputValue.length>this.maxInputLength)){t.next=10;break}return Fc.show("自定义举报内容长度为2-200字符"),t.abrupt("return");case 10:return t.prev=10,n={},this.isBiliPc&&(n={appId:Number(this.appId),platform:Number(this.platform)}),t.next=15,ru({type:Number(this.type),oid:this.oid,rpid:this.rpid,reason:this.optionValue,content:0===this.optionValue?this.inputValue:"",add_blacklist:this.blockValue,ordering:this.ordering,statistics:this.isBiliPc?JSON.stringify(n):""});case 15:if(0!==(i=t.sent).code){t.next=26;break}if(Fc.show((null==(e=i.data)?void 0:e.toast)||"举报成功"),this.handleHide(),r={oid:this.oid,type:this.type,rpid:this.rpid,mid:this.mid,reasonid:this.optionValue,blacklist:this.blockValue,ctime:Date.now()},this.isBiliPc||(Cu("show","comment-report-reason-submit-button",r),Tu("show","comments.report_submit.show",r)),o={type:Number(this.type),oid:Number(this.oid),oid_str:this.oid,rpid:Number(this.rpid),rpid_str:this.rpid},!this.blockValue){t.next=24;break}return xu.emit("remove",{namespaces:[_u,Au],method:"filter",predicate:function(t){var e;return(null==(e=t.member)?void 0:e.mid)===a.mid},value:o}),t.abrupt("return");case 24:return xu.emit("remove",{namespaces:[_u,Au],method:"findIndex",predicate:function(t){return t.rpid_str===a.rpid},value:o}),t.abrupt("return");case 26:Fc.show(i.message||"举报失败"),t.next=32;break;case 29:t.prev=29,t.t0=t.catch(10),Fc.show("举报失败");case 32:case"end":return t.stop()}}),t,this,[[10,29]])}))),function(){return n.apply(this,arguments)})},{key:"handleJumpJudgement",value:function(){this.isBiliPc||Cu("click","judgement",{}),window.open("//www.bilibili.com/judgement/apply"),this.isBiliPc&&xu.emit("jump",{type:"link",link:"https://www.bilibili.com/judgement/apply"})}},{key:"textareaTemplate",value:function(){return qe(za||(za=g([" <textarea\n      .value=",'\n      placeholder="请填写举报理由"\n      maxlength="','"\n      @input=',"\n      @keydown=","\n      @keyup=","\n    ></textarea>"])),this.inputValue,this.maxInputLength,this.handleInputChange,(function(t){return t.stopPropagation()}),(function(t){return t.stopPropagation()}))}},{key:"render",value:function(){var t=this;return qe(Ua||(Ua=g(['\n      <div id="tips" @click=','>\n        <span>申请加入风纪委员会，共治更好的社区氛围</span>\n        <bili-icon size="16" icon="BDC/arrow_forward_right_line/3"></bili-icon>\n      </div>\n      <div id="form">\n        ',"\n        ",'\n      </div>\n      <div id="footer">\n        <div id="action">\n          <button id="cancel" @click=','>取消</button>\n          <button id="confirm" @click=',">确定</button>\n        </div>\n        ","\n      </div>\n    "])),this.handleJumpJudgement,this.groups.map((function(e){return qe(Fa||(Fa=g(['<div id="group">\n              ','\n              <div id="group-options">\n                ',"\n              </div>\n            </div>"])),e.name?qe(Va||(Va=g(['<div id="group-name">',"</div"])),e.name):"",e.options.map((function(e){return qe(Ha||(Ha=g(['<bili-radio\n                      label="','"\n                      value="','"\n                      checked="','"\n                      @change=',"\n                    ></bili-radio>"])),e.label,e.value,e.value===t.optionValue,t.handleOptionChange)})))})),0===this.optionValue?this.textareaTemplate():"",this.handleCancel,this.handleConfirm,this.mid&&this.uname?qe(Wa||(Wa=g(['<div id="optional">\n              <bili-checkbox value="block" label="拉黑 @','" @change=',"></bili-checkbox>\n            </div>"])),this.uname,this.onBlockChange):"")}}]);var n,a}(fn);ju.styles=ve($a||($a=g(["\n    :host {\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n    }\n    #tips {\n      display: flex;\n      align-items: center;\n      position: relative;\n      padding: 12px;\n      font-size: 14px;\n      border-radius: 4px;\n      color: var(--text1);\n      background-color: var(--bg2);\n      transition: 0.2s;\n      cursor: pointer;\n      margin-bottom: 12px;\n    }\n    #tips bili-icon {\n      margin-left: auto;\n    }\n    #tips:hover {\n      background-color: var(--bg3);\n    }\n    #form {\n      min-height: 400px;\n    }\n    #group {\n    }\n    #group + #group {\n      margin-top: 12px;\n    }\n    #group-name {\n      font-size: 12px;\n      color: var(--text3);\n      margin-bottom: 15px;\n    }\n    #group-options {\n      display: flex;\n      flex-wrap: wrap;\n    }\n    bili-radio {\n      --bili-radio-margin-inline-end: 0;\n      width: 25%;\n      margin-bottom: 16px;\n    }\n    textarea {\n      margin-top: -8px;\n      box-sizing: border-box;\n      width: 100%;\n      height: 70px;\n      padding: 8px;\n      border: 1px solid var(--graph_weak);\n      border-radius: 4px;\n      outline: none;\n      resize: none;\n    }\n\n    #footer {\n      margin-top: 16px;\n    }\n    #footer #action {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    #action button {\n      -webkit-font-smoothing: antialiased;\n      border: 1px solid var(--brand_blue);\n      border-radius: 6px;\n      box-sizing: border-box;\n      cursor: pointer;\n      font-family: PingFang SC, HarmonyOS_Regular, Helvetica Neue, Microsoft YaHei, sans-serif !important;\n      font-weight: 400;\n      height: 32px;\n      outline: none;\n      transition: all 0.2s;\n      width: 130px;\n      margin-left: 12px;\n    }\n    #action button#cancel {\n      background-color: var(--bg1);\n      border-color: var(--line_regular);\n      color: var(--text1);\n    }\n    #action button#confirm {\n      background-color: var(--brand_blue);\n      border-color: var(--brand_blue);\n      color: var(--text_white);\n    }\n    #optional {\n      margin-top: 20px;\n      color: var(--text3);\n      display: flex;\n      justify-content: center;\n    }\n  "]))),Ru([gn({type:String,attribute:"data-type"})],ju.prototype,"type",2),Ru([gn({type:String,attribute:"data-oid"})],ju.prototype,"oid",2),Ru([gn({type:String,attribute:"data-rpid"})],ju.prototype,"rpid",2),Ru([gn({type:String,attribute:"data-mid"})],ju.prototype,"mid",2),Ru([gn({type:String,attribute:"data-uname"})],ju.prototype,"uname",2),Ru([gn({type:String,attribute:"data-ordering"})],ju.prototype,"ordering",2),Ru([gn({type:String,attribute:"data-app-id"})],ju.prototype,"appId",2),Ru([gn({type:String,attribute:"data-platform"})],ju.prototype,"platform",2),Ru([wn()],ju.prototype,"maxInputLength",2),Ru([wn()],ju.prototype,"optionValue",2),Ru([wn()],ju.prototype,"inputValue",2),Ru([wn()],ju.prototype,"blockValue",2),Ru([wn()],ju.prototype,"groups",2),ju=Ru([mn("bili-comment-report-form")],ju);var Lu=function(t){return Gc.request({url:"/x/member/web/uname/update",method:"POST",data:{uname:t,source:"reply"},headers:{"Content-Type":"application/x-www-form-urlencoded"}})},Mu=Object.defineProperty,Du=Object.getOwnPropertyDescriptor,Nu=function(t,e,n,i){for(var r,o=i>1?void 0:i?Du(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Mu(e,n,o),o},Bu=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).inputValue="",t}return p(e,t),s(e,[{key:"handleInputChange",value:function(t){this.inputValue=t.target.value}},{key:"handleHide",value:function(){this.dispatchEvent(new CustomEvent("hide"))}},{key:"handleCancel",value:function(){this.handleHide()}},{key:"handleConfirm",value:(n=i(m().mark((function t(){var e,n,i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.inputValue){t.next=4;break}return Fc.show("请输入昵称"),t.abrupt("return");case 4:return t.next=6,Lu(this.inputValue);case 6:if(e=t.sent,n=e.code,i=e.message,0!==n){t.next=12;break}return Fc.show("成功设置昵称"),this.handleHide(),t.abrupt("return");case 12:Fc.show(i||"设置昵称失败"),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),Fc.show("设置昵称失败");case 18:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(){return n.apply(this,arguments)})},{key:"render",value:function(){return qe(qa||(qa=g(['\n      <div id="form">\n        <div id="tips">拥有昵称后才能评论哦！快来取个适合你的昵称吧！</div>\n        <div id="input">\n          <input .value=',' placeholder="请输入新的昵称" maxlength="16" @input=',' />\n        </div>\n        <div id="footer">\n          <div id="action">\n            <button id="cancel" @click=','>取消</button>\n            <button id="confirm" @click=',">确定</button>\n          </div>\n        </div>\n      </div>\n    "])),this.inputValue,this.handleInputChange,this.handleCancel,this.handleConfirm)}}]);var n}(fn);Bu.styles=ve(Ga||(Ga=g(["\n    :host {\n      padding: 24px;\n      display: flex;\n      flex-direction: column;\n    }\n\n    #tips {\n      width: 100%;\n      text-align: center;\n      font-size: 14px;\n      color: var(--text2);\n      margin-bottom: 16px;\n    }\n\n    #input {\n      width: 100%;\n      margin-bottom: 40px;\n    }\n\n    #input input {\n      box-sizing: border-box;\n      width: 100%;\n      height: 40px;\n      padding: 0 10px;\n      border: 1px solid var(--graph_weak);\n      border-radius: 4px;\n      outline: none;\n    }\n\n    #footer {\n      margin-top: 16px;\n    }\n    #footer #action {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n    #action button {\n      -webkit-font-smoothing: antialiased;\n      border: 1px solid var(--brand_blue);\n      border-radius: 6px;\n      box-sizing: border-box;\n      cursor: pointer;\n      font-family: PingFang SC, HarmonyOS_Regular, Helvetica Neue, Microsoft YaHei, sans-serif !important;\n      font-weight: 400;\n      height: 32px;\n      outline: none;\n      transition: all 0.2s;\n      width: 160px;\n    }\n    #action button#cancel {\n      background-color: var(--bg1);\n      border-color: var(--line_regular);\n      color: var(--text1);\n    }\n    #action button#confirm {\n      background-color: var(--brand_blue);\n      border-color: var(--brand_blue);\n      color: var(--text_white);\n    }\n  "]))),Nu([wn()],Bu.prototype,"inputValue",2),Bu=Nu([mn("bili-comment-update-uname-form")],Bu);var zu=Object.defineProperty,Uu=Object.getOwnPropertyDescriptor,Fu=function(t,e,n,i){for(var r,o=i>1?void 0:i?Uu(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&zu(e,n,o),o},Vu=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).type="",t.oid="",t.rpid="",t.maxInputLength=100,t.optionValue=-1,t.inputValue="",t.options=[],t}return p(e,t),s(e,[{key:"connectedCallback",value:function(){u(d(e.prototype),"connectedCallback",this).call(this),this.initData()}},{key:"initData",value:(a=i(m().mark((function t(){var e,n,i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Gc.request({baseURL:"//cm.bilibili.com",url:"/commercialorder/api/web_api/v1/main_site/upper/comment/reason_list"});case 3:0===(n=t.sent).code&&null!=(e=n.result)&&e.length&&(i=n.result.map((function(t){return{label:t.reason_content,value:t.reason_index}})),this.options=i.concat({label:"其他原因",value:0})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Fc.show("获取举报理由失败");case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return a.apply(this,arguments)})},{key:"handleOptionChange",value:function(t){this.optionValue=parseInt(t.detail.value)}},{key:"handleInputChange",value:function(t){this.inputValue=t.target.value}},{key:"handleHide",value:function(){this.dispatchEvent(new CustomEvent("hide"))}},{key:"handleCancel",value:function(){this.handleHide()}},{key:"handleConfirm",value:(n=i(m().mark((function t(){var e,n,i,r=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==this.optionValue){t.next=3;break}return Fc.show("请选择申诉原因"),t.abrupt("return");case 3:if(0!==this.optionValue){t.next=10;break}if(this.inputValue){t.next=7;break}return Fc.show("请选择或填写申诉原因"),t.abrupt("return");case 7:if(!this.inputValue||!(this.inputValue.length<2||this.inputValue.length>this.maxInputLength)){t.next=10;break}return Fc.show("自定义举报内容长度为2-100字符"),t.abrupt("return");case 10:return t.prev=10,e="",n=this.options.find((function(t){return t.value===r.optionValue})),0===this.optionValue?e=this.inputValue:n&&(e=n.label),t.next=16,au({av_id:this.oid,comment_id:this.rpid,reason:e});case 16:0===(i=t.sent).code?Fc.show(i.result||"申诉成功"):Fc.show(i.message||"申诉失败"),this.handleHide(),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(10),Fc.show("申诉失败");case 23:case"end":return t.stop()}}),t,this,[[10,20]])}))),function(){return n.apply(this,arguments)})},{key:"textareaTemplate",value:function(){return qe(Xa||(Xa=g(['<div id="input">\n      <textarea\n        .value=','\n        placeholder="请填写具体原因"\n        maxlength="','"\n        @input=',"\n      ></textarea>\n    </div>"])),this.inputValue,this.maxInputLength,this.handleInputChange)}},{key:"render",value:function(){var t=this;return qe(Ya||(Ya=g(['\n      <div id="tips">\n        <span>因以下理由申请撤销商业推广置顶：</span>\n      </div>\n      <div id="form">\n        ',"\n        ",'\n      </div>\n      <div id="footer">\n        <div id="action">\n          <button id="cancel" @click=','>取消</button>\n          <button id="confirm" @click=',">确定</button>\n        </div>\n      </div>\n    "])),this.options.map((function(e){return qe(Za||(Za=g(['<div class="option">\n              <bili-radio\n                label="','"\n                value="','"\n                checked="','"\n                @change=',"\n              ></bili-radio>\n            </div>"])),e.label,e.value,e.value===t.optionValue,t.handleOptionChange)})),0===this.optionValue?this.textareaTemplate():"",this.handleCancel,this.handleConfirm)}}]);var n,a}(fn);Vu.styles=ve(Qa||(Qa=g(["\n    :host {\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n    }\n    #tips {\n      display: flex;\n      align-items: center;\n      position: relative;\n      padding: 12px 0;\n      font-size: 14px;\n      border-radius: 4px;\n      color: var(--text1);\n      transition: 0.2s;\n      cursor: pointer;\n      margin-bottom: 12px;\n    }\n    #form {\n      min-height: 220px;\n    }\n    bili-radio {\n      --bili-radio-margin-inline-end: 0;\n      margin-bottom: 16px;\n    }\n    #input {\n    }\n    textarea {\n      box-sizing: border-box;\n      width: 100%;\n      height: 70px;\n      padding: 8px;\n      border: 1px solid var(--graph_weak);\n      border-radius: 4px;\n      outline: none;\n      resize: none;\n    }\n\n    #footer {\n      margin-top: 16px;\n    }\n    #footer #action {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    #action button {\n      -webkit-font-smoothing: antialiased;\n      border: 1px solid var(--brand_blue);\n      border-radius: 6px;\n      box-sizing: border-box;\n      cursor: pointer;\n      font-family: PingFang SC, HarmonyOS_Regular, Helvetica Neue, Microsoft YaHei, sans-serif !important;\n      font-weight: 400;\n      height: 32px;\n      outline: none;\n      transition: all 0.2s;\n      width: 130px;\n      margin-left: 12px;\n    }\n    #action button#cancel {\n      background-color: var(--bg1);\n      border-color: var(--line_regular);\n      color: var(--text1);\n    }\n    #action button#confirm {\n      background-color: var(--brand_blue);\n      border-color: var(--brand_blue);\n      color: var(--text_white);\n    }\n  "]))),Fu([gn({type:String,attribute:"data-type"})],Vu.prototype,"type",2),Fu([gn({type:String,attribute:"data-oid"})],Vu.prototype,"oid",2),Fu([gn({type:String,attribute:"data-rpid"})],Vu.prototype,"rpid",2),Fu([wn()],Vu.prototype,"maxInputLength",2),Fu([wn()],Vu.prototype,"optionValue",2),Fu([wn()],Vu.prototype,"inputValue",2),Fu([wn()],Vu.prototype,"options",2),Vu=Fu([mn("bili-comment-commercial-order-appeal-form")],Vu);function Hu(t,e){var n=[];if(!0!==t.can_modify)return n;var i=t.up_reply_selection,r=t.up_reply,o=t.up_dm;if(null!=i&&i.can_modify){var a=1===i.status;n.push({key:"select",text:a?"停止评论精选":"开启评论精选",data:{active:!a}})}if(null!=r&&r.can_modify){var s=1===r.status;n.push({key:"close",text:s?"关闭评论":"恢复评论",data:{active:!s}})}if(null!=o&&o.can_modify&&!e){var l=1===o.status;n.push({key:"close-danmaku",text:l?"关闭弹幕":"恢复弹幕",data:{active:!l}})}return n}function Wu(t){var e={customTitle:"登录参与社区互动",hideClose:!1,origin:(null==t?void 0:t.origin)||"comments",spm_id_from:"".concat((null==t?void 0:t.spmPrefix)||hi(),".").concat((null==t?void 0:t.event)||"replyUnknowAction")};return ii(e)}var $u=Object.defineProperty,qu=Object.getOwnPropertyDescriptor,Gu=function(t,e,n,i){for(var r,o=i>1?void 0:i?qu(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&$u(e,n,o),o},Xu=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.spmPrefix="",t.oid="",t.type=0,t.root="",t.user=null,t.assist=!1,t.upMid=0,t.likeCount=0,t.isLike=!1,t.isDislike=!1,t.showMoreMenu=!1,t.options=[],t}return p(e,t),s(e,[{key:"pubDate",get:function(){return function(t){var e=Math.floor((new Date).getTime()/1e3)-t,n=new Date;if(n.setHours(0),n.setMinutes(0),n.setSeconds(0),!(Math.floor(n.getTime()/1e3)<t&&e>=0)){var i=new Date;i.setTime(1e3*t);var r=i.getFullYear(),o=i.getMonth()+1>=10?i.getMonth()+1:"0".concat(i.getMonth()+1),a=i.getDate()>=10?i.getDate():"0".concat(i.getDate()),s=i.getHours()>=10?i.getHours():"0".concat(i.getHours()),l=i.getMinutes()>=10?i.getMinutes():"0".concat(i.getMinutes());return"".concat(r,"-").concat(o,"-").concat(a," ").concat(s,":").concat(l)}if(e<60){var c=10*Math.floor(e%60/10);return c>=10?"".concat(c,"秒前"):"刚刚"}return 60<=e&&e<3600?"".concat(Math.floor(e/60),"分钟前"):e>=3600?"".concat(Math.floor(e/3600),"小时前"):void 0}(this.data.ctime)}},{key:"likeIcon",get:function(){return this.isLike?"BDC/hand_thumbsup_fill/1":"BDC/hand_thumbsup_line/1"}},{key:"dislikeIcon",get:function(){return this.isDislike?"BDC/hand_thumbsdown_fill/2":"BDC/hand_thumbsdown_line/1"}},{key:"trackReport",value:function(t){Tu("click","comment.action.click",{rpid:this.data.rpid_str,action:t},{spmPrefix:this.spmPrefix})}},{key:"handleLikeState",value:(l=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Eu("like"===e?"replyCardLikeClick":"replyCardHateClick",{rpid:this.data.rpid_str}),this.trackReport(e),"like"!==e){t.next=3;break}return!this.isLike&&this.isDislike&&(this.isDislike=!1),this.isLike=!this.isLike,this.likeCount=this.isLike?this.likeCount+1:this.likeCount-1,this.handleTrackClick(this.isLike?5:21),t.abrupt("return");case 3:!this.isDislike&&this.isLike&&(this.isLike=!1,this.likeCount=this.likeCount-1),this.isDislike=!this.isDislike,this.handleTrackClick(this.isDislike?6:22);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"handleTrackClick",value:function(t){this.dispatchEvent(new CustomEvent("track",{detail:t}))}},{key:"connectedCallback",value:function(){u(d(e.prototype),"connectedCallback",this).call(this),this.initData()}},{key:"initData",value:function(){var t=this;this.likeCount=this.data.like,this.isLike=1===this.data.action,this.isDislike=2===this.data.action,this.options=function(t){var e=t.upMid,n=t.reply,i=t.user,r=t.top,o=t.assist,a=t.isBiliPc;if(!e)return console.warn("get comments actions warning: no up mid"),[];var s=[],l=(null==i?void 0:i.mid)===e;l&&"main"===t.ns&&s.push({key:"top",text:r?"取消置顶":"设为置顶",data:{active:!r}});var c=!i||String(i.mid)!==n.member.mid;if(c)if(a||s.push({key:"block",text:"加入黑名单"}),i){var u=i.is_jury,d=i.is_senior_member;u?s.push({key:"report",text:"风纪委举报",data:{hiddenJuryTips:!0}}):s.push({key:"report",text:d?"硬核会员举报":"举报"})}else s.push({key:"report",text:"举报"});return(l||!c||o)&&s.push({key:"delete",text:"删除"}),s}({upMid:this.upMid,reply:this.data,user:this.user,top:this.data.reply_control.is_up_top||!1,ns:this.root?"reply":"main",assist:this.assist}),setTimeout((function(){t.disposables.addEventListener(t.menu,"mouseleave",(function(){t.showMoreMenu=!1}))}))}},{key:"updated",value:function(t){t.get("data")&&this.initData()}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose()}},{key:"handleLike",value:(a=i(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.user){t.next=3;break}return Wu({event:"selfDef.replyCardLikeClick",spmPrefix:this.spmPrefix}),t.abrupt("return");case 3:return t.prev=3,t.next=6,Zc({oid:this.oid,type:this.type,rpid:this.data.rpid,action:this.isLike?0:1});case 6:if(0===t.sent.code){t.next=10;break}return t.abrupt("return");case 10:this.handleLikeState("like"),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),console.error(t.t0);case 16:case"end":return t.stop()}}),t,this,[[3,13]])}))),function(){return a.apply(this,arguments)})},{key:"handleHate",value:(n=i(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.user){t.next=3;break}return Wu({event:"selfDef.replyCardDisikeClick",spmPrefix:this.spmPrefix}),t.abrupt("return");case 3:return t.prev=3,t.next=6,Qc({oid:this.oid,type:this.type,rpid:this.data.rpid,action:this.isDislike?0:1});case 6:if(0===t.sent.code){t.next=10;break}return t.abrupt("return");case 10:this.handleLikeState("dislike"),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),console.error(t.t0);case 16:case"end":return t.stop()}}),t,this,[[3,13]])}))),function(){return n.apply(this,arguments)})},{key:"handleReply",value:function(t){t.stopPropagation(),Eu("replyCardReplyClick",{rpid:this.data.rpid_str}),this.trackReport("reply"),this.dispatchEvent(new CustomEvent("reply")),this.handleTrackClick(28)}},{key:"handleMore",value:function(){Eu("replyCardMoreClick",{rpid:this.data.rpid_str}),this.trackReport("more"),this.showMoreMenu=!0,this.handleTrackClick(8)}},{key:"handleSelectOption",value:function(t){this.trackReport(t.detail.key),this.showMoreMenu=!1,this.user?this.dispatchEvent(new CustomEvent("action",{detail:t.detail})):Wu({event:"selfDef.replyCardOptionClick",spmPrefix:this.spmPrefix})}},{key:"render",value:function(){return qe(Ka||(Ka=g(['\n      <div id="pubdate">','</div>\n      <div id="like">\n        <button @click=','>\n          <bili-icon\n            size="16"\n            icon="','"\n            style="','"\n          ></bili-icon>\n          <span id="count">','</span>\n        </button>\n      </div>\n      <div id="dislike">\n        <button @click=','>\n          <bili-icon\n            size="16"\n            icon="','"\n            style="','"\n          ></bili-icon>\n        </button>\n      </div>\n      <div id="reply">\n        <button @click=','>回复</button>\n      </div>\n      <div id="more">\n        <button @click=','>\n          <bili-icon size="16" icon="BDC/more_vertical_fill/1"></bili-icon>\n        </button>\n        <bili-comment-menu\n          style="','"\n          .options=',"\n          @select=","\n        ></bili-comment-menu>\n      </div>\n    "])),this.pubDate,this.handleLike,this.likeIcon,this.isLike?Gn({color:"var(--brand_blue)"}):"",this.likeCount>0?this.likeCount:"",this.handleHate,this.dislikeIcon,this.isDislike?Gn({color:"var(--brand_blue)"}):"",this.handleReply,this.handleMore,this.showMoreMenu?Gn({"--bili-comment-menu-display":"block"}):"",this.options,this.handleSelectOption)}}]);var n,a,l}(fn);Xu.styles=ve(Ja||(Ja=g(["\n    :host {\n      width: 100%;\n      display: flex;\n      align-items: center;\n      position: relative;\n      margin-top: 3px;\n      font-size: 13px;\n      color: var(--text3);\n    }\n    :host > *:not(:first-child) {\n      margin-left: 20px;\n    }\n\n    button {\n      padding: 0;\n      outline: none;\n      border: none;\n      background: transparent;\n      height: 24px;\n      font-size: 13px;\n      color: var(--text3);\n      display: inline-flex;\n      align-items: center;\n      cursor: pointer;\n    }\n    button:hover {\n      color: var(--brand_blue);\n    }\n    button span {\n      margin-left: 5px;\n      display: inline-block;\n    }\n    button bili-icon {\n      vertical-align: middle;\n    }\n\n    #more {\n      margin-left: auto;\n      margin-right: 20px;\n      width: 24px;\n      height: 24px;\n      position: relative;\n    }\n    #more button {\n      width: 24px;\n      height: 24px;\n      text-align: center;\n      display: var(--bili-comment-action-buttons-more-display, none);\n    }\n  "]))),Gu([gn({type:String})],Xu.prototype,"spmPrefix",2),Gu([gn()],Xu.prototype,"data",2),Gu([gn()],Xu.prototype,"oid",2),Gu([gn()],Xu.prototype,"type",2),Gu([gn()],Xu.prototype,"root",2),Gu([gn()],Xu.prototype,"user",2),Gu([gn()],Xu.prototype,"assist",2),Gu([gn()],Xu.prototype,"upMid",2),Gu([wn()],Xu.prototype,"pubDate",1),Gu([wn()],Xu.prototype,"likeCount",2),Gu([wn()],Xu.prototype,"isLike",2),Gu([wn()],Xu.prototype,"isDislike",2),Gu([wn()],Xu.prototype,"showMoreMenu",2),Gu([wn()],Xu.prototype,"likeIcon",1),Gu([wn()],Xu.prototype,"options",2),Gu([_n("bili-comment-menu")],Xu.prototype,"menu",2),Xu=Gu([mn("bili-comment-action-buttons-renderer")],Xu);var Yu=function(t){var e,n=v({},t);return null!=(e=t.pictures)&&e.length&&(n.pictures=JSON.stringify(t.pictures)),t.has_vote_option&&(n.has_vote_option="true"),Gc.request({method:"POST",url:"/x/v2/reply/add",data:v(v({},n),{},{gaia_source:"main_web"}),chainProxy:function(t){return t.with("UNIOS_RISK_USER_LOG",{active:!0}).with(Yc).with("UNIOS_WBI_ENCODE",{active:!0})},headers:{"Content-Type":"application/x-www-form-urlencoded"}})};function Zu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qu(t,e){return Qu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Qu(t,e)}function Ku(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qu(t,e)}function Ju(t){return Ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ju(t)}function td(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(td=function(){return!!t})()}function ed(t){return ed="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(t)}function nd(t){var e=td();return function(){var n,i=Ju(t);if(e){var r=Ju(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){if(e&&("object"===ed(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Zu(t)}(this,n)}}function id(t){var e=function(t,e){if("object"!=ed(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=ed(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ed(e)?e:String(e)}function rd(t,e,n){return(e=id(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function od(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,id(i.key),i)}}function ad(t,e,n){return e&&od(t.prototype,e),n&&od(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function sd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var ld=ad((function t(){sd(this,t)})),cd="widget-layer-avatar",ud=function(t){Ku(n,t);var e=nd(n);function n(){var t;sd(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return rd(Zu(t=e.call.apply(e,[this].concat(r))),"pos",{axis_x:1,axis_y:1,coordinate_pos:0}),rd(Zu(t),"size",{height:1,width:1}),rd(Zu(t),"render",{opacity:1}),t}return ad(n,[{key:"setPos",value:function(t,e,n){return this.pos={axis_x:t,axis_y:e,coordinate_pos:n},this}},{key:"setSize",value:function(t,e){return this.size={height:e,width:t},this}},{key:"getValue",value:function(){return{pos_spec:this.pos,size_spec:this.size,render_spec:this.render}}}]),n}(ld),dd=function(t){Ku(n,t);var e=nd(n);function n(){var t;sd(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return rd(Zu(t=e.call.apply(e,[this].concat(r))),"tags",{}),rd(Zu(t),"isCritical",!1),rd(Zu(t),"allowOverPaint",!1),rd(Zu(t),"mask",null),t}return ad(n,[{key:"setIsCritical",value:function(){return this.isCritical=!0,this}},{key:"setTag",value:function(t,e){return this.tags[t]=e,this}},{key:"getTag",value:function(t){return this.tags[t]}},{key:"setMask",value:function(t){return this.mask=t,this}},{key:"getValue",value:function(){return{tags:this.tags,is_critical:this.isCritical,allow_over_paint:this.allowOverPaint,layer_mask:this.mask}}}]),n}(ld),pd=function(t){Ku(n,t);var e=nd(n);function n(){var t;sd(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return rd(Zu(t=e.call.apply(e,[this].concat(r))),"type",3),rd(Zu(t),"image",void 0),rd(Zu(t),"animation",void 0),rd(Zu(t),"nativeDraw",void 0),t}return ad(n,[{key:"setImage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return this.type=3,this.image=e?{image_src:{src_type:1,remote:{url:e,bfs_style:cd},placeholder:t}}:{image_src:{src_type:2,local:t,placeholder:t}},this}},{key:"setAnimation",value:function(t,e){return this.type=4,this.animation={webp_src:{src_type:1,remote:{url:t,bfs_style:cd},placeholder:e}},this}},{key:"setNativeDraw",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff";return this.type=5,this.nativeDraw={draw_src:{src_type:3,placeholder:0,draw:{draw_type:t,fill_mode:null!=e?e:0,color_config:{day:{argb:n},is_dark_mode_aware:!1,night:{argb:n}},edge_weight:0}}},this}},{key:"getValue",value:function(){switch(this.type){case 3:return{res_type:this.type,res_image:this.image};case 4:return{res_type:this.type,res_animation:this.animation};case 5:return{res_type:this.type,res_native_draw:this.nativeDraw};default:return{res_type:this.type}}}}]),n}(ld),hd=function(t){Ku(n,t);var e=nd(n);function n(){var t;sd(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return rd(Zu(t=e.call.apply(e,[this].concat(r))),"spec",new ud),rd(Zu(t),"config",new dd),rd(Zu(t),"resource",new pd),t}return ad(n,[{key:"getConfigTag",value:function(t){return this.config.getTag(t)}},{key:"getValue",value:function(){return{layer_id:"",visible:!0,general_spec:this.spec.getValue(),layer_config:this.config.getValue(),resource:this.resource.getValue()}}}]),n}(ld),fd=function(t){Ku(n,t);var e=nd(n);function n(){var t;sd(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return rd(Zu(t=e.call.apply(e,[this].concat(r))),"layers",[]),rd(Zu(t),"mask",null),rd(Zu(t),"isCritical",!1),t}return ad(n,[{key:"setMask",value:function(t){return this.mask=t,this}},{key:"addLayer",value:function(t){return this.layers.push(t),this}},{key:"setIsCritical",value:function(){return this.isCritical=!0,this}},{key:"getValue",value:function(){return{group_id:"",layers:this.layers.map((function(t){return t.getValue()})),group_mask:this.mask,is_critical_group:this.isCritical}}}]),n}(ld),vd=function(t){return"string"==typeof t?t:t.image||""},md=function(){var t=new hd;return t.config.setIsCritical().setTag("PENDENT_LAYER",{config_type:0}).setTag("GENERAL_CFG",{config_type:1,general_config:{web_css_style:{borderRadius:"50%"}}}),t},bd=function(){var t=new hd;return t.config.setTag("ICON_LAYER",{config_type:0}).setTag("GENERAL_CFG",{config_type:1,general_config:{web_css_style:{"background-color":"rgb(255,255,255)",border:"2px solid rgba(255,255,255,1)",borderRadius:"50%",boxSizing:"border-box"}}}),t},yd=function(t,e){var n,i=new fd,r=t.face,o=t.pendant,a=t.official,s=t.vip,l=t.nft,c=null!==(n=t.a)&&void 0!==n?n:48,u=function(t){var e=new hd;return e.config.setIsCritical().setTag("AVATAR_LAYER",{config_type:0}).setTag("GENERAL_CFG",{config_type:1,general_config:{web_css_style:{borderRadius:"50%"}}}),e.resource.setImage(6,t),e}(r),d=1,p=null,h=o?vd(o):"";h&&(p=md()).resource.setImage(0,h);var f=[];l&&[1,2].includes(l)?(f.push(function(t){var e=bd();return e.resource.setAnimation(1===t?"https://i0.hdslb.com/bfs/activity-plat/static/20220506/334553dd7c506a92b88eaf4d59ac8b4d/j8AeXAkEul.gif":"https://i0.hdslb.com/bfs/activity-plat/static/20220506/334553dd7c506a92b88eaf4d59ac8b4d/IOHoVs1ebP.gif",5),e}(l)),p?(p.spec.setSize(e,e).setPos(e/2,e/2,2),d=.94,u.spec.setSize(d,d).setPos(e/2,e/2,2)):(d=c>48?1.2:1.3,u.spec.setSize(d,d).setPos(e/2,e/2,2))):p?(p.spec.setPos(.6875,.6875,2).setSize(1.375,1.375),d=.787,u.spec.setSize(d,d).setPos(.6875,.6875,2)):u.spec.setSize(1,1).setPos(.675,.675,2);var v=function(t){var e=-1;return t&&(e="number"==typeof t?t:t.type),e}(a),m=function(t){if(!t)return!1;if(!0===t)return!0;if("string"==typeof t)return t;var e=t.type,n=t.status,i=t.avatar_subscript_url;return e>0&&1===n&&(i||!0)}(s);if(-1!==v?f.push(function(t){var e=bd();return e.resource.setImage(0===t?3:4),e}(v)):m&&f.push(function(t){var e=bd();return e.resource.setImage(1,t),e}("string"==typeof m?m:"")),i.addLayer(u),p&&i.addLayer(p),f.length){var b=function(t,e,n){switch(t){case 64:case 80:return(16+2*e)/t;default:return((1===n?16:14)+2*e)/t}}(c,2,f.length),y=(b*c-2)/c,g=e/2+d/2-y,w=g;p&&(g+=1/15,w+=.05),f.slice(0,2).reverse().forEach((function(t,e){t.spec.setSize(b,b).setPos(w-e*y,g,1),i.addLayer(t)}))}return i},gd=function(t){var e=function(t){var e,n=null!==(e=t.a)&&void 0!==e?e:48,i=t.pendant?vd(t.pendant):"";return 80===n?t.nft?i?1.8:1.65:1.5:t.nft?i?1.65:1.5:i?1.375:1.35}(t),n=yd(t,e),i={container_size:{width:e,height:e},fallback_layers:n.getValue(),mid:t.mid},r=function(t,e){var n=t.pendant;if(!n||"string"==typeof n||!n.image_enhance)return[];md().resource.setAnimation(n.image_enhance,0);var i=[];return e.layers.forEach((function(t){var e=new fd;t.getConfigTag("PENDENT_LAYER")&&t.resource.setAnimation(n.image_enhance,0),e.addLayer(t),i.push(e)})),i.map((function(t){return t.getValue()}))}(t,n);return r.length&&(i.layers=r),i},wd=function(t){var e=t.lastIndexOf("@");if(-1===e)return null;var n=t.substring(e+1);return n.length<=16&&!/\s/.test(n)?n:null},xd=!1,kd=null;("undefined"==typeof window?"undefined":k(window))<"u"&&(xd="IntersectionObserver"in window);var _d=function(t){t.forEach((function(t){var e=function(t){return t.__i18r_callback__}(t.target);"function"==typeof e&&e(t)}))},Ad={start:"start_time",end:"end_time",duration:"duration"},Ed=function(){return s((function t(e){o(this,t),this.isIntersecting=!1,this.showFinished=!1,this.showSupport=xd,this.showDurational=!1,this.showDurationConfig=Ad,this.showDurationStart=0,this.type=e.type,this.el=e.el,this.handler=e.handler,this.value=e.value,this.modifiers=e.modifiers||{},e.durational&&(this.showDurational=!0,"object"==k(e.durational)&&(this.showDurationConfig=e.durational)),this.init()}),[{key:"observeShow",value:function(t,e){kd||(kd=new IntersectionObserver(_d)),function(t,e){t.__i18r_callback__=e}(t,e),kd.observe(t)}},{key:"unobserveShow",value:function(t){this.showFinished=!0,kd&&(kd.unobserve(t),function(t){delete t.__i18r_callback__}(t))}},{key:"observeClick",value:function(t,e){t.addEventListener("click",e)}},{key:"unobserveClick",value:function(t,e){t.removeEventListener("click",e)}},{key:"report",value:function(t){var e=this.value.event,n=v({},this.value.data),i=this.modifiers.raw,r=!1;"both"===this.type&&i&&console.warn("show and click event use raw will be same"),this.showDurational&&["tech","show"].includes(t)&&(this.showDurationStart?(Object.assign(n,c(c({},this.showDurationConfig.end||Ad.end,Date.now()),this.showDurationConfig.duration||Ad.duration,Date.now()-this.showDurationStart)),this.showDurationConfig.repeat&&(this.showDurationStart=0),this.showDurationConfig.endEvent?e=this.showDurationConfig.endEvent:(e=e.replace(".all",".end"),this.showDurationStart=0),this.showDurationConfig.beforeunload&&(r=!0)):(this.showDurationStart=Date.now(),delete n[this.showDurationConfig.end||Ad.end],delete n[this.showDurationConfig.duration||Ad.duration],Object.assign(n,c({},this.showDurationConfig.start||Ad.start,this.showDurationStart)))),this.handler(t,i?e:"".concat(e,".").concat(t),n,{flush:r})}},{key:"reportShowDuration",value:function(t){if(this.showDurational&&!this.showFinished){if(t){if(!this.isIntersecting||0!==this.showDurationStart)return;return void this.report("show")}0!==this.showDurationStart&&(this.report("show"),this.showDurationConfig.repeat||(this.showFinished=!0))}}},{key:"init",value:function(){var t=this;if(this.el){var e=this.el,n=[];if("click"===this.type||"both"===this.type){var i=function(){t.report(t.modifiers.tech?"tech":"click")};n.push((function(){t.unobserveClick(e,i)})),this.observeClick(e,i)}if("show"===this.type||"both"===this.type)if(this.showSupport){n.push((function(){t.showFinished||(t.showDurational&&t.showDurationStart&&t.report(t.modifiers.tech?"tech":"show"),t.unobserveShow(e))}));var r=function(){};if(this.showDurationConfig.beforeunload){var o=!1,a=function(){t.showFinished||(t.showDurationStart&&t.report(t.modifiers.tech?"tech":"show"),t.unobserveShow(e))};window.addEventListener("beforeunload",a),window.addEventListener("pagehide",a),r=function(){o||(o=!0,window.removeEventListener("beforeunload",a),window.removeEventListener("pagehide",a))},n.push(r)}this.observeShow(e,(function(n){if(t.isIntersecting=n.isIntersecting,t.showDurational)if(n.isIntersecting){if(t.showDurationStart)return;t.report(t.modifiers.tech?"tech":"show")}else{if(!t.showDurationStart||(t.report(t.modifiers.tech?"tech":"show"),t.showDurationConfig.repeat))return;t.showDurationConfig.beforeunload&&r(),t.unobserveShow(e)}else n.isIntersecting&&(t.report(t.modifiers.tech?"tech":"show"),t.unobserveShow(e))}))}else console.warn("IntersectionObserver not supported");this.removeListener=function(){n.forEach((function(t){t()}))}}}},{key:"update",value:function(t){this.value=t}},{key:"dispose",value:function(){var t;null==(t=this.removeListener)||t.call(this),this.el=null}}])}();function Cd(t){var e=document.createElement("bili-modal");document.body.appendChild(e),e.show(v(v({},t),{},{final:function(){var n;null==(n=t.final)||n.call(t),document.body.removeChild(e)}}))}function Td(t){return new Promise((function(e,n){var r=v({},t),o=!1===t.confirm,a=!1===t.cancel;if(o&&a)return n("Not allow confirm and cancel both false");function s(n){var o,a,s,l="confirm"===n,c=null!==(o=t[n])&&void 0!==o?o:l?"确定":"取消";if("function"==typeof c)r[n]=function(){var t=i(m().mark((function t(n){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0="function"==typeof c,!t.t0){t.next=4;break}return t.next=4,c(n);case 4:e(l);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();else if("string"==typeof c)r[n]={text:c,click:(s=i(m().mark((function t(n){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n();case 2:e(l);case 3:case"end":return t.stop()}}),t)}))),function(t){return s.apply(this,arguments)})};else{var u=c;r[n]={text:u.text||("confirm"===n?"确定":"取消"),click:(a=i(m().mark((function t(n){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.click(n);case 2:e(l);case 3:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})}}}o||a?t.final=function(){return e(o)}:(s("confirm"),s("cancel")),Cd(r)}))}var Sd="//www.bilibili.com",Od="//space.bilibili.com",Pd="//search.bilibili.com",Id="//bangumi.bilibili.com",Rd="//t.bilibili.com",jd="//live.bilibili.com",Ld=function(t){return/https?:/.test(t)?t:(t.startsWith("//")||(t="//".concat(t)),"".concat(location.protocol).concat(t))},Md=function(t,e){var n=new URL(Ld(t));return Object.keys(e).forEach((function(t){n.searchParams.has(t)&&n.searchParams.delete(t),n.searchParams.append(t,encodeURIComponent(e[t]))})),n.toJSON()},Dd={DYN:function(t){return"".concat(Rd,"/").concat(t)},SPACE:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"".concat(Od,"/").concat(t).concat(e)},VIDEO:function(t){var e=t.bvid,n=t.avid,i=t.ssid,r=t.epid;return e?"".concat(Sd,"/video/").concat(e,"/"):n?"".concat(Sd,"/video/av").concat(n,"/"):i?"".concat(Sd,"/bangumi/play/ss").concat(i):r?"".concat(Sd,"/bangumi/play/ep").concat(i):""},ARTICLE:function(t){return"".concat(Sd,"/read/cv").concat(t,"/")},PGC:function(t){return"".concat(Id,"/anime/").concat(t)},LIVE:function(t){return"".concat(jd,"/").concat(t)},SEARCH:function(t){return Md("".concat(Pd,"/all"),{keyword:t})},LOTTERY:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i="".concat(Rd,"/lottery/h5/index/#/result");return n&&(i="".concat(Sd,"/h5/lottery/result")),Md(i,{business_type:String(t),business_id:String(e),isWeb:"1"})},VOTE:function(t,e){return e||(e="comment"),"//t.bilibili.com/h5/dynamic/vote/#/result?vote_id=".concat(t,"&from=").concat(e,"&isWeb=1")}};function Nd(t){return Object.keys(t).map((function(e){return"".concat(e,":").concat(t[e])})).join(";")}function Bd(t,e){return function(t,e,n){var i=[];return e&&Object.keys(e).forEach((function(t){void 0!==e[t]&&i.push("".concat(t,'="').concat(e[t],'"'))})),"<".concat(t).concat(i.length?" ".concat(i.join(" ")):"",">").concat(n?Array.isArray(n)?n.join(""):n:"","</").concat(t,">")}("iframe",{src:t,style:e||""})}function zd(t){var e,n=document.createElement("bili-comments-popup");if(t.mask&&(n.setAttribute("mask",""),!1!==t.maskClosable&&n.setAttribute("maskClosable","")),n.style.zIndex=(null!==(e=t.zIndex)&&void 0!==e?e:jn()+1e3).toString(),t.title&&n.setAttribute("title",t.title),t.width){var i="";i="number"==typeof t.width?"".concat(t.width,"px"):t.width,n.setAttribute("width",i)}t.transparent&&n.setAttribute("transparent","true");var r=t.render();return"string"==typeof r?n.innerHTML=r:n.appendChild(r),document.body.appendChild(n),n}function Ud(t){return zd({title:"投票详情",width:550,render:function(){return Bd(Dd.VOTE(t),Nd({"min-height":"550px"}))},mask:!0})}function Fd(t){var e,n,i,r,o=document.createElement("bili-comment-report-form");o.dataset.type=String(t.type),o.dataset.oid=t.oid,o.dataset.rpid=t.rpid,o.dataset.mid=null!==(e=null==(i=t.member)?void 0:i.mid)&&void 0!==e?e:"",o.dataset.uname=null!==(n=null==(r=t.member)?void 0:r.uname)&&void 0!==n?n:"",o.dataset.ordering=t.ordering;var a=zd({title:"请选择举报理由",width:520,mask:!0,maskClosable:!0,render:function(){return o}});o.addEventListener("hide",(function(){a.parentElement&&a.parentElement.removeChild(a)}))}function Vd(){var t=document.createElement("bili-comment-update-uname-form"),e=zd({title:"设置昵称",width:380,mask:!0,maskClosable:!0,render:function(){return t}});t.addEventListener("hide",(function(){e.parentElement&&e.parentElement.removeChild(e)}))}function Hd(t){var e=document.createElement("bili-comment-commercial-order-appeal-form");e.dataset.type=String(t.type),e.dataset.oid=String(t.oid),e.dataset.rpid=t.rpid;var n=zd({title:"申请撤销推广置顶",width:520,mask:!0,maskClosable:!0,render:function(){return e}});e.addEventListener("hide",(function(){n.parentElement&&n.parentElement.removeChild(n)}))}var Wd=function(){return s((function t(){o(this,t),this.target=null,this.events={}}),[{key:"addEventListener",value:function(t,e){("undefined"==typeof window?"undefined":k(window))>"u"?console.warn("EventBridge is not supported in server side"):(this.events[t]?this.events[t].push(e):this.events[t]=[e],this.target&&this.target.addEventListener(t,e))}},{key:"removeEventListener",value:function(t,e){if(("undefined"==typeof window?"undefined":k(window))>"u")console.warn("EventBridge is not supported in server side");else if(this.target&&this.target.removeEventListener(t,e),this.events[t].length){var n=this.events[t];this.events[t]=n.filter((function(t){return t!==e}))}}},{key:"connect",value:function(t){var e=this;this.target||t&&(this.target=t,Object.keys(this.events).forEach((function(n){e.events[n].forEach((function(e){t.addEventListener(n,e)}))})))}},{key:"disconnect",value:function(){var t=this;if(this.target){var e=this.target;Object.keys(this.events).forEach((function(n){t.events[n].forEach((function(t){e.removeEventListener(n,t)}))}))}this.events={},this.target=null}}])}(),$d=function(){return s((function t(e){o(this,t),this.el={current:null},this.parent=null,this.props={},this.methods={},this.emits=[],this.dispose=null,this.eventBridge=new Wd,e&&(this.props=e)}),[{key:"engine",get:function(){return{core:"custom"}}},{key:"addEventListener",value:function(t,e){!this.emits.length||this.emits.includes(t)?this.eventBridge.addEventListener(t,e):console.warn("Event ".concat(String(t)," is not defined in emits"))}},{key:"removeEventListener",value:function(t,e){this.eventBridge.removeEventListener(t,e)}},{key:"dispatchAction",value:function(t){var e,n=t.type,i=t.args,r=t.callback,o=null==(e=this.methods)?void 0:e[n];if("function"==typeof o){var a=o.apply(void 0,w(i||[]));return null==r||r(a),a}console.warn("Action ".concat(String(n)," is undefined or not a function"))}},{key:"renderToString",value:function(){return""}},{key:"renderAsync",value:function(){var t=this;return new Promise((function(e){try{t.render(),e(!0)}catch(t){e(!1)}}))}},{key:"update",value:function(t){var e=!!this.el.current,n=this.parent;return e&&this.unmount(),this.props=t,e&&(this.parent=n,this.render()),this}},{key:"mount",value:function(t,e){return this.el.current?(console.warn("Component is already mounted"),this):this.parent?(t===this.parent||console.warn("Component maybe in mounting, please wait mounted, and then use update or unmount first"),this):(this.parent=t,e?this.renderAsync():this.render(),this)}},{key:"unmount",value:function(){var t;if(null==(t=this.dispose)||t.call(this),this.eventBridge.disconnect(),this.props={},this.methods={},this.el.current){var e=this.parent||this.el.current.parentElement;e!==this.el.current&&null!=e&&e.contains(this.el.current)&&(e.removeChild(this.el.current),this.parent=null),this.el.current=null}}}])}();function qd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Gd(t,e,n){return e=tp(e),function(t,e){if(e&&("object"==k(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,np()?Reflect.construct(e,n||[],tp(t).constructor):e.apply(t,n))}function Xd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,rp(i.key),i)}}function Zd(t,e,n){return e&&Yd(t.prototype,e),n&&Yd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qd(t,e){var n=("undefined"==typeof Symbol?"undefined":k(Symbol))<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return qd(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qd(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Kd(t,e,n){return(e=rp(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jd(){return Jd=("undefined"==typeof Reflect?"undefined":k(Reflect))<"u"&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=tp(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},Jd.apply(null,arguments)}function tp(t){return tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tp(t)}function ep(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ip(t,e)}function np(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(np=function(){return!!t})()}function ip(t,e){return ip=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ip(t,e)}function rp(t){var e=function(t,e){if("object"!=k(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=k(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==k(e)?e:e+""}function op(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)}var ap=function(){function t(){Xd(this,t),this.disposables=[]}return Zd(t,[{key:"addEventListener",value:function(t,e,n,i){return this.add(function(t,e,n,i){return t.addEventListener(e,n,i),function(){!function(t,e,n,i){t.removeEventListener(e,n,i)}(t,e,n,i)}}(t,e,n,i))}},{key:"mutationObserve",value:function(t,e,n){var i=!1,r=new MutationObserver(e);return r.observe(t,n),function(){i||(i=!0,r.disconnect())}}},{key:"requestAnimationFrame",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=requestAnimationFrame.apply(void 0,arguments);return this.add((function(){return cancelAnimationFrame(t)}))}))},{key:"nextFrame",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.requestAnimationFrame((function(){return t.requestAnimationFrame.apply(t,n)}))}},{key:"setTimeout",value:function(t,e){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];var a=(n=window).setTimeout.apply(n,[t,e].concat(r));return this.add((function(){return clearTimeout(a)}))}},{key:"microTask",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i,r={current:!0};return i=function(){r.current&&e[0]()},"function"==typeof queueMicrotask?queueMicrotask(i):Promise.resolve().then(i).catch((function(t){return setTimeout((function(){throw t}))})),this.add((function(){r.current=!1}))}},{key:"style",value:function(t,e,n){var i=t.style.getPropertyValue(e);return Object.assign(t.style,Kd({},e,n)),this.add((function(){Object.assign(t.style,Kd({},e,i))}))}},{key:"group",value:function(e){var n=new t;return e(n),this.add((function(){return n.dispose()}))}},{key:"add",value:function(t){var e=this;return this.disposables.push(t),function(){var n=e.disposables.indexOf(t);n>=0&&e.remove(n,1)}}},{key:"remove",value:function(t,e){var n,i=Qd(this.disposables.splice(t,null!=e?e:this.disposables.length));try{for(i.s();!(n=i.n()).done;)(0,n.value)()}catch(t){i.e(t)}finally{i.f()}}},{key:"dispose",value:function(){this.remove(0)}}])}();function sp(){return new ap}var lp=Zd((function t(){Xd(this,t)}));lp.nodeName="",lp.attributes=[],lp.create=function(t,e){if("#text"===t)return document.createTextNode(e.raw);var n=document.createElement(t),i=e.attributes;i&&Object.keys(i).forEach((function(t){var e=i[t];e&&n.setAttribute(t,e)}));var r=e.data;return r&&Object.keys(r).forEach((function(t){var e=r[t];e&&n.setAttribute("data-".concat(t),e)})),n},lp.from=function(t){return console.warn("RichNode.from is not implemented",t),null};var cp={TEXT:"text",IMG:"img",BREAK:"break",HIGHLIGHT:"highlight",LINK:"link"},up=function(){function t(e){var n;return Xd(this,t),(n=Gd(this,t)).raw=e,n}return ep(t,lp),Zd(t,[{key:"block",get:function(){return!1}},{key:"rawValue",get:function(){return(this.raw.nodeValue||"").replace(new RegExp("​","g"),"")}},{key:"length",get:function(){return this.rawValue.length}},{key:"getValue",value:function(){return{type:cp.TEXT,raw:this.rawValue}}}],[{key:"create",value:function(t){return document.createTextNode(t)}}])}();up.nodeName="#text",up.from=function(t){return t.type!==cp.TEXT?null:up.create(t.raw)};var dp=function(){function t(e){var n;return Xd(this,t),(n=Gd(this,t)).raw=e,n}return ep(t,lp),Zd(t,[{key:"block",get:function(){return!0}},{key:"rawValue",get:function(){return this.raw.textContent||""}},{key:"length",get:function(){return this.rawValue.length}},{key:"getValue",value:function(){var t=Array.from(this.raw.classList),e={};return t.length&&(e.class=t[0]),{type:cp.HIGHLIGHT,raw:this.rawValue,attributes:e,data:JSON.parse(JSON.stringify(this.raw.dataset))}}}])}();dp.nodeName="SPAN",dp.attributes=["class"],dp.className="brt-hl",dp.from=function(t){if(t.type!==cp.HIGHLIGHT)return null;var e=lp.create(dp.nodeName,t);return e.setAttribute("contenteditable","false"),e.classList.add(dp.className),e.textContent=t.raw,e},dp.match=function(t){return t.nodeName===dp.nodeName&&t.classList.contains(dp.className)};var pp=function(){function t(e){var n;return Xd(this,t),(n=Gd(this,t)).raw=e,n}return ep(t,lp),Zd(t,[{key:"block",get:function(){return!0}},{key:"rawValue",get:function(){return this.raw.getAttribute("alt")||""}},{key:"length",get:function(){return this.rawValue.length}},{key:"getValue",value:function(){return{type:cp.IMG,raw:this.rawValue,attributes:{src:this.raw.src,alt:this.raw.alt,width:this.raw.width.toString(),height:this.raw.height.toString()}}}}])}();pp.nodeName="IMG",pp.attributes=["src","alt","width","height"],pp.from=function(t){return t.type!==cp.IMG?null:t.attributes?pp.create(pp.nodeName,t):null};var hp=function(){function t(e){var n;return Xd(this,t),(n=Gd(this,t)).raw=e,n}return ep(t,lp),Zd(t,[{key:"block",get:function(){return!0}},{key:"rawValue",get:function(){return this.raw.getAttribute("href")||""}},{key:"length",get:function(){return this.rawValue.length}},{key:"getValue",value:function(){return{type:cp.LINK,raw:this.rawValue,data:JSON.parse(JSON.stringify(this.raw.dataset))}}}])}();hp.nodeName="A",hp.attributes=["href"],hp.from=function(t){if(t.type!==cp.LINK)return null;var e=lp.create(hp.nodeName,t);return e.setAttribute("contenteditable","false"),e.setAttribute("target","_blank"),e.textContent=t.raw,e};var fp=function(){function t(e){var n;return Xd(this,t),(n=Gd(this,t)).raw=e,n}return ep(t,lp),Zd(t,[{key:"block",get:function(){return!0}},{key:"rawValue",get:function(){return t.value.raw}},{key:"length",get:function(){return this.rawValue.length}},{key:"getValue",value:function(){return t.value}}])}();fp.nodeName="BR",fp.from=function(t){return t.type!==cp.BREAK?null:lp.create(fp.nodeName,t)},fp.value={type:cp.BREAK,raw:"\n"};var vp,mp,bp,yp,gp,wp,xp,kp,_p,Ap,Ep,Cp,Tp,Sp,Op,Pp,Ip,Rp,jp,Lp,Mp,Dp,Np=function(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(var r=0,o=n;r<o.length;r++){var a=o[r];if(t[a]!==e[a])return!1}return!0},Bp=function(t){return t.nodeType===Node.TEXT_NODE},zp=function(t){if(Bp(t))return new up(t);if("SPAN"===t.nodeName)return dp.match(t)?new dp(t):new up(up.create(t.textContent||""));switch(t.nodeName){case up.nodeName:return new up(t);case pp.nodeName:return new pp(t);case hp.nodeName:return new hp(t);case fp.nodeName:return new fp(t);default:return null}},Up=function(t){if(!t)return window.getSelection();var e=t.getRootNode();return e?e===document?window.getSelection():e.getSelection():window.getSelection()},Fp=function(t,e){var n=[],i=e.start,r=e.end,o=t.textContent||"",a=o.slice(0,i),s=o.slice(r);if(o.slice(i,r).length!==o.length)if(a){if(t.textContent=a,n.push(t),s){var l=document.createTextNode(s);n.push(l)}}else t.textContent=s,n.push(t);return n},Vp=function(t,e){var n=Array.from(t.childNodes),i=e.startOffset,r=i,o=e.endOffset,a=o;if(Bp(e.startContainer)){var s=e.startContainer;r=n.indexOf(s)}else i=0;if(Bp(e.endContainer)){var l=e.endContainer;a=n.indexOf(l)}else o=0;return{startIndex:r,startOffset:i,endIndex:a,endOffset:o,collapsed:e.collapsed}},Hp=function(t,e){var n=Array.from(t.childNodes),i=e.startIndex,r=e.endIndex,o=e.collapsed,a=e.startOffset,s=e.endOffset,l=t,c=t,u=n[i],d=n[r];return u&&Bp(u)?l=u:a=i,d&&Bp(d)?c=d:s=r,{startContainer:l,endContainer:c,startOffset:a,endOffset:s,collapsed:o}},Wp=function(t,e){var n=[];return t.forEach((function(t){var i=t.type;if(e){var r=e.get(t.type);if(r){var o=r.from(t);return void(o&&n.push(o))}}if(i!==cp.BREAK)if(i!==cp.TEXT)if(i!==cp.HIGHLIGHT)if(i!==cp.IMG){if(i===cp.LINK){var a=hp.from(t);a&&n.push(a)}}else{var s=pp.from(t);s&&n.push(s)}else{var l=dp.from(t);l&&n.push(l)}else{var c=up.from(t);c&&n.push(c)}else{var u=fp.from(t);u&&n.push(u)}})),n},$p=Zd((function t(e){var n=this;if(Xd(this,t),this.disposables=sp(),"TEXTAREA"!==e.tagName&&null===e.getAttribute("contenteditable"))throw new Error("TextareaAutoSize can only be used on textarea elements");this.element=e,this.verticalBorderSize=this.getStyleProp("borderTopWidth")+this.getStyleProp("borderBottomWidth")||0,this.disposables.addEventListener(this.element,"input",(function(){n.update()})),this.update()}),[{key:"destroy",value:function(){this.disposables.dispose(),this.element=null}},{key:"update",value:function(){var t=this.getStyleProp("fontSize");this.element.style.height="".concat(t,"px");var e=this.element.scrollHeight+this.verticalBorderSize;this.element.style.height="".concat(e,"px")}},{key:"getStyleProp",value:function(t){var e=getComputedStyle(this.element,null);return parseInt(e[t])}}]),qp=Zd((function t(e){Xd(this,t),this.stack=[],this.index=-1,this.editor=e.editor,this.depth=e.depth||50}),[{key:"isLatest",value:function(){return-1===this.index||this.index===this.stack.length-1}},{key:"reset",value:function(){this.stack=[],this.index=-1}},{key:"record",value:function(t,e){this.isLatest()||this.stack.splice(this.index,this.stack.length-this.index);var n=e?Vp(this.editor,e):null;this.stack.push({value:t,range:n}),this.stack.length>this.depth&&this.stack.shift(),this.index=this.stack.length-1}},{key:"undo",value:function(){if(0!==this.index)return this.index--,this.stack[this.index]}},{key:"redo",value:function(){if(!(this.index<0)&&this.index!==this.stack.length-1)return this.index++,this.stack[this.index]}}]),Gp=function(t,e){return e===t.key&&(t.ctrlKey||t.metaKey)},Xp=function(){function t(){var e;return Xd(this,t),e=Gd(this,t,arguments),vp.add(e),e.disposables=sp(),e.autosize=null,e.history=null,e.historyRecording=!1,e.historyRecordTimer=null,e.isFoused=!1,e.range=null,e.content={nodes:[]},e.contentValue={raw:"",nodes:[]},e}return ep(t,$d),Zd(t,[{key:"update",value:function(e){var n,i,r;return this.el.current?op(this,vp,"m",Dp).call(this,e):(n=t,i=this,r=Jd(tp(1&3?n.prototype:n),"update",i),function(t){return r.apply(i,t)})([e]),this}},{key:"render",value:function(){var t,e=this;if(this.parent){var n=document.createElement("div");n.innerHTML=this.renderToString();var i=n.firstChild;this.el.current=i,this.placeholder=i.querySelector(".".concat(op(this,vp,"m",mp).call(this,"placeholder"))),op(this,vp,"m",Mp).call(this),this.eventBridge.connect(i);var r=this.editor;this.methods={focus:op(this,vp,"m",Ep).bind(this),blur:op(this,vp,"m",Cp).bind(this),setContent:function(t){op(e,vp,"m",Ap).call(e,t);var n=op(e,vp,"m",Op).call(e,r);op(e,vp,"m",Ip).call(e,n),setTimeout((function(){var t;null===(t=e.autosize)||void 0===t||t.update()}))},insertNodes:function(t,n){var i;n&&(i=Hp(r,n)),op(e,vp,"m",Pp).call(e,t,i)}},this.parent.appendChild(this.el.current),this.dispose=function(){e.disposables.dispose()},this.history=new qp({editor:r,depth:null===(t=this.props.history)||void 0===t?void 0:t.maxDepth}),this.history.record(this.contentValue,this.range),this.props.autosize&&window.setTimeout((function(){e.autosize=new $p(r),e.disposables.add((function(){var t;null===(t=e.autosize)||void 0===t||t.destroy(),e.autosize=null}))})),this.props.value&&op(this,vp,"m",Ap).call(this,this.props.value)}}},{key:"renderAsync",value:function(){var t=this;return new Promise((function(e){t.render(),e(!0)}))}},{key:"renderToString",value:function(){return'<div class="'.concat(op(this,vp,"m",mp).call(this,"root"),'">').concat(['<div class="'.concat(op(this,vp,"m",mp).call(this,"placeholder"),'">').concat(this.props.placeholder||"请输入内容","</div>"),'<div class="'.concat(op(this,vp,"m",mp).call(this,"editor"),'" contenteditable="true"></div>')].join(""),"</div>")}}],[{key:"register",value:function(t,e){this.nodeMap.set(t,e)}}])}();vp=new WeakSet,mp=function(t){return"brt-".concat(t)},bp=function(){if(this.editor){var t=function(t){var e=Up(t);if(!e)return null;var n=e.rangeCount>0?e.getRangeAt(0):null;return n?n.startContainer!==t&&n.startContainer.parentElement!==t?null:n:null}(this.editor);if(t){this.range=t;var e=function(t,e){var n=Vp(t,e);return Object.assign(Object.assign({},n),{getBoundingClientRect:function(){return e.getBoundingClientRect?e.getBoundingClientRect():null}})}(this.editor,t);op(this,vp,"m",yp).call(this,"selection-change",e)}}},yp=function(t,e){this.el.current&&function(t,e,n){t.dispatchEvent(new CustomEvent(e,{detail:n}))}(this.el.current,t,e)},gp=function(){if(this.editor&&this.el.current){var t,e,n=(t=Array.from(this.editor.childNodes||[]),e=[],t.forEach((function(t){var n=zp(t);n&&e.push(n)})),{nodes:e});this.content=n,this.contentValue=function(t){var e,n="",i=[],r=Qd(t.nodes);try{for(r.s();!(e=r.n()).done;){var o=e.value.getValue();n+=o.raw,i.push(o)}}catch(t){r.e(t)}finally{r.f()}return{raw:n,nodes:i}}(n);var i=op(this,vp,"m",Sp).call(this);this.placeholder&&(i?this.placeholder.style.setProperty("display","none"):this.placeholder.style.removeProperty("display")),i?op(this,vp,"m",yp).call(this,"change",Object.assign({},this.contentValue)):op(this,vp,"m",yp).call(this,"change",{raw:"",nodes:[]})}},wp=function(t){op(this,vp,"m",gp).call(this),op(this,vp,"m",bp).call(this),op(this,vp,"m",Lp).call(this,t)},xp=function(){this.autosize&&this.autosize.update()},kp=function(){if(this.editor&&this.range){var t=this.range.getBoundingClientRect(),e=this.editor.getBoundingClientRect(),n=t.top-e.top,i=this.editor.scrollTop,r=n+i+t.height-e.height;r>0&&this.editor.scrollTo({top:i+r,behavior:"auto"})}},_p=function(){var t=this;op(this,vp,"m",xp).call(this),window.setTimeout((function(){op(t,vp,"m",kp).call(t)}))},Ap=function(t){if(this.editor){var e=[];if(t.nodes)e=Wp(t.nodes,Xp.nodeMap);else if(t.raw){var n=up.from({type:"text",raw:t.raw});n&&e.push(n)}var i=this.editor;e.length?i.childNodes.length?function(t,e){for(var n,i,r,o=Array.from(t.childNodes||[]),a=Array.from(e),s=Math.max(o.length,a.length),l=0;l<s;l++){var c=a[l],u=o[l];if(u)if(c)if(c.nodeType===u.nodeType&&c.nodeName===u.nodeName)if(c.nodeType===Node.TEXT_NODE)c.textContent!==u.textContent&&(u.textContent=c.textContent);else{var d=zp(u),p=zp(c);if(d&&p){if(n=p,void 0,void 0,i=d.getValue(),r=n.getValue(),i.type===r.type&&i.raw===r.raw&&Np(i.attributes,r.attributes)&&Np(i.data,r.data))continue;t.replaceChild(c,u)}else if(d)t.removeChild(u);else{if(!p)continue;t.appendChild(c)}}else t.replaceChild(c,u);else t.removeChild(u);else t.appendChild(c)}}(i,e):e.forEach((function(t){i.appendChild(t)})):i.innerHTML="",op(this,vp,"m",gp).call(this)}},Ep=function(){this.editor&&this.editor.focus()},Cp=function(){this.editor&&this.editor.blur()},Tp=function(){if(!this.editor)return!1;var t=this.range;if(!t)return!1;var e=t.endContainer;return e===this.editor?t.endOffset===this.editor.childNodes.length:e.parentElement===this.editor&&e===this.editor.childNodes[this.editor.childNodes.length-1]},Sp=function(t){return t&&op(this,vp,"m",gp).call(this),this.contentValue.raw.trim().length>0},Op=function(t){return{startContainer:t,startOffset:0,endContainer:t,endOffset:t.childNodes.length,collapsed:!0}},Pp=function(t,e){var n=this;if(this.editor){var i=this.editor,r=Wp(t,Xp.nodeMap);if(r.length){var o=e||this.range||op(this,vp,"m",Op).call(this,i);if(o){op(this,vp,"m",Lp).call(this,!0),o=function(t,e){if(e.collapsed)return e;var n=Array.from(t.childNodes);if(e.startContainer===e.endContainer)if(Bp(e.startContainer)){var i=e.startContainer,r=i.textContent||"",o={start:e.startOffset,end:e.endOffset},a=Fp(i,o);if(a.length)if(2===a.length)i.nextSibling?t.insertBefore(a[1],i.nextSibling):t.appendChild(a[1]),e={startContainer:i,startOffset:o.start,endContainer:i,endOffset:o.start,collapsed:!0};else{var s=o.end===r.length?o.start:0;e={startContainer:i,startOffset:s,endContainer:i,endOffset:s,collapsed:!0}}else{var l=Math.max(0,n.indexOf(i));i.remove(),e={startContainer:t,startOffset:l,endContainer:t,endOffset:l,collapsed:!0}}}else{var c=e,u=c.startOffset,d=c.endOffset;n.slice(u,d).forEach((function(t){return t.remove()})),e={startContainer:t,startOffset:u,endContainer:t,endOffset:u,collapsed:!0}}else{var p=e,h=p.startContainer,f=p.startOffset,v=p.endContainer,m=p.endOffset,b=Bp(h)?n.indexOf(h):f,y=Bp(v)?n.indexOf(v):m;if(Bp(h)){var g=h,w={start:f,end:(g.textContent||"").length},x=Fp(g,w),k=Math.max(0,n.indexOf(g)-1);x.length?e={startContainer:g,startOffset:w.start,endContainer:g,endOffset:w.start,collapsed:!0}:(g.remove(),e={startContainer:t,startOffset:k,endContainer:t,endOffset:k,collapsed:!0})}if(Bp(v)){var _=v;if(Fp(_,{start:0,end:m}).length){if(Bp(e.startContainer)){var A=e.startContainer,E=_.textContent||"";_.remove(),e.startContainer.textContent=(A.textContent||"")+E}}else _.remove()}y-b>1&&n.slice(b+1,y).forEach((function(t){return t.remove()}))}return e}(i,o);var a=null,s=0,l=o.endContainer,c=Array.from(i.childNodes);if(l===i)a=c.length?c[o.endOffset]:null,s=o.endOffset;else if(Bp(l)){var u=l.textContent||"";if(0===o.endOffset)a=l;else if(o.endOffset===u.length)s=(a=l.nextSibling||null)?c.indexOf(a):c.length;else{var d=u.slice(0,o.endOffset),p=u.slice(o.endOffset),h=up.create(p);l.nextSibling?i.insertBefore(h,l.nextSibling):i.appendChild(h),l.textContent=d,a=h}}else a=l,s=o.endOffset;var f=r[r.length-1];if(r.forEach((function(t,e){if(a)i.insertBefore(t,a);else{if(Bp(t)&&i.lastChild){var n=i.lastChild;if(Bp(n))return n.textContent=(n.textContent||"")+(t.textContent||""),void(e===r.length-1&&(f=n))}i.appendChild(t)}})),Bp(f)){var v=f.length;op(this,vp,"m",Ip).call(this,{startContainer:f,startOffset:v,endContainer:f,endOffset:v,collapsed:!0})}else if(f.nextSibling&&Bp(f.nextSibling))op(this,vp,"m",Ip).call(this,{startContainer:f.nextSibling,startOffset:0,endContainer:f.nextSibling,endOffset:0,collapsed:!0});else{var m=s+r.length;op(this,vp,"m",Ip).call(this,{startContainer:i,startOffset:m,endContainer:i,endOffset:m,collapsed:!0})}window.setTimeout((function(){var t;null===(t=n.autosize)||void 0===t||t.update(),op(n,vp,"m",wp).call(n,!0)}))}}}},Ip=function(t){!function(t,e){var n=Up(e);if(!n)return console.warn("Selection is not found.");var i=document.createRange();i.setStart(t.startContainer,t.startOffset),t.collapsed?i.collapse(!0):(i.setEnd(t.endContainer,t.endOffset),i.collapse(!1)),n.removeAllRanges(),n.addRange(i)}(t,this.editor)},Rp=function(){if(this.editor&&this.history){var t=this.editor,e=this.history.undo();e&&(op(this,vp,"m",Ap).call(this,e.value),e.range&&op(this,vp,"m",Ip).call(this,Hp(t,e.range)))}},jp=function(){if(this.editor&&this.history){var t=this.editor,e=this.history.undo();e&&(op(this,vp,"m",Ap).call(this,e.value),e.range&&op(this,vp,"m",Ip).call(this,Hp(t,e.range)))}},Lp=function(t){var e,n,i=this;if(this.history){if(t)this.historyRecordTimer&&(window.clearTimeout(this.historyRecordTimer),this.historyRecordTimer=null);else if(this.historyRecording)return;this.historyRecording=!0,this.history.record(this.contentValue,this.range),this.historyRecordTimer=window.setTimeout((function(){i.historyRecording=!1}),null!==(n=null===(e=this.props.history)||void 0===e?void 0:e.recordInterval)&&void 0!==n?n:500)}},Mp=function(){var t=this;if(this.el.current){var e=this.el.current.querySelector(".".concat(op(this,vp,"m",mp).call(this,"editor")));e.className=op(this,vp,"m",mp).call(this,"editor"),e.contentEditable="true",this.editor=e,this.el.current.appendChild(e),this.disposables.addEventListener(e,"blur",(function(){t.isFoused=!1,op(t,vp,"m",yp).call(t,"focus-change",!1)})),this.disposables.addEventListener(e,"focus",(function(){t.isFoused=!0,op(t,vp,"m",yp).call(t,"focus-change",!0)})),this.disposables.addEventListener(e,"input",(function(){op(t,vp,"m",wp).call(t)})),this.disposables.addEventListener(e,"copy",(function(){})),this.disposables.addEventListener(e,"cut",(function(){})),this.disposables.addEventListener(e,"paste",(function(e){e.stopPropagation(),e.preventDefault();var n=e.clipboardData;if(n){var i=n.getData("Text").trim().replace(/\r/g,"\n"),r=[],o=i.split("\n");o.length>1?o.forEach((function(t,e){r.push({type:"text",raw:t}),e<o.length-1&&r.push(fp.value)})):r.push({type:"text",raw:i}),op(t,vp,"m",Pp).call(t,r),op(t,vp,"m",_p).call(t)}})),this.disposables.addEventListener(e,"drop",(function(t){t.preventDefault()})),this.disposables.addEventListener(e,"dragstart",(function(t){t.preventDefault()})),this.disposables.addEventListener(e,"keydown",(function(e){var n,i,r;e.stopPropagation();var o=e.key;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End"].includes(o))window.setTimeout((function(){op(t,vp,"m",bp).call(t)}));else if(function(t){return Gp(t,"a")}(e))window.setTimeout((function(){op(t,vp,"m",bp).call(t)}),20);else{if(function(t){return Gp(t,"z")&&!t.shiftKey}(e))return e.preventDefault(),void op(t,vp,"m",Rp).call(t);if(function(t){return Gp(t,"z")&&t.shiftKey}(e))return e.preventDefault(),void op(t,vp,"m",jp).call(t);if(function(t){return"Enter"===t.key}(e))return e.preventDefault(),op(t,vp,"m",Tp).call(t)?op(t,vp,"m",Pp).call(t,[fp.value,{type:cp.TEXT,raw:"​"}]):op(t,vp,"m",Pp).call(t,[fp.value]),void op(t,vp,"m",_p).call(t);if(function(t){return"Backspace"===t.key}(e)&&null!==(n=t.range)&&void 0!==n&&n.endContainer&&Bp(t.range.endContainer)){var a=t.range.endContainer;1===a.length&&"​"===a.nodeValue&&(null===(i=a.previousSibling)||void 0===i?void 0:i.nodeName)===fp.nodeName&&(null===(r=a.previousSibling)||void 0===r||r.remove())}}})),this.disposables.addEventListener(e,"keyup",(function(t){t.stopPropagation()})),this.disposables.addEventListener(e,"mousedown",(function(){})),this.disposables.addEventListener(document,"mouseup",(function(){op(t,vp,"m",bp).call(t)}))}},Dp=function(t){var e=t.placeholder,n=t.value;e&&this.props.placeholder&&e!==this.props.placeholder&&(this.props.placeholder=e,this.placeholder&&(this.placeholder.textContent=e)),n&&n!==this.contentValue&&(this.props.value=n,op(this,vp,"m",Ap).call(this,n))},Xp.nodeMap=new Map,Xp.NodeType=cp,Xp.isSupportShadowDOM=function(){return("undefined"==typeof window?"undefined":k(window))<"u"&&void 0!==ShadowRoot.prototype.getSelection};var Yp=function(){var t=i(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ti("//s1.hdslb.com/bfs/static/jinkela/long/growup/risk-control-captcha.js",{lib:"RiskControlCaptcha"}));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Zp=function(){var t=i(m().mark((function t(e){var n,i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Yp();case 2:return n=t.sent,i=n.verify,t.next=6,i(e);case 6:return t.abrupt("return",t.sent.token);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Qp=Object.defineProperty,Kp=Object.getOwnPropertyDescriptor,Jp=function(t,e,n,i){for(var r,o=i>1?void 0:i?Kp(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Qp(e,n,o),o},th=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.spmPrefix="",t.oid="",t.type=0,t.mode=3,t.reply=null,t.user=null,t.avatarSize=48,t.keepActive=!1,t.useRichTextarea="function"==typeof ShadowRoot.prototype.getSelection,t.active=!1,t.activeToggleTimer=0,t.defaultInputValue="",t.inputValue="",t.nodes=[],t.placeholder="",t.voteOption=null,t.scrollContainer=null,t.pubBtnText="发布",t.uploadPicState=1,t.goodsState=3,t.goodsIds="",t.voteOptionHidden=!1,t.syncToDynamic=!1,t.showEmojiPicker=!1,t.mountEmojiPicker=!1,t.pics=[],t.mentionMap={},t.mentionText="",t.mentionDisabled=!1,t.trackObserver=null,t}return p(e,t),s(e,[{key:"cmGoodsEventId",get:function(){return"cm_goods_comments"}},{key:"hasContent",get:function(){return!!this.inputValue||this.pics.length>0||this.syncToDynamic}},{key:"uploadImgExts",get:function(){return["jpg","jpeg","png"]}},{key:"addNamespace",get:function(){return this.reply?Au:_u}},{key:"showPicBtn",get:function(){return this.addNamespace===_u&&3!==this.uploadPicState}},{key:"showGoodsBtn",get:function(){return!(this.addNamespace!==_u||!this.useRichTextarea)&&3!==this.goodsState}},{key:"showSyncToDynamic",get:function(){return this.addNamespace===_u}},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),this.inputValue=this.defaultInputValue,setTimeout((function(){var e,n,i,r,o,a,s;t.biliAvatar.load(gd({face:(null==(n=t.user)?void 0:n.face)||"",mid:(null==(i=t.user)?void 0:i.mid)||0,pendant:(null==(r=t.user)?void 0:r.pendant)||"",vip:null==(o=t.user)?void 0:o.vip,official:null==(a=t.user)?void 0:a.official,nft:null!==(e=null==(s=t.user)?void 0:s.face_nft_type)&&void 0!==e?e:0}),{baseSize:t.avatarSize,isFloat:!0})})),this.disposables.addEventListener(document.documentElement,"click",(function(e){"none"!==t.style.getPropertyValue("--bili-comment-box-display")&&e.composedPath&&(e.composedPath().includes(t.shadowRoot)||t.handleDeactive())}),!0),this.trackObserver=new Ed({el:this,type:"show",value:{event:"comment_box.all",data:{type:this.type,oid:this.oid,version:"v2",tools:JSON.stringify({pic:this.showPicBtn?1:0,goods:this.showGoodsBtn?1:0})}},handler:function(e,n,i){"show"===e&&(t.trackReport(e,n,i),t.showGoodsBtn&&t.trackReportGoods("show"))}}),this.disposables.add((function(){t.trackObserver&&(t.trackObserver.dispose(),t.trackObserver=null)}))}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose()}},{key:"trackReport",value:function(t,e,n){Tu(t,e,n,{spmPrefix:this.spmPrefix})}},{key:"handleFocusChange",value:function(t){t.detail&&this.handleActive()}},{key:"handleActive",value:function(){var t=this,e={type:this.type,oid:this.oid,position:this.addNamespace===_u?1:3};Eu("replyInputClick",e),this.trackReport("click","comment_box.textarea.click",e),this.active||this.voteOption&&this.voteOptionHidden&&(this.voteOptionHidden=!1),this.toggleActive(!0,20),this.useRichTextarea?setTimeout((function(){t.mentionDisabled?t.mentionPopover.refresh(null):t.handleMentionStart(t.richTextarea.getSelection())}),200):this.handleRawMentionStart(this.textarea.getSelection())}},{key:"handleDeactive",value:function(){this.keepActive||(this.mentionPopover.refresh(null),this.showEmojiPicker=!1,!this.hasContent&&this.toggleActive(!1,0))}},{key:"toggleActive",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;this.activeToggleTimer&&(window.clearTimeout(this.activeToggleTimer),this.activeToggleTimer=0),this.activeToggleTimer=window.setTimeout((function(){e.active=t}),n)}},{key:"handleFocusInput",value:function(){var t=this;window.setTimeout((function(){t.focus()}),20)}},{key:"handleRawInputChange",value:function(t){this.inputValue=t.detail}},{key:"handleRawMentionStart",value:function(t){if(!this.showEmojiPicker){var e=t.start;if(e===t.end){var n=this.inputValue.slice(0,e),i=wd(n);if(null!==i){this.mentionText=i;var r=this.getBoundingClientRect(),o=window.innerHeight;this.scrollContainer&&this.scrollContainer!==document.body&&(o=this.scrollContainer.getBoundingClientRect().height),o<r.y+325?(this.mentionPopover.style.top="",this.mentionPopover.style.bottom="".concat(r.height,"px"),this.mentionPopover.style.setProperty("--max-content-height","160px")):(this.mentionPopover.style.removeProperty("--max-content-height"),this.mentionPopover.style.bottom="",this.mentionPopover.style.top="32px"),this.mentionPopover.style.zIndex="".concat(jn())}if(this.mentionPopover.refresh(i),null!==i){var a={oid:this.oid,type:this.type};Cu("show","comment.at_recomlist",a),this.trackReport("show","comment_box.mention_popover.show",a)}}}}},{key:"handleInputChange",value:function(t){var e=t.detail.nodes;this.nodes=e;var n="",i=[],r={};e.forEach((function(t){var e;switch(t.type){case Xp.NodeType.IMG:n+=t.raw;break;case Xp.NodeType.HIGHLIGHT:if(null!=(e=t.data)&&e.type){if("mention"===t.data.type){n+=t.raw,r[t.data.uname]=Number(t.data.uid);break}if("goods"===t.data.type){n+=t.data.goods_url,i.push(t.data.goods_id);break}}else n+=t.raw;break;case Xp.NodeType.TEXT:default:n+=t.raw}})),this.inputValue=n,this.mentionMap=r,this.goodsIds=i.join(",")}},{key:"handleMentionStart",value:function(t){if(!this.showEmojiPicker){var e=t.collapsed,n=t.startIndex,i=t.startOffset;if(e){var r=this.nodes[n];if(r){if("text"===r.type){var o=r.raw.slice(0,i),a=wd(o);if(null!==a){this.mentionText=a;var s=this.getBoundingClientRect(),l=window.innerHeight;this.scrollContainer&&this.scrollContainer!==document.body&&(l=this.scrollContainer.getBoundingClientRect().height),l<s.y+325?(this.mentionPopover.style.top="",this.mentionPopover.style.bottom="".concat(s.height,"px"),this.mentionPopover.style.setProperty("--max-content-height","160px")):(this.mentionPopover.style.removeProperty("--max-content-height"),this.mentionPopover.style.bottom="",this.mentionPopover.style.top="32px"),this.mentionPopover.style.zIndex="".concat(jn())}if(this.mentionPopover.refresh(a),null!==a){var c={oid:this.oid,type:this.type};Cu("show","comment.at_recomlist",c),this.trackReport("show","comment_box.mention_popover.show",c)}}}else this.mentionPopover.refresh(null)}}}},{key:"handleMentionEnd",value:function(t){var e=this,n=t.detail,i=n.name,r=n.mid,o=this.mentionText;if(this.useRichTextarea){var a=this.richTextarea.getSelection(),s="@".concat(i),l={startIndex:a.startIndex,startOffset:a.startOffset-o.length-1,endIndex:a.startIndex,endOffset:a.startOffset,collapsed:!1};this.richTextarea.insertNodes([{type:Xp.NodeType.HIGHLIGHT,raw:s,attributes:{class:"mention"},data:{type:"mention",uname:i,uid:String(r)}}],l),this.mentionDisabled=!0,window.setTimeout((function(){e.mentionDisabled=!1}),300)}else{var c=this.textarea.getSelection();this.textarea.insertText("@".concat(i," "),{start:c.start-o.length-1,end:c.end}),this.mentionMap[i]=r}this.mentionText="";var u={oid:this.oid,type:this.type,mid:r};Cu("click","comment.at_recomlist",u),this.trackReport("click","comment_box.mention_popover.show",u)}},{key:"handleRawSelectionChange",value:function(t){this.handleRawMentionStart(t.detail)}},{key:"handleSelectionChange",value:function(t){this.handleMentionStart(t.detail)}},{key:"handleHideVoteOption",value:function(t){t.stopPropagation(),this.voteOptionHidden=!0}},{key:"handleReset",value:function(){this.picturesUpload.reset(),this.syncToDynamic&&(this.syncToDynamic=!1),this.useRichTextarea?this.richTextarea.reset():(this.inputValue="",this.mentionMap={}),this.toggleActive(!1),this.addNamespace===Au&&xu.emit("hideReply")}},{key:"handleTool",value:function(t,e){var n=this;e.stopPropagation();var i={tool_type:t,type:this.type,oid:this.oid,position:this.addNamespace===_u?1:3};if(this.trackReport("click","comment_box.tool.click",i),"emoji"!==t){if(this.showEmojiPicker=!1,"mention"===t)return Cu("click","comment.at_button",i),void setTimeout((function(){n.useRichTextarea?n.richTextarea.insertText("@"):n.textarea.insertText("@")}));"pic"!==t?"goods"===t&&(this.trackReportGoods("click"),function(t){var e={"event-id":t.eventId,"data-select-ids":t.selectIds,"source-from":"1","content-oid":t.contentOid};t.spmIdFrom&&(e["spm-id-from"]=t.spmIdFrom);var n=document.createElement("bili-cm-goods");Object.keys(e).forEach((function(t){n.setAttribute(t,e[t])}));var i=On();i.addEventListener(n,"confirm",(function(e){t.onConfirm(e.detail),i.dispose()})),i.addEventListener(n,"cancel",(function(){t.onCancel(),i.dispose()}));var r=zd({title:"",width:"auto",zIndex:1e4,render:function(){return n}});i.add((function(){r.remove()}))}({eventId:this.cmGoodsEventId,selectIds:this.goodsIds,contentOid:"".concat(this.type,"_").concat(this.oid),onConfirm:function(t){var e=[],i=n.nodes.filter((function(e){var n;if(e.type===Xp.NodeType.HIGHLIGHT&&"goods"===(null==(n=e.data)?void 0:n.type)){var i=e.data.goods_id;return t.findIndex((function(t){return t.itemIdStr===i}))>-1}return!0}));t.forEach((function(t){if(-1===i.findIndex((function(e){var n;return e.type===Xp.NodeType.HIGHLIGHT&&"goods"===(null==(n=e.data)?void 0:n.type)&&e.data.goods_id===t.itemIdStr}))){var n={type:Xp.NodeType.HIGHLIGHT,raw:t.name,attributes:{class:"goods"},data:{type:"goods",goods_url:t.shortUrl||t.jumpUrl,goods_id:t.itemIdStr}};e.push(n,{type:Xp.NodeType.TEXT,raw:" "})}})),n.richTextarea.reset([].concat(w(i),e))},onCancel:function(){console.log("cancel")}})):this.handleUploadPic()}else{if(Eu("replyEmojiClick",i),!this.mountEmojiPicker&&!this.showEmojiPicker&&(this.mountEmojiPicker=!0),this.showEmojiPicker=!this.showEmojiPicker,this.showEmojiPicker){this.emojiPopover.style.zIndex="".concat(jn());var r=this.getBoundingClientRect().bottom;window.innerHeight-r<300?(this.emojiPopover.style.removeProperty("bottom"),this.emojiPopover.style.setProperty("top","0"),this.emojiPopover.style.setProperty("transform","translateY(-100%)")):(this.emojiPopover.style.removeProperty("top"),this.emojiPopover.style.setProperty("bottom","0"),this.emojiPopover.style.setProperty("transform","translateY(100%)"))}this.useRichTextarea?this.richTextarea.focus():this.textarea.focus()}}},{key:"trackReportGoods",value:function(t){var e;this.trackReport(t,"comment_box.tool_goods.".concat(t),{mid:(null==(e=this.user)?void 0:e.mid)||0,source_from:1,content_oid:"".concat(this.type,"_").concat(this.oid)})}},{key:"handleUploadPic",value:function(){this.picturesUpload.trigger()}},{key:"handlePicsChange",value:(l=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{this.pics=w(e.detail)}catch(t){Fc.show(t.message)}case 1:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"handleSelectEmoji",value:function(t){var e=this;setTimeout((function(){var n=t.detail,i=n.type,r=n.webp_url,o=n.gif_url,a=n.url,s=n.text;e.useRichTextarea?4===i?e.richTextarea.insertNodes([{type:Xp.NodeType.TEXT,raw:s}]):e.richTextarea.insertNodes([{type:Xp.NodeType.IMG,raw:s,attributes:{src:ki.getBmgSrcNext(r||o||a,{w:20,h:20}),alt:s,width:"20",height:"20"}}]):e.textarea.insertText(t.detail.text)}))}},{key:"handleSyncToDynamicChange",value:function(t){this.syncToDynamic=t.detail.checked}},{key:"handlePublish",value:(a=i(m().mark((function t(e){var n,i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.stopPropagation(),this.showEmojiPicker=!1,this.inputValue){t.next=3;break}return Fc.show("你还没有评论！"),t.abrupt("return");case 3:return n={plat:1,oid:this.oid,type:this.type,message:""},i=this.inputValue,this.reply&&(this.reply.root?(n.root=this.reply.root_str,n.parent=this.reply.rpid_str,this.placeholder&&(i="".concat(this.placeholder).concat(i))):(n.root=this.reply.rpid_str,n.parent=n.root)),n.message=i,this.voteOption&&!this.voteOptionHidden&&(n.has_vote_option=!0),Object.keys(this.mentionMap)&&(n.at_name_to_mid=this.mentionMap),this.pics.length&&(n.pictures=this.pics),this.syncToDynamic&&(n.sync_to_dynamic=1),t.next=13,this.doPublishRequest(n);case 13:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"doPublishRequest",value:(n=i(m().mark((function t(e){var n,i,r,o,a,s,l,c,u,d=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=0,t.prev=1,t.next=4,Yu(e);case 4:if(i=t.sent,r=i.code,o=i.data,a=i.message,0===r&&o){t.next=20;break}t.t0=r,t.next=12015===t.t0?12:12074===t.t0?14:61001===t.t0?16:18;break;case 12:return null!=o&&o.need_captcha_v2&&(n=3),t.abrupt("break",19);case 14:return n=1,t.abrupt("break",19);case 16:return n=2,t.abrupt("break",19);case 18:return t.abrupt("break",19);case 19:throw new Error(a||"发布失败");case 20:Fc.show(o.success_toast||"发布成功"),xu.emit("add",{namespaces:[this.addNamespace],method:this.addNamespace===_u?"unshift":"push",value:o.reply}),this.handleReset(),o.easter_egg&&(s=o.easter_egg,l=s.resource,c=s.jump_url,xu.emit("displayAlphaVideo",{src:l,jumpUrl:c})),u={type:this.type,oid:this.oid,root:e.root,parent:e.parent,ordering:3===this.mode?"heat":"time",position:this.addNamespace===_u?1:3},Eu("reply-send-click",u),Eu("replySendClick",u),this.trackReport("click","comment_box.pub_btn.click",u),t.next=37;break;case 25:if(t.prev=25,t.t1=t.catch(1),1!==n){t.next=30;break}return Vd(),t.abrupt("return");case 30:if(2!==n){t.next=33;break}return Td({title:"请绑定手机号",message:"根据国家实名制认证的相关要求，您需要绑定手机号，才能继续进行操作。",cancel:!1,confirm:function(){window.open("//passport.bilibili.com/account/security#/bindphone/unverify/set")}}),t.abrupt("return");case 33:if(3!==n){t.next=36;break}return Zp({verifyMethod:"biliword",verifyRelation:"0",extraInfo:{type:this.type,page:e.root?"detail":"list",ordering:3===this.mode?"heat":"time"},biz:"reply",theme:"primary"}).then((function(t){d.doPublishRequest(v(v({},e),{},{code_v2:t}))})).catch((function(){Fc.show("评论太频繁啦,稍微休息一下吧~")})),t.abrupt("return");case 36:Fc.show(t.t1.message);case 37:case"end":return t.stop()}}),t,this,[[1,25]])}))),function(t){return n.apply(this,arguments)})},{key:"focus",value:function(){this.useRichTextarea?this.richTextarea.focus():this.textarea.focus()}},{key:"blur",value:function(){this.useRichTextarea?this.richTextarea.blur():this.textarea.blur()}},{key:"voteOptionTemplate",value:function(){return qe(ts||(ts=g(['<div\n      id="vote-option"\n      class="','"\n    >\n      <bili-comment-vote-option .data=',"></bili-comment-vote-option>\n      <bili-icon @click=",' size="12" icon="BDC/xmark_close_circle_fill/1"></bili-icon>\n    </div>'])),this.voteOptionHidden?Ea({hidden:!0}):"",this.voteOption,this.handleHideVoteOption)}},{key:"render",value:function(){var t=this;return qe(es||(es=g(['\n      <div id="user-avatar">\n        <bili-avatar></bili-avatar>\n      </div>\n      <div id="comment-area">\n        <div\n          id="emoji-popover"\n          style=',"\n        >\n          ",'\n        </div>\n        <div id="body">\n          <div\n            id="editor"\n            class=',"\n            @click=","\n          >\n            ","\n            ","\n\n            <bili-comment-pictures-upload .accept="," @change=",'></bili-comment-pictures-upload>\n          </div>\n        </div>\n        <div\n          id="footer"\n          class=','\n        >\n          <button class="tool-btn emoji" @click=','>\n            <bili-icon icon="BDC/emoji_circle_line/1" size="16"></bili-icon>\n          </button>\n          <button\n            class="tool-btn mention"\n            @click=','\n          >\n            <bili-icon icon="BDC/at_line/1" size="16"></bili-icon>\n          </button>\n          <bili-comment-mention-popover @select=',"></bili-comment-mention-popover>\n          ","\n          ","\n          ",'\n          <div id="pub">\n            <button\n              class=','\n              data-v-risk="fingerprint"\n              @click=',"\n            >\n              ","\n            </button>\n          </div>\n        </div>\n      </div>\n    "])),Gn({display:this.showEmojiPicker?"block":"none"}),this.mountEmojiPicker?qe(ns||(ns=g(["<bili-emoji-picker @select=","></bili-emoji-picker>"])),this.handleSelectEmoji):"",this.keepActive||this.active?Ea({active:!0}):"",this.handleFocusInput,this.voteOption?this.voteOptionTemplate():"",this.useRichTextarea?qe(is||(is=g(["<bili-comment-rich-textarea\n                  .defaultValue=","\n                  .nodes=","\n                  .placeholder=","\n                  @change=","\n                  @focus-change=","\n                  @selection-change=","\n                ></bili-comment-rich-textarea>"])),this.defaultInputValue,this.nodes,this.placeholder,this.handleInputChange,this.handleFocusChange,this.handleSelectionChange):qe(rs||(rs=g(["\n                  <bili-comment-textarea\n                    .value=","\n                    .placeholder=","\n                    @focus=","\n                    @change=","\n                    @selection-change=","\n                  ></bili-comment-textarea>\n                "])),this.defaultInputValue,this.placeholder,this.handleActive,this.handleRawInputChange,this.handleRawSelectionChange),this.uploadImgExts,this.handlePicsChange,Ea({hidden:!this.keepActive&&!this.active}),(function(e){return t.handleTool("emoji",e)}),(function(e){t.handleTool("mention",e)}),this.handleMentionEnd,this.showPicBtn?qe(os||(os=g(['<button\n                class="','"\n                @click=','\n              >\n                <bili-icon icon="BDC/image_line/3" size="16"></bili-icon>\n              </button>'])),Ea({"tool-btn":!0,disabled:2===this.uploadPicState}),(function(e){2!==t.uploadPicState&&t.handleTool("pic",e)})):"",this.showGoodsBtn?qe(as||(as=g(['<button\n                class="','"\n                @click=','\n              >\n                <bili-icon icon="BDC/bag_commodity_line/2" size="16"></bili-icon>\n              </button>'])),Ea({"tool-btn":!0,disabled:2===this.goodsState}),(function(e){2!==t.goodsState&&t.handleTool("goods",e)})):"",this.showSyncToDynamic?qe(ss||(ss=g(['<div id="optional">\n                <bili-checkbox\n                  checked=','\n                  value="sync"\n                  label="同时转发到我的动态"\n                  @change=',"\n                ></bili-checkbox>\n              </div>"])),this.syncToDynamic,this.handleSyncToDynamicChange):"",Ea({active:!!this.inputValue}),this.handlePublish,this.pubBtnText)}}]);var n,a,l}(fn);th.styles=ve(ls||(ls=g(["\n    :host {\n      --bili-comment-box-display: flex;\n      display: var(--bili-comment-box-display);\n    }\n\n    #user-avatar {\n      flex-shrink: 0;\n      width: 80px;\n      height: 50px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #user-avatar img {\n      border-radius: 50%;\n    }\n    #comment-area {\n      position: relative;\n      width: calc(100% - 80px);\n    }\n    #emoji-popover {\n      position: absolute;\n      left: 0;\n    }\n\n    #body {\n      width: 100%;\n      transition: height 0.2s;\n    }\n    #editor {\n      width: 100%;\n      padding: 8px 0;\n      border: 1px solid var(--Ga1);\n      box-sizing: border-box;\n      border-radius: 6px;\n      background-color: var(--bg3);\n      transition: 0.2s;\n      cursor: text;\n    }\n    #editor:hover,\n    #editor.active {\n      background-color: var(--bg1);\n      border-color: var(--graph_weak);\n    }\n    #editor.active #vote-option {\n      display: flex;\n    }\n    #editor #vote-option {\n      display: none;\n      padding: 0 8px;\n      align-items: center;\n      margin-bottom: 4px;\n    }\n    #editor #vote-option.hidden {\n      display: none;\n    }\n    #editor #vote-option bili-comment-vote-option {\n      margin-right: 4px;\n    }\n    #editor #vote-option bili-icon {\n      color: var(--text4);\n      cursor: pointer;\n    }\n    #editor bili-comment-pictures-upload {\n      margin-top: 8px;\n    }\n    bili-comment-mention-popover {\n      left: 38px;\n      z-index: 2;\n    }\n    #pub {\n      height: 32px;\n      width: 70px;\n      margin-left: auto;\n    }\n    #pub button {\n      cursor: pointer;\n      border-radius: 4px;\n      outline: none;\n      border: none;\n      width: 100%;\n      height: 100%;\n      font-size: 16px;\n      color: var(--text_white);\n      background-color: rgba(var(--brand_blue_rgb), 0.5);\n    }\n    #pub button:hover,\n    #pub button.active {\n      background-color: var(--brand_blue);\n    }\n\n    #footer {\n      position: relative;\n      margin-top: 10px;\n      display: flex;\n      align-items: center;\n    }\n\n    #footer.hidden {\n      display: none;\n    }\n\n    #footer #optional bili-checkbox {\n      transform: scale(0.8);\n    }\n    #footer #optional bili-checkbox label {\n      margin-left: 6px;\n    }\n\n    /* 设置slot 隐藏 */\n    #footer bili-popover > * {\n      display: none;\n    }\n\n    .tool-btn {\n      outline: none;\n      border: none;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      position: relative;\n      width: 32px;\n      height: 26px;\n      border: 1px solid var(--Ga1);\n      background-color: var(--bg1);\n      border-radius: 4px;\n      color: var(--text2);\n      cursor: pointer;\n      margin-right: 6px;\n    }\n    .tool-btn.disabled {\n      color: var(--text4);\n      cursor: not-allowed;\n    }\n  "]))),Jp([gn()],th.prototype,"spmPrefix",2),Jp([gn()],th.prototype,"oid",2),Jp([gn()],th.prototype,"type",2),Jp([gn()],th.prototype,"mode",2),Jp([gn()],th.prototype,"reply",2),Jp([gn()],th.prototype,"user",2),Jp([gn({type:Boolean})],th.prototype,"keepActive",2),Jp([wn()],th.prototype,"useRichTextarea",2),Jp([wn()],th.prototype,"active",2),Jp([gn({type:String})],th.prototype,"defaultInputValue",2),Jp([wn()],th.prototype,"inputValue",2),Jp([gn({type:String})],th.prototype,"placeholder",2),Jp([gn({type:Object})],th.prototype,"voteOption",2),Jp([gn()],th.prototype,"scrollContainer",2),Jp([gn({type:String})],th.prototype,"pubBtnText",2),Jp([gn()],th.prototype,"uploadPicState",2),Jp([gn()],th.prototype,"goodsState",2),Jp([wn()],th.prototype,"voteOptionHidden",2),Jp([wn()],th.prototype,"syncToDynamic",2),Jp([wn()],th.prototype,"showEmojiPicker",2),Jp([wn()],th.prototype,"mountEmojiPicker",2),Jp([wn()],th.prototype,"pics",2),Jp([wn()],th.prototype,"hasContent",1),Jp([wn()],th.prototype,"uploadImgExts",1),Jp([wn()],th.prototype,"addNamespace",1),Jp([wn()],th.prototype,"showPicBtn",1),Jp([wn()],th.prototype,"showGoodsBtn",1),Jp([wn()],th.prototype,"showSyncToDynamic",1),Jp([_n("bili-avatar")],th.prototype,"biliAvatar",2),Jp([_n("#editor bili-comment-rich-textarea")],th.prototype,"richTextarea",2),Jp([_n("#editor bili-comment-textarea")],th.prototype,"textarea",2),Jp([_n("#emoji-popover")],th.prototype,"emojiPopover",2),Jp([_n("bili-comment-mention-popover")],th.prototype,"mentionPopover",2),Jp([_n("#editor bili-comment-pictures-upload")],th.prototype,"picturesUpload",2),th=Jp([mn("bili-comment-box")],th);var eh=function(t){return Gc.request({url:"/x/v2/reply/at",params:v({},t)})},nh=Object.defineProperty,ih=Object.getOwnPropertyDescriptor,rh=function(t,e,n,i){for(var r,o=i>1?void 0:i?ih(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&nh(e,n,o),o},oh=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).keyword="",t.groups=[],t}return p(e,t),s(e,[{key:"handleVisible",value:function(t){this.style[t?"setProperty":"removeProperty"]("display","flex")}},{key:"refresh",value:(n=i(m().mark((function t(e){var n,i,r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.groups=[],null!==e){t.next=3;break}return this.keyword="",this.handleVisible(!1),t.abrupt("return");case 3:return this.keyword=e,t.prev=4,t.next=7,eh({keyword:e});case 7:n=t.sent,i=n.code,r=n.data,0===i&&null!=r&&r.groups&&(this.groups=r.groups),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(4),console.error(t.t0);case 16:this.handleVisible(!0);case 17:case"end":return t.stop()}}),t,this,[[4,13]])}))),function(t){return n.apply(this,arguments)})},{key:"handleSelect",value:function(t){var e=t.target.dataset,n=Number(e.group),i=Number(e.item);if(!isNaN(n)&&!isNaN(i)){var r=this.groups[n].items[i];r&&this.dispatchEvent(new CustomEvent("select",{detail:{mid:r.mid,name:r.name}}))}}},{key:"renderKeywordName",value:function(t){if(this.keyword){var e=t.indexOf(this.keyword);if(e>-1)return qe(cs||(cs=g(["","<em>","</em>",""])),t.slice(0,e),this.keyword,t.slice(e+this.keyword.length))}return qe(us||(us=g(["",""])),t)}},{key:"renderCountDesc",value:function(t){return"".concat(function(t,e){var n=parseInt(t,10);return Number.isNaN(n)||n<0?"":n>=1e4&&n<1e8?(n/1e4).toFixed(1)+(e?"萬":"万"):n>=1e8?(n/1e8).toFixed(1)+(e?"億":"亿"):/\./.test(t)?t:n}(t),"粉丝")}},{key:"itemTemplate",value:function(t,e,n){return qe(ds||(ds=g(['<li class="item" data-group="','" data-item="','" @click=','>\n      <div class="item-avatar">\n        <img\n          src="','"\n        />\n      </div>\n      <div class="item-info">\n        <div class="item-name">','</div>\n        <div class="item-desc">',"</div>\n      </div>\n    </li>"])),n,e,this.handleSelect,ki.getBmgSrcNext(t.face,{w:36,h:36,dpr:2}),this.renderKeywordName(t.name),this.renderCountDesc(t.fan))}},{key:"render",value:function(){var t=this;return qe(ps||(ps=g(['<div id="title">选择或输入你想@的人</div>\n      ',""])),this.groups.length?qe(hs||(hs=g(['<div id="content">\n            ',"\n          </div>"])),this.groups.map((function(e,n){return qe(fs||(fs=g(['<div class="group">\n                <div class="group-name">','</div>\n                <ul class="group-items">\n                  ',"\n                </ul>\n              </div>"])),e.group_name,e.items.map((function(e,i){return t.itemTemplate(e,i,n)})))}))):"")}}]);var n}(fn);oh.styles=ve(vs||(vs=g(["\n    :host {\n      --max-content-height: 282px;\n      position: absolute;\n      display: none;\n      flex-direction: column;\n      width: 219px;\n      border: 1px solid var(--graph_bg_thick);\n      border-radius: 6px;\n      font-size: 12px;\n      background-color: var(--bg1);\n      box-shadow: 0 2px 10px #00000014;\n    }\n    #title {\n      width: 100%;\n      height: 41px;\n      padding: 12px;\n      color: var(--text2);\n      font-size: 12px;\n      box-sizing: border-box;\n    }\n    #content {\n      max-height: var(--max-content-height);\n      overflow-x: hidden;\n      overflow-y: scroll;\n    }\n    #content::-webkit-scrollbar {\n      width: 4px;\n      border-radius: 4px;\n      background-color: transparent;\n    }\n    #content::-webkit-scrollbar-thumb {\n      border-radius: 4px;\n      border-radius: 4px;\n      background-color: var(--graph_bg_thick);\n      transition: 0.3s ease-in-out;\n    }\n    #content::-webkit-scrollbar-track {\n      border-radius: 4px;\n      background-color: transparent;\n    }\n\n    .group {\n    }\n    .group-name {\n      padding: 0 12px;\n      color: var(--text2);\n    }\n    .group-items {\n      padding: 0;\n      margin: 0;\n    }\n    .item {\n      display: flex;\n      align-items: center;\n      height: 52px;\n      padding: 0 12px;\n      margin: 4px 0;\n      cursor: pointer;\n      box-sizing: border-box;\n    }\n    .item:hover {\n      background-color: var(--bg2_float);\n    }\n    .item-avatar {\n      width: 36px;\n      height: 36px;\n      margin-right: 8px;\n      pointer-events: none;\n    }\n    .item-avatar img {\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n    }\n    .item-info {\n      font-size: 12px;\n      color: var(--text1);\n      pointer-events: none;\n    }\n    .item-name em {\n      color: var(--brand_blue);\n      font-style: normal;\n    }\n    .item-desc {\n      color: var(--text3);\n    }\n  "]))),rh([wn()],oh.prototype,"keyword",2),rh([wn()],oh.prototype,"groups",2),oh=rh([mn("bili-comment-mention-popover")],oh);var ah=Object.defineProperty,sh=Object.getOwnPropertyDescriptor,lh=function(t,e,n,i){for(var r,o=i>1?void 0:i?sh(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&ah(e,n,o),o},ch=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).options=[],t}return p(e,t),s(e,[{key:"handleClick",value:function(t){this.dispatchEvent(new CustomEvent("select",{detail:t}))}},{key:"render",value:function(){var t=this;return qe(ms||(ms=g(['\n      <ul id="options">\n        ',"\n      </ul>\n    "])),this.options.map((function(e){return qe(bs||(bs=g([" <li @click=",">","</li> "])),(function(){return t.handleClick(e)}),e.text)})))}}])}(fn);ch.styles=ve(ys||(ys=g(["\n    :host {\n      --bili-comment-menu-display: none;\n      --bili-comment-menu-position: absolute;\n      --bili-comment-menu-top: 20px;\n      --bili-comment-menu-right: 0;\n    }\n    #options {\n      display: var(--bili-comment-menu-display);\n      position: var(--bili-comment-menu-position);\n      top: var(--bili-comment-menu-top);\n      right: var(--bili-comment-menu-right);\n      margin: 0;\n      padding: 0;\n      z-index: 10;\n      width: 120px;\n      list-style: none;\n      border-radius: 4px;\n      font-size: 14px;\n      color: var(--text2);\n      background-color: var(--bg1_float);\n      box-shadow: 0 0 5px #0003;\n      overflow: hidden;\n    }\n\n    #options li {\n      box-sizing: border-box;\n      width: 100%;\n      display: flex;\n      align-items: center;\n      height: 36px;\n      padding: 0 15px;\n      cursor: pointer;\n      user-select: none;\n    }\n    #options li:hover {\n      background-color: var(--graph_bg_regular_float);\n    }\n  "]))),lh([gn()],ch.prototype,"options",2),ch=lh([mn("bili-comment-menu")],ch);var uh=function(){var t=i(m().mark((function t(e,n){var i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ti("//s1.hdslb.com/bfs/seed/water-ui/common/bili-photoswipe.js",{lib:"BiliPhotoswipe"});case 2:if(i=t.sent){t.next=6;break}return Fc.show("预览图片遇到些问题，请稍后重试"),t.abrupt("return");case 6:i.open(null!=n?n:0,e);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),dh=Object.defineProperty,ph=Object.getOwnPropertyDescriptor,hh=function(t,e,n,i){for(var r,o=i>1?void 0:i?ph(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&dh(e,n,o),o},fh=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).list=[],t}return p(e,t),s(e,[{key:"items",get:function(){return function(t,e){var n,i=[],r=1===t.length,o=l(t);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=a.img_src,c=a.img_width,u=a.img_height,d=e.multiple,p=d.width,h=d.height,f=c>u,m=Math.floor(f?c/u:u/c)>=3,b={x:0,y:0,w:p,h:h};if(r){var y=e.single[f?"horizontal":"vertical"],g=y.width/y.height,w=c/u;m||!f&&c>y.width&&u>y.height?(p=y.width,h=y.height,b.w=p,b.h=h):w>g?(p=y.width,h=Math.floor(p/w)):(h=y.height,p=Math.floor(h*w))}i.push({width:p,height:h,src:ki.getBmgSrcNext(s,v(v({w:m&&f?0:p,h:m&&!f?0:h,s:!0},m?{a:b}:{c:!r}),{},{dpr:2})),original:a})}}catch(t){o.e(t)}finally{o.f()}return i}(this.list,{single:{horizontal:{width:240,height:135},vertical:{width:135,height:180}},multiple:{width:88,height:88}}).slice(0,8)}},{key:"handleView",value:function(t){uh(this.list.map((function(t){return{src:t.img_src,width:t.img_width,height:t.img_height}})),t||0)}},{key:"render",value:function(){var t=this;return qe(gs||(gs=g(['\n      <div id="content">\n        ',"\n        ","\n      </div>\n    "])),this.items.map((function(e,n){return qe(ws||(ws=g([' <img\n            src="','"\n            width="','"\n            height="','"\n            loading="lazy"\n            @click=',"\n          />"])),e.src,e.width,e.height,(function(){return t.handleView(n)}))})),this.list.length>this.items.length?qe(xs||(xs=g(['<div id="more-tag">+',"</div>"])),this.list.length-this.items.length):"")}}])}(fn);function vh(t){return new Promise((function(e,n){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.onerror=function(){n(new Error("blobToBase64 error"))},i.readAsDataURL(t)}))}function mh(){var t={};return t.promise=new Promise((function(e,n){t.resolve=e,t.reject=n})),t}fh.styles=ve(ks||(ks=g(["\n    :host {\n    }\n    #content {\n      position: relative;\n      display: flex;\n      flex-wrap: wrap;\n      gap: 4px;\n      max-width: 364px;\n    }\n    #content img {\n      display: block;\n      border-radius: var(--bili-comment-picutres-border-radius, 6px);\n      cursor: zoom-in;\n    }\n    #more-tag {\n      position: absolute;\n      right: 4px;\n      bottom: 4px;\n      height: 20px;\n      padding: 0 6px;\n      border-radius: 4px;\n      font-size: 13px;\n      color: var(--text_white);\n      font-weight: 500;\n      line-height: 18px;\n      background: rgba(0, 0, 0, 0.7);\n      pointer-events: none;\n    }\n  "]))),hh([gn({type:Array})],fh.prototype,"list",2),hh([wn()],fh.prototype,"items",1),fh=hh([mn("bili-comment-pictures-renderer")],fh);var bh,yh,gh,wh,xh,kh,_h,Ah,Eh,Ch,Th,Sh,Oh,Ph,Ih,Rh,jh,Lh,Mh=function(t,e,n){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Dh=function(t,e,n){return function(t,e,n){if(!e.has(t))throw TypeError("Cannot "+n)}(t,e,"access private method"),n},Nh=1048576,Bh=function(t){return t[t.PICTURE_UPLOAD_STATUS_INITIAL=0]="PICTURE_UPLOAD_STATUS_INITIAL",t[t.PICTURE_UPLOAD_STATUS_SUCCESS=1]="PICTURE_UPLOAD_STATUS_SUCCESS",t[t.PICTURE_UPLOAD_STATUS_FAILURE=2]="PICTURE_UPLOAD_STATUS_FAILURE",t}(Bh||{}),zh=function(){return s((function t(e){o(this,t),Mh(this,bh),Mh(this,gh),Mh(this,xh),Mh(this,_h),Mh(this,Eh),Mh(this,Th),Mh(this,Oh),Mh(this,Ih),Mh(this,jh),this.defer=null,this.config=Object.assign({},{remoteOptions:{url:"",body:function(){return{}}},accept:["png","jpeg","jpg","gif"],multiple:!1,maxSize:20,minWidth:10,minHeight:10,onComplete:function(){},onError:function(){}},e||{}),Dh(this,bh,yh).call(this)}),[{key:"trigger",value:function(){return this.defer=mh(),this.el.click(),this.defer.promise}}])}();bh=new WeakSet,yh=function(){var t=document.createElement("input");t.type="file",this.config.multiple&&t.setAttribute("multiple","multiple");var e=this.config.accept.filter(Boolean).map((function(t){return"image/".concat(t)})).join(", ");t.accept=e||"image/png, image/jpeg, image/jpg, image/gif",t.name="upload",t.addEventListener("change",Dh(this,Ih,Rh).bind(this)),this.el=t,this.defer=null},gh=new WeakSet,wh=function(t){for(var e=t.type||"",n=0;n<this.config.accept.length;n++)if(e.indexOf(this.config.accept[n])>-1)return"";return"仅支持".concat(this.config.accept.map((function(t){return t.toLocaleUpperCase()})).join(" "))},xh=new WeakSet,kh=function(t){return((null==t?void 0:t.type)||"").indexOf("gif")>-1?Math.floor(t.size/Nh)>=8?"请上传小于".concat(8,"MB的Gif图片"):"":Math.floor(t.size/Nh)>=this.config.maxSize?"请上传小于".concat(this.config.maxSize,"MB的图片"):""},_h=new WeakSet,Ah=function(t){return t<this.config.minWidth?"图片宽度不得小于".concat(this.config.minWidth,"像素"):""},Eh=new WeakSet,Ch=function(t){return t<this.config.minHeight?"图片高度不得小于".concat(this.config.minHeight,"像素"):""},Th=new WeakSet,Sh=function(t,e){var n=this;return new Promise((function(r,o){var a=function(e){t.status=2,t.msg=e},s=Dh(n,gh,wh).call(n,e);if(s)return a(s),o(t);var l=Dh(n,xh,kh).call(n,e);if(l)return a(l),o(t);var c=new Image;c.src=URL.createObjectURL(e),c.onload=i(m().mark((function i(){var s,l,u;return m().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(s=Dh(n,_h,Ah).call(n,c.width))){i.next=3;break}return i.abrupt("return",(a(s),o(t)));case 3:if(!(l=Dh(n,Eh,Ch).call(n,c.height))){i.next=6;break}return i.abrupt("return",(a(l),o(t)));case 6:return i.prev=6,i.next=9,vh(e);case 9:t.src=i.sent,i.next=15;break;case 12:i.prev=12,i.t0=i.catch(6),console.log(i.t0);case 15:return i.prev=15,i.next=18,Gc.request({url:n.config.remoteOptions.url,method:"POST",data:n.config.remoteOptions.body(e)});case 18:if(0===(u=i.sent).code){i.next=21;break}throw new Error(u.message);case 21:t.data=n.config.remoteOptions.response(u),t.status=1,r(t),i.next=27;break;case 24:i.prev=24,i.t1=i.catch(15),a("上传失败"),o(t);case 27:case"end":return i.stop()}}),i,null,[[6,12],[15,24]])})))}))},Oh=new WeakSet,Ph=function(){return{status:0,msg:"",src:"",data:null}},Ih=new WeakSet,Rh=function(t){var e,n,r=this,o=[],a=t.target,s=Array.from(a.files);if(a.value="",0===s.length)return null==(e=this.defer)?void 0:e.reject("empty");this.config.onBeforeUpload&&this.config.onBeforeUpload(s);var l=[];s.forEach((function(t){var e=Dh(r,Oh,Ph).call(r);o.push(e),l.push(Dh(r,Th,Sh).call(r,e,t))})),setTimeout(i(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l.length!==o.length){t.next=10;break}return t.prev=1,t.next=4,Promise.all(l);case 4:Dh(r,jh,Lh).call(r,r.config.onComplete,o),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),Dh(r,jh,Lh).call(r,r.config.onError,t.t0);case 10:case"end":return t.stop()}}),t,null,[[1,7]])})))),null==(n=this.defer)||n.resolve(o)},jh=new WeakSet,Lh=function(){var t=i(m().mark((function t(e){var n,i,r,o=arguments;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"==typeof e){t.next=2;break}throw new Error("cb is not a function");case 2:for(n=o.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=o[r];return t.next=5,e.apply(void 0,i);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),zh.status=Bh;var Uh=Object.defineProperty,Fh=Object.getOwnPropertyDescriptor,Vh=function(t,e,n,i){for(var r,o=i>1?void 0:i?Fh(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Uh(e,n,o),o},Hh=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.items=[],t.showSlideLeft=!1,t.showSlideRight=!1,t.slideOffsetX=0,t.slideToRight=!1,t}return p(e,t),s(e,[{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),this.uploader=new zh({remoteOptions:{url:"/x/dynamic/feed/draw/upload_bfs",body:function(t){var e=new FormData;return e.append("file_up",t),e.append("biz","new_dyn"),e.append("category","daily"),e},response:function(t){return{img_src:t.data.image_url,img_width:t.data.image_width,img_height:t.data.image_height,img_size:t.data.img_size}}},accept:this.accept||["png","jpeg","jpg"],multiple:!0,onComplete:function(){t.requestUpdate(),t.updateState()},onBeforeUpload:function(e){var n=e.length+t.items.length-9;n>0&&(e.splice(e.length-n),Fc.show("上传图片不得超过9张（￣∞￣）"))}}),this.disposables.addEventListener(window,"resize",this.handleSlideBtnVisible.bind(this))}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose()}},{key:"reset",value:function(){this.items=[],this.updateState()}},{key:"trigger",value:(n=i(m().mark((function t(){var e;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.uploader.trigger();case 3:e=t.sent,this.items=[].concat(w(this.items),w(e)),this.items.length&&this.updateVisible(!0),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Fc.show(t.t0.message);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return n.apply(this,arguments)})},{key:"updateState",value:function(){this.handleSlideBtnVisible(),this.dispatchEvent(new CustomEvent("change",{detail:this.items.filter((function(t){return t.data&&t.status===zh.status.PICTURE_UPLOAD_STATUS_SUCCESS})).map((function(t){return t.data}))}))}},{key:"handleComputeOffset",value:function(){var t=this.contentEl.parentElement.offsetWidth,e=this.contentEl.offsetWidth;this.slideOffsetX=Math.max(0,e+16-t)}},{key:"handleSlideBtnVisible",value:function(){if(this.handleComputeOffset(),this.slideOffsetX<=0)return this.showSlideLeft=!1,void(this.showSlideRight=!1);this.showSlideLeft=this.slideToRight,this.showSlideRight=!this.showSlideLeft}},{key:"handleSlide",value:function(t){0!==this.slideOffsetX&&(this.slideToRight=t,this.showSlideLeft=t,this.showSlideRight=!this.showSlideLeft)}},{key:"updateVisible",value:function(t){this.style.display=t?"flex":"none"}},{key:"removeItem",value:function(t){var e=w(this.items);e.splice(t,1),this.items=e,0===this.items.length&&this.updateVisible(!1),this.updateState()}},{key:"itemTemplate",value:function(t,e){var n=this;return qe(Es||(Es=g(['<div class="item">\n      <div class="close" @click=','>\n        <bili-icon icon="BDC/xmark_close_line/1" size="12"> </bili-icon>\n      </div>\n      '," ","\n    </div>"])),(function(){return n.removeItem(e)}),t.src?qe(Cs||(Cs=g(["<img src=",' alt="图片" />'])),t.src):"",function(){switch(t.status){case zh.status.PICTURE_UPLOAD_STATUS_INITIAL:return qe(_s||(_s=g(['<div class="mask">\n            <img class="loading" width="24" height="24" src="//i0.hdslb.com/bfs/static/jinkela/long/gif/loading-blue.gif" />\n          </div>'])));case zh.status.PICTURE_UPLOAD_STATUS_FAILURE:return qe(As||(As=g(['<div class="mask error"><div class="msg">',"</div></div>"])),t.msg||"上传失败");case zh.status.PICTURE_UPLOAD_STATUS_SUCCESS:default:return""}}())}},{key:"render",value:function(){var t=this;return qe(Ts||(Ts=g(['\n      <div\n        id="wrapper"\n        class="','"\n      >\n        <div id="shadow" class="left"></div>\n        <div id="slide-btn" class="left" @click=','>\n          <bili-icon icon="BDC/arrow_back_left_line/3" size="12"></bili-icon>\n        </div>\n        <div\n          id="content"\n          style="','"\n        >\n          ','\n        </div>\n        <div id="slide-btn" class="right" @click=','>\n          <bili-icon icon="BDC/arrow_back_left_line/3" size="12"></bili-icon>\n        </div>\n        <div id="shadow" class="right"></div>\n      </div>\n    '])),Ea({"slide-left":this.showSlideLeft,"slide-right":this.showSlideRight}),(function(){return t.handleSlide(!1)}),Gn({transform:"translateX(".concat(this.slideToRight?-this.slideOffsetX:0,"px)")}),this.items.map((function(e,n){return t.itemTemplate(e,n)})),(function(){return t.handleSlide(!0)}))}}]);var n}(fn);Hh.styles=ve(Ss||(Ss=g(["\n    :host {\n      display: none;\n    }\n    #wrapper {\n      position: relative;\n      padding: 0 8px;\n      width: 100%;\n      overflow: hidden;\n    }\n    #wrapper.slide-left #slide-btn.left,\n    #wrapper.slide-left #shadow.left {\n      display: flex;\n    }\n    #wrapper.slide-right #slide-btn.right,\n    #wrapper.slide-right #shadow.right {\n      display: flex;\n    }\n    #slide-btn {\n      position: absolute;\n      top: 50%;\n      display: none;\n      justify-content: center;\n      align-items: center;\n      width: 24px;\n      height: 24px;\n      border-radius: 50%;\n      border: 1px solid var(--line_regular);\n      background-color: #fff;\n      color: var(--text3);\n      cursor: pointer;\n      z-index: 2;\n    }\n    #slide-btn.left {\n      left: 8px;\n      transform: translateY(-50%);\n    }\n    #slide-btn.right {\n      right: 8px;\n      transform: translateY(-50%) rotate(180deg);\n    }\n    #shadow {\n      display: none;\n      position: absolute;\n      top: 0;\n      width: 20px;\n      height: 100%;\n      pointer-events: none;\n      z-index: 1;\n    }\n    #shadow.left {\n      left: 0;\n      background: linear-gradient(to right, #fff, #fff 28.5%, rgba(255, 255, 255, 0) 100%);\n    }\n    #shadow.right {\n      right: 0;\n      background: linear-gradient(to left, #fff 28.5%, rgba(255, 255, 255, 0) 100%);\n    }\n    #content {\n      width: fit-content;\n      display: flex;\n      flex-wrap: nowrap;\n      transition: 0.2s ease-in-out;\n    }\n    .item {\n      position: relative;\n      width: 72px;\n      height: 72px;\n      border-radius: 4px;\n      background-color: #f1f2f3;\n      overflow: hidden;\n      flex-shrink: 0;\n    }\n    .item .close {\n      position: absolute;\n      top: 0;\n      right: 0;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: 20px;\n      height: 20px;\n      border-radius: 0 4px;\n      background-color: #0003;\n      color: #fff;\n      cursor: pointer;\n      z-index: 2;\n    }\n    .item > img {\n      width: 100%;\n      height: 100%;\n      object-fit: cover;\n    }\n    .item .mask {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      background-color: #0005;\n      flex-direction: column;\n      color: #fff;\n      font-size: 20px;\n      z-index: 1;\n    }\n    .item .mask.error {\n      color: #f85a54;\n    }\n    .item .mask .msg {\n      height: 14px;\n      font-size: 20px;\n      transform: scale(0.5);\n      transform-origin: center center;\n      font-weight: 500;\n      white-space: nowrap;\n    }\n\n    #content .item:not(:last-child) {\n      margin-right: 8px;\n    }\n  "]))),Vh([gn()],Hh.prototype,"accept",2),Vh([wn()],Hh.prototype,"items",2),Vh([wn()],Hh.prototype,"showSlideLeft",2),Vh([wn()],Hh.prototype,"showSlideRight",2),Vh([wn()],Hh.prototype,"slideOffsetX",2),Vh([wn()],Hh.prototype,"slideToRight",2),Vh([_n("#content")],Hh.prototype,"contentEl",2),Hh=Vh([mn("bili-comment-pictures-upload")],Hh);var Wh=function(t,e){if(!t)return[];var n=t.match(e);if(!n)return[{type:0,text:t}];var i=0,r=n.reduce((function(e,n){var r=[],o=t.slice(i).indexOf(n),a=t.slice(i,i+o);return a&&r.push({type:0,text:a}),r.push({type:1,text:n}),i=i+o+n.length,e.concat(r)}),[]);return i<t.length&&r.push({type:0,text:t.slice(i)}),r};function $h(t,e){return function(n,i){for(var r=0;r<i.length;r++){var o=i[r];o.type?n.push(t(o.text)):e(n,o.text)}}}var qh=Object.defineProperty,Gh=Object.defineProperties,Xh=Object.getOwnPropertyDescriptors,Yh=Object.getOwnPropertySymbols,Zh=Object.prototype.hasOwnProperty,Qh=Object.prototype.propertyIsEnumerable,Kh=function(t,e,n){return e in t?qh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},Jh=function(t,e){for(var n in e||(e={}))Zh.call(e,n)&&Kh(t,n,e[n]);if(Yh){var i,r=l(Yh(e));try{for(r.s();!(i=r.n()).done;){n=i.value;Qh.call(e,n)&&Kh(t,n,e[n])}}catch(t){r.e(t)}finally{r.f()}}return t},tf=function(t,e,n){return Kh(t,"symbol"!=k(e)?e+"":e,n),n},ef=/(https?:\/\/)((?:[a-zA-Z0-9]|[_-](?=[a-zA-Z0-9]))+(?:\.(?:[a-zA-Z0-9]|[_-](?=[a-zA-Z0-9]))*)+)((?:\/(?!\/)(?:[a-zA-Z0-9]|[.~!@$%^&*=+_-](?=[a-zA-Z0-9]))*)*)([?#][a-zA-Z0-9\[{\]}\\\|;:'",<.>/?`~!@#$%^&*()=+_-]{0,256})?/,nf=/(https?:\/\/)((?:[a-zA-Z0-9]|[_-](?=[a-zA-Z0-9]))+(?:\.(?:[a-zA-Z0-9]|[_-](?=[a-zA-Z0-9]))*)+)((?:\/(?!\/)(?:[a-zA-Z0-9]|[.~!@$%^&*=+_-](?=[a-zA-Z0-9]))*)*)/,rf="default",of={blacklist:{domain:[],rex:[]},whitelist:{domain:[],rex:[]}},af=function(t){return function(t,e){return Gh(t,Xh(e))}(Jh({},null!=t?t:{}),{appKey:"333.1339",nscode:7})},sf=function(t){for(var e=[],n=0;n<t.length;n++)/[^a-zA-Z0-9]/.test(t[n])?e.push("\\".concat(t[n])):e.push(t[n]);return e.join("")},lf=function(t,e){var n,i,r,o,a,s,l,c,u=null!=e?e:rf,d=Jh({},of);try{var p=t,h=Jh({},of),f=Jh({},of);h={blacklist:JSON.parse(null!=(i=null==(n=null==p?void 0:p[rf])?void 0:n.blacklist)?i:"{}"),whitelist:JSON.parse(null!=(o=null==(r=null==p?void 0:p[rf])?void 0:r.whitelist)?o:"{}")},u!==rf&&(f={blacklist:JSON.parse(null!=(s=null==(a=null==p?void 0:p[u])?void 0:a.blacklist)?s:"{}"),whitelist:JSON.parse(null!=(c=null==(l=null==p?void 0:p[u])?void 0:l.whitelist)?c:"{}")}),d=function(t){var e={domain:[],rex:[]},n={domain:[],rex:[]};return null==t||t.forEach((function(t){var i,r,o,a,s,l,c,u,d,p,h,f,v,m,b,y;null==(c=e.domain)||(i=c).push.apply(i,w(null!=(l=null==(s=null==t?void 0:t.whitelist)?void 0:s.domain)?l:[])),null==(p=e.rex)||(r=p).push.apply(r,w(null!=(d=null==(u=null==t?void 0:t.whitelist)?void 0:u.rex)?d:[])),null==(v=n.domain)||(o=v).push.apply(o,w(null!=(f=null==(h=null==t?void 0:t.blacklist)?void 0:h.domain)?f:[])),null==(y=n.rex)||(a=y).push.apply(a,w(null!=(b=null==(m=null==t?void 0:t.blacklist)?void 0:m.rex)?b:[]))})),{whitelist:e,blacklist:n}}([h,f])}catch(p){console.warn(p)}return d},cf=function(t,e){var n,i,r,o,a,s,c,u,d,p;if("string"!=typeof t)return!1;var h=null!=(i=null==(n=nf.exec(t))?void 0:n[0])?i:"";if(!h)return!1;var f,v=l(null!=(o=null==(r=null==e?void 0:e.blacklist)?void 0:r.rex)?o:[]);try{for(v.s();!(f=v.n()).done;){var m=f.value;if(new RegExp(m).test(h))return!1}}catch(t){v.e(t)}finally{v.f()}var b,y=l(null!=(s=null==(a=null==e?void 0:e.blacklist)?void 0:a.domain)?s:[]);try{for(y.s();!(b=y.n()).done;){var g=b.value;if(new RegExp("(?:^(?:https?://)?(?:[a-zA-Z0-9_-]+.)?)(".concat(sf(g),")(?=[\\/?#]|$)")).test(h))return!1}}catch(t){y.e(t)}finally{y.f()}var w,x=l(null!=(u=null==(c=null==e?void 0:e.whitelist)?void 0:c.rex)?u:[]);try{for(x.s();!(w=x.n()).done;){var k=w.value;if(new RegExp(k).test(h))return!0}}catch(t){x.e(t)}finally{x.f()}var _,A=l(null!=(p=null==(d=null==e?void 0:e.whitelist)?void 0:d.domain)?p:[]);try{for(A.s();!(_=A.n()).done;){var E=_.value;if(new RegExp("(?:^(?:https?://)?(?:[a-zA-Z0-9_-]+.)?)(".concat(sf(E),")(?=[\\/?#]|$)")).test(h))return!0}}catch(t){A.e(t)}finally{A.f()}return!1},uf=function(){return s((function t(e){var n,i;o(this,t),tf(this,"rawKvConfig",{}),tf(this,"scene",rf),tf(this,"urlRuleSceneConfig",Jh({},of)),this.rawKvConfig=null!=(n=null==e?void 0:e.rawKvConfig)?n:{},this.scene=null!=(i=null==e?void 0:e.scene)?i:rf,this.urlRuleSceneConfig=lf(this.rawKvConfig,this.scene)}),[{key:"isWhitelistUrl",value:function(t){return cf(t,this.urlRuleSceneConfig)}},{key:"getProcessedText",value:function(t){return function(t,e){if("string"!=typeof t)return[];for(var n=[],i=t.matchAll(new RegExp(ef,"g")),r=0,o=0,a=Array.from(i);o<a.length;o++){var s=a[o],l=s[0];if(cf(l,e)){var c=s.index,u=c+l.length;r<c&&n.push({value:t.slice(r,c),type:"text"}),n.push({value:l,type:"link"}),r=u}}return r<t.length&&n.push({value:t.slice(r,t.length),type:"text"}),n}(t,this.urlRuleSceneConfig)}}],[{key:"getKvInitConfig",value:function(t){return af(t)}}])}(),df=null,pf=function(){var t=i(m().mark((function t(){var e;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(df){t.next=13;break}return t.prev=1,t.next=4,ei(uf.getKvInitConfig());case 4:return t.next=6,t.sent.getAll();case 6:e=t.sent,df=new uf({rawKvConfig:e,scene:"comments"}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),Tu("tech","comments.urlkv.failed",{});case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(){return t.apply(this,arguments)}}(),hf={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},ff=function(t){return t.replace(/[&<>"'``]/g,(function(t){return hf[t]||t}))},vf=function(t,e){return t=t.replace(/^(https?:)?\/\//,"//"),e?0===t.indexOf("//")?t:"//".concat(t):t},mf="%[a-f0-9]{2}",bf=new RegExp("("+mf+")|([^%]+?)","gi"),yf=new RegExp("("+mf+")+","gi");function gf(t,e){try{return[decodeURIComponent(t.join(""))]}catch(t){}if(1===t.length)return t;e=e||1;var n=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],gf(n),gf(i))}function wf(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(bf)||[],n=1;n<e.length;n++)e=(t=gf(e,n).join("")).match(bf)||[];return t}}function xf(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+k(t)+"`");try{return decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},n=yf.exec(t);n;){try{e[n[0]]=decodeURIComponent(n[0])}catch(t){var i=wf(n[0]);i!==n[0]&&(e[n[0]]=i)}n=yf.exec(t)}e["%C2"]="�";for(var r=0,o=Object.keys(e);r<o.length;r++){var a=o[r];t=t.replace(new RegExp(a,"g"),e[a])}return t}(t)}}function kf(t,e){var n={};if(Array.isArray(e)){var i,r=l(e);try{for(r.s();!(i=r.n()).done;){var o=i.value,a=Object.getOwnPropertyDescriptor(t,o);null!=a&&a.enumerable&&Object.defineProperty(n,o,a)}}catch(t){r.e(t)}finally{r.f()}}else{var s,c=l(Reflect.ownKeys(t));try{for(c.s();!(s=c.n()).done;){var u=s.value,d=Object.getOwnPropertyDescriptor(t,u);if(d.enumerable)e(u,t[u],t)&&Object.defineProperty(n,u,d)}}catch(t){c.e(t)}finally{c.f()}}return n}function _f(t,e){if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===t||""===e)return[];var n=t.indexOf(e);return-1===n?[]:[t.slice(0,n),t.slice(n+e.length)]}var Af=function(t){return null==t},Ef=function(t){return encodeURIComponent(t).replaceAll(/[!'()*]/g,(function(t){return"%".concat(t.charCodeAt(0).toString(16).toUpperCase())}))},Cf=Symbol("encodeFragmentIdentifier");function Tf(t){if("string"!=typeof t||1!==t.length)throw new TypeError("arrayFormatSeparator must be single character string")}function Sf(t,e){return e.encode?e.strict?Ef(t):encodeURIComponent(t):t}function Of(t,e){return e.decode?xf(t):t}function Pf(t){return Array.isArray(t)?t.sort():"object"==k(t)?Pf(Object.keys(t)).sort((function(t,e){return Number(t)-Number(e)})).map((function(e){return t[e]})):t}function If(t){var e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function Rf(t,e,n){return"string"===n&&"string"==typeof t?t:"function"==typeof n&&"string"==typeof t?n(t):!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()?"number"===n&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()||e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?Number(t):t:"true"===t.toLowerCase()}function jf(t){var e=(t=If(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function Lf(t,e){Tf((e=v({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null)},e)).arrayFormatSeparator);var n=function(t){var e;switch(t.arrayFormat){case"index":return function(t,n,i){e=/\[(\d*)]$/.exec(t),t=t.replace(/\[\d*]$/,""),e?(void 0===i[t]&&(i[t]={}),i[t][e[1]]=n):i[t]=n};case"bracket":return function(t,n,i){e=/(\[])$/.exec(t),t=t.replace(/\[]$/,""),e?void 0!==i[t]?i[t]=[].concat(w(i[t]),[n]):i[t]=[n]:i[t]=n};case"colon-list-separator":return function(t,n,i){e=/(:list)$/.exec(t),t=t.replace(/:list$/,""),e?void 0!==i[t]?i[t]=[].concat(w(i[t]),[n]):i[t]=[n]:i[t]=n};case"comma":case"separator":return function(e,n,i){var r="string"==typeof n&&n.includes(t.arrayFormatSeparator),o="string"==typeof n&&!r&&Of(n,t).includes(t.arrayFormatSeparator);n=o?Of(n,t):n;var a=r||o?n.split(t.arrayFormatSeparator).map((function(e){return Of(e,t)})):null===n?n:Of(n,t);i[e]=a};case"bracket-separator":return function(e,n,i){var r=/(\[])$/.test(e);if(e=e.replace(/\[]$/,""),r){var o=null===n?[]:n.split(t.arrayFormatSeparator).map((function(e){return Of(e,t)}));void 0!==i[e]?i[e]=[].concat(w(i[e]),w(o)):i[e]=o}else i[e]=n&&Of(n,t)};default:return function(t,e,n){void 0!==n[t]?n[t]=[].concat(w([n[t]].flat()),[e]):n[t]=e}}}(e),i=Object.create(null);if("string"!=typeof t||!(t=t.trim().replace(/^[?#&]/,"")))return i;var r,o=l(t.split("&"));try{for(o.s();!(r=o.n()).done;){var a=r.value;if(""!==a){var s=e.decode?a.replaceAll("+"," "):a,c=y(_f(s,"="),2),u=c[0],d=c[1];void 0===u&&(u=s),d=void 0===d?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?d:Of(d,e),n(Of(u,e),d,i)}}}catch(t){o.e(t)}finally{o.f()}for(var p=0,h=Object.entries(i);p<h.length;p++){var f=y(h[p],2),m=f[0],b=f[1];if("object"==k(b)&&null!==b&&"string"!==e.types[m])for(var g=0,x=Object.entries(b);g<x.length;g++){var _=y(x[g],2),A=_[0],E=_[1],C=e.types[m]?e.types[m].replace("[]",""):void 0;b[A]=Rf(E,e,C)}else"object"==k(b)&&null!==b&&"string"===e.types[m]?i[m]=Object.values(b).join(e.arrayFormatSeparator):i[m]=Rf(b,e,e.types[m])}return!1===e.sort?i:(!0===e.sort?Object.keys(i).sort():Object.keys(i).sort(e.sort)).reduce((function(t,e){var n=i[e];return t[e]=n&&"object"==k(n)&&!Array.isArray(n)?Pf(n):n,t}),Object.create(null))}function Mf(t,e){if(!t)return"";Tf((e=v({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e)).arrayFormatSeparator);for(var n=function(n){return e.skipNull&&Af(t[n])||e.skipEmptyString&&""===t[n]},i=function(t){switch(t.arrayFormat){case"index":return function(e){return function(n,i){var r=n.length;return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:[].concat(w(n),null===i?[[Sf(e,t),"[",r,"]"].join("")]:[[Sf(e,t),"[",Sf(r,t),"]=",Sf(i,t)].join("")])}};case"bracket":return function(e){return function(n,i){return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:[].concat(w(n),null===i?[[Sf(e,t),"[]"].join("")]:[[Sf(e,t),"[]=",Sf(i,t)].join("")])}};case"colon-list-separator":return function(e){return function(n,i){return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:[].concat(w(n),null===i?[[Sf(e,t),":list="].join("")]:[[Sf(e,t),":list=",Sf(i,t)].join("")])}};case"comma":case"separator":case"bracket-separator":var e="bracket-separator"===t.arrayFormat?"[]=":"=";return function(n){return function(i,r){return void 0===r||t.skipNull&&null===r||t.skipEmptyString&&""===r?i:(r=null===r?"":r,0===i.length?[[Sf(n,t),e,Sf(r,t)].join("")]:[[i,Sf(r,t)].join(t.arrayFormatSeparator)])}};default:return function(e){return function(n,i){return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:[].concat(w(n),null===i?[Sf(e,t)]:[[Sf(e,t),"=",Sf(i,t)].join("")])}}}}(e),r={},o=0,a=Object.entries(t);o<a.length;o++){var s=y(a[o],2),l=s[0],c=s[1];n(l)||(r[l]=c)}var u=Object.keys(r);return!1!==e.sort&&u.sort(e.sort),u.map((function(n){var r=t[n];return void 0===r?"":null===r?Sf(n,e):Array.isArray(r)?0===r.length&&"bracket-separator"===e.arrayFormat?Sf(n,e)+"[]":r.reduce(i(n),[]).join("&"):Sf(n,e)+"="+Sf(r,e)})).filter((function(t){return t.length>0})).join("&")}function Df(t,e){var n,i;e=v({decode:!0},e);var r=y(_f(t,"#"),2),o=r[0],a=r[1];return void 0===o&&(o=t),v({url:null!==(n=null==(i=null==o?void 0:o.split("?"))?void 0:i[0])&&void 0!==n?n:"",query:Lf(jf(t),e)},e&&e.parseFragmentIdentifier&&a?{fragmentIdentifier:Of(a,e)}:{})}function Nf(t,e){e=v(c({encode:!0,strict:!0},Cf,!0),e);var n=If(t.url).split("?")[0]||"",i=Mf(v(v({},Lf(jf(t.url),{sort:!1})),t.query),e);i&&(i="?".concat(i));var r=function(t){var e="",n=t.indexOf("#");return-1!==n&&(e=t.slice(n)),e}(t.url);if("string"==typeof t.fragmentIdentifier){var o=new URL(n);o.hash=t.fragmentIdentifier,r=e[Cf]?o.hash:"#".concat(t.fragmentIdentifier)}return"".concat(n).concat(i).concat(r)}function Bf(t,e,n){var i=Df(t,n=v(c({parseFragmentIdentifier:!0},Cf,!1),n)),r=i.url,o=i.query,a=i.fragmentIdentifier;return Nf({url:r,query:kf(o,e),fragmentIdentifier:a},n)}var zf=Object.freeze(Object.defineProperty({__proto__:null,exclude:function(t,e,n){var i=Array.isArray(e)?function(t){return!e.includes(t)}:function(t,n){return!e(t,n)};return Bf(t,i,n)},extract:jf,parse:Lf,parseUrl:Df,pick:Bf,stringify:Mf,stringifyUrl:Nf},Symbol.toStringTag,{value:"Module"})),Uf=null,Ff=function(t){var e;if(("undefined"==typeof window?"undefined":k(window))>"u")return null;if(t||null===Uf){var n=null==(e=zf.parseUrl(location.href).query)?void 0:e.spm_id_from;"string"==typeof n&&(Uf=n)}return Uf},Vf=function(t,e){var n=zf.parseUrl(t);return n.query.spm_id_from=e,zf.stringifyUrl(n)},Hf="BDC/chain_link_line/1",Wf="BDC/video_circle_line/1",$f="BDC/column_line/1",qf="BDC/vote_line/2",Gf=function(t,e,n,i,r){return{tag:"a",style:i,dataset:r||{type:"link"},a:{text:ff(e||"网页链接"),href:t,icon:n,target:"_blank"}}},Xf=function(t){return{tag:"span",span:{text:ff(t)}}},Yf="(https?://)",Zf="([/.$*?~=#!%@&A-Za-z0-9_-]*)";function Qf(t,e,n,i){var r,o=[];if(null==(r=t.content)||!r.message)return o.push(Xf("暂不支持展示的内容")),o;var a=t.content,s=a.message,l=a.emote,c=a.members,u=a.jump_url,d=a.vote,p=df,h=new RegExp("(AV|av|Av|aV)[0-9]+","ug"),f=new RegExp("(BV|bv|Bv|bV)1[1-9A-NP-Za-km-z]{9}","ug"),m=new RegExp("((CV|cv)[0-9]+|(mobile/[0-9]+))","ug"),b=new RegExp("(EP|ep|Ep|eP)[0-9]+","ug"),g=new RegExp("(SS|ss|Ss|sS)[0-9]+","ug"),w=/\[(?:[\0-'\+-Z\\\^-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+\]/g,x=new RegExp("".concat(Yf,"?([a-z0-9A-Z-]{1,15}.)?(bilibili\\.(com|tv|cn)|esheep\\.(com|cn|net)|biligame\\.(com|cn|net)|(bilibiliyoo|im9)\\.com|biliapi\\.net|b23\\.tv|bili22\\.cn|bili33\\.cn|bili23\\.cn|bili2233\\.cn|(sugs\\.suning\\.com)|jueze2021\\.peopleapp\\.com|kaola\\.com|bigfun\\.cn|mcbbs\\.net|mp\\.weixin\\.qq\\.com|static\\.cdsb\\.com|bjnews\\.com\\.cn|720yun\\.com|\\.cctv\\.com)($|/|)").concat(Zf),"ug"),k=new RegExp("".concat(Yf,"?(((uat-)?www\\.bilibili\\.com)|(b23\\.tv|bili22\\.cn|bili33\\.cn|bili23\\.cn|bili2233\\.cn))(/video)?/((av[0-9]+)|((BV)1[1-9A-NP-Za-km-z]{9}))($|/|)").concat(Zf),"ug"),_=new RegExp("".concat(Yf,"?(((uat-)?www\\.bilibili\\.com/bangumi/(play/|media/)|(b23\\.tv|bili22\\.cn|bili33\\.cn|bili23\\.cn|bili2233.cn)/)(ss|ep)[0-9]+)($|/|)").concat(Zf),"ug"),A=new RegExp("".concat(Yf,"?(uat-)?www\\.bilibili\\.com/read/((cv[0-9]+)|(native?id=[0-9]+)|(app/[0-9]+)|(native/[0-9]+)|(mobile/[0-9]+))($|/|)").concat(Zf),"ug"),E=/(\d+#)?(\d+(:|：)){1,2}\d\d/g,C=function(t){t.lastIndex=0},T=$h((function(t){if(null!=l&&l[t]){var e=l[t],n=e.url,i=e.meta,r=e.webp_url,o=e.gif_url,a=r||o||n,s=20,c={width:"1.4em",height:"1.4em","vertical-align":"text-bottom"};return 2===i.size&&(s=50,c={width:"50px",height:"50px"}),function(t,e,n){return{tag:"img",style:n,img:{src:t,alt:e?ff(e):"",loading:"lazy"}}}(ki.getBmgSrcNext(a,{w:s,h:s,dpr:2}),t,c)}return Xf(t)}),(function(t,e){t.push(Xf(e))})),S=$h((function(t){var n=t;if(!1===(null==e?void 0:e.videoTime))return Xf(t);var i="-1";if(t.indexOf("#")>-1){var r=y(t.split("#"),2);i=r[0],t=r[1]}var o=(t=t.replace(/[:：]/g,":")).split(":").map((function(t){return parseInt(t)})).reverse().reduce((function(t,e,n){return t+e*Math.pow(60,n)}),0);return{tag:"a",dataset:{type:"seek","video-time":String(o),"video-part":i},a:{text:n,href:""}}}),(function(t,e){T(t,Wh(e,w))})),O=$h((function(t){return Gf(Dd.ARTICLE(Hc(t)),t,$f)}),(function(t,e){S(t,Wh(e,E))})),P=$h((function(t){return Gf(function(t){var e=Dd.VIDEO({bvid:t});return i&&(e=Vf(e,i)),e}(t),t,Wf)}),(function(t,e){O(t,Wh(e,m))})),I=$h((function(t){return Gf(function(t){var e=Dd.VIDEO({avid:t});return i&&(e=Vf(e,i)),e}(Hc(t)),t,Wf)}),(function(t,e){P(t,Wh(e,f))})),R={};c.length&&c.forEach((function(t){R["@"+t.uname]=t}));var j=$h((function(t){var e=R[t],n=null==e?void 0:e.mid;return Gf(Dd.SPACE(n),t,void 0,void 0,{type:"mention","user-profile-id":n})}),(function(t,e){B(t,e,2)})),L=Object.keys(u||{}),M={},D=function(t,e){var r=e.pc_url,o=e.title,a=e.prefix_icon,s=e.match_once,l=e.icon_position,c=e.extra;if(s&&M[t])return Xf(t);M[t]=!0;var u=1===l,d="";if(r?d=vf(r):(C(x),x.test(t)?(d=vf(t,!0),i&&(C(k),k.test(d)&&(d=Vf(d,i)))):(C(f),C(h),f.test(t)?(d=Dd.VIDEO({bvid:t}),i&&(d=Vf(d,i))):h.test(t)?(d=Dd.VIDEO({avid:Hc(t)}),i&&(d=Vf(d,i))):d=function(t){if(t.startsWith("http")){var e=t.match(/www.bilibili.com\/h5\/note-app\/view\?cvid=(\d+)/);return null!=e&&e[1]?Dd.ARTICLE(e[1]):t}return""}(t))),!d)return Xf(t);var p=o||t,m="",b=!1,y="";null!=c&&c.goods_item_id&&(b=!0,null!=c&&c.goods_pc_click_urls&&Array.isArray(c.goods_pc_click_urls)&&(y=c.goods_pc_click_urls.join(",")),C(x),x.test(t)&&(m=t));var g=b?{type:"goods","goods-url":y,"raw-url":m}:null!=c&&c.is_word_search?{type:"search",keyword:ff(p)}:{type:"link"};return n&&(g=v(v({},g),{},{link:d})),Gf(d,p,a,u?{display:"inline-flex","flex-direction":"row-reverse","--icon-width":"0.65em","--icon-height":"1.2em"}:{"--icon-width":"1.2em","--icon-height":"1.2em"},g)},N=$h((function(t){return null!=u&&u[t]?D(t,u[t]):Gf(Dd.SEARCH(t),t)}),(function(t,e){B(t,e,1)})),B=function(t,e,n){n<=0&&L.length?N(t,Wh(e,new RegExp("(".concat(L.map($c).join("|"),")"),"gu"))):n<=1&&c.length?j(t,Wh(e,new RegExp("@(".concat(c.map((function(t){return t.uname})).join("|"),")"),"gu"))):I(t,Wh(e,h))},z=$h((function(t){if(null!=u&&u[t])return D(t,u[t]);var e=null,i=t;if(null!=(e=i.match(k))&&e[0]){var r=e[0].match(f);if(null!=r&&r[0])return Gf(i,r[0],Wf);var o=e[0].match(h);if(null!=o&&o[0])return Gf(i,o[0],Wf)}if(null!=(e=i.match(_))&&e[0]){var a=e[0].match(g);if(null!=a&&a[0])return Gf(i,a[0],Wf);var s=e[0].match(b);if(null!=s&&s[0])return Gf(i,s[0],Wf)}if(null!=(e=i.match(A))&&e[0]){var l=e[0].match(m);if(null!=l&&l[0])return Gf(i,l[0],$f)}if(n){var c={type:"link",link:i};return Gf(Ld(t),t,Hf,void 0,c)}return Gf(Ld(t),t,Hf)}),(function(t,e){B(t,e,0)})),U=[];if(d){var F="{vote:".concat(d.id,"}");s.indexOf(F)>-1?function(t,e){if(!t)return[];for(var n=[],i=t.indexOf(e);-1!==i;){var r=t.slice(0,i);r&&n.push({type:0,text:r}),n.push({type:1,text:e}),i=(t=t.slice(i+e.length)).indexOf(e)}return t&&n.push({type:0,text:t}),n}(s,F).forEach((function(t){var e=t.type,i=t.text;if(e)if(n){var r={type:"link",link:d.url};U.push(Gf(d.url,d.title,qf,void 0,r))}else U.push(Gf(d.url,d.title,qf));else U.push(Xf(i))})):U.push(Xf(s))}else U.push(Xf(s));return U.forEach((function(t){if("span"!==t.tag)o.push(t);else{var e=t.span.text;z(o,p?p.getProcessedText(e).map((function(t){return{type:"link"===t.type?1:0,text:t.value}})):Wh(e,x))}})),o}function Kf(t){return!!t.reply_control&&!!t.reply_control.is_note_v2}function Jf(t){return t.reply_control?t.reply_control.is_note?{type:"note",oid:t.note_cvid_str}:t.reply_control.is_note_v2&&t.reply_control.fold_pictures?{type:"opus",oid:t.dynamic_id_str}:null:null}var tv=Object.defineProperty,ev=Object.getOwnPropertyDescriptor,nv=function(t,e,n,i){for(var r,o=i>1?void 0:i?ev(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&tv(e,n,o),o},iv=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).data=null,t.userNameColor="",t}return p(e,t),s(e,[{key:"note",get:function(){return!!this.data&&Kf(this.data)}},{key:"expand",get:function(){return!!this.data&&!!Jf(this.data)}},{key:"pictures",get:function(){var t,e,n;return null!=(n=null==(e=null==(t=this.data)?void 0:t.content)?void 0:e.pictures)&&n.length?this.data.content.pictures:null}},{key:"load",value:function(t){this.data=t}},{key:"loadNoteData",value:function(t){var e="",n=[];t.noteContent.forEach((function(t){var i,r,o,a=t.insert;if("video"===(null==(i=a.imageUpload)?void 0:i.source)&&n.length<3&&n.push({img_src:a.imageUpload.url,img_width:a.imageUpload.width}),null!=(o=null==(r=a.tag)?void 0:r.seconds)&&o.toString()){var s=a.tag.seconds,l=a.tag.desc;e=e.concat("".concat(function(t){var e=Math.floor(t/3600),n=Math.floor((t-3600*e)/60),i=t-(3600*e+60*n),r=e.toString().padStart(2,"0"),o=n.toString().padStart(2,"0"),a=i.toString().padStart(2,"0");return e?"".concat(r,":").concat(o,":").concat(a):"".concat(o,":").concat(a)}(s)," ").concat(l))}"string"==typeof a&&(e=e.concat(a))})),e=this.limitContent(e);var i={member:{mid:"1",uname:t.upName,level_info:{current_level:t.upLevel||0},avatar:t.upAvatar,face_nft_new:0,is_contractor:!1,official_verify:{type:-1,desc:""},avatar_item:null,is_senior_member:t.isHardcoreMember?1:0},content:{message:e,members:[],max_line:6,jump_url:{},pictures:n},ctime:"刚刚"===t.noteTime?Date.now()/1e3-1:new Date(t.noteTime).getTime()/1e3,reply_control:{is_note:!0,max_line:6,time_desc:"",location:""}};t.upNameColor&&(this.userNameColor=t.upNameColor),this.data=i}},{key:"limitContent",value:function(t){var e=(t=t.replace(/^\s*/,"").replace(/\s*$/,"")).match(/\n/g);return e&&e.length>6?t.split("\n").slice(0,6).join("\n").slice(0,77).concat("..."):t.length>77?t.slice(0,77).concat("..."):t}},{key:"connectedCallback",value:function(){u(d(e.prototype),"connectedCallback",this).call(this),this.initData()}},{key:"initData",value:function(){var t=this;setTimeout((function(){var e;if(t.data){if(null!=(e=t.data.member)&&e.avatar){var n=t.data.member,i=n.avatar,r=n.mid,o=n.pendant,a=n.vip,s=n.official_verify,l=n.face_nft_new;t.biliAvatar.load(gd({face:i,mid:r,pendant:o||"",vip:a,official:s,nft:null!=l?l:0}),{baseSize:48,isFloat:!0})}t.biliRichText.setContents(Qf(t.data))}}))}},{key:"noteTemplate",value:function(){return qe(Os||(Os=g(['<i id="note">\n      <bili-icon icon="BDC/note_line/1" size="16"></bili-icon>\n      <span>笔记</span>\n    </i>'])))}},{key:"expandTemplate",value:function(){return qe(Ps||(Ps=g(['<span id="expand">展开</span>'])))}},{key:"picturesTemplate",value:function(){return qe(Is||(Is=g(['<div id="pictures">\n      <div id="pic">\n        <bili-comment-pictures-renderer .list=',"></bili-comment-pictures-renderer>\n      </div>\n    </div>"])),this.pictures)}},{key:"render",value:function(){return qe(Rs||(Rs=g(['<div id="body">\n      <div id="user-avatar"><bili-avatar></bili-avatar></div>\n      <div id="main">\n        <div id="header">\n          <bili-comment-user-info\n            .data=','\n            style="','"\n          ></bili-comment-user-info>\n        </div>\n        <div id="content">\n          ','\n\n          <bili-rich-text\n            style="','"\n          ></bili-rich-text>\n          '," ",'\n        </div>\n        <div id="footer">\n          <bili-comment-action-buttons-renderer\n            style="','"\n            .data=',"\n          ></bili-comment-action-buttons-renderer>\n        </div>\n      </div>\n    </div>"])),this.data,this.userNameColor?Gn({"--bili-comment-user-info-name-color":this.userNameColor}):"",this.note?this.noteTemplate():"",Gn({"--bili-rich-text-font-size":"var(--bili-comments-font-size-content)","--bili-rich-text-line-height":"var(--bili-comments-line-height-content)","--bili-rich-text-link-color":"var(--Lb6)","--bili-rich-text-display":"inline"}),this.expand?this.expandTemplate():"",this.pictures?this.picturesTemplate():"",Gn({"--bili-comment-action-buttons-more-display":"var(--bili-comment-hover-more-display)"}),this.data)}}])}(fn);function rv(t){return 1===t.type}function ov(t){var e,n,i=t.reply_control;if(null!=(e=null==i?void 0:i.easter_egg_label)&&e.image){var r=i.easter_egg_label.image;return{type:"easter-egg",width:82,height:36,render:function(){return kc('<img src="'.concat(ki.getBmgSrcNext(r,{w:82,h:36}),'" width="').concat(82,'" height="').concat(36,'" style="transform: translateY(6px)" >'))}}}var o=function(t){var e;if(null!=(e=t.card_label)&&e.length){var n=t.card_label.find((function(t){return rv(t)}));if(n)return n}return null}(t);if(null!=o&&o.background){var a=o.background_width,s=o.background_height;return{type:"awesome-comment",width:a,height:s,render:function(){return kc('<img src="'.concat(ki.getBmgSrcNext(o.background,{w:a,h:s,dpr:2}),'" width="').concat(a,'" height="').concat(s,'">'))}}}return null!=(n=t.member)&&n.user_sailing_v2?{type:"user-sailing",width:288,height:48,render:function(){return qe(Ls||(Ls=g(["<bili-comment-user-sailing-card .data=","></bili-comment-user-sailing-card>"])),t.member.user_sailing_v2)}}:null}iv.styles=ve(js||(js=g(["\n    #body {\n      pointer-events: none;\n      position: relative;\n      padding-left: 80px;\n      --bili-comment-hover-more-display: block;\n    }\n    #user-avatar {\n      position: absolute;\n      left: 20px;\n      top: 0;\n      width: 48px;\n      height: 48px;\n      transform-origin: left top;\n      transform: var(--bili-comments-avatar-size);\n    }\n    #ornament {\n      position: absolute;\n      right: 0;\n      top: 7px;\n      user-select: none;\n    }\n    bili-comment-vote-option {\n      margin-top: 2px;\n      margin-bottom: 6px;\n    }\n    #main {\n      width: 100%;\n    }\n    #header {\n      margin-bottom: 4px;\n    }\n    i {\n      font-size: 12px;\n      font-style: normal;\n    }\n    i#note {\n      width: 48px;\n      height: 22px;\n      display: inline-flex;\n      justify-content: center;\n      align-items: center;\n      border-radius: 4px;\n      color: var(--text3);\n      background-color: var(--bg2);\n      vertical-align: text-bottom;\n    }\n    #content {\n      font-size: var(--bili-comments-font-size-content);\n      line-height: var(--bili-comments-line-height-content);\n      color: var(--text1);\n    }\n    #content #expand {\n      color: var(--brand_blue);\n      cursor: pointer;\n    }\n    #pictures {\n      display: block;\n      width: 100%;\n      margin-top: 8px;\n    }\n  "]))),nv([wn()],iv.prototype,"data",2),nv([wn()],iv.prototype,"userNameColor",2),nv([_n("bili-avatar")],iv.prototype,"biliAvatar",2),nv([_n("bili-rich-text")],iv.prototype,"biliRichText",2),nv([wn()],iv.prototype,"note",1),nv([wn()],iv.prototype,"expand",1),nv([wn()],iv.prototype,"pictures",1),iv=nv([mn("bili-comment-preview-renderer")],iv);var av=null;function sv(t){return av||(av=document.querySelector("bili-user-profile")||document.createElement("bili-user-profile")),av.setup(t)}function lv(){if(av)av.parentElement&&av.parentElement.removeChild(av);else{var t=document.querySelector("bili-user-profile");t&&t.parentElement&&t.parentElement.removeChild(t)}}var cv=function(t,e,n){var i;i=n?null==n?void 0:n.scrollTop:document.documentElement.scrollTop;var r=t.getBoundingClientRect().top+i+(e||0);(n||window).scrollTo({top:r,left:0,behavior:"smooth"})},uv=Object.defineProperty,dv=Object.getOwnPropertyDescriptor,pv=function(t,e,n,i){for(var r,o=i>1?void 0:i?dv(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&uv(e,n,o),o},hv=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.richTextDisposables=null,t.spmPrefix="",t.upMid=0,t.theme="light",t.user=null,t.assist=!1,t.oid="",t.type=0,t.trackObserver=null,t}return p(e,t),s(e,[{key:"ornament",get:function(){return ov(this.data)}},{key:"top",get:function(){return function(t){return!(!t.reply_control||!t.reply_control.is_up_top&&!t.reply_control.is_admin_top)}(this.data)}},{key:"note",get:function(){return Kf(this.data)}},{key:"expandAction",get:function(){return Jf(this.data)}},{key:"expand",get:function(){return!!this.expandAction}},{key:"voteOption",get:function(){var t;return(null==(t=this.data.reply_control)?void 0:t.vote_option)||null}},{key:"vote",get:function(){return this.data.content.vote||null}},{key:"richTextContent",get:function(){return Qf(this.data,this.contentFeatures,!1,"".concat(this.spmPrefix||hi(),".comment.all.click"))}},{key:"getRichTextContent",value:function(){return this.richTextContent}},{key:"pictures",get:function(){var t,e;return null==(t=this.data.content.pictures)||!t.length||null!=(e=this.data.reply_control)&&e.fold_pictures?null:this.data.content.pictures}},{key:"tags",get:function(){return function(t){var e;if(null!=(e=t.card_label)&&e.length){var n=t.card_label.filter((function(t){return!rv(t)}));if(n.length)return n}return null}(this.data)}},{key:"uid",get:function(){return this.data.member.mid}},{key:"spaceLink",get:function(){return Dd.SPACE(this.uid)}},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),this.initData(),setTimeout((function(){var e=t.biliAvatar.parentNode;t.disposables.add(sv(e)),t.trackObserver=new Ed({el:t,type:"show",value:{event:"comment.content",data:{type:t.type,oid:t.oid,rpid:t.data.rpid_str}},handler:function(e,n,i){if("show"===e){var r=[];t.richTextContent.forEach((function(t){var n,o;t.dataset&&"search"===(null==(n=t.dataset)?void 0:n.type)&&null!=(o=t.dataset)&&o.keyword&&(r.push(t.dataset.keyword),Cu(e,"community.public-community.reply-card.underline",v(v({},i),{},{message:t.dataset.keyword})))})),Tu(e,n,v(v({},i),{},{keywords:r.join(",")}),{spmPrefix:t.spmPrefix})}}})}))}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose(),this.clearRichTextDisposables()}},{key:"clearRichTextDisposables",value:function(){this.richTextDisposables&&(this.richTextDisposables.dispose(),this.richTextDisposables=null)}},{key:"initData",value:function(){var t=this;this.clearRichTextDisposables(),setTimeout((function(){var e,n;t.biliAvatar.load(t.data.member.avatar_item,{baseSize:48,isFloat:!0,lazyload:!0}),t.biliRichText.setContents(t.richTextContent),Array.from((null==(e=t.biliRichText.contentsElement)?void 0:e.children)||[]).forEach((function(e){e.dataset.userProfileId&&(t.richTextDisposables||(t.richTextDisposables=On()),t.richTextDisposables.add(sv(e)))})),null!=(n=t.data.$extra)&&n.spotlight&&window.setTimeout((function(){cv(t,-300),setTimeout((function(){t.startSpotlight()}),100)}),100)}))}},{key:"startSpotlight",value:(n=i(m().mark((function t(){var e,n=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="spotlight",this.disposables.addEventListener(this.bodyElement,"transitionend",(function(){n.bodyElement.classList.remove(e),n.bodyElement.style.removeProperty("background-color"),n.bodyElement.style.removeProperty("transition")})),this.bodyElement.classList.add(e),t.next=5,Wc(10);case 5:return this.bodyElement.style.setProperty("transition","background-color 2s 3s"),t.next=8,Wc(10);case 8:this.bodyElement.style.setProperty("background-color","transparent");case 9:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"updated",value:function(t){t.get("data")&&this.initData()}},{key:"handleAction",value:function(t){var e=t.detail,n=e.key,i=e.data;switch(n){case"top":this.dispatchEvent(new CustomEvent("top",{detail:i.active})),this.handleClickTrack(i.active?18:19);break;case"block":this.dispatchEvent(new CustomEvent("block")),this.handleClickTrack(13);break;case"report":this.dispatchEvent(new CustomEvent("report")),this.handleClickTrack(14);break;case"delete":this.dispatchEvent(new CustomEvent("delete")),this.handleClickTrack(23)}}},{key:"handleReply",value:function(){this.dispatchEvent(new CustomEvent("reply"))}},{key:"handleAvatarClick",value:function(t){t.stopPropagation();var e={rpid:this.data.rpid_str};Eu("replyCardProfileClick",e),Tu("click","comment.user_avatar.click",e,{spmPrefix:this.spmPrefix}),this.handleClickTrack(3)}},{key:"handleTextClick",value:function(t){var e,n,i=t.detail;if(i){if("seek"===i.type){var r=Number(i.videoTime),o=Number(i.videoPart);!isNaN(r)&&!isNaN(o)&&(this.dispatchEvent(new CustomEvent("seek",{detail:{time:r,part:o},composed:!0})),this.handleClickTrack(29))}if("search"===i.type){var a={position:32,keyword:i.keyword};Cu("click","community.public-community.reply-card.all",a),Tu("click","comment.content.click",a,{spmPrefix:this.spmPrefix}),this.handleClickTrack(32)}if("goods"===i.type){var s=i.goodsUrl;s&&null!=(n=null==(e=window.BiliCm)?void 0:e.Base)&&n.sendThirdClickUrls&&window.BiliCm.Base.sendThirdClickUrls(s),this.handleClickTrack(15)}"link"===i.type&&this.handleClickTrack(15)}}},{key:"handleExpand",value:function(t){if("opus"!==this.expandAction.type){var e=t.target,n=v(v({},this.expandAction),{},{ref:e});this.dispatchEvent(new CustomEvent("expand",{detail:n})),this.handleClickTrack(24)}else!function(t,e){var n="//www.bilibili.com/blackboard/comment-detail.html?id=".concat(t,"&theme=").concat(e);zd({title:"评论详情",render:function(){return Bd(n,Nd({"min-height":"550px"}))}})}(this.expandAction.oid,this.theme)}},{key:"mainTags",value:function(){var t;return qe(Ms||(Ms=g(['\n      <div id="tags">\n        ','\n        <div class="tag"></div>\n      </div>\n    '])),null==(t=this.tags)?void 0:t.map((function(t){return qe(Ds||(Ds=g(['<div\n              class="tag"\n              style=',"\n            >\n              ","\n            </div>"])),Gn({"--bili-comment-tag-color-light":t.text_color_day,"--bili-comment-tag-color-dark":t.text_color_night,"--bili-comment-tag-bg-light":t.label_color_day,"--bili-comment-tag-bg-dark":t.label_color_night}),t.text_content)})))}},{key:"ornamentTemplate",value:function(){if(!this.ornament)return"";var t=this.ornament,e=t.render,n=t.width,i=t.height;return qe(Ns||(Ns=g(['<div\n      id="ornament"\n      style="','"\n    >\n      ',"\n    </div>"])),Gn({width:"".concat(n,"px"),height:"".concat(i,"px")}),e())}},{key:"isFilterClick",value:function(t){var e=t.target;return[this.biliRichText,this.actionButtons].includes(e)}},{key:"handleClickTrack",value:function(t){this.dispatchEvent(new CustomEvent("track",{detail:{position:t}}))}},{key:"topTemplate",value:function(){return qe(Bs||(Bs=g(['<i id="top">置顶</i>'])))}},{key:"noteTemplate",value:function(){return qe(zs||(zs=g(['<i id="note">\n      <bili-icon icon="BDC/note_line/1" size="16"></bili-icon>\n      <span>笔记</span>\n    </i>'])))}},{key:"expandTemplate",value:function(){return qe(Us||(Us=g(['<span id="expand" @click=',">展开</span>"])),this.handleExpand)}},{key:"voteTemplate",value:function(){var t=this;return qe(Fs||(Fs=g(['<div\n      id="vote"\n      @click=',"\n    >\n      <bili-comment-vote-renderer .data=","></bili-comment-vote-renderer>\n    </div>"])),(function(e){e.stopPropagation(),t.handleClickTrack(10)}),this.vote)}},{key:"picturesTemplate",value:function(){var t=this;return qe(Vs||(Vs=g(['<div\n      id="pictures"\n      @click=',"\n    >\n      <bili-comment-pictures-renderer .list=","></bili-comment-pictures-renderer>\n    </div>"])),(function(e){e.stopPropagation(),t.handleClickTrack(37)}),this.pictures)}},{key:"render",value:function(){var t,e,n=this;return qe(Hs||(Hs=g(['\n      <div\n        id="body"\n        class="','"\n        @click=','\n      >\n        <a\n          href="','"\n          @click=','\n          id="user-avatar"\n          data-user-profile-id="','"\n          data-user-profile-spmid-follow="comment.profile.click"\n          target="_blank"\n        >\n          <bili-avatar></bili-avatar>\n        </a>\n        <div id="main">\n          <div id="header">\n            <bili-comment-user-info\n              .spmPrefix=',"\n              .data=","\n              .upMid=","\n              .medalVisible=","\n              @track=","\n            ></bili-comment-user-info>\n            ","\n          </div>\n          ",'\n          <div id="content">\n            '," ","\n            <bili-rich-text\n              @text-click=",'\n              style="','"\n            ></bili-rich-text>\n            '," ","\n            ",'\n          </div>\n          <div id="footer">\n            <bili-comment-action-buttons-renderer\n              .spmPrefix=',"\n              .user=","\n              .upMid=","\n              .oid=","\n              .type=","\n              .assist=",'\n              style="','"\n              .data=',"\n              @reply=","\n              @action=","\n              @track=","\n            ></bili-comment-action-buttons-renderer>\n          </div>\n          ","\n        </div>\n      </div>\n    "])),Ea(c({spotlight:null!==(t=null==(e=this.data.$extra)?void 0:e.spotlight)&&void 0!==t&&t},this.theme,!0)),(function(t){t.stopPropagation(),!n.isFilterClick(t)&&n.handleClickTrack(1)}),this.spaceLink,this.handleAvatarClick,this.uid,this.spmPrefix,this.data,this.upMid,!0,(function(t){return n.handleClickTrack(t.detail)}),this.ornamentTemplate(),this.voteOption?qe(Ws||(Ws=g(["<bili-comment-vote-option .data=","></bili-comment-vote-option>"])),this.voteOption):"",this.top?this.topTemplate():"",this.note?this.noteTemplate():"",this.handleTextClick,Gn({"--bili-rich-text-font-size":"var(--bili-comments-font-size-content)","--bili-rich-text-line-height":"var(--bili-comments-line-height-content)","--bili-rich-text-link-color":"var(--Lb6)","--bili-rich-text-display":"inline"}),this.expand?this.expandTemplate():"",this.vote?this.voteTemplate():"",this.pictures?this.picturesTemplate():"",this.spmPrefix,this.user,this.upMid,this.oid,this.type,this.assist,Gn({"--bili-comment-action-buttons-more-display":"var(--bili-comment-hover-more-display)"}),this.data,this.handleReply,this.handleAction,(function(t){return n.handleClickTrack(t.detail)}),this.tags&&this.mainTags())}}]);var n}(fn);hv.styles=ve($s||($s=g(["\n    :host {\n      --bili-comment-spotlight-color: var(--brand_blue_thin);\n    }\n    #body.dark .tag {\n      --bili-comment-tag-color: var(--bili-comment-tag-color-dark);\n      --bili-comment-tag-bg: var(--bili-comment-tag-bg-dark);\n    }\n    #body {\n      position: relative;\n      padding-left: 80px;\n      padding-top: 22px;\n      --bili-comment-hover-more-display: none;\n    }\n    #body.spotlight {\n      background-color: var(--bili-comment-spotlight-color);\n      transition: background-color 2s 3s;\n    }\n    #body:hover {\n      --bili-comment-hover-more-display: block;\n    }\n    #user-avatar {\n      position: absolute;\n      left: 20px;\n      top: 22px;\n      width: 48px;\n      height: 48px;\n      transform-origin: left top;\n      transform: var(--bili-comments-avatar-size);\n    }\n    #ornament {\n      position: absolute;\n      right: 0;\n      top: 7px;\n      user-select: none;\n    }\n    bili-comment-vote-option {\n      margin-top: 2px;\n      margin-bottom: 6px;\n    }\n    #main {\n      width: 100%;\n    }\n    #content {\n      width: 100%;\n      display: block;\n      overflow: hidden;\n    }\n    #header {\n      margin-bottom: 4px;\n    }\n    i {\n      font-size: 12px;\n      font-style: normal;\n    }\n    i#top {\n      display: inline-flex;\n      justify-content: center;\n      align-items: center;\n      position: relative;\n      width: 30px;\n      height: 18px;\n      border: 1px solid var(--brand_pink);\n      border-radius: 3px;\n      color: var(--brand_pink);\n      vertical-align: text-bottom;\n      margin-bottom: 0.0666em;\n    }\n    i#note {\n      width: 48px;\n      height: 22px;\n      display: inline-flex;\n      justify-content: center;\n      align-items: center;\n      border-radius: 4px;\n      color: var(--text3);\n      background-color: var(--bg2);\n      vertical-align: text-bottom;\n    }\n    #content {\n      font-size: var(--bili-comments-font-size-content);\n      line-height: var(--bili-comments-line-height-content);\n      color: var(--text1);\n    }\n    #content #expand {\n      color: var(--brand_blue);\n      cursor: pointer;\n    }\n    #vote {\n      margin: 10px 0;\n    }\n    #pictures {\n      display: block;\n      width: 100%;\n      margin-top: 8px;\n    }\n    #tags {\n      margin-top: 6px;\n      display: flex;\n      align-items: center;\n    }\n    .tag {\n      --bili-comment-tag-color: var(--bili-comment-tag-color-light);\n      --bili-comment-tag-bg: var(--bili-comment-tag-bg-light);\n      color: var(--bili-comment-tag-color, --brand_pink);\n      background-color: var(--bili-comment-tag-bg, ----brand_pink_thin);\n      padding: 6px;\n      border-radius: 2px;\n      box-sizing: border-box;\n      font-size: 12px;\n      line-height: 1;\n    }\n    .tag + .tag {\n      margin-left: 10px;\n    }\n  "]))),pv([gn({type:String})],hv.prototype,"spmPrefix",2),pv([gn()],hv.prototype,"data",2),pv([gn()],hv.prototype,"upMid",2),pv([gn()],hv.prototype,"theme",2),pv([gn()],hv.prototype,"user",2),pv([gn()],hv.prototype,"assist",2),pv([gn()],hv.prototype,"contentFeatures",2),pv([gn()],hv.prototype,"oid",2),pv([gn()],hv.prototype,"type",2),pv([wn()],hv.prototype,"ornament",1),pv([wn()],hv.prototype,"top",1),pv([wn()],hv.prototype,"note",1),pv([wn()],hv.prototype,"expandAction",1),pv([wn()],hv.prototype,"expand",1),pv([wn()],hv.prototype,"voteOption",1),pv([wn()],hv.prototype,"vote",1),pv([wn()],hv.prototype,"pictures",1),pv([wn()],hv.prototype,"tags",1),pv([wn()],hv.prototype,"uid",1),pv([wn()],hv.prototype,"spaceLink",1),pv([_n("bili-avatar")],hv.prototype,"biliAvatar",2),pv([_n("bili-rich-text")],hv.prototype,"biliRichText",2),pv([_n("bili-comment-action-buttons-renderer")],hv.prototype,"actionButtons",2),pv([_n("#body")],hv.prototype,"bodyElement",2),hv=pv([mn("bili-comment-renderer")],hv);var fv=function(t){return Gc.request({url:"/x/v2/reply/reply",params:v({},t)})};function vv(t,e,n){if(!n.namespaces.includes(t))return e;var i=w(e);if("findIndex"===n.method){var r=i.findIndex(n.predicate);return r>-1?i.splice(r,1):[]}return i.filter(n.predicate)}function mv(t,e,n){if(!n.namespaces.includes(t))return e;var i=w(e);return i[n.method](n.value),i}var bv=Object.defineProperty,yv=Object.getOwnPropertyDescriptor,gv=function(t,e,n,i){for(var r,o=i>1?void 0:i?yv(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&bv(e,n,o),o},wv=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.spmPrefix="",t.upMid=0,t.oid="",t.type=0,t.root="",t.currentPage=1,t.pageSize=10,t.showSpinner=!1,t.showViewMore=!0,t.showPagination=!1,t.count=0,t.totalPage=0,t.cacheList=[],t.list=[],t.newItems=[],t.invisibleID={},t.user=null,t.assist=!1,t}return p(e,t),s(e,[{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this);var n=function(e){e.value.root_str===t.root&&(t.newItems=mv(Au,t.newItems,e))},i=function(e){if(t.isChildItem(e.value)){var n=vv(Au,[].concat(w(t.newItems),w(t.list)),e);t.updateInvisibleID(n.map((function(t){return t.rpid_str})))}};xu.on("add",n),xu.on("remove",i),this.disposables.add((function(){return xu.off("remove",i)})),this.disposables.add((function(){return xu.off("add",n)})),this.root=this.data.rpid_str,this.list=this.data.replies||[],this.count=this.data.rcount,this.totalPage=Math.ceil(this.count/this.pageSize)}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose()}},{key:"isChildItem",value:function(t){return"".concat(t.type,",").concat(t.oid_str)=="".concat(this.type,",").concat(this.oid)}},{key:"viewMoreText",get:function(){var t,e,n=this.data,i=n.rcount,r=n.replies;if(!r||!this.data.rcount||i===(null==r?void 0:r.length))return"";var o="共".concat(this.data.rcount,"条回复");return null!=(t=this.data.reply_control)&&t.sub_reply_entry_text&&(o=null==(e=this.data.reply_control)?void 0:e.sub_reply_entry_text),o}},{key:"paginationItems",get:function(){var t=[],e=this.currentPage-1;if(this.totalPage>7){var n=e,i=e;e<=2?(n=0,i=Math.min(n+5,this.totalPage-1)):e>=this.totalPage-3?(i=this.totalPage-1,n=Math.max(i-5,0)):(i=Math.min(e+3,this.totalPage-1),n=Math.max(0,e-2)),new Array(i-n).fill(1).forEach((function(e,i){t.push({text:String(n+1+i),idx:n+i,clickable:!0})})),n>0&&(n>1&&t.unshift({text:"...",idx:-1,clickable:!1}),t.unshift({text:"1",idx:0,clickable:!0})),i<=this.totalPage-1&&(i<=this.totalPage-2&&t.push({text:"...",idx:-1,clickable:!1}),t.push({text:String(this.totalPage),idx:this.totalPage-1,clickable:!0}))}else new Array(this.totalPage).fill(1).forEach((function(e,n){t.push({text:String(1+n),idx:n,clickable:!0})}));return e>0&&t.unshift({text:"上一页",idx:e-1,clickable:!0}),this.currentPage<this.totalPage&&t.push({text:"下一页",idx:e+1,clickable:!0}),t}},{key:"getList",value:(a=i(m().mark((function t(){var e,n,i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.showSpinner=!0,t.next=4,fv({oid:this.oid,type:this.type,root:this.root,ps:this.pageSize,pn:this.currentPage});case 4:if(0===(n=t.sent).code&&null!=(e=n.data)&&e.replies){t.next=8;break}return this.showSpinner=!1,t.abrupt("return");case 8:i=n.data.replies,this.invisibleID={},this.newItems=[],this.list=w(i),this.showSpinner=!1,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log("getList error",t.t0),this.showSpinner=!1;case 15:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return a.apply(this,arguments)})},{key:"handleRevert",value:function(){this.list=w(this.cacheList),this.showPagination=!1,this.showViewMore=!0}},{key:"handleClickTrack",value:function(t){this.dispatchEvent(new CustomEvent("track",{detail:{position:t}}))}},{key:"handleViewMore",value:function(t){t.stopPropagation(),Eu("replyCardCheckClick",{parentId:this.root}),Tu("click","comment.replies_check.click",{root:this.root},{spmPrefix:this.spmPrefix}),this.handleClickTrack(39),this.user?(this.cacheList=w(this.list),this.count>this.pageSize?this.showPagination=!0:this.showViewMore=!1,this.getList()):Wu({event:"selfDef.replyCardCheckClick"})}},{key:"handleChangePage",value:function(t){this.currentPage!==t.idx+1&&(this.currentPage=t.idx+1,this.getList())}},{key:"handleItemDelete",value:(n=i(m().mark((function t(e,n){var i,r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=w("feed"===n?this.list:this.newItems)[e],r="删除失败",t.prev=2,t.next=5,Td({title:"删除评论",message:"删除评论后，评论下所有回复都会被删除,是否继续?"});case 5:if(t.sent){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,Kc({oid:this.oid,type:this.type,rpid:i.rpid_str});case 9:0===t.sent.code&&(this.updateInvisibleID([i.rpid_str]),r="删除成功"),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(2),console.log("删除失败",t.t0);case 17:return t.prev=17,Fc.show(r),t.finish(17);case 20:case"end":return t.stop()}}),t,this,[[2,14,17,20]])}))),function(t,e){return n.apply(this,arguments)})},{key:"handleItemReport",value:function(t,e){var n={member:{mid:t.member.mid,uname:t.member.uname},oid:this.oid,type:this.type,rpid:t.rpid_str,hiddenJuryTips:e||!1};this.dispatchEvent(new CustomEvent("report",{detail:n}))}},{key:"updateInvisibleID",value:function(t){var e=v({},this.invisibleID);t.forEach((function(t){e[t]=!0})),this.invisibleID=e,this.requestUpdate()}},{key:"viewMoreTemplate",value:function(){return this.viewMoreText?qe(qs||(qs=g(['\n          <div id="view-more">\n            <span>','，</span><bili-text-button @click="','">点击查看</bili-text-button>\n          </div>\n        '])),this.viewMoreText,this.handleViewMore):""}},{key:"paginationTemplate",value:function(){var t=this;return qe(Gs||(Gs=g(['<div id="pagination">\n      <div id="pagination-head">共','页</div>\n      <div id="pagination-body">\n        ','\n      </div>\n      <div id="pagination-foot">\n        <bili-text-button @click="','">收起</bili-text-button>\n      </div>\n    </div>'])),this.totalPage,this.paginationItems.map((function(e){return qe(Xs||(Xs=g(["<bili-text-button\n              ",'\n              style="','"\n              data-idx="','"\n              @click="','"\n              >',"</bili-text-button\n            >"])),e.clickable?"":"disabled",e.idx===t.currentPage-1?Gn({"--_label-text-color":"var(--brand_blue)"}):"",e.idx,(function(){return t.handleChangePage(e)}),e.text)})),this.handleRevert)}},{key:"isVisibleItem",value:function(t){return!this.invisibleID[t]}},{key:"renderItem",value:function(t,e,n){var i=this;return qe(Ys||(Ys=g(["<bili-comment-reply-renderer\n      .spmPrefix=","\n      .oid=","\n      .type=","\n      .root=","\n      .data=","\n      .user=","\n      .assist=","\n      .upMid=","\n      .visible=","\n      .contentFeatures=","\n      @reply=","\n      @delete=","\n      @block=",'\n      @report="','"\n    ></bili-comment-reply-renderer>'])),this.spmPrefix,this.oid,this.type,this.root,t,this.user,this.assist,this.upMid,this.isVisibleItem(t.rpid_str),this.contentFeatures,(function(){return i.dispatchEvent(new CustomEvent("reply",{detail:t}))}),(function(){return i.handleItemDelete(e,n)}),(function(){return i.dispatchEvent(new CustomEvent("block",{detail:{mid:t.member.mid}}))}),(function(e){var n;return i.handleItemReport(t,null==(n=e.detail)?void 0:n.hiddenJuryTips)}))}},{key:"render",value:function(){var t=this;return qe(Zs||(Zs=g(['\n      <div id="expander">\n        <div id="expander-contents">\n          ',"\n          ","\n          ",'\n          <div id="expander-footer">\n            ',"\n          </div>\n        </div>\n      </div>\n    "])),Ic(this.list,(function(t){return t.rpid_str}),(function(e,n){return t.renderItem(e,n,"feed")})),Ic(this.newItems,(function(t){return t.rpid_str}),(function(e,n){return t.renderItem(e,n,"new")})),this.showSpinner?qe(Qs||(Qs=g(['<div id="spinner"><bili-comments-spinner></bili-comments-spinner></div>']))):"",this.showPagination?this.paginationTemplate():this.showViewMore?this.viewMoreTemplate():"")}}]);var n,a}(fn);wv.styles=ve(Ks||(Ks=g(["\n    #expander {\n      padding-left: 80px;\n      margin-top: 2px;\n    }\n    #expander-contents {\n      position: relative;\n    }\n    #spinner {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(var(--bg1_rgb), 0.85);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    #view-more {\n      font-size: 13px;\n      color: var(--text3);\n    }\n    #pagination {\n      display: flex;\n      align-items: center;\n      font-size: 13px;\n      color: var(--text1);\n    }\n    #expander-footer bili-text-button {\n      vertical-align: unset;\n    }\n    #pagination-head {\n      margin-right: 10px;\n    }\n    #pagination-body {\n      display: flex;\n      align-items: center;\n    }\n    #pagination-body bili-text-button,\n    #pagination-foot bili-text-button {\n      margin-left: 8px;\n    }\n    #pagination-body bili-text-button:first-child {\n      margin-left: 10px;\n    }\n  "]))),gv([gn()],wv.prototype,"contentFeatures",2),gv([gn()],wv.prototype,"spmPrefix",2),gv([gn()],wv.prototype,"data",2),gv([gn()],wv.prototype,"upMid",2),gv([gn()],wv.prototype,"oid",2),gv([gn()],wv.prototype,"type",2),gv([gn()],wv.prototype,"root",2),gv([wn()],wv.prototype,"currentPage",2),gv([wn()],wv.prototype,"showSpinner",2),gv([wn()],wv.prototype,"showViewMore",2),gv([wn()],wv.prototype,"showPagination",2),gv([wn()],wv.prototype,"totalPage",2),gv([gn({type:Array})],wv.prototype,"list",2),gv([wn()],wv.prototype,"newItems",2),gv([gn()],wv.prototype,"user",2),gv([gn()],wv.prototype,"assist",2),gv([wn()],wv.prototype,"viewMoreText",1),gv([wn()],wv.prototype,"paginationItems",1),wv=gv([mn("bili-comment-replies-renderer")],wv);var xv=Object.defineProperty,kv=Object.getOwnPropertyDescriptor,_v=function(t,e,n,i){for(var r,o=i>1?void 0:i?kv(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&xv(e,n,o),o},Av=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.richTextDisposables=null,t.visible=!0,t.spmPrefix="",t.upMid=0,t.oid="",t.type=0,t.root="",t.user=null,t.assist=!1,t.avatarSize=24,t}return p(e,t),s(e,[{key:"uid",get:function(){return this.data.member.mid}},{key:"spaceLink",get:function(){return Dd.SPACE(this.uid)}},{key:"userAvatarSrc",get:function(){return ki.getBmgSrcNext(this.data.member.avatar,{w:this.avatarSize,h:this.avatarSize,s:!0,dpr:2})}},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),this.initData(),setTimeout((function(){t.disposables.add(sv(t.shadowRoot.querySelector("#user-avatar")))}))}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose()}},{key:"clearRichTextDisposables",value:function(){this.richTextDisposables&&(this.richTextDisposables.dispose(),this.richTextDisposables=null)}},{key:"initData",value:function(){var t=this;this.clearRichTextDisposables(),setTimeout((function(){var e,n;t.biliRichText.setContents(Qf(t.data,t.contentFeatures,!1,"".concat(t.spmPrefix||hi(),".comment.all.click"))),Array.from((null==(e=t.biliRichText.contentsElement)?void 0:e.children)||[]).forEach((function(e){e.dataset.userProfileId&&(t.richTextDisposables||(t.richTextDisposables=On()),t.richTextDisposables.add(sv(e)))})),null!=(n=t.data.$extra)&&n.spotlight&&window.setTimeout((function(){cv(t,-300),setTimeout((function(){t.startSpotlight()}),100)}),100)}))}},{key:"startSpotlight",value:(n=i(m().mark((function t(){var e,n=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="spotlight",this.disposables.addEventListener(this.bodyElement,"transitionend",(function(){n.bodyElement.classList.remove(e),n.bodyElement.style.removeProperty("background-color"),n.bodyElement.style.removeProperty("transition")})),this.bodyElement.classList.add(e),t.next=5,Wc(10);case 5:return this.bodyElement.style.setProperty("transition","background-color 2s 3s"),t.next=8,Wc(10);case 8:this.bodyElement.style.setProperty("background-color","transparent");case 9:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"updated",value:function(t){t.get("data")&&this.initData(),t.get("visible")&&(!1===this.visible?this.style.setProperty("display","none"):this.style.removeProperty("display"))}},{key:"handleReply",value:function(){this.dispatchEvent(new CustomEvent("reply"))}},{key:"handleAction",value:function(t){var e=t.detail,n=e.key,i=e.data;this.dispatchEvent(new CustomEvent(n,{detail:i}))}},{key:"handleTextClick",value:function(t){var e=t.detail;if(e&&"seek"===e.type){var n=Number(e.videoTime),i=Number(e.videoPart);!isNaN(n)&&!isNaN(i)&&this.dispatchEvent(new CustomEvent("seek",{detail:{time:n,part:i},composed:!0}))}}},{key:"render",value:function(){return qe(Js||(Js=g(['\n      <div id="body">\n        <div id="main">\n          <bili-comment-user-info .spmPrefix='," .data="," .upMid=",'>\n            <a\n              href="','"\n              id="user-avatar"\n              data-user-profile-id="','"\n              data-user-profile-spmid-follow="comment.profile.click"\n              target="_blank"\n            >\n              <img width="','" height="','" src='," />\n            </a>\n          </bili-comment-user-info>\n          <bili-rich-text\n            @text-click=",'\n            style="','"\n          ></bili-rich-text>\n        </div>\n        <div id="footer">\n          <bili-comment-action-buttons-renderer\n            .spmPrefix=',"\n            .data=","\n            .oid=","\n            .type=","\n            .root=","\n            .upMid=","\n            .user=","\n            .assist=",'\n            style="','"\n            @reply=',"\n            @action=","\n          ></bili-comment-action-buttons-renderer>\n        </div>\n      </div>\n    "])),this.spmPrefix,this.data,this.upMid,this.spaceLink,this.uid,this.avatarSize,this.avatarSize,this.userAvatarSrc,this.handleTextClick,Gn({"--bili-rich-text-line-height":"24px","--bili-rich-text-link-color":"var(--Lb6)","--bili-rich-text-display":"inline"}),this.spmPrefix,this.data,this.oid,this.type,this.root,this.upMid,this.user,this.assist,Gn({"--bili-comment-action-buttons-more-display":"var(--bili-comment-hover-more-display)"}),this.handleReply,this.handleAction)}}]);var n}(fn);Av.styles=ve(tl||(tl=g(["\n    :host {\n      --bili-comment-spotlight-color: var(--brand_blue_thin);\n    }\n    #body {\n      position: relative;\n      padding: 8px 0 8px 34px;\n      border-radius: 4px;\n      --bili-comment-hover-more-display: none;\n    }\n    #body.spotlight {\n      background-color: var(--bili-comment-spotlight-color);\n    }\n    #body:hover {\n      --bili-comment-hover-more-display: block;\n    }\n    #footer {\n      padding-right: 20px;\n    }\n    #user-avatar {\n      position: absolute;\n      left: 0;\n      width: 24px;\n      height: 24px;\n    }\n    #user-avatar img {\n      border-radius: 50%;\n    }\n    #main {\n      width: 100%;\n      display: block;\n      overflow: hidden;\n    }\n  "]))),_v([gn({type:Boolean})],Av.prototype,"visible",2),_v([gn({type:String})],Av.prototype,"spmPrefix",2),_v([gn({type:Object})],Av.prototype,"data",2),_v([gn()],Av.prototype,"upMid",2),_v([gn()],Av.prototype,"oid",2),_v([gn()],Av.prototype,"type",2),_v([gn()],Av.prototype,"root",2),_v([gn()],Av.prototype,"user",2),_v([gn()],Av.prototype,"assist",2),_v([gn()],Av.prototype,"contentFeatures",2),_v([wn()],Av.prototype,"uid",1),_v([wn()],Av.prototype,"spaceLink",1),_v([wn()],Av.prototype,"userAvatarSrc",1),_v([_n("bili-rich-text")],Av.prototype,"biliRichText",2),_v([_n("#body")],Av.prototype,"bodyElement",2),Av=_v([mn("bili-comment-reply-renderer")],Av);var Ev=function(t){return Gc.request({url:"/x/v2/reply/wbi/main",params:v(v({},t),{},{web_location:1315875}),chainProxy:function(t){return t.with("UNIOS_WBI_ENCODE",{active:!0,encWbiKeys:{wbiImgKey:"839c8b697b0d44dc80e9a604592bb432",wbiSubKey:"02cd020b04d64aacad6b3a08d06f8eb0"}})}})},Cv=function(t){return Gc.request({url:"/x/v2/reply/subject/interaction-status",params:v({},t)})},Tv=function(t){return Gc.request({url:"/x/v2/reply/subject/description",params:v({},t)})};var Sv="bili-comment-notice";function Ov(){var t={expires:Date.now()+864e5};!function(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch(t){}}(Sv,t)}function Pv(){var t=function(t){try{return JSON.parse(localStorage.getItem(t))}catch(t){return null}}(Sv);return(null==t?void 0:t.expires)||-1}function Iv(t){if(("undefined"==typeof window?"undefined":k(window))<"u"&&!(Pv()<Date.now())||null==t||!t.ads)return null;for(var e in t.ads){var n=t.ads[e];if(Array.isArray(n)){var i=n[0];return i?{isEmpty:!(i.name&&i.creative_id&&i.is_ad),locId:Number(e),title:i.name,data:i}:null}}return null}function Rv(t){return t.disabled?{source:"disabled",message:t.message||"评论功能已关闭"}:t.user?t.closed?{source:"closed",message:t.message}:null:{source:"unlogin"}}function jv(t){if(null==t||!t.options||null==t||!t.my_vote_option)return null;var e=t.options[t.my_vote_option-1];if(!e)return null;var n=e.desc;-1===n.indexOf("已投")&&(n="已投“".concat(n,"”"));var i=3;return 2===t.options.length&&(i=e.idx),v(v({},e),{},{label_kind:i,desc:n})}function Lv(t,e){var n="",i="查看完整评论";return"unlogin"===t&&(n="登录后"),e>=1e4?i="查看 ".concat(Math.floor(e/1e3)/10,"万+ 条评论"):e>=1e3?i="查看 ".concat(1e3*Math.floor(e/1e3),"+ 条评论"):e>=3&&(i="查看 ".concat(e," 条评论")),"".concat(n).concat(i)}function Mv(t){if(!t.user){if(t.count<=2)return null;var e="unlogin";return{type:e,count:2,text:Lv(e,t.count)}}return null}function Dv(t){return 12061===t||12002===t}function Nv(t){var e;return!0===(null==(e=t.control)?void 0:e.web_selection)}function Bv(t,e,n){var i,r=n||{},o=r.noTrailing,a=void 0!==o&&o,s=r.noLeading,l=void 0!==s&&s,c=r.debounceMode,u=void 0===c?void 0:c,d=!1,p=0;function h(){i&&clearTimeout(i)}function f(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var s=this,c=Date.now()-p;function f(){p=Date.now(),e.apply(s,r)}function v(){i=void 0}d||(!l&&u&&!i&&f(),h(),void 0===u&&c>t?l?(p=Date.now(),a||(i=setTimeout(u?v:f,t))):f():!0!==a&&(i=setTimeout(u?v:f,void 0===u?t-c:t)))}return f.cancel=function(t){var e=(t||{}).upcomingOnly,n=void 0!==e&&e;h(),d=!n},f}var zv='\n  @font-face {\n    font-family: "fans-num";\n    src: url("//activity.hdslb.com/blackboard/static/20240516/6fdde5f06d0b876f68573682fa59da66/v6u7v27Ucs.ttf");\n  }\n  @font-face {\n    font-family: "'.concat("medalnum",'";\n    src: url("').concat("//s1.hdslb.com/bfs/seed/jinkela/short/webui/comments",'/font/medal-num.ttf");\n  }\n  @font-face {\n    font-family: "').concat("pc-comments-cljzkg6fxb9","\";\n    src: url('https://s1.hdslb.com/bfs/svg-next/font/2024-08-12/pc-comments-cljzkg6fxb9.ttf') format('truetype');\n    font-weight: normal;\n    font-style: normal;\n  }\n  :root {\n    --bili-comments-font-size-title: 20px;\n    --bili-comments-font-size-count: 13px;\n    --bili-comments-font-size-sort: 13px;\n    --bili-comments-font-size-name: 13px;\n    --bili-comments-font-size-content: 15px;\n    --bili-comments-line-height-content: 24px;\n    --bili-comments-avatar-size: scale(0.83333333);\n  }\n  @media screen and (min-width: 1681px) {\n    :root {\n      --bili-comments-font-size-title: 24px;\n      --bili-comments-font-size-count: 14px;\n      --bili-comments-font-size-sort: 16px;\n      --bili-comments-font-size-name: 14px;\n      --bili-comments-font-size-content: 16px;\n      --bili-comments-line-height-content: 26px;\n      --bili-comments-avatar-size: scale(1);\n    }\n  }\n"),Uv=function(t,e){return new Promise((function(n){var i=-1,r=window.setTimeout((function(){var r=document.createElement(e.tag);r.style.display="none",r.style.opacity="0",r.style.position="absolute",r.style.top="-9999px",r.style.left="-9999px",document.body.appendChild(r),r.onload=function(){i=1,document.body.removeChild(r),n(i)},r.onerror=function(){i=2,document.body.removeChild(r),n(i)},i=0,r.src=-1===t.indexOf("//")?"//".concat(t):t}),e.delay||0);if(e.ctrl){e.ctrl((function(){-1===i?(window.clearTimeout(r),n(i)):console.warn("preloadResource: already started")}))}}))},Fv=Object.defineProperty,Vv=Object.getOwnPropertyDescriptor,Hv=function(t,e,n,i){for(var r,o=i>1?void 0:i?Vv(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Fv(e,n,o),o},Wv=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.scrollContainer=null,t.user=null,t.assist=!1,t.params="0,0",t.spmPrefix="",t.oid="",t.type=0,t.mode=3,t.paginationStr=JSON.stringify({offset:""}),t.seekRpid="",t.cmFromTrackId="",t.maxViewLimit=0,t.showViewMore=!1,t.theme="light",t.eventBubbles=!1,t.showSpinner=!0,t.showContinuations=!1,t.showContinueTrigger=!!window.IntersectionObserver,t.contentFeatures={videoTime:!0},t.showEnd=!1,t.upMid=0,t.globalOptions=[],t.notice=null,t.vote=null,t.count=0,t.hideSortTime=!1,t.rootInputPlaceholder="加载中…",t.inputDisabled=!1,t.rootInputUploadPicState=3,t.rootInputGoodsState=3,t.initUserDP=null,t.initDescriptionDP=null,t.invisibleID={},t.loadedID={},t.isClosed=!1,t.isSelected=!1,t.limitMaskState=null,t.cmTopProtection=null,t.list=[],t.newItems=[],t.replyTarget=null,t.replyInputValue="",t.replyKeepActive=!1,t.commentBoxDisabledState=null,t.replyCommentBox=null,t.trackObserver=null,t}return p(e,t),s(e,[{key:"replyInputPlaceholder",get:function(){var t,e;return"回复 @".concat(null==(e=null==(t=this.replyTarget)?void 0:t.member)?void 0:e.uname," : ")}},{key:"voteOption",get:function(){return jv(this.vote)}},{key:"commonTrackData",get:function(){return{cm_from_track_id:this.cmFromTrackId}}},{key:"isVisibleItem",value:function(t){return!this.invisibleID[t]}},{key:"isChildItem",value:function(t){return"".concat(t.type,",").concat(t.oid_str||t.oid)=="".concat(this.type,",").concat(this.oid)}},{key:"initReplyCommentBox",value:function(){if(!this.replyCommentBox){var t=this.shadowRoot.querySelector("#reply-commentbox bili-comment-box");t&&(this.replyCommentBox=t)}}},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),this.initData();var n=function(e){if(t.isChildItem(e.value)){var n=vv(_u,[].concat(w(t.newItems),w(t.list)),e);t.updateInvisibleID(n.map((function(t){return t.rpid_str})))}},r=function(e){t.isChildItem(e.value)&&(t.newItems=mv(_u,t.newItems,e))},o=function(){t.replyCommentBox&&(t.replyKeepActive=!1,t.replyTarget=null,t.replyCommentBoxContainer.appendChild(t.replyCommentBox),t.replyCommentBox.style.setProperty("--bili-comment-box-display","none"))},a=function(){var e=i(m().mark((function e(n){var i,r,a,s;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.target,r=n.defaultInput,a=n.mount,i&&t.isChildItem(i)&&(t.initReplyCommentBox(),t.replyCommentBox)){e.next=3;break}return e.abrupt("return");case 3:if(!t.commentBoxDisabledState){e.next=9;break}if("unlogin"!==t.commentBoxDisabledState.source){e.next=7;break}return Wu({event:"selfDef.replyCardReplyClick",spmPrefix:t.spmPrefix}),e.abrupt("return");case 7:return Fc.show(t.commentBoxDisabledState.message||"评论功能已关闭"),e.abrupt("return");case 9:if(!t.replyTarget||i!==t.replyTarget){e.next=12;break}return o(),e.abrupt("return");case 12:return t.replyCommentBox.style.removeProperty("--bili-comment-box-display"),t.replyKeepActive=!0,t.replyInputValue=r||"",t.replyTarget=i,e.next=18,Wc(0);case 18:return a(t.replyCommentBox),e.next=21,Wc(0);case 21:t.replyCommentBox.focus(),(s=t.replyCommentBox.getBoundingClientRect()).y>window.innerHeight-200&&window.scrollTo({top:window.scrollY+s.y-window.innerHeight+s.height+200,behavior:"smooth"});case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(e){var n=e.src,i=e.jumpUrl,r=!1;!function(t){var e=t.src;-1===e.indexOf("//")&&(e="//".concat(e));var n=t.root.getBoundingClientRect(),i=document.createElement("bili-alpha-video");i.setAttribute("src",e),i.setAttribute("width","600"),i.setAttribute("height","500"),i.setAttribute("autoplay",""),i.style.setProperty("position","fixed"),i.style.setProperty("top","50%"),i.style.setProperty("left","50%"),i.style.setProperty("transform","translate(-50%, -50%)"),i.style.setProperty("position","fixed"),i.style.setProperty("z-index","9999"),i.style.setProperty("top","50%"),i.style.setProperty("left","".concat(n.left+n.width/2,"px")),i.style.setProperty("transform","translate(-50%, -50%)");var r=function(){var e;null==(e=null==t?void 0:t.onClick)||e.call(t)};i.addEventListener("click",r),i.addEventListener("ended",(function e(){var n;null==(n=null==t?void 0:t.onEnded)||n.call(t),setTimeout((function(){i.removeEventListener("click",r),i.removeEventListener("ended",e),i.parentElement&&i.parentElement.removeChild(i)}),20)})),document.documentElement.appendChild(i)}({src:n,root:t,onClick:function(){i&&(r=!0,window.open(i))},onEnded:function(){i&&(r||window.open(i))}})};xu.on("remove",n),xu.on("add",r),xu.on("reply",a),xu.on("hideReply",o),xu.on("displayAlphaVideo",s),this.disposables.add((function(){return xu.off("remove",n)})),this.disposables.add((function(){return xu.off("add",r)})),this.disposables.add((function(){return xu.off("reply",a)})),this.disposables.add((function(){return function(){t.replyTarget&&o(),xu.off("hideReply",o)}})),this.disposables.add((function(){return xu.off("displayAlphaVideo",s)})),this.disposables.addEventListener(window,"message",(function(t){if(t.data&&"object"==k(t.data)){var e=t.data,n=e.images,i=e.index;if(Array.isArray(n)&&"number"==typeof i){var r=n[i];if(!(r&&r.src&&r.width&&r.height))return;uh(w(n),i)}}})),this.disposables.add(lv),this.addLoadEvent(),this.initTheme(),this.initDependencies(),this.appendGlobalStyle(),this.trackObserver=new Ed({el:this,type:"show",value:{event:"comments.all",data:v({oid:this.oid,type:this.type,from_spmid:Ff(!0)||""},this.commonTrackData)},durational:{repeat:!0,beforeunload:!0},handler:function(e,n,i,r){if("show"===e){Eu("replyCardShow",i);var o={spmPrefix:t.spmPrefix};Tu(e,n,i,r?Object.assign({},r,o):o)}}}),this.disposables.add((function(){if(t.trackObserver){var e=t.trackObserver;t.trackObserver=null,setTimeout((function(){e.dispose()}))}}))}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose(),this.replyCommentBox=null,this.maxViewLimit=0,this.eventBubbles=!1,this.unload()}},{key:"updated",value:function(t){t.get("params")&&(this.unload(),this.initData())}},{key:"initDependencies",value:function(){Su()}},{key:"initTheme",value:function(){var t=this,e=function(t,e){e||(e={});var n=!1===e.decode,i=e.template;!i&&!uu()&&(i=document.cookie);var r=!0===t,o={};if(i)for(var a=(n?i:decodeURIComponent(i)).split(";"),s=0;s<a.length;s++){for(var l=a[s];" "===l.charAt(0);)l=l.substring(1);var c=l.split("="),u=c[0],d=c[1];if(o[u]=d,t===u)return o[t]}return r?o:""}("theme_style"),n=function(e){t.theme=e};"dark"===e&&n("dark"),ku.on("global.themeChange",(function(t){n(t.payload)})),this.disposables.add((function(){ku.off("global.themeChange")}))}},{key:"appendGlobalStyle",value:function(){var t="bili-comments-global-style";if(!document.querySelector("#"+t)){var e=document.createElement("style");e.id=t,e.innerHTML=zv,document.body.appendChild(e)}}},{key:"initData",value:function(){if(this.shadowRoot)if(this.params&&"string"==typeof this.params&&"0,0"!==this.params){var t=y(this.params.split(","),2),e=t[0],n=t[1];if(n&&"0"!==n&&e&&"0"!==e&&!isNaN(Number(e))){var i=this.getAttribute("mode")||"3",r=this.getAttribute("seek-id")||"";isNaN(Number(r))&&(r="");var o=this.getAttribute("cm-from-track-id")||"",a=0,s=this.getAttribute("max-view-limit");"string"==typeof s&&(a=Number(s),isNaN(a)&&(a=0));var l=this.getAttribute("disable-video-time");"string"==typeof l&&"false"!==l&&(this.contentFeatures.videoTime=!1);var c,u=this.getAttribute("spm-prefix")||"",d=this.getAttribute("event-bubbles");if(this.parentElement&&!this.scrollContainer&&this.parentElement!==document.body){var p=getComputedStyle(this.parentElement);["auto","scroll"].includes(p.overflowY)&&(c=this.parentElement)}this.load({oid:n,type:Number(e),seekRpid:r,spmPrefix:u,cmFromTrackId:o,mode:Number(i),maxViewLimit:a,eventBubbles:null!==d,scrollContainer:c})}else console.warn("Please set correct 'data-params' attribute for bili-comments element")}else console.warn("Please set 'data-params' attribute for bili-comments element, eg: 'type,oid'")}},{key:"updateList",value:function(t){this.list=t}},{key:"clearList",value:function(){this.newItems=[],this.list=[],this.invisibleID={},this.loadedID={},this.showEnd=!1,this.showContinuations=!1,this.paginationStr=JSON.stringify({offset:""})}},{key:"unload",value:function(){this.user=null,this.notice=null,this.upMid=0,this.assist=!1,this.hideSortTime=!1,this.vote=null,this.inputDisabled=!1,this.isClosed=!1,this.isSelected=!1,this.limitMaskState=null,this.cmTopProtection=null,this.mode=3,this.showViewMore=!1,this.clearList()}},{key:"reload",value:(T=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.unload(),t.next=3,this.load(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return T.apply(this,arguments)})},{key:"load",value:(C=i(m().mark((function t(e){var n,i,r,o,a,s,l,c,u;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e&&(n=e.oid,i=e.type,r=e.mode,o=e.seekRpid,a=e.spmPrefix,s=e.maxViewLimit,l=e.scrollContainer,c=e.cmFromTrackId,this.oid=String(n),this.type=i,r&&[2,3].includes(r)&&(this.mode=r),this.seekRpid=o?String(o):"",this.spmPrefix=a||"",this.cmFromTrackId=c||"",s&&s>0&&(this.maxViewLimit=s),l&&("string"==typeof l?(u=document.querySelector(l))?this.scrollContainer=u:console.warn("scrollContainer not found"):this.scrollContainer=l),this.eventBubbles=e.eventBubbles||!1),this.showSpinner=!0,this.initUser(),t.next=6,Promise.all([this.initUpGlobalActions(),this.initDescription(),this.getList(),pf()]);case 6:return t.next=8,this.requestUpdate();case 8:this.showSpinner=!1,this.handleTriggerEvent("inited"),!this.showEnd&&this.list.length<10&&this.getList(),t.next=16;break;case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",(console.warn("bili comments load error",t.t0),Promise.reject(t.t0)));case 16:case"end":return t.stop()}}),t,this,[[0,13]])}))),function(t){return C.apply(this,arguments)})},{key:"initUser",value:(E=i(m().mark((function t(){var e,n,i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.initUserDP=mh(),t.next=4,ni();case 4:if(e=t.sent,n=e.code,i=e.data,this.initUserDP.resolve(),this.initUserDP=null,0!==n||!i){t.next=9;break}return t.abrupt("return",(this.user=i,i));case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),this.initUserDP&&(this.initUserDP.resolve(),this.initUserDP=null),console.warn("获取用户信息失败",t.t0);case 14:return t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return E.apply(this,arguments)})},{key:"initUpGlobalActions",value:(A=i(m().mark((function t(){var e,n,i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Cv({oid:this.oid,type:this.type});case 3:if(e=t.sent,n=e.code,i=e.data,0===n&&i){t.next=8;break}return t.abrupt("return");case 8:this.globalOptions=Hu(i),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log("bili comments up interaction status error",t.t0);case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return A.apply(this,arguments)})},{key:"initDescription",value:(_=i(m().mark((function t(){var e,n,i,r,o,a,s,l,c;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.initDescriptionDP=mh(),t.next=4,Tv({oid:this.oid,type:this.type});case 4:if(i=t.sent,r=i.code,o=i.data,this.initDescriptionDP.resolve(),this.initDescriptionDP=null,0===r&&null!=o&&o.base){t.next=9;break}return t.abrupt("return");case 9:a=o.base,s=a.count,l=a.input,c=a.up_mid,this.upMid=parseInt(c),this.handleCountChange(parseInt(s||"0")),l&&(this.rootInputPlaceholder=l.root_text||"",l.editor_icon_config&&(this.rootInputUploadPicState=l.editor_icon_config.upload_picture_icon_state,this.rootInputGoodsState=null!==(e=l.editor_icon_config.goods_icon_state)&&void 0!==e?e:3,this.inputDisabled=null!==(n=l.disabled)&&void 0!==n&&n)),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),this.initDescriptionDP&&(this.initDescriptionDP.resolve(),this.initDescriptionDP=null),console.log("bili comments description error",t.t0);case 16:case"end":return t.stop()}}),t,this,[[0,13]])}))),function(){return _.apply(this,arguments)})},{key:"addLoadEvent",value:(x=i(m().mark((function t(){var e,n=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.showContinueTrigger&&this.continueTrigger?(e=new IntersectionObserver(function(){var t=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e[0].isIntersecting||n.showEnd){t.next=4;break}if(!n.showSpinner&&!n.showContinuations){t.next=3;break}return t.abrupt("return");case 3:n.getList();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.observe(this.continueTrigger),this.disposables.add((function(){e.unobserve(n.continueTrigger),e.disconnect()}))):this.disposables.addEventListener(this.scrollContainer||window,"scroll",Bv(100,(function(){if(!n.showSpinner&&!n.showContinuations)if(n.scrollContainer){var t=n.scrollContainer,e=t.scrollTop,i=t.scrollHeight,r=t.clientHeight;Math.ceil(e)+2*r>=i&&n.getList()}else{var o=document.documentElement,a=o.scrollTop,s=o.scrollHeight,l=window.innerHeight;Math.ceil(a)+2*l>=s&&n.getList()}})));case 1:case"end":return t.stop()}}),t,this)}))),function(){return x.apply(this,arguments)})},{key:"updateInvisibleID",value:function(t){var e=v({},this.invisibleID);t.forEach((function(t){e[t]=!0})),this.invisibleID=e,this.requestUpdate()}},{key:"handleItemDelete",value:(b=i(m().mark((function t(e,n){var i,r,o,a=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=w("feed"===n?this.list:this.newItems)[e],(null==(i=this.cmTopProtection)?void 0:i.rpid)!==(null==r?void 0:r.rpid_str)){t.next=4;break}return Cd({title:"删除评论",message:this.cmTopProtection.message,cancel:{text:"我要申诉",click:function(t){t(),Hd({type:a.type,oid:a.oid,rpid:r.rpid_str})}},confirm:{text:"我知道了",click:function(t){t()}}}),t.abrupt("return");case 4:return o="删除失败",t.prev=5,t.next=8,Td({title:"删除评论",message:"删除评论后，评论下所有回复都会被删除,是否继续?"});case 8:if(t.sent){t.next=11;break}return o="",t.abrupt("return");case 11:return t.next=13,Kc({oid:this.oid,type:this.type,rpid:r.rpid_str});case 13:0===t.sent.code&&(this.updateInvisibleID([r.rpid_str]),o="删除成功"),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(5),console.log("删除失败",t.t0);case 21:return t.prev=21,o&&Fc.show(o),t.finish(21);case 24:case"end":return t.stop()}}),t,this,[[5,18,21,24]])}))),function(t,e){return b.apply(this,arguments)})},{key:"handleCountChange",value:function(t){this.count=t,this.handleTriggerEvent("count",this.count)}},{key:"handleItemTop",value:(f=i(m().mark((function t(e,n,i){var r,o,a,s,l,c=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=w("feed"===n?this.list:this.newItems)[e],a="".concat(i?"":"取消","置顶"),null==(r=this.cmTopProtection)||!r.rpid){t.next=5;break}return Cd({title:a+"评论",message:this.cmTopProtection.message,cancel:{text:"我要申诉",click:function(t){t(),Hd({type:c.type,oid:c.oid,rpid:o.rpid_str})}},confirm:{text:"我知道了",click:function(t){t()}}}),t.abrupt("return");case 5:return t.prev=5,t.next=8,Jc({oid:this.oid,type:this.type,rpid:o.rpid_str,action:i?1:0});case 8:s=t.sent,l=s.code,a+=0===l?"成功":"失败",t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),a+="失败";case 16:return t.prev=16,Fc.show(a),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[5,13,16,19]])}))),function(t,e,n){return f.apply(this,arguments)})},{key:"handleItemReport",value:(h=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Fd(v(v({},e),{},{ordering:3===this.mode?"heat":"time"}));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"handleItemBlock",value:(c=i(m().mark((function t(e){var n,i,r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Td({title:"拉黑用户",message:"加入黑名单后，将自动解除关注关系和对该用户的合集订阅关系，禁止该用户与我互动或查看我的空间"});case 3:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,ou({fid:e.mid,act:5,re_src:15});case 7:if(n=t.sent,i=n.code,r=n.message,0===i){t.next=13;break}return Fc.show(r||"拉黑失败"),t.abrupt("return");case 13:xu.emit("remove",{namespaces:[_u,Au],method:"filter",predicate:function(t){var n;return(null==(n=t.member)?void 0:n.mid)===e.mid},value:{type:this.type,oid:this.oid,oid_str:this.oid}}),Fc.show("拉黑成功"),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),Fc.show("拉黑失败");case 19:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(t){return c.apply(this,arguments)})},{key:"updatePaginationStr",value:function(t){this.paginationStr=JSON.stringify({offset:t})}},{key:"updateReplyItemExtra",value:function(t,e,n){t.$extra||(t.$extra={}),t.$extra[e]=n}},{key:"getList",value:(l=i(m().mark((function t(){var e,n,i,r,o,a,s,l,c,u,d,p,h,f,v,b,y,g=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.showEnd){t.next=3;break}return t.abrupt("return");case 3:return this.list.length&&(this.showContinuations=!0),t.next=6,Ev({oid:this.oid,type:this.type,mode:this.mode,pagination_str:this.paginationStr,plat:1,seek_rpid:0===this.list.length?this.seekRpid:void 0,cm_from_track_id:this.cmFromTrackId||void 0});case 6:if(i=t.sent,!this.showSpinner){t.next=15;break}if(r=[],this.initUserDP&&r.push(this.initUserDP.promise),this.initDescriptionDP&&r.push(this.initDescriptionDP.promise),t.t0=r.length,!t.t0){t.next=15;break}return t.next=15,Promise.all(r);case 15:if(0===i.code&&i.data){t.next=18;break}return this.isClosed=Dv(i.code),this.commentBoxDisabledState=Rv({user:this.user,closed:this.isClosed,message:i.message||"啥都木有~",disabled:!0}),this.showContinuations=!1,this.showSpinner&&(this.showEnd=!0),t.abrupt("return");case 18:if(o=i.data,a=o.cursor,s=o.cm_info,l=o.control,c=o.top_replies,u=o.upper,d=o.assist,p=i.data.replies||[],h=[],(f=0===this.list.length)&&null!=c&&c.length&&c.reverse().forEach((function(t){p.unshift(t)})),this.showSpinner&&((v=!!this.upMid)||(this.upMid=u.mid),this.assist=1===d,this.notice=Iv(s),this.vote=i.data.vote_card||null,this.count||this.handleCountChange((null==a?void 0:a.all_count)||0),l&&(2===l.show_type&&(this.hideSortTime=!0),v||(this.rootInputPlaceholder=l.root_input_text||"",this.rootInputUploadPicState=l.upload_picture_icon_state,this.inputDisabled=l.input_disable),this.commentBoxDisabledState=Rv({user:this.user,closed:this.isClosed,message:this.rootInputPlaceholder,disabled:this.inputDisabled}),l.cm_top_reply_protection&&(this.cmTopProtection={rpid:String(l.cm_top_reply_protection.protected_top_rpid),message:l.cm_top_reply_protection.popup_message}),l.preload_resources)&&(b=l.preload_resources,window.setTimeout((function(){b.forEach((function(t,e){3===t.biz_kind&&t.url&&Uv(t.url,{tag:"video",delay:1e3*e})}))}),6e3)),this.isSelected=Nv(i.data),this.limitMaskState=Mv({user:this.user,count:this.count}),this.limitMaskState&&(this.showEnd=!0,p=p.slice(0,this.limitMaskState.count))),null!=(e=null==a?void 0:a.pagination_reply)&&e.next_offset&&this.updatePaginationStr(null==(n=null==a?void 0:a.pagination_reply)?void 0:n.next_offset),y=!this.seekRpid,p.forEach((function(t){var e;g.loadedID[t.rpid_str]||!0!==t.invisible&&(g.loadedID[t.rpid_str]=!0,!1===y&&(t.rpid_str===g.seekRpid?(g.updateReplyItemExtra(t,"spotlight",!0),y=!0):null!=(e=t.replies)&&e.length&&t.replies.forEach((function(t){y||t.rpid_str===g.seekRpid&&(g.updateReplyItemExtra(t,"spotlight",!0),y=!0)}))),h.push(t))})),this.showContinuations=!1,!(f&&this.maxViewLimit>0)){t.next=27;break}return h.length&&(h.length>this.maxViewLimit&&(this.showViewMore=!0),this.updateList(this.list.concat(h.slice(0,this.maxViewLimit)))),this.showEnd=!0,t.abrupt("return");case 27:null!=a&&a.is_end&&(this.showEnd=!0),h.length&&this.updateList(this.list.concat(h)),t.next=33;break;case 30:t.prev=30,t.t1=t.catch(0),console.log("getList error",t.t1),this.showContinuations=!1;case 33:case"end":return t.stop()}}),t,this,[[0,30]])}))),function(){return l.apply(this,arguments)})},{key:"handleGlobalAction",value:(a=i(m().mark((function t(e){var n,i,r,o,a,s,l,c,u,d,p,h,f,v,b,y,g,w,x,k,_=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(n=e.detail)&&n.key&&null!=(i=e.detail)&&i.data){t.next=2;break}return t.abrupt("return");case 2:if(r=e.detail.key,o=e.detail.data.active,a=e.detail.text,"select"!==r){t.next=25;break}return t.prev=4,t.next=7,Td({title:a,message:o?"开启精选评论后，所有评论都需经过我的确认后再向所有用户展示。可前往PC端创作中心":"停止精选评论后，如有遗留未处理评论，可前往PC端创作中心"});case 7:if(t.sent){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,eu({oid:this.oid,type:this.type,action:o?tu.SELECT:tu.UNSELECT});case 11:if(s=t.sent,l=s.code,c=s.message,u=s.data,0===l){t.next=18;break}return Fc.show((null==u?void 0:u.action_toast)||c||"操作失败"),t.abrupt("return");case 18:Fc.show((null==u?void 0:u.action_toast)||c||a+"成功"),Eu("interaction-submit",{type:"selection",status:o?0:1}),Tu("click","comments.action.click",{action:"select",status:o?0:1},{spmPrefix:this.spmPrefix}),setTimeout((function(){_.reload()}),2e3),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(4),Fc.show("操作失败");case 24:return t.abrupt("return");case 25:if("close"!==r){t.next=49;break}return t.prev=26,t.next=29,Td({title:a,message:o?"恢复评论后，用户可正常发表评论、参与评论互动，已有的评论也恢复正常展示":"关闭评论将会禁止任何人在此评论区发表内容，且已有评论在关闭期间将不可见"});case 29:if(t.sent){t.next=31;break}return t.abrupt("return");case 31:return t.next=33,eu({oid:this.oid,type:this.type,action:o?tu.OPEN:tu.CLOSE});case 33:if(d=t.sent,p=d.code,h=d.message,f=d.data,0===p){t.next=40;break}return Fc.show((null==f?void 0:f.action_toast)||h||"操作失败"),t.abrupt("return");case 40:Fc.show((null==f?void 0:f.action_toast)||h||a+"成功"),Eu("interaction-submit",v={type:"reply",status:o?0:1}),Tu("click","comments.action.click",v,{spmPrefix:this.spmPrefix}),setTimeout((function(){_.reload()}),2e3),t.next=48;break;case 45:t.prev=45,t.t1=t.catch(26),Fc.show("操作失败");case 48:return t.abrupt("return");case 49:if("close-danmaku"!==r){t.next=74;break}return t.prev=50,t.next=53,Td({title:a,message:o?"恢复弹幕后，用户可正常发表弹幕、参与弹幕互动，已有的弹幕也恢复正常展示":"关闭弹幕将会禁止任何人在此视频中发表弹幕，且已有弹幕在关闭期间将不可见"});case 53:if(t.sent){t.next=55;break}return t.abrupt("return");case 55:return t.next=57,nu({aid:this.oid,state:o?0:1});case 57:if(b=t.sent,y=b.code,g=b.message,w=b.data,0===y){t.next=64;break}return Fc.show((null==w?void 0:w.action_toast)||g||"操作失败"),t.abrupt("return");case 64:"0"===(x=(null==w?void 0:w.action_toast)||g)&&(x="操作成功"),Fc.show(x||a+"成功"),Eu("interaction-submit",k={type:"dm",status:o?0:1}),Tu("click","comments.action.click",k,{spmPrefix:this.spmPrefix}),t.next=73;break;case 70:t.prev=70,t.t2=t.catch(50),Fc.show("操作失败");case 73:return t.abrupt("return");case 74:case"end":return t.stop()}}),t,this,[[4,21],[26,45],[50,70]])}))),function(t){return a.apply(this,arguments)})},{key:"handleModeChange",value:(n=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.user){t.next=3;break}return Wu({event:"selfDef.replyOrderClick",spmPrefix:this.spmPrefix}),t.abrupt("return");case 3:return this.mode=e.detail,this.clearList(),this.showContinuations=!0,t.next=8,this.getList();case 8:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"handleNoticeClose",value:function(){Ov(),this.notice=null}},{key:"handleTriggerEvent",value:function(t,e){this.eventBubbles?this.dispatchEvent(new CustomEvent("bili-comments-".concat(t),{detail:e,bubbles:!0})):this.dispatchEvent(new CustomEvent(t,{detail:e}))}},{key:"handleLimitClick",value:function(){var t;"unlogin"===(null==(t=this.limitMaskState)?void 0:t.type)&&Wu({event:"selfDef.replyCardShowMore",spmPrefix:this.spmPrefix})}},{key:"handleViewMoreClick",value:function(){this.dispatchEvent(new CustomEvent("view-more"))}},{key:"headerTemplate",value:function(){return qe(el||(el=g(['\n      <div id="header">\n        <bili-comments-header-renderer\n          .spmPrefix=',"\n          .hideSortTime=","\n          .oid=","\n          .type=","\n          .mode=","\n          .user=","\n          .upMid=","\n          .isClosed=","\n          .isSelected=","\n          .options=","\n          .notice=","\n          .vote=","\n          .count=","\n          .inputPlaceholder=","\n          .commentBoxDisabledState=","\n          .commentBoxTeleportDisabled=","\n          .uploadPicState=","\n          .goodsState=","\n          .scrollContainer=","\n          @mode-change=","\n          @notice-close=","\n          @action=","\n        ></bili-comments-header-renderer>\n      </div>\n    "])),this.spmPrefix,this.hideSortTime,this.oid,this.type,this.mode,this.user,this.upMid,this.isClosed,this.isSelected,this.globalOptions,this.notice,this.vote,this.count,this.rootInputPlaceholder,this.commentBoxDisabledState,this.maxViewLimit>0,this.rootInputUploadPicState,this.rootInputGoodsState,this.scrollContainer,this.handleModeChange,this.handleNoticeClose,this.handleGlobalAction)}},{key:"spinnerTemplate",value:function(){return qe(nl||(nl=g(['<div id="spinner-container">\n      <div id="title">评论</div>\n      <bili-comments-spinner></bili-comments-spinner>\n    </div> '])))}},{key:"renderItem",value:function(t,e,n){var i=this;return qe(il||(il=g(["<bili-comment-thread-renderer\n      .theme=","\n      .spmPrefix=","\n      .user=","\n      .assist=","\n      .upMid=","\n      .data=","\n      .visible=","\n      .oid=","\n      .type=","\n      .mode=","\n      .idx=","\n      .contentFeatures=","\n      .extraTrackData=","\n      @delete=","\n      @top=","\n      @report=","\n      @block=","\n      @expand=","\n      @seek=","\n    ></bili-comment-thread-renderer>"])),this.theme,this.spmPrefix,this.user,this.assist,this.upMid,t,this.isVisibleItem(t.rpid_str),this.oid,this.type,this.mode,e,this.contentFeatures,this.commonTrackData,(function(){return i.handleItemDelete(e,n)}),(function(t){return i.handleItemTop(e,n,t.detail)}),(function(t){return i.handleItemReport(t.detail)}),(function(t){return i.handleItemBlock(t.detail)}),(function(t){return i.handleTriggerEvent("expand",t.detail)}),(function(t){t.stopPropagation(),i.handleTriggerEvent("seek",t.detail)}))}},{key:"limitMaskTemplate",value:function(){var t;return qe(rl||(rl=g(['<div id="limit-mask">\n      <div id="limit-mask-wall"></div>\n      <div id="limit-mask-tip" @click=',">","</div>\n    </div>"])),this.handleLimitClick,null==(t=this.limitMaskState)?void 0:t.text)}},{key:"contentTemplate",value:function(){var t=this;return qe(ol||(ol=g(['\n      <div id="contents">\n        <div id="new">\n          ','\n        </div>\n        <div id="feed">\n          ',"\n        </div>\n        ",'\n        <div id="reply-commentbox">\n          <bili-comment-box\n            style="padding: 25px 0 10px 80px;--bili-comment-box-display: none;"\n            .spmPrefix=',"\n            .oid=","\n            .type=","\n            .mode=","\n            .reply=","\n            .defaultInputValue=","\n            .voteOption=","\n            .keepActive=","\n            .user=","\n            .placeholder=","\n          ></bili-comment-box>\n        </div>\n      </div>\n    "])),Ic(this.newItems,(function(t){return t.rpid_str}),(function(e,n){return t.renderItem(e,n,"new")})),Ic(this.list,(function(t){return t.rpid_str}),(function(e,n){return t.renderItem(e,n,"feed")})),this.limitMaskState?this.limitMaskTemplate():"",this.spmPrefix,this.oid,this.type,this.mode,this.replyTarget,this.replyInputValue,this.voteOption,this.replyKeepActive,this.user,this.replyInputPlaceholder)}},{key:"continuationsTemplate",value:function(){return qe(al||(al=g(['\n      <div id="continuations">\n        ',"\n        ","\n      </div>\n    "])),this.showContinuations?qe(sl||(sl=g(['<div class="bottombar">正在加载…</div>']))):"",this.showContinueTrigger?qe(ll||(ll=g(['<div class="trigger"></div>']))):"")}},{key:"endTemplate",value:function(){return qe(cl||(cl=g(['\n      <div id="end" class="','">\n        ',"\n      </div>\n    "])),this.maxViewLimit?"limit":"",this.showViewMore?qe(ul||(ul=g(['<div class="bottombar clickable" @click=',">查看更多评论</div>"])),this.handleViewMoreClick):qe(dl||(dl=g(['<div class="bottombar">没有更多评论</div>']))))}},{key:"render",value:function(){return qe(pl||(pl=g(["\n      ","\n      ","\n    "])),this.showSpinner?this.spinnerTemplate():qe(hl||(hl=g(["","",""])),this.headerTemplate(),this.contentTemplate()),this.showEnd?this.endTemplate():this.continuationsTemplate())}}]);var n,a,l,c,h,f,b,x,_,A,E,C,T}(fn);Wv.styles=ve(fl||(fl=g(['\n    :host {\n      -webkit-font-smoothing: antialiased;\n    }\n\n    #spinner-container #title {\n      margin: 0;\n      color: var(--text1);\n      font-weight: 500;\n      font-size: 20px;\n      margin-bottom: 20px;\n    }\n\n    #contents {\n      padding-top: 14px;\n      position: relative;\n    }\n\n    #reply-commentbox {\n      display: none;\n      height: 0;\n      overflow: hidden;\n      opacity: 0;\n    }\n\n    #limit-mask {\n      width: 100%;\n      position: absolute;\n      bottom: -36px;\n      left: 0;\n    }\n\n    #limit-mask-wall {\n      width: 100%;\n      height: 300px;\n    }\n    #limit-mask-wall::before {\n      display: block;\n      content: "";\n      height: 80%;\n      background: linear-gradient(180deg, rgba(255, 255, 255, 0) 0%, var(--bg1) 100%);\n    }\n    #limit-mask-wall::after {\n      display: block;\n      content: "";\n      height: 20%;\n      background: var(--bg1);\n    }\n    #limit-mask-tip {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin-left: 80px;\n      width: calc(100% - 80px);\n      height: 50px;\n      border-radius: 6px;\n      font-size: 14px;\n      color: var(--brand_blue);\n      background-color: var(--brand_blue_thin);\n      transition: 0.2s;\n      cursor: pointer;\n    }\n    .bottombar {\n      width: 100%;\n      margin-top: 20px;\n      font-size: 13px;\n      color: var(--text3);\n      text-align: center;\n      user-select: none;\n    }\n    .bottombar.clickable:hover {\n      cursor: pointer;\n      color: var(--brand_blue);\n    }\n    #continuations .trigger {\n      width: 100%;\n      height: 40px;\n    }\n    #end .bottombar {\n      padding-bottom: 100px;\n    }\n    #end.limit .bottombar {\n      padding-bottom: 20px;\n    }\n  ']))),Hv([wn()],Wv.prototype,"scrollContainer",2),Hv([wn()],Wv.prototype,"user",2),Hv([wn()],Wv.prototype,"assist",2),Hv([gn({attribute:"data-params"})],Wv.prototype,"params",2),Hv([wn()],Wv.prototype,"spmPrefix",2),Hv([wn()],Wv.prototype,"mode",2),Hv([wn()],Wv.prototype,"maxViewLimit",2),Hv([wn()],Wv.prototype,"theme",2),Hv([wn()],Wv.prototype,"showSpinner",2),Hv([wn()],Wv.prototype,"showContinuations",2),Hv([wn()],Wv.prototype,"showContinueTrigger",2),Hv([wn()],Wv.prototype,"contentFeatures",2),Hv([wn()],Wv.prototype,"showEnd",2),Hv([wn()],Wv.prototype,"upMid",2),Hv([wn()],Wv.prototype,"globalOptions",2),Hv([wn()],Wv.prototype,"notice",2),Hv([wn()],Wv.prototype,"vote",2),Hv([wn()],Wv.prototype,"count",2),Hv([wn()],Wv.prototype,"hideSortTime",2),Hv([wn()],Wv.prototype,"rootInputPlaceholder",2),Hv([wn()],Wv.prototype,"inputDisabled",2),Hv([wn()],Wv.prototype,"rootInputUploadPicState",2),Hv([wn()],Wv.prototype,"limitMaskState",2),Hv([wn()],Wv.prototype,"list",2),Hv([wn()],Wv.prototype,"newItems",2),Hv([wn()],Wv.prototype,"replyTarget",2),Hv([wn()],Wv.prototype,"replyInputValue",2),Hv([wn()],Wv.prototype,"replyKeepActive",2),Hv([wn()],Wv.prototype,"replyInputPlaceholder",1),Hv([wn()],Wv.prototype,"commentBoxDisabledState",2),Hv([wn()],Wv.prototype,"voteOption",1),Hv([wn()],Wv.prototype,"commonTrackData",1),Hv([_n("#continuations .trigger")],Wv.prototype,"continueTrigger",2),Hv([_n("#reply-commentbox")],Wv.prototype,"replyCommentBoxContainer",2),Wv=Hv([mn("bili-comments")],Wv);var $v=Object.defineProperty,qv=Object.getOwnPropertyDescriptor,Gv=function(t,e,n,i){for(var r,o=i>1?void 0:i?qv(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&$v(e,n,o),o},Xv="bili-comments-bottom-fixed-wrapper",Yv=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.spmPrefix="",t.oid="",t.type=0,t.user=null,t.isClosed=!1,t.isSelected=!1,t.options=[],t.notice=null,t.vote=null,t.titleVisible=!0,t.hideSortTime=!1,t.count=0,t.mode=3,t.inputPlaceholder="",t.commentBoxDisabledState=null,t.commentBoxTeleportDisabled=!1,t.uploadPicState=1,t.goodsState=3,t.scrollContainer=null,t.commentboxInited=!1,t.revertTeleportCommentbox=null,t.showMoreMenu=!1,t.moreMenuInited=!1,t}return p(e,t),s(e,[{key:"voteOption",get:function(){return jv(this.vote)}},{key:"sortClass",get:function(){return 3===this.mode?"hot":2===this.mode?"time":""}},{key:"connectedCallback",value:function(){u(d(e.prototype),"connectedCallback",this).call(this),this.initMoreMenu(),this.initCommentbox()}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose()}},{key:"update",value:function(t){u(d(e.prototype),"update",this).call(this,t),t.get("options")&&this.initMoreMenu(),t.get("user")&&this.initCommentbox()}},{key:"initMoreMenu",value:function(){var t=this;this.menu&&(this.moreMenuInited||setTimeout((function(){t.disposables.addEventListener(t.menu,"mouseleave",(function(){t.showMoreMenu=!1}))})))}},{key:"initCommentbox",value:function(){var t=this;this.commentBoxDisabledState||this.commentboxInited||(this.commentboxInited=!0,!this.commentBoxTeleportDisabled&&setTimeout((function(){if(window.IntersectionObserver){var e=new IntersectionObserver(function(){var e=i(m().mark((function e(n){var i,r,o,a,s,l;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.scrollContainer){e.next=6;break}if(i=t.scrollContainer.scrollTop,r=t.commentboxEl.offsetTop-t.scrollContainer.offsetTop,o=t.scrollContainer.clientHeight,!(r-i>o)){e.next=4;break}return e.abrupt("return");case 4:e.next=9;break;case 6:if(a=t.commentboxEl.getBoundingClientRect(),s=a.top,l=window.innerHeight,!(s>=l)){e.next=9;break}return e.abrupt("return");case 9:t.teleportCommentbox(n[0].isIntersecting);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());e.observe(t.commentboxEl),t.disposables.add((function(){e.unobserve(t.commentboxEl),e.disconnect()})),t.disposables.addEventListener(window,"resize",(function(){t.updateBottomFixedWrapperStyle()}))}})))}},{key:"updateBottomFixedWrapperStyle",value:function(){var t;if(this.commentboxEl&&this.revertTeleportCommentbox){var e=((null==(t=this.scrollContainer)?void 0:t.parentElement)||this.shadowRoot).querySelector(".".concat(Xv));if(e){var n=this.commentboxEl.getBoundingClientRect(),i=n.width,r=n.left;e.style.width="".concat(i,"px"),e.style.left="".concat(r,"px")}}}},{key:"teleportCommentbox",value:function(t){var e,n=this;if(t)return null==(e=this.revertTeleportCommentbox)||e.call(this),void(this.revertTeleportCommentbox=null);var i=this.commentboxEl.children[0],r=this.commentboxEl.getBoundingClientRect(),o=r.width,a=r.height,s=r.left;this.commentboxEl.style.setProperty("--bili-comments-commentbox-height","".concat(a,"px"));var l=document.createElement("div");l.className=Xv,l.style.position=this.scrollContainer?"absolute":"fixed",l.style.bottom="0",l.style.left="".concat(s,"px"),l.style.width="".concat(o,"px"),l.style.zIndex="1";var c=document.createElement("div");c.appendChild(i),c.style.width="100%",c.style.padding="15px 0",c.style.position="relative",c.style.backgroundColor="var(--bg1)",c.style.borderTop="0.5px solid var(--graph_bg_thick)",l.appendChild(c);var u=this.shadowRoot,d=!1;this.scrollContainer&&this.scrollContainer.parentElement&&this.scrollContainer.parentElement!==document.body&&(u=this.scrollContainer.parentElement,"static"===getComputedStyle(u).position&&(d=!0,u.style.position="relative")),u.appendChild(l),this.revertTeleportCommentbox=function(){n.commentboxEl.appendChild(i),u.removeChild(l),d&&u instanceof HTMLElement&&(u.style.position=""),n.commentboxEl.style.setProperty("--bili-comments-commentbox-height","".concat(i.clientHeight,"px")),setTimeout((function(){n.commentboxEl.style.removeProperty("--bili-comments-commentbox-height")}),300)}}},{key:"handleChangeMode",value:function(t){this.mode!==t&&this.dispatchEvent(new CustomEvent("mode-change",{detail:t}))}},{key:"handleMore",value:function(){this.showMoreMenu=!0}},{key:"handleSelectOption",value:function(t){this.showMoreMenu=!1,this.dispatchEvent(new CustomEvent("action",{detail:t.detail}))}},{key:"handleNoticeClose",value:function(){this.dispatchEvent(new CustomEvent("notice-close"))}},{key:"handleLogin",value:function(){Wu({event:"selfDef.relpyInputClick",spmPrefix:this.spmPrefix})}},{key:"noticeTemplate",value:function(){return qe(vl||(vl=g(['\n      <div id="notice">\n        ',"\n      </div>\n    "])),qe(ml||(ml=g(["<bili-comments-notice\n          .data=","\n          .spmPrefix=","\n          @close=","\n        ></bili-comments-notice>"])),this.notice,this.spmPrefix,this.handleNoticeClose))}},{key:"voteTemplate",value:function(){return qe(bl||(bl=g(['\n      <div id="vote">\n        ',"\n      </div>\n    "])),qe(yl||(yl=g(["<bili-comments-vote-card\n          .spmPrefix=","\n          .data=","\n          .oid=","\n          .type=","\n          .user=","\n        ></bili-comments-vote-card>"])),this.spmPrefix,this.vote,this.oid,this.type,this.user))}},{key:"sortTemplate",value:function(){var t=this;return this.isClosed?"":this.isSelected?qe(gl||(gl=g(['<div id="sort-title">精选评论</div>']))):this.hideSortTime?qe(wl||(wl=g(['<div id="sort-title" class="single">最热</div>']))):qe(xl||(xl=g(['<div\n      id="sort-actions"\n      class=',"\n    >\n      <bili-text-button @click=",'>最热</bili-text-button>\n      <div class="sort-div"></div>\n      <bili-text-button @click=',">最新</bili-text-button>\n    </div>"])),this.sortClass?Ea(c({},this.sortClass,!0)):"",(function(){return t.handleChangeMode(3)}),(function(){return t.handleChangeMode(2)}))}},{key:"navbarTemplate",value:function(){return qe(kl||(kl=g(['\n      <div id="navbar">\n        ',"\n        ","\n        ","\n      </div>\n    "])),this.titleVisible&&qe(_l||(_l=g(['\n          <div id="title">\n            <h2>评论</h2>\n            <div id="count">',"</div>\n          </div>\n        "])),this.count),this.sortTemplate(),this.options.length?qe(Al||(Al=g([' <div id="more">\n              <button @click=','>\n                <bili-icon size="16" icon="BDC/more_vertical_fill/1"></bili-icon>\n              </button>\n              <bili-comment-menu\n                style="','"\n                .options=',"\n                @select=","\n              ></bili-comment-menu>\n            </div>"])),this.handleMore,this.showMoreMenu?Gn({"--bili-comment-menu-display":"block"}):"",this.options,this.handleSelectOption):"")}},{key:"disabledCommentboxTemplate",value:function(){var t,e,n;return qe(El||(El=g(['\n      <div id="disabled-commentbox">\n        <div id="user-avatar">\n          <img\n            src="','"\n            width="48"\n            height="48"\n          />\n        </div>\n        ',"\n      </div>\n    "])),ki.getBmgSrcNext((null==(t=this.user)?void 0:t.face)||"//i0.hdslb.com/bfs/face/member/noface.jpg",{w:48,h:48,dpr:2}),"unlogin"===(null==(e=this.commentBoxDisabledState)?void 0:e.source)?qe(Cl||(Cl=g(['<div id="edit">\n              <div>请先</div>\n              <button @click=',">登录</button>\n              <div>后发表评论 (・ω・)</div>\n            </div>"])),this.handleLogin):qe(Tl||(Tl=g(['<div id="edit">\n              <div>',"</div>\n            </div>"])),(null==(n=this.commentBoxDisabledState)?void 0:n.message)||"啥都木有"))}},{key:"commentboxTemplate",value:function(){return qe(Sl||(Sl=g(['\n      <div id="commentbox">\n        ',"\n      </div>\n    "])),this.commentBoxDisabledState?this.disabledCommentboxTemplate():qe(Ol||(Ol=g(["<bili-comment-box\n              .spmPrefix=","\n              .oid=","\n              .type=","\n              .mode=","\n              .user=","\n              .placeholder=","\n              .uploadPicState=","\n              .goodsState=","\n              .voteOption=","\n              .scrollContainer=","\n            ></bili-comment-box>"])),this.spmPrefix,this.oid,this.type,this.mode,this.user,this.inputPlaceholder,this.uploadPicState,this.goodsState,this.voteOption,this.scrollContainer))}},{key:"render",value:function(){return qe(Pl||(Pl=g(["\n      "," "," "," ","\n    "])),this.notice?this.noticeTemplate():"",this.vote&&this.voteTemplate(),this.navbarTemplate(),this.commentboxTemplate())}}])}(fn);Yv.styles=ve(Il||(Il=g(["\n    #notice {\n      margin-bottom: 10px;\n    }\n    #vote {\n      margin-bottom: 24px;\n    }\n    #navbar {\n      display: flex;\n      align-items: center;\n      height: 28px;\n      margin-bottom: 22px;\n    }\n    #title {\n      display: var(--bili-comments-title-display, flex);\n      align-items: center;\n    }\n    #title h2 {\n      margin: 0;\n      color: var(--text1);\n      font-weight: 500;\n      font-size: var(--bili-comments-font-size-title, 20px);\n    }\n    #title #count {\n      margin: 0 30px 0 6px;\n      font-size: var(--bili-comments-font-size-count, 13px);\n      font-weight: 400;\n      color: var(--text3);\n    }\n\n    #sort-title {\n      font-weight: 500;\n      color: var(--text1);\n    }\n    #sort-title.single {\n      font-weight: 400;\n      font-size: var(--bili-comments-font-size-sort, 13px);\n    }\n\n    #sort-actions .sort-div {\n      display: inline-block;\n      height: 11px;\n      margin: 0 3px;\n      border-left: solid 1px var(--text3);\n      vertical-align: -2px;\n    }\n\n    #sort-actions bili-text-button {\n      --_container-height: 28px;\n      --_leading-space: 6px;\n      --_trailing-space: 6px;\n      --_label-text-size: var(--bili-comments-font-size-sort, 13px);\n      --_label-text-color: var(--text3);\n    }\n\n    #sort-actions.hot bili-text-button:first-child {\n      --_label-text-color: var(--text1);\n    }\n    #sort-actions.time bili-text-button:last-child {\n      --_label-text-color: var(--text1);\n    }\n    #commentbox {\n      flex-shrink: 0;\n      transition: height 0.2s;\n      height: var(--bili-comments-commentbox-height, auto);\n    }\n    #more {\n      margin-left: auto;\n      width: 24px;\n      height: 24px;\n      position: relative;\n    }\n    #more button {\n      width: 24px;\n      height: 24px;\n      text-align: center;\n      padding: 0;\n      outline: none;\n      border: none;\n      background: transparent;\n      font-size: 13px;\n      color: var(--text3);\n      display: inline-flex;\n      align-items: center;\n      cursor: pointer;\n      justify-content: end;\n    }\n    #disabled-commentbox {\n      display: flex;\n      height: 50px;\n    }\n    #disabled-commentbox #user-avatar {\n      flex-shrink: 0;\n      width: 80px;\n      height: 50px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #disabled-commentbox #user-avatar img {\n      border-radius: 50%;\n    }\n    #disabled-commentbox #edit {\n      flex: 1;\n      height: 100%;\n      border-radius: 6px;\n      font-size: 12px;\n      color: var(--text3);\n      background-color: var(--bg3);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    #disabled-commentbox #edit button {\n      box-sizing: border-box;\n      padding: 4px 9px;\n      margin: 0 3px;\n      border-radius: 4px;\n      color: var(--text_white);\n      background-color: var(--brand_blue);\n      outline: none;\n      border: none;\n      cursor: pointer;\n      font-size: 12px;\n    }\n    #disabled-commentbox #edit button:hover {\n      background-color: var(--Lb4);\n    }\n  "]))),Gv([gn({type:String})],Yv.prototype,"spmPrefix",2),Gv([gn()],Yv.prototype,"oid",2),Gv([gn()],Yv.prototype,"type",2),Gv([gn()],Yv.prototype,"user",2),Gv([gn()],Yv.prototype,"isClosed",2),Gv([gn()],Yv.prototype,"isSelected",2),Gv([gn()],Yv.prototype,"options",2),Gv([gn()],Yv.prototype,"notice",2),Gv([gn()],Yv.prototype,"vote",2),Gv([gn({type:Boolean})],Yv.prototype,"titleVisible",2),Gv([gn({type:Boolean})],Yv.prototype,"hideSortTime",2),Gv([gn({type:Number})],Yv.prototype,"count",2),Gv([gn({type:String})],Yv.prototype,"mode",2),Gv([gn({type:String})],Yv.prototype,"inputPlaceholder",2),Gv([gn({type:Object})],Yv.prototype,"commentBoxDisabledState",2),Gv([gn({type:Boolean})],Yv.prototype,"commentBoxTeleportDisabled",2),Gv([gn({type:Number})],Yv.prototype,"uploadPicState",2),Gv([gn({type:Number})],Yv.prototype,"goodsState",2),Gv([wn()],Yv.prototype,"voteOption",1),Gv([gn()],Yv.prototype,"scrollContainer",2),Gv([wn()],Yv.prototype,"showMoreMenu",2),Gv([wn()],Yv.prototype,"sortClass",1),Gv([_n("#commentbox")],Yv.prototype,"commentboxEl",2),Gv([_n("bili-comment-menu")],Yv.prototype,"menu",2),Yv=Gv([mn("bili-comments-header-renderer")],Yv);var Zv=Object.defineProperty,Qv=Object.getOwnPropertyDescriptor,Kv=function(t,e,n,i){for(var r,o=i>1?void 0:i?Qv(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Zv(e,n,o),o},Jv=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).i18r=null,t.isIntersecting=!1,t.isReported=!1,t.spmPrefix="",t}return p(e,t),s(e,[{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),window.IntersectionObserver&&(this.i18r=new IntersectionObserver((function(e){var n=e[0];n&&n.target===t&&(t.isIntersecting=n.isIntersecting,!t.isReported&&n.isIntersecting&&t.cmReport())})),this.i18r.observe(this))}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.clearI18r(),this.isReported=!1}},{key:"clearI18r",value:function(){this.isIntersecting=!1,this.i18r&&(this.i18r.disconnect(),this.i18r=null)}},{key:"cmReport",value:function(){var t,e=this;if(null!=(t=window.BiliCm)&&t.Base){this.isReported=!0;var n=this.data,i=n.isEmpty,r=n.data,o=n.locId;window.BiliCm.Base.sendShowData(r,o),i?this.clearI18r():setTimeout((function(){var t;null!=(t=window.BiliCm)&&t.Base&&(e.isIntersecting&&window.BiliCm.Base.sendStrictShowData(r,o),e.clearI18r())}),1e3)}}},{key:"handleJump",value:function(){Eu("playpage_anoun"),Tu("show","comments.notice.show",{},{spmPrefix:this.spmPrefix});var t=function(t,e){return window.BiliCm?window.BiliCm.Base.getSyncUrl(t,e):t.url}(this.data.data,this.data.locId);t&&window.open(t,"_blank")}},{key:"handleClose",value:function(t){t.stopPropagation(),this.dispatchEvent(new CustomEvent("close"))}},{key:"render",value:function(){return qe(Rl||(Rl=g(['\n      <div\n        id="bar"\n        style=',"\n        @click=",'\n      >\n        <div id="bg"></div>\n        <bili-icon icon="BDC/speaker_notice_fill/1" size="14"></bili-icon>\n        <div id="title">','</div>\n        <div id="close" @click=','>\n          <bili-icon icon="BDC/xmark_close_line/1" size="16"></bili-icon>\n        </div>\n      </div>\n    '])),Gn({display:this.data.isEmpty?"none":"flex"}),this.handleJump,this.data.title,this.handleClose)}}])}(fn);Jv.styles=ve(jl||(jl=g(["\n    :host {\n      display: block;\n    }\n    #bar {\n      display: flex;\n      align-items: center;\n      position: relative;\n      height: 40px;\n      padding: 0 10px;\n      font-size: 12px;\n      color: var(--Ye5_u);\n      cursor: pointer;\n    }\n    #bg {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border-radius: 2px;\n      background-color: var(--Ye5_u);\n      opacity: 0.2;\n      pointer-events: none;\n    }\n    #title {\n      position: relative;\n      z-index: 1;\n      margin-right: auto;\n      flex: 1;\n      padding: 0 5px;\n      vertical-align: top;\n      word-wrap: break-word;\n      word-break: break-all;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    #close {\n      position: relative;\n      z-index: 1;\n      display: flex;\n    }\n  "]))),Kv([gn()],Jv.prototype,"spmPrefix",2),Kv([gn()],Jv.prototype,"data",2),Jv=Kv([mn("bili-comments-notice")],Jv);var tm=Object.defineProperty,em=Object.getOwnPropertyDescriptor,nm=function(t,e,n,i){for(var r,o=i>1?void 0:i?em(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&tm(e,n,o),o},im=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).mask=!1,t.maskClosable=!0,t.titleText="",t.width="600px",t.minWidth="300px",t.transparent=!1,t}return p(e,t),s(e,[{key:"handleClose",value:function(){this.maskClosable&&this.hide()}},{key:"hide",value:function(){this.parentElement&&this.parentElement.removeChild(this)}},{key:"connectedCallback",value:function(){u(d(e.prototype),"connectedCallback",this).call(this),this.initData()}},{key:"initData",value:function(){var t=this.getAttribute("title"),e=this.getAttribute("width"),n=this.getAttribute("min-width"),i="true"===this.getAttribute("transparent");t&&(this.titleText=t),e&&(this.width=e),n&&(this.minWidth=n),i&&(this.transparent=!0)}},{key:"render",value:function(){return qe(Ll||(Ll=g(["\n      ",'\n      <div\n        id="wrap"\n        class="','"\n        style="','"\n      >\n        ','\n        <div id="content">\n          <slot></slot>\n        </div>\n      </div>\n    '])),this.mask?qe(Ml||(Ml=g(['<div id="mask" @click=',"></div>"])),this.handleClose):qe(Dl||(Dl=g([""]))),this.titleText?"":"overflow",Gn({width:this.width,minWidth:this.minWidth,background:this.transparent?"transparent":"var(--bg1)"}),this.titleText?qe(Nl||(Nl=g(['<div id="header">\n              <div id="title">','</div>\n              <div id="close" @click=','><bili-icon icon="BDC/xmark_close_line/1" size="22"></bili-icon></div>\n            </div>'])),this.titleText,this.hide):qe(Bl||(Bl=g(['<div id="close" class="outer" @click=','><bili-icon icon="BDC/xmark_close_line/1" size="22"></bili-icon></div>'])),this.hide))}}])}(fn);im.styles=ve(zl||(zl=g(["\n    :host {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #mask {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background-color: rgba(0, 0, 0, 0.5);\n    }\n    #wrap {\n      position: relative;\n      width: 100%;\n      border-radius: 6px;\n      box-shadow: 0 0 25px #00000026;\n      background-color: var(--bg1);\n      overflow: hidden;\n      max-height: 100vh;\n      display: flex;\n      flex-direction: column;\n    }\n    #wrap.overflow {\n      overflow: initial;\n    }\n    #header {\n      box-sizing: border-box;\n      width: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      height: 50px;\n      flex-shrink: 0;\n      padding: 0 10px;\n      border-bottom: 0.5px solid var(--line_light);\n      position: relative;\n      color: var(--text1);\n    }\n    #close {\n      cursor: pointer;\n      position: absolute;\n      right: 10px;\n      color: var(--text2);\n    }\n    #close.outer {\n      top: -30px;\n      right: 0;\n    }\n    #content {\n      height: calc(100% - 50px);\n      overflow-y: auto;\n    }\n    ::slotted(iframe) {\n      width: 100%;\n      height: 100%;\n      border: none;\n    }\n  "]))),nm([gn({type:Boolean})],im.prototype,"mask",2),nm([gn({type:Boolean})],im.prototype,"maskClosable",2),nm([gn()],im.prototype,"titleText",2),nm([wn()],im.prototype,"width",2),nm([wn()],im.prototype,"minWidth",2),nm([wn()],im.prototype,"transparent",2),im=nm([mn("bili-comments-popup")],im);var rm=Object.defineProperty,om=Object.getOwnPropertyDescriptor,am=function(t){function e(){return o(this,e),r(this,e,arguments)}return p(e,t),s(e,[{key:"render",value:function(){return qe(Ul||(Ul=g(['\n      <div id="spinner">\n        <img width="24" height="24" src="//i0.hdslb.com/bfs/static/jinkela/long/gif/loading-blue.gif" />\n        <span>正在玩命加载…</span>\n      </div>\n    '])))}}])}(fn);am.styles=ve(Fl||(Fl=g(["\n    #spinner {\n      padding: 20px 0;\n      width: 100%;\n      text-align: center;\n      font-size: 14px;\n      color: var(--text3);\n    }\n    #spinner img {\n      margin-right: 8px;\n      vertical-align: bottom;\n    }\n  "]))),am=function(t,e,n,i){for(var r,o=i>1?void 0:i?om(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&rm(e,n,o),o}([mn("bili-comments-spinner")],am);var sm=Object.defineProperty,lm=Object.getOwnPropertyDescriptor,cm=function(t,e,n,i){for(var r,o=i>1?void 0:i?lm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&sm(e,n,o),o},um=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).spmPrefix="",t.oid="",t.type=0,t.user=null,t}return p(e,t),s(e,[{key:"isDuel",get:function(){return 2===this.data.options.length}},{key:"optionIdx",get:function(){return this.data.my_vote_option||0}},{key:"handleClick",value:function(){Ud(this.data.vote_id)}},{key:"handleOptionClick",value:(n=i(m().mark((function t(e){var n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.user){t.next=3;break}return Wu({event:"selfDef.voteCardClick",spmPrefix:this.spmPrefix}),t.abrupt("return");case 3:if(!(this.optionIdx>0)){t.next=5;break}return t.abrupt("return");case 5:return n=e.idx,t.prev=6,t.next=9,iu({option:n,vote_id:this.data.vote_id,oid:this.oid,type:this.type});case 9:this.data.my_vote_option=n,this.data.count?this.data.count+=1:this.data.count=1,this.data.options[n-1].count?this.data.options[n-1].count+=1:this.data.options[n-1].count=1,this.requestUpdate(),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(6),console.error(t.t0);case 18:case"end":return t.stop()}}),t,this,[[6,15]])}))),function(t){return n.apply(this,arguments)})},{key:"duelOptionTemplate",value:function(t){var e=this,n=this.optionIdx,i=0!==n,r="".concat(n?Math.round((t.count||0)/this.data.count*100):50,"%");return qe(Vl||(Vl=g(['<div\n      class="','"\n      style="','"\n      @click=','\n    >\n      <div class="option-info">\n        <div class="option-desc">',"</div>\n        ",'\n      </div>\n      <div class="option-skew">\n        <div class="option-skew-fill"></div>\n      </div>\n      ',"\n    </div>"])),Ea(c({option:!0},1===t.idx?"left":"right",!0)),i?Gn({"--option-opacity":".8","--option-width":r,"--option-color":"var(--text_white)","--option-font-size":"12px","--option-cursor":"default"}):"",(function(){return e.handleOptionClick(t)}),t.desc,i?qe(Hl||(Hl=g(['<div class="option-ratio">',"</div>"])),r):"",t.idx===n?qe(Wl||(Wl=g(['<bili-icon icon="BDC/checkmark_circle_fill/1" size="20"></bili-icon>']))):"")}},{key:"duelTemplate",value:function(){var t=this;return qe($l||($l=g(['<div id="duel">',"</div>"])),this.data.options.map((function(e){return t.duelOptionTemplate(e)})))}},{key:"render",value:function(){return qe(ql||(ql=g(['\n      <div id="card">\n        <div id="info">\n          <div id="title">\n            <bili-icon icon="BDC/vote_line/2" size="16"></bili-icon>\n            <span>',"</span>\n          </div>\n          ","\n        </div>\n        ","\n      </div>\n    "])),this.data.title,this.isDuel?qe(Gl||(Gl=g(['<div id="desc">\n                <div id="count">',"人参与</div>\n              </div>"])),this.data.count||0):qe(Xl||(Xl=g(['<div id="desc">\n                <div id="count">','人参与</div>\n                <div id="split">|</div>\n                ',"\n              </div>"])),this.data.count||0,this.optionIdx>0?qe(Yl||(Yl=g(['<div id="status">已投票 ·&nbsp;</div>\n                      <bili-text-button .trailingIcon=',' id="action" @click=','>\n                        查看投票结果 <bili-icon slot="icon" icon="BDC/arrow_forward_right_line/3" size="12"></bili-icon\n                      ></bili-text-button> '])),!0,this.handleClick):qe(Zl||(Zl=g(['<bili-text-button id="action" @click=',">去投票</bili-text-button>"])),this.handleClick)),this.isDuel?this.duelTemplate():"")}}]);var n}(fn);um.styles=ve(Ql||(Ql=g(["\n    :host {\n      --option-opacity: 0.15;\n      --option-width: 50%;\n      --option-radius: 6px;\n      --option-font-size: 13px;\n      --option-color: var(--Pi10_u);\n      --option-cursor: pointer;\n    }\n    #card {\n      width: 100%;\n      height: 80px;\n      display: flex;\n      border-radius: 6px;\n      background-color: var(--graph_bg_thin);\n      padding: 12px 16px 12px 10px;\n      box-sizing: border-box;\n      align-items: center;\n    }\n\n    #info {\n      flex: 1;\n      color: var(--option-color);\n    }\n\n    #duel {\n      flex-shrink: 0;\n      width: 60%;\n      margin-left: 30px;\n      height: 40px;\n      display: flex;\n    }\n\n    #info #title {\n      color: var(--text1);\n      font-size: 13px;\n      display: flex;\n      align-items: center;\n    }\n    #info #title span {\n      margin-left: 2px;\n    }\n    #info #desc {\n      margin-top: 4px;\n      color: var(--text3);\n      display: flex;\n      font-size: 12px;\n      align-items: center;\n    }\n    #info #desc #split {\n      color: var(--line_regular);\n      margin: 0px 6px;\n    }\n\n    #duel .option {\n      position: relative;\n      display: flex;\n      min-width: 120px;\n      align-items: center;\n      justify-content: space-between;\n      height: 40px;\n      width: var(--option-width);\n      color: var(--option-color);\n      font-size: var(--option-font-size);\n      cursor: var(--option-cursor);\n    }\n    #duel .option.left {\n      margin-right: 30px;\n      padding-left: 10px;\n      border-radius: var(--option-radius) 0 0 var(--option-radius);\n      background-color: rgba(255, 102, 153, var(--option-opacity));\n    }\n    #duel .option.right {\n      flex-direction: row-reverse;\n      text-align: right;\n      padding-right: 10px;\n      border-radius: 0 var(--option-radius) var(--option-radius) 0;\n      background-color: rgba(0, 174, 236, var(--option-opacity));\n    }\n    #duel .option-skew {\n      position: absolute;\n      top: 0;\n      height: 100%;\n      width: 20px;\n      overflow: hidden;\n      opacity: var(--option-opacity);\n      pointer-events: none;\n    }\n    #duel .option-skew-fill {\n      pointer-events: all;\n      position: absolute;\n      top: 0;\n      width: 100%;\n      height: 100%;\n    }\n    #duel .option.left .option-skew {\n      right: -20px;\n    }\n    #duel .option.right .option-skew {\n      left: -20px;\n    }\n    #duel .option.left .option-skew-fill {\n      left: -8px;\n      background-color: #f69;\n      transform: skew(21deg);\n      border-top-right-radius: calc(var(--option-radius) - 2px);\n      border-bottom-right-radius: var(--option-radius);\n    }\n    #duel .option.right .option-skew-fill {\n      left: 8px;\n      background-color: #00aeec;\n      transform: skew(21deg);\n      border-top-left-radius: var(--option-radius);\n      border-bottom-left-radius: calc(var(--option-radius) - 2px);\n    }\n  "]))),cm([gn({type:String})],um.prototype,"spmPrefix",2),cm([gn({type:Object})],um.prototype,"data",2),cm([gn()],um.prototype,"oid",2),cm([gn()],um.prototype,"type",2),cm([gn()],um.prototype,"user",2),cm([wn()],um.prototype,"isDuel",1),cm([wn()],um.prototype,"optionIdx",1),um=cm([mn("bili-comments-vote-card")],um);var dm=Object.defineProperty,pm=Object.getOwnPropertyDescriptor,hm=function(t,e,n,i){for(var r,o=i>1?void 0:i?pm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&dm(e,n,o),o},fm=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.defaultValue="",t.value="",t.nodes=[],t.placeholder="请输入你想评论的内容",t.rows=1,t.isFocus=!1,t.selection={startIndex:0,startOffset:0,endIndex:0,endOffset:0,collapsed:!0},t}return p(e,t),s(e,[{key:"getSelection",value:function(){return v({},this.selection)}},{key:"update",value:function(t){if(u(d(e.prototype),"update",this).call(this,t),this.brt&&t.get("placeholder")){if(!this.placeholder)return;var n={raw:this.defaultValue,nodes:this.defaultValue?[{type:Xp.NodeType.TEXT,raw:this.defaultValue}]:[]};this.brt.update({placeholder:this.placeholder,value:n})}}},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),this.value=this.defaultValue,window.setTimeout((function(){t.brt=new Xp({value:t.nodes.length?{nodes:t.nodes}:t.defaultValue?{raw:t.defaultValue}:void 0,placeholder:t.placeholder,autosize:!0}).mount(t.input),t.brt.addEventListener("change",(function(e){var n=e.detail,i=n.raw,r=n.nodes;t.value=i,t.nodes=r,t.dispatchEvent(new CustomEvent("change",{detail:{raw:i,nodes:w(r)}}))})),t.brt.addEventListener("selection-change",(function(e){t.selection={startIndex:e.detail.startIndex,startOffset:e.detail.startOffset,endIndex:e.detail.endIndex,endOffset:e.detail.endOffset,collapsed:e.detail.collapsed},t.dispatchEvent(new CustomEvent("selection-change",{detail:e.detail}))})),t.brt.addEventListener("focus-change",(function(e){t.isFocus=e.detail,t.dispatchEvent(new CustomEvent("focus-change",{detail:e.detail}))})),t.disposables.add((function(){t.brt&&t.brt.unmount()}))}))}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose()}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.brt&&this.brt.dispatchAction({type:"setContent",args:[{raw:"",nodes:t}]})}},{key:"focus",value:function(){this.brt&&this.brt.dispatchAction({type:"focus"})}},{key:"blur",value:function(){this.brt&&this.brt.dispatchAction({type:"blur"})}},{key:"insertNodes",value:function(t,e){this.brt&&this.brt.dispatchAction({type:"insertNodes",args:[w(t),e]})}},{key:"insertText",value:function(t,e){this.insertNodes([{type:"text",raw:t}],e)}},{key:"render",value:function(){return qe(Kl||(Kl=g(['\n      <div\n        id="input"\n        class="','"\n      ></div>\n    '])),Ea({active:!!this.value}))}}])}(fn);fm.styles=ve(Jl||(Jl=g(['\n    :host {\n      --bili-comment-textarea-bg: transparent;\n      --bili-comment-textarea-color: var(--text1);\n      --bili-comment-textarea-placeholder-color: var(--text3);\n      --bili-comment-textarea-padding: 8px;\n      --bili-comment-textarea-font-size: 14px;\n      --brt-line-height: 32px;\n    }\n    :host {\n      display: flex;\n    }\n    #input {\n      min-height: 32px;\n      max-height: 100px;\n      line-height: 32px;\n      width: 100%;\n      font-size: var(--bili-comment-textarea-font-size);\n      font-family: inherit;\n      box-sizing: border-box;\n      color: var(--bili-comment-textarea-color);\n      background-color: var(--bili-comment-textarea-bg);\n    }\n    #input.active {\n      --brt-line-height: normal;\n    }\n    .brt-root {\n      position: relative;\n    }\n\n    .brt-placeholder {\n      position: absolute;\n      left: var(--brt-editor-padding-hrz, 8px);\n      top: var(--brt-editor-padding-vtc, 0);\n      color: var(--brt-placeholder-color, var(--text3, #9499a0));\n      font-size: var(--brt-font-size, 14px);\n      line-height: var(--brt-line-height, 20px);\n      pointer-events: none;\n    }\n    .brt-editor {\n      outline: none;\n      border: none;\n      box-sizing: border-box;\n      padding: var(--brt-editor-padding-vtc, 0) var(--brt-editor-padding-hrz, 8px);\n      font-size: var(--brt-font-size, 14px);\n      line-height: var(--brt-line-height, 20px);\n      min-height: var(--brt-line-height, 20px);\n      overflow-y: auto;\n      max-height: 100px;\n    }\n\n    .brt-editor .brt-hl {\n      color: var(--text_link, #008ac5);\n    }\n\n    .brt-hl.goods::before {\n      font-family: "pc-comments-cljzkg6fxb9";\n      content: "\\e000";\n      text-rendering: geometricPrecision;\n    }\n\n    .brt-editor img {\n      vertical-align: text-bottom;\n    }\n\n    .brt-editor a {\n      color: var(--text_link, #008ac5);\n      text-decoration: none;\n    }\n  '],['\n    :host {\n      --bili-comment-textarea-bg: transparent;\n      --bili-comment-textarea-color: var(--text1);\n      --bili-comment-textarea-placeholder-color: var(--text3);\n      --bili-comment-textarea-padding: 8px;\n      --bili-comment-textarea-font-size: 14px;\n      --brt-line-height: 32px;\n    }\n    :host {\n      display: flex;\n    }\n    #input {\n      min-height: 32px;\n      max-height: 100px;\n      line-height: 32px;\n      width: 100%;\n      font-size: var(--bili-comment-textarea-font-size);\n      font-family: inherit;\n      box-sizing: border-box;\n      color: var(--bili-comment-textarea-color);\n      background-color: var(--bili-comment-textarea-bg);\n    }\n    #input.active {\n      --brt-line-height: normal;\n    }\n    .brt-root {\n      position: relative;\n    }\n\n    .brt-placeholder {\n      position: absolute;\n      left: var(--brt-editor-padding-hrz, 8px);\n      top: var(--brt-editor-padding-vtc, 0);\n      color: var(--brt-placeholder-color, var(--text3, #9499a0));\n      font-size: var(--brt-font-size, 14px);\n      line-height: var(--brt-line-height, 20px);\n      pointer-events: none;\n    }\n    .brt-editor {\n      outline: none;\n      border: none;\n      box-sizing: border-box;\n      padding: var(--brt-editor-padding-vtc, 0) var(--brt-editor-padding-hrz, 8px);\n      font-size: var(--brt-font-size, 14px);\n      line-height: var(--brt-line-height, 20px);\n      min-height: var(--brt-line-height, 20px);\n      overflow-y: auto;\n      max-height: 100px;\n    }\n\n    .brt-editor .brt-hl {\n      color: var(--text_link, #008ac5);\n    }\n\n    .brt-hl.goods::before {\n      font-family: "pc-comments-cljzkg6fxb9";\n      content: "\\\\e000";\n      text-rendering: geometricPrecision;\n    }\n\n    .brt-editor img {\n      vertical-align: text-bottom;\n    }\n\n    .brt-editor a {\n      color: var(--text_link, #008ac5);\n      text-decoration: none;\n    }\n  ']))),hm([_n("#input")],fm.prototype,"input",2),hm([gn({type:String})],fm.prototype,"defaultValue",2),hm([wn()],fm.prototype,"value",2),hm([gn({type:Array})],fm.prototype,"nodes",2),hm([gn({type:String})],fm.prototype,"placeholder",2),hm([wn()],fm.prototype,"rows",2),fm=hm([mn("bili-comment-rich-textarea")],fm);var vm=function(){return s((function t(e){var n=this;if(o(this,t),this.disposables=On(),"TEXTAREA"!==e.tagName)throw new Error("TextareaAutoSize can only be used on textarea elements");this.element=e,this.verticalBorderSize=this.getStyleProp("borderTopWidth")+this.getStyleProp("borderBottomWidth")||0,this.disposables.addEventListener(this.element,"input",(function(){n.update()})),this.update()}),[{key:"destroy",value:function(){this.disposables.dispose(),this.element=null}},{key:"update",value:function(){var t=this.getStyleProp("fontSize");this.element.style.height="".concat(t,"px");var e=this.element.scrollHeight+this.verticalBorderSize;this.element.style.height="".concat(e,"px")}},{key:"getStyleProp",value:function(t){var e=getComputedStyle(this.element,null);return parseInt(e[t])}}])}(),mm=Object.defineProperty,bm=Object.getOwnPropertyDescriptor,ym=function(t,e,n,i){for(var r,o=i>1?void 0:i?bm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&mm(e,n,o),o},gm=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.value="",t.placeholder="请输入你想评论的内容",t.rows=1,t.isFocus=!1,t.selection={start:0,end:0},t}return p(e,t),s(e,[{key:"getSelection",value:function(){return v({},this.selection)}},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),setTimeout((function(){var e=new vm(t.input);t.disposables.add((function(){e.destroy()}))}))}},{key:"handleFocus",value:function(t){t.stopPropagation(),this.isFocus="focus"===t.type,this.dispatchEvent(new CustomEvent(t.type))}},{key:"handleSelectionChange",value:function(t){var e=t.selectionStart,n=t.selectionEnd;e===this.selection.start&&n===this.selection.end||(this.selection.start=t.selectionStart,this.selection.end=t.selectionEnd,this.dispatchEvent(new CustomEvent("selection-change",{detail:v({},this.selection)})))}},{key:"handleClick",value:function(t){t.stopPropagation(),this.handleSelectionChange(t.target)}},{key:"handleInput",value:function(t){var e=t.target;t.stopPropagation(),this.value=e.value,this.dispatchInputEvent()}},{key:"handleKeydown",value:function(t){t.stopPropagation()}},{key:"handleKeyup",value:function(t){t.stopPropagation();var e=t.target;this.handleSelectionChange(e)}},{key:"dispatchInputEvent",value:function(){this.dispatchEvent(new CustomEvent("change",{detail:this.value}))}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"insertText",value:function(t,e){var n=this,i=this.input;e||(e={start:i.selectionStart,end:i.selectionEnd});var r=e,o=r.start,a=r.end,s=this.value;this.value=s.slice(0,o)+t+s.slice(a),this.dispatchInputEvent(),setTimeout((function(){i.selectionStart=i.selectionEnd=o+t.length,n.handleSelectionChange(i),n.focus()}))}},{key:"render",value:function(){return qe(tc||(tc=g(['\n      <textarea\n        id="input"\n        .value=',"\n        .placeholder=",'\n        class="','"\n        @focus=',"\n        @blur=","\n        @click=","\n        @keydown=","\n        @keyup=","\n        @input=","\n      ></textarea>\n    "])),this.value,this.placeholder,Ea({active:!!this.value}),this.handleFocus,this.handleFocus,this.handleClick,this.handleKeydown,this.handleKeyup,this.handleInput)}}])}(fn);gm.styles=ve(ec||(ec=g(["\n    :host {\n      --bili-comment-textarea-bg: transparent;\n      --bili-comment-textarea-color: var(--text1);\n      --bili-comment-textarea-placeholder-color: var(--text3);\n      --bili-comment-textarea-padding: 8px;\n      --bili-comment-textarea-font-size: 14px;\n    }\n    :host {\n      display: flex;\n    }\n    #input {\n      min-height: 32px;\n      max-height: 100px;\n      line-height: 32px;\n      width: 100%;\n      font-size: var(--bili-comment-textarea-font-size);\n      font-family: inherit;\n      box-sizing: border-box;\n      color: var(--bili-comment-textarea-color);\n      background-color: var(--bili-comment-textarea-bg);\n      padding: 0 var(--bili-comment-textarea-padding);\n      border: none;\n      resize: none;\n      outline: none;\n    }\n    #input.active {\n      line-height: normal;\n    }\n    #input::placeholder {\n      color: var(--bili-comment-textarea-placeholder-color);\n    }\n  "]))),ym([_n("#input")],gm.prototype,"input",2),ym([gn({type:String})],gm.prototype,"value",2),ym([gn({type:String})],gm.prototype,"placeholder",2),ym([wn()],gm.prototype,"rows",2),gm=ym([mn("bili-comment-textarea")],gm);var wm=Object.defineProperty,xm=Object.getOwnPropertyDescriptor,km=function(t,e,n,i){for(var r,o=i>1?void 0:i?xm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&wm(e,n,o),o},_m=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).spmPrefix="",t.oid="",t.type=0,t.mode=3,t.idx=0,t.visible=!0,t.upMid=0,t.theme="light",t.user=null,t.assist=!1,t.extraTrackData={},t.commonTrackData=null,t.trackObserver=null,t}return p(e,t),s(e,[{key:"handleReply",value:function(t){var e,n=this;xu.emit("reply",{target:t,defaultInput:(null==(e=t.reply_control)?void 0:e.preset_reply_text)||"",mount:function(t){t.parentElement!==n.replyContainer&&n.replyContainer.appendChild(t)}})}},{key:"handleReport",value:function(t){this.dispatchEvent(new CustomEvent("report",{detail:t}))}},{key:"handleBlock",value:function(t){this.dispatchEvent(new CustomEvent("block",{detail:t}))}},{key:"getClickTrackData",value:function(t){var e=this.getCommonTrackData();return Object.assign(e,t,{ext_json:JSON.stringify({likes:this.data.like,rank:this.idx,rp_mid:this.data.member.mid,rpid:this.data.rpid_str})}),e}},{key:"getCommonTrackData",value:function(){var t,e,n,i,r,o,a,s,l,c,u;if(this.commonTrackData)return this.commonTrackData;var d="-";null!=(n=this.data.reply_control)&&n.is_note_v2&&(d=this.data.reply_control.is_note?"note":"opus_"+this.data.dynamic_id_str);var p="";if("string"==typeof this.data.track_info)try{var h=JSON.parse(this.data.track_info);null!=h&&h.track_id&&(p=h.track_id)}catch(t){}var f=[],m=0;this.commentRenderer?this.commentRenderer.getRichTextContent().forEach((function(t){var e,n,i;if("a"===t.tag&&t.a)if(t.a.href){var r=(null==(e=t.dataset)?void 0:e.type)||"";if(!["search","mention"].includes(r)){var o=(null==(n=t.dataset)?void 0:n["raw-url"])||function(t){return t.replace(/^(https?:)?\/\//,"https://")}(t.a.href);f.push(o)}}else"seek"===(null==(i=t.dataset)?void 0:i.type)&&(m+=1)})):console.warn("commentRenderer is not ready");var b=null!==(t=this.data.content)&&void 0!==t?t:{},y=b.members,g=b.vote,w=(null==(i=this.data.replies)?void 0:i.map((function(t){return t.rpid_str})))||[],x=[];this.data.card_label&&this.data.card_label.forEach((function(t){x.push(t.text_content)}));var k=v({oid:this.oid,type:this.type,rpid:this.data.rpid_str,tag_name:"",ordering:3===this.mode?"heat":"time",from_spmid:Ff(),spmid:this.spmPrefix||hi(),reply_list:w.join(","),rank:this.idx,card_type:d,url:f.join(","),ext_json:JSON.stringify({is_contain_at:(null==y?void 0:y.length)||0,is_contain_vote:null!=g&&g.id?1:0,is_contain_topic:0,is_contain_url:f.length,is_contain_time:m}),reply_track_id:p,exposure_metadata:"",shown_tags:x.join(","),has_image:null!=(r=this.data.content.pictures)&&r.length?1:0,fold_pictures:(null==(o=this.data.reply_control)?void 0:o.fold_pictures)||"",picture_count:null!==(e=null==(a=this.data.content.pictures)?void 0:a.length)&&void 0!==e?e:0,pic_scale:1,has_fans_medal:null!=(l=null==(s=this.data.member)?void 0:s.fans_detail)&&l.medal_name?1:0,has_god_label:0,has_oldfans_label:null!=(c=this.data.member)&&c.is_contractor?1:0,has_decoration:null!=(u=this.data.member)&&u.user_sailing_v2?1:0,has_guard:0},this.extraTrackData);return this.commonTrackData=k,k}},{key:"handleClickTrack",value:function(t){Tu("click","comment.all.click",this.getClickTrackData(t.detail),{spmPrefix:this.spmPrefix})}},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),setTimeout((function(){t.trackObserver=new Ed({el:t,type:"show",value:{event:"comment.all",data:t.getCommonTrackData()},handler:function(e,n,i){"show"===e&&(Eu("replyCardShow",i),Tu(e,n,i,{spmPrefix:t.spmPrefix}))},durational:{beforeunload:!0}})}))}},{key:"disconnectedCallback",value:function(){if(u(d(e.prototype),"disconnectedCallback",this).call(this),this.trackObserver){var t=this.trackObserver;this.trackObserver=null,setTimeout((function(){t.dispose()}))}}},{key:"updated",value:function(t){t.get("visible")&&(!1===this.visible?this.style.setProperty("display","none"):this.style.removeProperty("display"))}},{key:"repliesTemplate",value:function(){var t=this,e=this.data,n=e.replies,i=e.rcount;return null!=n&&n.length&&!i?"":qe(nc||(nc=g(['<div id="replies">\n      <bili-comment-replies-renderer\n        .spmPrefix=',"\n        .data=","\n        .oid=","\n        .type=","\n        .user=","\n        .assist=","\n        .upMid=","\n        .contentFeatures=","\n        @reply=","\n        @block=","\n        @report=","\n        @track=","\n      ></bili-comment-replies-renderer>\n    </div>"])),this.spmPrefix,this.data,this.oid,this.type,this.user,this.assist,this.upMid,this.contentFeatures,(function(e){return t.handleReply(e.detail)}),(function(e){return t.handleBlock(e.detail)}),(function(e){return t.handleReport(e.detail)}),this.handleClickTrack)}},{key:"render",value:function(){var t=this;return qe(ic||(ic=g(['\n      <bili-comment-renderer\n        id="comment"\n        .theme=',"\n        .spmPrefix=","\n        .data=","\n        .user=","\n        .assist=","\n        .upMid=","\n        .oid=","\n        .type=","\n        .contentFeatures=","\n        @delete=","\n        @block=","\n        @report=","\n        @top=","\n        @reply=","\n        @expand=","\n        @track=","\n      ></bili-comment-renderer>\n      ",'\n      <div id="reply-container"></div>\n      <div id="div"></div>\n    '])),this.theme,this.spmPrefix,this.data,this.user,this.assist,this.upMid,this.oid,this.type,this.contentFeatures,(function(){return t.dispatchEvent(new CustomEvent("delete"))}),(function(){t.handleBlock({mid:t.data.member.mid})}),(function(e){var n;return t.handleReport({member:{mid:t.data.member.mid,uname:t.data.member.uname},oid:t.oid,type:t.type,rpid:t.data.rpid_str,hiddenJuryTips:(null==(n=e.detail)?void 0:n.hiddenJuryTips)||!1})}),(function(e){return t.dispatchEvent(new CustomEvent("top",{detail:e.detail}))}),(function(){return t.handleReply(t.data)}),(function(e){return t.dispatchEvent(new CustomEvent("expand",{detail:e.detail}))}),this.handleClickTrack,this.repliesTemplate())}}])}(fn);_m.styles=ve(rc||(rc=g(["\n    #div {\n      padding-bottom: 14px;\n      margin-left: 80px;\n      border-bottom: 1px solid var(--graph_bg_thick);\n    }\n  "]))),km([gn({type:String})],_m.prototype,"spmPrefix",2),km([gn({type:Object})],_m.prototype,"data",2),km([gn()],_m.prototype,"oid",2),km([gn()],_m.prototype,"type",2),km([gn()],_m.prototype,"mode",2),km([gn()],_m.prototype,"idx",2),km([gn({type:Boolean})],_m.prototype,"visible",2),km([gn()],_m.prototype,"upMid",2),km([gn()],_m.prototype,"theme",2),km([gn()],_m.prototype,"user",2),km([gn()],_m.prototype,"assist",2),km([gn()],_m.prototype,"contentFeatures",2),km([gn()],_m.prototype,"extraTrackData",2),km([_n("#comment")],_m.prototype,"commentRenderer",2),km([_n("#reply-container")],_m.prototype,"replyContainer",2),_m=km([mn("bili-comment-thread-renderer")],_m);var Am=function(t){"number"==typeof t&&(t=t.toString(16)),6===t.length&&(t="ff".concat(t));var e=parseInt(t.slice(2,4),16),n=parseInt(t.slice(4,6),16),i=parseInt(t.slice(6,8),16),r=parseInt(t.slice(0,2),16);return"rgba(".concat(e,",").concat(n,",").concat(i,",").concat(r/255,")")},Em=function(t){return t[t.NONE=0]="NONE",t[t.CONTRACTOR=1]="CONTRACTOR",t[t.FANS=2]="FANS",t}(Em||{});var Cm=Object.defineProperty,Tm=Object.getOwnPropertyDescriptor,Sm=function(t,e,n,i){for(var r,o=i>1?void 0:i?Tm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Cm(e,n,o),o},Om=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=On(),t.spmPrefix="",t.upMid=0,t.medalVisible=!1,t}return p(e,t),s(e,[{key:"uid",get:function(){return this.data.member.mid}},{key:"isUp",get:function(){return this.uid===String(this.upMid)}},{key:"userName",get:function(){return this.data.member.uname}},{key:"userNameRenderStyle",get:function(){var t,e;if(null==(t=this.data.member)||!t.name_render)return null;var n=fu(null==(e=this.data.member)?void 0:e.name_render,{variable:"--name-render-bg"});return n?n.variable:null}},{key:"userNameStyle",get:function(){var t,e;if(!this.data.member)return null;if(this.userNameRenderStyle)return this.userNameRenderStyle;var n=null==(e=null==(t=this.data.member)?void 0:t.vip)?void 0:e.nickname_color;return n?{color:n}:null}},{key:"spaceLink",get:function(){return Dd.SPACE(this.uid)}},{key:"levelImgSrc",get:function(){var t=this.data.member,e=t.is_senior_member,n=t.level_info.current_level;return"//i0.hdslb.com/bfs/seed/jinkela/short/webui/user-profile/img/level_".concat(e?"h":n,".svg")}},{key:"userMedal",get:function(){return!this.medalVisible||this.isUp?null:function(t){var e=t.member,n=e.is_contractor,i=e.contract_desc,r=e.fans_detail,o={type:0};return n?(o.type=1,o.contractor={name:{text:i,style:{color:"var(--brand_pink, #FF6699)"}}},o.contractor.style="原始粉丝"===i?{backgroundColor:"transparent",borderColor:"var(--brand_pink, #FF6699)"}:{backgroundColor:"var(--brand_pink_thin, #FFECF1)",borderColor:"transparent"},o):null!=r&&r.medal_name?(o.type=2,o.fans={style:{},name:{text:r.medal_name,style:{color:r.medal_color_name?Am(r.medal_color_name):""}},level:{text:String(r.level),style:{color:r.medal_color_level?Am(r.medal_color_level):"",backgroundColor:r.medal_level_bg_color?Am(r.medal_level_bg_color):""}}},r.medal_color&&r.medal_color_end&&(o.fans.style.backgroundImage="linear-gradient(90deg, ".concat(Am(r.medal_color),", ").concat(Am(r.medal_color_end),")")),r.medal_color_border&&(o.fans.style.borderColor=Am(r.medal_color_border)),r.first_icon&&(o.fans.icon={first:r.first_icon},r.second_icon&&(o.fans.icon.second=r.second_icon)),o):null}(this.data)}},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),setTimeout((function(){t.disposables.add(sv(t.shadowRoot.querySelector("#user-name")))}))}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.disposables.dispose()}},{key:"handleNameClick",value:function(t){t.stopPropagation();var e={rpid:this.data.rpid_str};Eu("replyCardNameClick",e),Tu("click","comment.user_name.click",e,{spmPrefix:this.spmPrefix}),this.handleTrackClick(3)}},{key:"handleTrackClick",value:function(t){this.dispatchEvent(new CustomEvent("track",{detail:t}))}},{key:"handleLevelClick",value:function(){var t={rpid:this.data.rpid_str};Eu("replyCardLvClick",t),Tu("click","comment.user_lv.click",t,{spmPrefix:this.spmPrefix}),window.open("https://www.bilibili.com/blackboard/help.html#/?qid=59e2cffdaa69465486497bb35a5ac295")}},{key:"render",value:function(){return qe(oc||(oc=g(['<div id="info">\n      <slot></slot>\n      <div\n        id="user-name"\n        data-user-profile-id="','"\n        data-user-profile-spmid-follow="comment.profile.click"\n        @click=','\n      >\n        <a\n          href="','"\n          class="','"\n          style="','"\n          target="_blank"\n          >','</a\n        >\n      </div>\n      <div id="user-level" @click=','>\n        <img width="30" height="30" src="','" />\n      </div>\n      ',"\n      ","\n    </div>"])),this.uid,this.handleNameClick,this.spaceLink,this.userNameRenderStyle?"name-render-style":"",this.userNameStyle?Gn(this.userNameStyle):"",this.userName,this.handleLevelClick,this.levelImgSrc,this.userMedal?qe(ac||(ac=g(['\n            <div id="user-medal">\n              <bili-comment-user-medal .data=',"></bili-comment-user-medal>\n            </div>\n          "])),this.userMedal):"",this.isUp?qe(sc||(sc=g(['<div id="user-up">\n            <img width="24" height="24" src="//i0.hdslb.com/bfs/seed/jinkela/short/webui/comments/img/icons/up_pb.svg" />\n          </div>']))):"")}}])}(fn);Om.styles=ve(lc||(lc=g(["\n    :host {\n      --bili-comment-user-info-name-color: var(--text2);\n    }\n    #info {\n      display: inline-flex;\n      align-items: center;\n    }\n    #user-name {\n      color: var(--bili-comment-user-info-name-color);\n      font-size: var(--bili-comments-font-size-name, 13px);\n      font-weight: 500;\n    }\n    #user-name a.name-render-style {\n      background-clip: text;\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n    }\n    .name-render-style {\n      background-image: var(--name-render-bg-light);\n    }\n    :host([dark]) .name-render-style {\n      background-image: var(--name-render-bg-dark);\n    }\n    #user-level {\n      margin-left: 5px;\n      width: 30px;\n      height: 30px;\n    }\n    #user-up {\n      width: 24px;\n      height: 24px;\n    }\n    a {\n      text-decoration: none;\n      color: inherit;\n    }\n  "]))),Sm([gn({type:String})],Om.prototype,"spmPrefix",2),Sm([gn()],Om.prototype,"data",2),Sm([gn()],Om.prototype,"upMid",2),Sm([gn({type:Boolean})],Om.prototype,"medalVisible",2),Sm([wn()],Om.prototype,"uid",1),Sm([wn()],Om.prototype,"isUp",1),Sm([wn()],Om.prototype,"userName",1),Sm([wn()],Om.prototype,"userNameRenderStyle",1),Sm([wn()],Om.prototype,"userNameStyle",1),Sm([wn()],Om.prototype,"spaceLink",1),Sm([wn()],Om.prototype,"levelImgSrc",1),Sm([wn()],Om.prototype,"userMedal",1),Om=Sm([mn("bili-comment-user-info")],Om);var Pm=Object.defineProperty,Im=Object.getOwnPropertyDescriptor,Rm=function(t,e,n,i){for(var r,o=i>1?void 0:i?Im(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Pm(e,n,o),o},jm=function(t){function e(){return o(this,e),r(this,e,arguments)}return p(e,t),s(e,[{key:"connectedCallback",value:function(){u(d(e.prototype),"connectedCallback",this).call(this),this.init()}},{key:"init",value:function(){var t=this;setTimeout((function(){var e=t.shadowRoot.querySelector("#name #name-text"),n=t.shadowRoot.querySelector("#name"),i=e.getBoundingClientRect().width;i&&(n.style.width="".concat(i,"px"))}))}},{key:"render",value:function(){if(this.data.type===Em.CONTRACTOR){var t=this.data.contractor,e=t.style,n=t.name;return qe(cc||(cc=g(['<div id="contractor" style=','>\n        <div id="name" style=','><div id="name-text">',"</div></div>\n      </div>"])),e?Gn(v({},e)):"",n.style?Gn(v({},n.style)):"",n.text)}if(this.data.type===Em.FANS){var i=this.data.fans,r=i.style,o=i.name,a=i.level,s=i.icon;return qe(uc||(uc=g(['<div\n        id="fans"\n        style=',"\n      >\n        ",'\n        <div id="name" style=','><div id="name-text">','</div></div>\n        <div id="level" style=','><div id="level-text">',"</div></div>\n      </div>"])),r?Gn(v({},r)):"",s?qe(dc||(dc=g(['<div\n              id="icon"\n              style=',"\n            >\n              ","\n              ","\n            </div>"])),Gn({width:"".concat(null!=s&&s.second?20:13,"px")}),s.first?qe(pc||(pc=g(['<img\n                    id="first-icon"\n                    src=',"\n                  />"])),ki.getBmgSrcNext(s.first,{w:20,h:20,dpr:2})):"",s.second?qe(hc||(hc=g(['<img\n                    id="second-icon"\n                    src=',"\n                  />"])),ki.getBmgSrcNext(s.second,{w:20,h:20,dpr:2})):""):"",o.style?Gn(v({},o.style)):"",o.text,a.style?Gn(v({},a.style)):"",a.text)}return qe(fc||(fc=g(['<div id="none"></div>'])))}}])}(fn);jm.styles=ve(vc||(vc=g(["\n    #contractor {\n      height: 12px;\n      padding: 0 2px;\n      border-radius: 2px;\n      border-width: 0.5px;\n      border-style: solid;\n      box-sizing: border-box;\n    }\n    #contractor #name {\n      height: 11px;\n      position: relative;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #contractor #name #name-text {\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      white-space: nowrap;\n      transform: scale(0.5) translate(-50%, -50%);\n      transform-origin: 0 0;\n      font-size: 16px;\n    }\n    #fans {\n      display: flex;\n      align-items: center;\n      height: 14px;\n      padding-left: 5px;\n      border-width: 0.5px;\n      border-style: solid;\n      border-radius: 10px;\n      margin-left: 5px;\n    }\n    #fans #icon {\n      display: flex;\n      align-items: center;\n      position: relative;\n    }\n    #fans #icon #first-icon {\n      position: absolute;\n      left: -8px;\n      width: 20px;\n      height: 20px;\n    }\n    #fans #icon #second-icon {\n      position: absolute;\n      right: 0;\n      width: 8px;\n      height: 11px;\n    }\n    #fans #name {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      position: relative;\n      height: 100%;\n      margin-right: 4px;\n    }\n    #fans #name #name-text {\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      font-weight: 500;\n      white-space: nowrap;\n      transform: scale(0.5) translate(-50%, -50%);\n      transform-origin: 0 0;\n      font-size: 18px;\n    }\n    #fans #level {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      position: relative;\n      width: 11.5px;\n      height: 11.5px;\n      border-radius: 50%;\n      margin-right: 0.5px;\n    }\n    #fans #level #level-text {\n      position: absolute;\n      top: 52%;\n      left: 50%;\n      font-family: medalnum;\n      font-weight: 500;\n      white-space: nowrap;\n      line-height: 1;\n      transform: scale(0.5) translate(-50%, -43%);\n      transform-origin: 0 0;\n    }\n  "]))),Rm([gn()],jm.prototype,"data",2),jm=Rm([mn("bili-comment-user-medal")],jm);var Lm=Object.defineProperty,Mm=Object.defineProperties,Dm=Object.getOwnPropertyDescriptors,Nm=Object.getOwnPropertySymbols,Bm=Object.prototype.hasOwnProperty,zm=Object.prototype.propertyIsEnumerable,Um=function(t,e,n){return e in t?Lm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},Fm=function(t,e){for(var n in e||(e={}))Bm.call(e,n)&&Um(t,n,e[n]);if(Nm){var i,r=l(Nm(e));try{for(r.s();!(i=r.n()).done;){n=i.value;zm.call(e,n)&&Um(t,n,e[n])}}catch(t){r.e(t)}finally{r.f()}}return t},Vm=function(t,e){return Mm(t,Dm(e))},Hm=function(){return s((function t(){o(this,t),this.target=null,this.events={}}),[{key:"addEventListener",value:function(t,e){("undefined"==typeof window?"undefined":k(window))>"u"?console.warn("EventBridge is not supported in server side"):(this.events[t]?this.events[t].push(e):this.events[t]=[e],this.target&&this.target.addEventListener(t,e))}},{key:"removeEventListener",value:function(t,e){if(("undefined"==typeof window?"undefined":k(window))>"u")console.warn("EventBridge is not supported in server side");else if(this.target&&this.target.removeEventListener(t,e),this.events[t].length){var n=this.events[t];this.events[t]=n.filter((function(t){return t!==e}))}}},{key:"connect",value:function(t){var e=this;this.target||!t||(this.target=t,Object.keys(this.events).forEach((function(t){e.events[t].forEach((function(n){e.addEventListener(t,n)}))})))}},{key:"disconnect",value:function(){var t=this;if(this.target){var e=this.target;Object.keys(this.events).forEach((function(n){t.events[n].forEach((function(t){e.removeEventListener(n,t)}))}))}this.events={},this.target=null}}])}(),Wm=function(){return s((function t(e){o(this,t),this.el={current:null},this.parent=null,this.props={},this.methods={},this.emits=[],this.dispose=null,this.eventBridge=new Hm,e&&(this.props=e)}),[{key:"engine",get:function(){return{core:"custom"}}},{key:"addEventListener",value:function(t,e){this.emits.length&&-1===this.emits.indexOf(t)?console.warn("Event ".concat(String(t)," is not defined in emits")):this.eventBridge.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventBridge.removeEventListener(t,e)}},{key:"dispatchAction",value:function(t){var e,n=t.type,i=t.args,r=t.callback,o=null==(e=this.methods)?void 0:e[n];if("function"==typeof o){var a=o.apply(void 0,w(i||[]));return null==r||r(a),a}console.warn("Action ".concat(String(n)," is undefined or not a function"))}},{key:"update",value:function(t){var e=!!this.el.current,n=this.parent;return e&&this.unmount(),this.props=t,e&&(this.parent=n,this.render()),this}},{key:"mount",value:function(t,e){return this.el.current?(console.warn("Component is already mounted"),this):this.parent?(t===this.parent||console.warn("Component maybe in mounting, please wait mounted, and then use update or unmount first"),this):(this.parent=t,e?this.renderAsync():this.render(),this)}},{key:"unmount",value:function(){var t;if(null==(t=this.dispose)||t.call(this),this.eventBridge.disconnect(),this.props={},this.methods={},this.el.current){var e=this.parent||this.el.current.parentElement;e!==this.el.current&&null!=e&&e.contains(this.el.current)&&(e.removeChild(this.el.current),this.parent=null),this.el.current=null}}}])}(),$m=function(t){var e=t.name,n=t.engine,i=t.emits,a=t.render,l=t.renderAsync,c=t.renderToString;return function(t){function h(t){var n;return o(this,h),(n=r(this,h,[t])).name=e,n.emits=i||[],n}return p(h,t),s(h,[{key:"engine",get:function(){return n||u(d(h.prototype),"engine",this)}},{key:"render",value:function(){var t=this;try{if(!this.parent)return;this.dispose=a({ref:function(e){t.el.current=e,e?t.eventBridge.connect(e):t.eventBridge.disconnect()},props:this.props,parent:this.parent,expose:function(e){t.methods=e}})}catch(t){console.error(t)}}},{key:"renderAsync",value:function(){return function(t,e,n){return new Promise((function(i,r){var o=function(t){try{s(n.next(t))}catch(t){r(t)}},a=function(t){try{s(n.throw(t))}catch(t){r(t)}},s=function(t){return t.done?i(t.value):Promise.resolve(t.value).then(o,a)};s((n=n.apply(t,e)).next())}))}(this,null,m().mark((function t(){var e,n,i,r=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.parent){t.next=3;break}return t.abrupt("return",!1);case 3:if(!l){t.next=12;break}return n=!1,i=new Promise((function(t){e=function(){n||(n=!0,t(!0))}})),t.next=8,l({parent:this.parent,ref:function(t){r.el.current=t,t?(e(),r.eventBridge.connect(t)):r.eventBridge.disconnect()},props:this.props,expose:function(t){r.methods=t}});case 8:return this.dispose=t.sent,t.next=11,i;case 11:return t.abrupt("return",t.sent);case 12:return t.abrupt("return",(this.render(),!!this.el.current));case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",(console.error(t.t0),!1));case 18:case"end":return t.stop()}}),t,this,[[0,15]])})))}},{key:"renderToString",value:function(){try{return"function"!=typeof c?"":c(this.props)}catch(t){return console.error(t),""}}}])}(Wm)},qm=Symbol("solid-proxy"),Gm={equals:function(t,e){return t===e}},Xm=vb,Ym=1,Zm=2,Qm={owned:null,cleanups:null,context:null,owner:null},Km=null,Jm=null,tb=null,eb=null,nb=null,ib=0;function rb(t,e){var n=tb,i=Km,r=0===t.length,o=void 0===e?i:e,a=r?Qm:{owned:null,cleanups:null,context:o?o.context:null,owner:o},s=r?t:function(){return t((function(){return sb((function(){return gb(a)}))}))};Km=a,tb=null;try{return fb(s,!0)}finally{tb=n,Km=i}}function ob(t,e,n){db(pb(t,e,!1,Ym))}function ab(t,e,n){n=n?Object.assign({},Gm,n):Gm;var i=pb(t,e,!0,0);return i.observers=null,i.observerSlots=null,i.comparator=n.equals||void 0,db(i),cb.bind(i)}function sb(t){if(null===tb)return t();var e=tb;tb=null;try{return t()}finally{tb=e}}function lb(t){!function(t,e,n){Xm=mb;var i=pb(t,e,!1,Ym);i.user=!0,nb?nb.push(i):db(i)}((function(){return sb(t)}))}function cb(){var t=this;if(this.sources&&this.state)if(this.state===Ym)db(this);else{var e=eb;eb=null,fb((function(){return bb(t)}),!1),eb=e}if(tb){var n=this.observers?this.observers.length:0;tb.sources?(tb.sources.push(this),tb.sourceSlots.push(n)):(tb.sources=[this],tb.sourceSlots=[n]),this.observers?(this.observers.push(tb),this.observerSlots.push(tb.sources.length-1)):(this.observers=[tb],this.observerSlots=[tb.sources.length-1])}return this.value}function ub(t,e,n){var i=t.value;return(!t.comparator||!t.comparator(i,e))&&(t.value=e,t.observers&&t.observers.length&&fb((function(){for(var e=0;e<t.observers.length;e+=1){var n=t.observers[e],i=Jm&&Jm.running;i&&Jm.disposed.has(n),(i?!n.tState:!n.state)&&(n.pure?eb.push(n):nb.push(n),n.observers&&yb(n)),i||(n.state=Ym)}if(eb.length>1e6)throw eb=[],new Error}),!1)),e}function db(t){if(t.fn){gb(t);var e=ib;!function(t,e,n){var i,r=Km,o=tb;tb=Km=t;try{i=t.fn(e)}catch(e){return t.pure&&(t.state=Ym,t.owned&&t.owned.forEach(gb),t.owned=null),t.updatedAt=n+1,wb(e)}finally{tb=o,Km=r}(!t.updatedAt||t.updatedAt<=n)&&(null!=t.updatedAt&&"observers"in t?ub(t,i):t.value=i,t.updatedAt=n)}(t,t.value,e)}}function pb(t,e,n){var i={fn:t,state:arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ym,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Km,context:Km?Km.context:null,pure:n};return null===Km||Km!==Qm&&(Km.owned?Km.owned.push(i):Km.owned=[i]),i}function hb(t){if(0!==t.state){if(t.state===Zm)return bb(t);if(t.suspense&&sb(t.suspense.inFallback))return t.suspense.effects.push(t);for(var e=[t];(t=t.owner)&&(!t.updatedAt||t.updatedAt<ib);)t.state&&e.push(t);for(var n=e.length-1;n>=0;n--)if((t=e[n]).state===Ym)db(t);else if(t.state===Zm){var i=eb;eb=null,fb((function(){return bb(t,e[0])}),!1),eb=i}}}function fb(t,e){if(eb)return t();var n=!1;e||(eb=[]),nb?n=!0:nb=[],ib++;try{var i=t();return function(t){if(eb&&(vb(eb),eb=null),t)return;var e=nb;nb=null,e.length&&fb((function(){return Xm(e)}),!1)}(n),i}catch(i){n||(nb=null),eb=null,wb(i)}}function vb(t){for(var e=0;e<t.length;e++)hb(t[e])}function mb(t){var e,n=0;for(e=0;e<t.length;e++){var i=t[e];i.user?t[n++]=i:hb(i)}for(e=0;e<n;e++)hb(t[e])}function bb(t,e){t.state=0;for(var n=0;n<t.sources.length;n+=1){var i=t.sources[n];if(i.sources){var r=i.state;r===Ym?i!==e&&(!i.updatedAt||i.updatedAt<ib)&&hb(i):r===Zm&&bb(i,e)}}}function yb(t){for(var e=0;e<t.observers.length;e+=1){var n=t.observers[e];n.state||(n.state=Zm,n.pure?eb.push(n):nb.push(n),n.observers&&yb(n))}}function gb(t){var e;if(t.sources)for(;t.sources.length;){var n=t.sources.pop(),i=t.sourceSlots.pop(),r=n.observers;if(r&&r.length){var o=r.pop(),a=n.observerSlots.pop();i<r.length&&(o.sourceSlots[a]=i,r[i]=o,n.observerSlots[i]=a)}}if(t.owned){for(e=t.owned.length-1;e>=0;e--)gb(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function wb(t){throw function(t){return t instanceof Error?t:new Error("string"==typeof t?t:"Unknown error",{cause:t})}(t)}function xb(t,e){return sb((function(){return t(e||{})}))}function kb(){return!0}var _b={get:function(t,e,n){return e===qm?n:t.get(e)},has:function(t,e){return e===qm||t.has(e)},set:kb,deleteProperty:kb,getOwnPropertyDescriptor:function(t,e){return{configurable:!0,enumerable:!0,get:function(){return t.get(e)},set:kb,deleteProperty:kb}},ownKeys:function(t){return t.keys()}};function Ab(t){return(t="function"==typeof t?t():t)?t:{}}function Eb(){for(var t=0,e=this.length;t<e;++t){var n=this[t]();if(void 0!==n)return n}}function Cb(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i=!1,r=0;r<e.length;r++){var o=e[r];i=i||!!o&&qm in o,e[r]="function"==typeof o?(i=!0,ab(o)):o}if(i)return new Proxy({get:function(t){for(var n=e.length-1;n>=0;n--){var i=Ab(e[n])[t];if(void 0!==i)return i}},has:function(t){for(var n=e.length-1;n>=0;n--)if(t in Ab(e[n]))return!0;return!1},keys:function(){for(var t=[],n=0;n<e.length;n++)t.push.apply(t,w(Object.keys(Ab(e[n]))));return w(new Set(t))}},_b);for(var a={},s=Object.create(null),l=e.length-1;l>=0;l--){var c=e[l];if(c)for(var u=Object.getOwnPropertyNames(c),d=function(){var t=u[p];if("__proto__"===t||"constructor"===t)return 1;var e=Object.getOwnPropertyDescriptor(c,t);if(s[t]){var n=a[t];n&&(e.get?n.push(e.get.bind(c)):void 0!==e.value&&n.push((function(){return e.value})))}else s[t]=e.get?{enumerable:!0,configurable:!0,get:Eb.bind(a[t]=[e.get.bind(c)])}:void 0!==e.value?e:void 0},p=u.length-1;p>=0;p--)d()}for(var h={},f=Object.keys(s),v=f.length-1;v>=0;v--){var m=f[v],b=s[m];b&&b.get?Object.defineProperty(h,m,b):h[m]=b?b.value:void 0}return h}function Tb(t){var e=t.keyed,n=ab((function(){return t.when}),void 0,{equals:function(t,n){return e?t===n:!t==!n}});return ab((function(){var i=n();if(i){var r=t.children;return"function"==typeof r&&r.length>0?sb((function(){return r(e?i:function(){if(!sb(n))throw function(t){return"Stale read from <".concat(t,">.")}("Show");return t.when})})):r}return t.fallback}),void 0,void 0)}function Sb(t,e,n){var i;return rb((function(r){i=r,e===document?t():jb(e,t(),e.firstChild?null:void 0,n)}),(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).owner),function(){i(),e.textContent=""}}function Ob(t,e,n){var i,r=function(){return(i||(i=function(){var e=document.createElement("template");return e.innerHTML=t,e.content.firstChild}())).cloneNode(!0)};return r.cloneNode=r,r}function Pb(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function Ib(t,e){null==e?t.removeAttribute("class"):t.className=e}function Rb(t,e,n){if(!e)return n?Pb(t,"style"):e;var i,r,o=t.style;if("string"==typeof e)return o.cssText=e;for(r in"string"==typeof n&&(o.cssText=n=void 0),n||(n={}),e||(e={}),n)null==e[r]&&o.removeProperty(r),delete n[r];for(r in e)(i=e[r])!==n[r]&&(o.setProperty(r,i),n[r]=i);return n}function jb(t,e,n,i){if(void 0!==n&&!i&&(i=[]),"function"!=typeof e)return Lb(t,e,i,n);ob((function(i){return Lb(t,e(),i,n)}),i)}function Lb(t,e,n,i,r){for(;"function"==typeof n;)n=n();if(e===n)return n;var o=k(e),a=void 0!==i;if(t=a&&n[0]&&n[0].parentNode||t,"string"===o||"number"===o)if("number"===o&&(e=e.toString()),a){var s=n[0];s&&3===s.nodeType?s.data!==e&&(s.data=e):s=document.createTextNode(e),n=Nb(t,n,i,s)}else n=""!==n&&"string"==typeof n?t.firstChild.data=e:t.textContent=e;else if(null==e||"boolean"===o)n=Nb(t,n,i);else{if("function"===o)return ob((function(){for(var r=e();"function"==typeof r;)r=r();n=Lb(t,r,n,i)})),function(){return n};if(Array.isArray(e)){var l=[],c=n&&Array.isArray(n);if(Mb(l,e,n,r))return ob((function(){return n=Lb(t,l,n,i,!0)})),function(){return n};if(0===l.length){if(n=Nb(t,n,i),a)return n}else c?0===n.length?Db(t,l,i):function(t,e,n){for(var i=n.length,r=e.length,o=i,a=0,s=0,l=e[r-1].nextSibling,c=null;a<r||s<o;)if(e[a]!==n[s]){for(;e[r-1]===n[o-1];)r--,o--;if(r===a)for(var u=o<i?s?n[s-1].nextSibling:n[o-s]:l;s<o;)t.insertBefore(n[s++],u);else if(o===s)for(;a<r;)(!c||!c.has(e[a]))&&e[a].remove(),a++;else if(e[a]===n[o-1]&&n[s]===e[r-1]){var d=e[--r].nextSibling;t.insertBefore(n[s++],e[a++].nextSibling),t.insertBefore(n[--o],d),e[r]=n[o]}else{if(!c){c=new Map;for(var p=s;p<o;)c.set(n[p],p++)}var h=c.get(e[a]);if(null!=h)if(s<h&&h<o){for(var f=a,v=1,m=void 0;++f<r&&f<o&&null!=(m=c.get(e[f]))&&m===h+v;)v++;if(v>h-s)for(var b=e[a];s<h;)t.insertBefore(n[s++],b);else t.replaceChild(n[s++],e[a++])}else a++;else e[a++].remove()}}else a++,s++}(t,n,l):(n&&Nb(t),Db(t,l));n=l}else if(e.nodeType){if(Array.isArray(n)){if(a)return n=Nb(t,n,i,e);Nb(t,n,null,e)}else null!=n&&""!==n&&t.firstChild?t.replaceChild(e,t.firstChild):t.appendChild(e);n=e}}return n}function Mb(t,e,n,i){for(var r=!1,o=0,a=e.length;o<a;o++){var s=e[o],l=n&&n[t.length],c=void 0;if(null!=s&&!0!==s&&!1!==s)if("object"==(c=k(s))&&s.nodeType)t.push(s);else if(Array.isArray(s))r=Mb(t,s,l)||r;else if("function"===c)if(i){for(;"function"==typeof s;)s=s();r=Mb(t,Array.isArray(s)?s:[s],Array.isArray(l)?l:[l])||r}else t.push(s),r=!0;else{var u=String(s);l&&3===l.nodeType&&l.data===u?t.push(l):t.push(document.createTextNode(u))}}return r}function Db(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=0,r=e.length;i<r;i++)t.insertBefore(e[i],n)}function Nb(t,e,n,i){if(void 0===n)return t.textContent="";var r=i||document.createTextNode("");if(e.length)for(var o=!1,a=e.length-1;a>=0;a--){var s=e[a];if(r!==s){var l=s.parentNode===t;o||a?l&&s.remove():l?t.replaceChild(r,s):t.insertBefore(r,n)}else o=!0}else t.insertBefore(r,n);return[r]}var Bb=function(t){var e=t.component,n=t.engine,i=t.renderToString,r=function(t){var i,r,o,a,s,l,c=t.ref,u=t.props,d=t.parent,p=t.expose,h=(null==n?void 0:n.core.createRoot)||(null==(i=window.Solid)?void 0:i.createRoot)||(null==(o=null==(r=window.SolidCore)?void 0:r.Solid)?void 0:o.createRoot),f=(null==n?void 0:n.core.render)||(null==(a=window.SolidWeb)?void 0:a.render)||(null==(l=null==(s=window.SolidCore)?void 0:s.SolidWeb)?void 0:l.render);if(!h)throw new Error("Solid engine API`createRoot` is not found");if(!f)throw new Error("Solid engine API`render` is not found");return h((function(t){var n=document.createElement("div");f((function(){return e(Vm(Fm({},u),{waterExpose:p}))}),n);var i=n.firstChild;return function(t){if(t instanceof HTMLElement)for(;t.firstChild;)t.removeChild(t.firstChild)}(d),d.appendChild(i),c(i),t}))},o=(null==n?void 0:n.src)||"//s1.hdslb.com/bfs/seed/water-ui/engine/solid-core.umd.js";return $m({name:t.name,engine:{core:"solid",version:(null==n?void 0:n.version)||"",src:o},render:r,renderAsync:function(t){return new Promise((function(e,n){(function(t){return new Promise((function(e,n){var i=function(){return!(!window.Solid||!window.SolidWeb||(e(window.Solid),0))};if(("undefined"==typeof window?"undefined":k(window))>"u")return n(new Error("not in browser"));if(!i()){var r=document.createElement("script");r.onload=function(){i()||n(new Error("load solid fail"))},r.onerror=function(t){n(t)},r.src=t}}))})(o).then((function(){e(r(t))})).catch(n)}))},renderToString:i})},zb="_star_14qf7_99",Ub="_fans_14qf7_13",Fb="_specialDynamicMedalPc_14qf7_30",Vb="_specialDynamicMedal_14qf7_30",Hb="_text_14qf7_40",Wb="_background_14qf7_53",$b="_medalImg_14qf7_66",qb="_medalImgAnimation_14qf7_71",Gb="_textMask_14qf7_88",Xb="_backgroundImg_aob6i_1",Yb="_bfsImg_aob6i_6";function Zb(t){return!isNaN(parseFloat(t))&&isFinite(t)}function Qb(){return("undefined"==typeof window?"undefined":k(window))<"u"}var Kb={webp:Qb(),fuzzyMatch:!0,whiteList:[],webpFallback:Qb()?"png":"",dpr:1,ratio:1},Jb={isSupported:!1};function ty(t){Jb.isSupported=t}!function(){if(Qb())try{var t=document.createElement("canvas");if(t.getContext&&t.getContext("2d"))try{0===t.toDataURL("image/webp").indexOf("data:image/webp")?ty(!0):function(){var t=new Image;t.onload=function(){ty(2===t.height)},t.onerror=function(){ty(2===t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}()}catch(t){ty(!1)}else ty(!1)}catch(t){ty(!1)}else ty(!0)}();var ey=function(){function t(t){this.debounceTime=1e3,this.timer=null,this.debounceTime=t}return t.prototype.set=function(t){this.clear(),this.timer=setTimeout(t,this.debounceTime)},t.prototype.clear=function(){this.timer&&clearTimeout(this.timer)},t}(),ny=function(){function t(t){void 0===t&&(t=1e3),this.MIN_TO_COLLAPSE=2,this.warnings=[],this.errors=[],this.warningDebouncer=new ey(t),this.errorDebouncer=new ey(t)}return t.prototype.pushWarning=function(t){var e=this;console.groupCollapsed?(this.warnings.push(t),this.warningDebouncer.set((function(){return e.printWarnings()}))):console.warn("[BFS Warning]:",t)},t.prototype.printWarnings=function(){var t=this.warnings.length>=this.MIN_TO_COLLAPSE;for(t&&console.groupCollapsed("[BFS Warning]: 有 "+this.warnings.length+" 个警告，点击查看.");this.warnings.length>0;){var e=this.warnings.shift();console.warn("[BFS Warning]:",e)}t&&console.groupEnd()},t.prototype.pushError=function(t){var e=this;console.groupCollapsed?(this.errors.push(t),this.errorDebouncer.set((function(){return e.printError()}))):console.error("[BFS Error]:",t)},t.prototype.printError=function(){var t=this.errors.length>=this.MIN_TO_COLLAPSE;for(t&&console.groupCollapsed("[BFS Error]: 有 "+this.errors.length+" 个错误，点击查看.");this.errors.length>0;){var e=this.errors.shift();console.error("[BFS Error]:",e)}t&&console.groupEnd()},t}(),iy=new ny(1e3);function ry(t,e){void 0===e&&(e=!1),e&&iy.pushWarning(t)}function oy(t,e){void 0===e&&(e=!1),e&&iy.pushError(t)}var ay=function(){function t(t){void 0===t&&(t=[]),this.whiteList=[],this.whiteListQuickMap={byWidth:[],byHeight:[]},t.length&&this.set(t)}return t.prototype.set=function(t){this.clear(),t.length>0&&(this.whiteList=t,this.setQuickMap())},t.prototype.get=function(){return this.whiteList},t.prototype.clear=function(){this.whiteList=[],this.initQuickMap()},t.prototype.initQuickMap=function(){this.whiteListQuickMap={byWidth:[],byHeight:[]}},t.prototype.setQuickMap=function(){var t=this;this.convertWhiteList().forEach((function(e){if(Zb(e.width)&&e.width>0&&Zb(e.height)&&e.height>0){var n=e.width/e.height;t.whiteListQuickMap[n]||(t.whiteListQuickMap[n]=[]),t.whiteListQuickMap[n].push(e)}else Zb(e.width)&&e.width>0?(t.whiteListQuickMap.byWidth||(t.whiteListQuickMap.byWidth=[]),t.whiteListQuickMap.byWidth.push({width:e.width,height:"auto"})):Zb(e.height)&&e.height>0&&(t.whiteListQuickMap.byHeight||(t.whiteListQuickMap.byHeight=[]),t.whiteListQuickMap.byHeight.push({width:"auto",height:e.height}))})),this.sortQuickMap()},t.prototype.convertWhiteList=function(){var t=this.whiteList.map((function(t){var e=t&&t.split?t.split("|"):[];return{width:e[0]&&Zb(e[0].trim())&&parseInt(e[0].trim())>0?parseInt(e[0].trim()):"auto",height:e[1]&&Zb(e[1].trim())&&parseInt(e[1].trim())>0?parseInt(e[1].trim()):"auto"}}));return function(t){return Array.from(new Set(t.map((function(t){return JSON.stringify(t)})))).map((function(t){return JSON.parse(t)}))}(t)},t.prototype.sortQuickMap=function(){var t=this;Object.keys(this.whiteListQuickMap).forEach((function(e){var n=t.whiteListQuickMap[e].sort((function(t,e){return Zb(t.width)&&Zb(e.width)?t.width-e.width:Zb(t.height)&&Zb(e.height)?t.height-e.height:void 0}));t.whiteListQuickMap[e]=n}))},t.prototype.getMatchedSize=function(t,e){var n=null;if(0===this.whiteList.length)return t;var i={width:"auto",height:"auto"};Zb(t.width)&&t.width>0&&Zb(t.height)&&t.height>0?n=t.width/t.height:Zb(t.width)&&t.width>0?n="byWidth":Zb(t.height)&&t.height>0&&(n="byHeight");var r=n?this.whiteListQuickMap[n]:[];if(r&&r.length>0){var o=e?this.fuzzyMatch(r,t):this.exactMatch(r,t);o.length>0?(i=o[0],(t.width!==i.width||t.height!==i.height)&&ry(t.width+" x "+t.height+" 在白名单中不存在，向上匹配得到 "+i.width+" x "+i.height)):ry("找不到与 "+t.width+" x "+t.height+" 匹配的白名单尺寸. 将使用原始尺寸.")}else ry("找不到与 "+t.width+" x "+t.height+" 匹配的白名单尺寸. 将使用原始尺寸.");return i},t.prototype.fuzzyMatch=function(t,e){return t.filter((function(t){return Zb(t.width)?t.width>=e.width:t.height>=e.height}))},t.prototype.exactMatch=function(t,e){return t.filter((function(t){return Zb(t.width)?t.width===e.width:t.height===e.height}))},t}();function sy(t){return"auto"===t&&("undefined"==typeof window?"undefined":k(window))<"u"&&window.devicePixelRatio?Number(window.devicePixelRatio)||1:Number(t)>0?Number(t):1}function ly(t){if(t&&t.split)return t.split(".").pop().toLowerCase()}function cy(t){if(!t||!function(t){return"string"==typeof t||t instanceof String}(t))return oy("URL 应该为 string 类型."),!1;return-1===["jpg","jpeg","png","webp","gif"].indexOf(ly(t))?(oy(t+" 不是支持的文件格式."),!1):("webp"===ly(t)&&ry(t+" 是webp格式的文件。建议通过配置参数 webp: true 使用webp格式，以便在不支持的浏览器上降级."),-1!==t.indexOf("/bfs/")||(ry(t+" 不是 bfs 路径."),!1))}function uy(t){var e=t;if(t&&t.slice&&t.indexOf){var n=t.indexOf("@");n>-1&&(e=t.slice(0,n))}return e}function dy(t,e,n){return t+=-1===t.indexOf("@")?"@":"_",t+=n+e}function py(t){return t.indexOf("@")>-1}var hy=function(){function t(t){void 0===t&&(t={}),this.defaultOpts=Kb,this.whiteList=new ay,Object.assign(this.defaultOpts,t),this.setWhiteList(this.defaultOpts.whiteList)}return t.prototype.getImageLink=function(t,e,n,i){void 0===e&&(e="auto"),void 0===n&&(n="auto"),void 0===i&&(i={});var r=Object.assign({},this.defaultOpts,i),o=i.whiteList?new ay(i.whiteList):this.whiteList,a=function(t){var e="";return t&&t.split&&(e=t.split("?")[1]),e}(t);return t=function(t){var e=t;if(t&&t.slice&&t.indexOf){var n=t.indexOf("?");n>-1&&(e=t.slice(0,n))}return e}(t),cy(uy(t))&&(function(t){var e=sy(t.dpr)*(Number(t.ratio)||1);if(1===e)return t;if(t.a)if(/^\d+-\d+-\d+-\d+$/.test(t.a)){var n=t.a.split("-");t.a=n.map((function(t){return Math.floor(Number(t)*e)})).join("-")}else oy(t.a+"不是有效的高级裁剪参数. 请参考 https://info.bilibili.co/pages/viewpage.action?pageId=4545261 正确设置");if(t.rc)if(/^\d+x\d+-[1-9]$/.test(t.rc)){var i=(n=t.rc.split("-"))[0].split("x");t.rc=i.map((function(t){return Math.floor(Number(t)*e)})).join("x")+"-"+n[1]}else oy(t.rc+"不是有效的区域裁剪参数. 请参考 https://info.bilibili.co/pages/viewpage.action?pageId=4545261 正确设置")}(r),t=function(t,e,n,i,r){var o=i.getMatchedSize({width:e,height:n},r.fuzzyMatch),a=o.width,s=o.height,l=sy(r.dpr),c=r.ratio||1;return Zb(a)&&a>0&&(t=dy(t,"w",Math.floor(a*l*c))),Zb(s)&&s>0&&(t=dy(t,"h",Math.floor(s*l*c))),t}(t=uy(t),e,n,o,r),t=function(t,e){return t}(t,r.watermark),t=function(t,e){return["e","p","c","rc","a","bl","q","o","s"].forEach((function(n){void 0!==e[n]&&(t=dy(t,n,e[n]))})),t}(t,r),t=function(t,e){var n=ly(uy(t)),i=n;return e.webp&&("gif"!==n||e.s)&&Jb.isSupported&&(i="webp"),!Jb.isSupported&&"webp"===i&&e.webpFallback&&(i=e.webpFallback),py(t)||n===i?py(t)&&(t+="."+i):t+="@."+i,t}(t,r)),function(t,e){return e&&""!==e?t+"?"+e:t}(t,a)},t.prototype.getWhiteList=function(){return this.whiteList.get()},t.prototype.setWhiteList=function(t){void 0===t&&(t=[]),this.whiteList.set(t)},t.prototype.clearWhiteList=function(){this.whiteList.clear()},t}(),fy=Ob("<div>"),vy=Ob("<img>"),my=new hy,by=function(t){var e=Cb({fit:"cover"},t),n=function(){if(!e.src)return"";if(/^data:/.test(e.src))return e.src;var t=e.src.replace("http://","https://");if(t.includes("gif")||t.includes(".svg"))return t;var n=("undefined"==typeof window?"undefined":k(window))>"u"?2:window.devicePixelRatio;return n=n>2?n:2,my.getImageLink(t,e.width?Math.ceil(e.width*n):"auto",e.height?Math.ceil(e.height*n):"auto",{webp:!0,webpFallback:"png"})},i=function(){var n=function(e){return"function"==typeof t.pxHandle?t.pxHandle(e):e+"px"};return{width:e.width?n(e.width):"auto",height:e.height?n(e.height):"auto"}};return xb(Tb,{get when(){return e.src},get children(){return[xb(Tb,{get when(){return e.background},get children(){var r=fy();return jb(r,(function(){return e.children})),ob((function(o){var a="".concat(Xb," ").concat(t.class),s=Vm(Fm({},i()),{"background-size":e.fit,"background-image":"url(".concat(n(),")")});return a!==o.e&&Ib(r,o.e=a),o.t=Rb(r,s,o.t),o}),{e:void 0,t:void 0}),r}}),xb(Tb,{get when(){return!e.background},get children(){var r=vy();return ob((function(o){var a=n(),s="".concat(Yb," ").concat(t.class),l=Vm(Fm({},i()),{"object-fit":e.fit}),c=e.alt;return a!==o.e&&Pb(r,"src",o.e=a),s!==o.t&&Ib(r,o.t=s),o.a=Rb(r,l,o.a),c!==o.o&&Pb(r,"alt",o.o=c),o}),{e:void 0,t:void 0,a:void 0,o:void 0}),r}})]}})},yy=function(t){return t[t.NORMAL=1]="NORMAL",t[t.FAN=2]="FAN",t[t.SPECIAL_DYNAMIC_MEDAL=3]="SPECIAL_DYNAMIC_MEDAL",t}(yy||{}),gy=function(t){return t.PC="pc",t.H5="h5",t}(gy||{});function wy(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t&&/^#([0-9a-fA-F]{6})$/.test(t)?"rgba("+parseInt("0x"+t.slice(1,3))+","+parseInt("0x"+t.slice(3,5))+","+parseInt("0x"+t.slice(5,7))+","+e+")":"rgba(0,0,0,0)"}var xy,ky,_y=function(){var t={medal:[0,1400],text:[750,1750],star:[1750,3e3]},e=function(t,e){var n={value:t,observers:null,observerSlots:null,comparator:(e=e?Object.assign({},Gm,e):Gm).equals||void 0};return[cb.bind(n),function(t){return"function"==typeof t&&(t=t(n.value)),ub(n,t)}]}(function(t,e){var n=Fm({},t);return Object.keys(t).forEach((function(t){n[t]=e})),n}(t,!1)),n=y(e,2),i=n[0],r=n[1];lb((function(){o()}));var o=function e(){var n=null;n&&clearTimeout(n),Object.keys(t).forEach((function(e){var n=y(t[e],2),o=n[0],a=n[1];setTimeout((function(){r(Vm(Fm({},i()),c({},e,!0)))}),o),setTimeout((function(){r(Vm(Fm({},i()),c({},e,!1)))}),a)})),n=setTimeout((function(){e()}),4e3)};return i},Ay=function(t){return(null==t?void 0:t.num_desc)||(null!=t&&t.number?"000000".concat(null==t?void 0:t.number).substring(String(null==t?void 0:t.number).length):"")},Ey=function(t){var e=null==t?void 0:t.color_format;if(e){var n=function(t){var e=t.colors,n=t.gradients,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:1,height:1},r=i.width,o=i.height;if(null==e||!e.length||null==n||!n.length)return"";var a=e.map((function(t,e){return"".concat(t," ").concat(n[e],"%")})).join(",");return"linear-gradient(".concat(function(t,e){return 180*Math.atan2(e,t)/Math.PI+90}(r,o),"deg, ").concat(a,")")}(e||{});if(n)return{"background-image":n,"-webkit-text-fill-color":"transparent","-webkit-background-clip":"text","background-clip":"text"}}return{color:null==t?void 0:t.color}},Cy=function(t,e){return 1===(null==e?void 0:e.type)?yy.SPECIAL_DYNAMIC_MEDAL:null!=t&&t.is_fan?yy.FAN:yy.NORMAL},Ty=function(t){return null==t?void 0:t.effect_visual},Sy=Ob("<span>"),Oy=Ob("<div><div>"),Py=Ob("<div>"),Iy=function(t){var e=_y();return function(){var n=Oy(),i=n.firstChild;return jb(n,xb(by,{get src(){var e;return null==(e=t.effect)?void 0:e.medal_image},width:40,height:40,fit:"contain",get class(){return"".concat($b," ").concat(e().medal?qb:"")},pxHandle:xy}),null),jb(n,xb(Tb,{get when(){return t.text},get children(){return[function(){var e=Sy();return jb(e,(function(){return t.text})),ob((function(n){var i=t.textStyle,r=Hb;return n.e=Rb(e,i,n.e),r!==n.t&&Ib(e,n.t=r),n}),{e:void 0,t:void 0}),e}(),xb(Tb,{get when(){return e().text},get children(){var e=Sy();return jb(e,(function(){return t.text})),ob((function(){return Ib(e,"".concat(Hb," ").concat(Gb))})),e}}),xb(Tb,{get when(){return e().star},get children(){var t=Sy();return ob((function(){return Ib(t,zb)})),t}})]}}),null),ob((function(e){var r,o,a="".concat(Vb),s=Wb,l="linear-gradient(270deg, ".concat(wy(null==(r=t.effect)?void 0:r.color_theme,.3)," 0%, ").concat(wy(null==(o=t.effect)?void 0:o.color_theme,0)," 100%)");return a!==e.e&&Ib(n,e.e=a),s!==e.t&&Ib(i,e.t=s),l!==e.a&&(null!=(e.a=l)?i.style.setProperty("background",l):i.style.removeProperty("background")),e}),{e:void 0,t:void 0,a:void 0}),n}()},Ry=function(t){return xb(Tb,{get when(){return t.uiType},get children(){return[xb(Tb,{get when(){return t.uiType===yy.NORMAL},get children(){return xb(by,{get src(){return t.url},width:60,height:34,fit:"contain"})}}),xb(Tb,{get when(){return t.uiType===yy.FAN},get children(){return xb(by,{get src(){return t.url},width:110,height:33,fit:"contain",background:!0,get class(){return Ub},get children(){return xb(Tb,{get when(){return t.text},get children(){var e=Sy();return jb(e,(function(){return t.text})),ob((function(n){return Rb(e,t.textStyle,n)})),e}})}})}}),xb(Tb,{get when(){return t.uiType===yy.SPECIAL_DYNAMIC_MEDAL},get children(){return ab((function(){return"pc"===t.scene}))()?function(){var e=Py();return jb(e,xb(Iy,t)),ob((function(){return Ib(e,Fb)})),e}():xb(Iy,t)}})]}})},jy=function(t){return xy=t.pxHandle,xb(Ry,Cb((function(){return{uiType:Cy(t.fan,t.image_group),url:t.card_url,text:Ay(t.fan),textStyle:Ey(t.fan),effect:Ty(t.image_group),scene:t.scene}})))},Ly=function(t){return t[t.NORMAL=1]="NORMAL",t[t.FAN=2]="FAN",t[t.SPECIAL_DYNAMIC_MEDAL=3]="SPECIAL_DYNAMIC_MEDAL",t}(Ly||{}),My=function(t){return t.PC="pc",t.H5="h5",t}(My||{}),Dy="_star_1aw9v_61",Ny="_cardBg_1aw9v_13",By="_fanTextPosition_1aw9v_21",zy="_fanText_1aw9v_21",Uy="_specialMedal_1aw9v_44",Fy="_medalImgAnimation_1aw9v_57",Vy="_fanTextWrap_1aw9v_67",Hy="_textMask_1aw9v_71",Wy="_specialMedalPc_1aw9v_86",$y="_medalImg_1aw9v_57",qy=Ob("<div><span></span><span>"),Gy=Ob("<div><div><span></span><span>"),Xy=Ob("<span>"),Yy=Ob("<div>"),Zy=function(t){var e=_y();return function(){var n=Yy();return jb(n,xb(by,{get src(){var e;return null==(e=t.effect)?void 0:e.medal_image},width:40,height:40,fit:"contain",get class(){return"".concat($y," ").concat(e().medal?Fy:"")},pxHandle:ky}),null),jb(n,xb(Tb,{get when(){return t.text},get children(){var n=Gy(),i=n.firstChild,r=i.firstChild,o=r.nextSibling;return jb(r,(function(){return t.textPrefix})),jb(o,(function(){return t.text})),jb(n,xb(Tb,{get when(){return e().text},get children(){var e=qy(),n=e.firstChild,i=n.nextSibling;return jb(n,(function(){return t.textPrefix})),jb(i,(function(){return t.text})),ob((function(){return Ib(e,"".concat(zy," ").concat(Hy))})),e}}),null),ob((function(e){var r=Vy,o=t.textStyle,a=zy;return r!==e.e&&Ib(n,e.e=r),e.t=Rb(i,o,e.t),a!==e.a&&Ib(i,e.a=a),e}),{e:void 0,t:void 0,a:void 0}),n}}),null),jb(n,xb(Tb,{get when(){return e().star},get children(){var t=Xy();return ob((function(){return Ib(t,Dy)})),t}}),null),ob((function(){return Ib(n,"".concat(Uy))})),n}()},Qy=function(t){return xb(Tb,{get when(){return t.uiType},get children(){return[xb(Tb,{get when(){return t.uiType===Ly.NORMAL||t.uiType===Ly.FAN},get children(){var e=Yy();return jb(e,xb(Tb,{get when(){return t.url},get children(){return xb(by,{get src(){return t.url},height:48})}}),null),jb(e,xb(Tb,{get when(){return t.uiType===Ly.FAN&&t.text},get children(){var e=qy(),n=e.firstChild,i=n.nextSibling;return jb(n,(function(){return t.textPrefix})),jb(i,(function(){return t.text})),ob((function(n){var i=t.textStyle,r="".concat(zy," ").concat(By);return n.e=Rb(e,i,n.e),r!==n.t&&Ib(e,n.t=r),n}),{e:void 0,t:void 0}),e}}),null),ob((function(){return Ib(e,Ny)})),e}}),xb(Tb,{get when(){return t.uiType===Ly.SPECIAL_DYNAMIC_MEDAL},get children(){return ab((function(){return"pc"===t.scene}))()?function(){var e=Yy();return jb(e,xb(Zy,t)),ob((function(){return Ib(e,Wy)})),e}():xb(Zy,t)}})]}})},Ky=function(t){return ky=t.pxHandle,xb(Qy,Cb((function(){var e;return{uiType:Cy(t.fan,t.image_group),url:t.image,text:Ay(t.fan),textStyle:Ey(t.fan),effect:Ty(t.image_group),textPrefix:(null==(e=t.fan)?void 0:e.num_prefix)||"NO.",scene:t.scene}})))};Bb({name:"CardForPC",component:function(t){return xb(jy,Cb((function(){return{fan:t.fan,card_url:t.card_url,image_group:t.image_group,scene:gy.PC}})))},engine:{core:{createRoot:rb,render:Sb}}});var Jy=Bb({name:"CardBgForPC",component:function(t){var e=function(){return t.card_bg||{}};return xb(Ky,Cb((function(){return{fan:e().fan,image:e().image,image_group:e().image_group,scene:My.PC}})))},engine:{core:{createRoot:rb,render:Sb}}});Bb({name:"CardCommon",component:jy,engine:{core:{createRoot:rb,render:Sb}}}),Bb({name:"CardCommon",component:Ky,engine:{core:{createRoot:rb,render:Sb}}});var tg=Object.defineProperty,eg=Object.getOwnPropertyDescriptor,ng=function(t,e,n,i){for(var r,o=i>1?void 0:i?eg(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&tg(e,n,o),o},ig=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).card=null,t}return p(e,t),s(e,[{key:"clearData",value:function(){this.card&&(this.card.unmount(),this.card=null)}},{key:"connectedCallback",value:function(){var t=this;u(d(e.prototype),"connectedCallback",this).call(this),setTimeout((function(){t.initData(t.data)}))}},{key:"disconnectedCallback",value:function(){u(d(e.prototype),"disconnectedCallback",this).call(this),this.clearData()}},{key:"updated",value:function(t){t.has("data")&&this.initData(this.data)}},{key:"initData",value:(n=i(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.card&&this.clearData(),this.card=new Jy(e).mount(this.shadowRoot.querySelector("#card"));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"render",value:function(){return qe(mc||(mc=g(['<div id="card"></div>'])))}}]);var n}(fn);ig.styles=ve(bc||(bc=g(["\n    #card {\n      width: 288px;\n      height: 48px;\n      position: relative;\n      overflow: hidden;\n      user-select: none;\n    }\n    #card div {\n      height: 100%;\n      max-width: 100%;\n    }\n    // 注意这里是通过copy产物，所以要锁版本\n    @keyframes _jiggle_14qf7_1 {\n      0% {\n        transform: rotate(0);\n      }\n      14.3% {\n        transform: rotate(11deg);\n      }\n      28.6% {\n        transform: rotate(0);\n      }\n      35.7% {\n        transform: rotate(-8deg);\n      }\n      46.4% {\n        transform: rotate(0);\n      }\n      46.4% {\n        transform: rotate(0);\n      }\n      53.6% {\n        transform: rotate(3deg);\n      }\n      64.3% {\n        transform: rotate(0);\n      }\n      71.4% {\n        transform: rotate(-1deg);\n      }\n      82.1% {\n        transform: rotate(0);\n      }\n      92.8% {\n        transform: rotate(0.5deg);\n      }\n      to {\n        transform: rotate(0);\n      }\n    }\n    @keyframes _star_14qf7_99 {\n      0% {\n        background-position: 0 0;\n      }\n      to {\n        background-position: -340px 0;\n      }\n    }\n    ._star_14qf7_99 {\n      display: inline-block;\n      background-image: url(https://i0.hdslb.com/bfs/activity-plat/static/20240521/6fdde5f06d0b876f68573682fa59da66/a8DG0BREmj.png);\n      background-size: 340px 20px;\n      background-repeat: no-repeat;\n      width: 20px;\n      height: 20px;\n      animation: _star_14qf7_99 0.85s steps(17);\n    }\n    @keyframes _light_14qf7_1 {\n      0% {\n        background-position: -100% 0;\n      }\n      to {\n        background-position: 60px 0;\n      }\n    }\n    ._fans_14qf7_13 {\n      position: relative;\n      user-select: none;\n    }\n    ._fans_14qf7_13 > span {\n      color: #fff;\n      font-family: fans-num, sans-serif !important;\n      font-size: 12px;\n      position: absolute;\n      top: 11px;\n      right: 39px;\n      transform: scale(0.88);\n      transform-origin: right center;\n      line-height: 1;\n    }\n    ._specialDynamicMedalPc_14qf7_30 {\n      display: inline-block;\n      height: 33px;\n      width: 110px;\n      overflow: hidden;\n    }\n    ._specialDynamicMedalPc_14qf7_30 ._specialDynamicMedal_14qf7_30 {\n      transform: scale(0.75);\n      transform-origin: left top;\n    }\n    ._specialDynamicMedalPc_14qf7_30 ._specialDynamicMedal_14qf7_30 ._text_14qf7_40 {\n      font-size: 14px;\n      transform: scale(1);\n    }\n    ._specialDynamicMedal_14qf7_30 {\n      width: 146px;\n      height: 44px;\n      position: relative;\n      user-select: none;\n    }\n    ._specialDynamicMedal_14qf7_30 ._background_14qf7_53 {\n      width: 108px;\n      height: 30px;\n      border-top-right-radius: 15px;\n      border-bottom-right-radius: 15px;\n      background-color: gray;\n      position: absolute;\n      top: 7px;\n      right: 0;\n      background: linear-gradient(270deg, #f8bb5b4d, #f8bb5b00);\n    }\n    ._specialDynamicMedal_14qf7_30 ._medalImg_14qf7_66 {\n      position: absolute;\n      right: 0;\n      top: 2px;\n    }\n    ._specialDynamicMedal_14qf7_30 ._medalImg_14qf7_66._medalImgAnimation_14qf7_71 {\n      animation: _jiggle_14qf7_1 1.4s linear;\n    }\n    ._specialDynamicMedal_14qf7_30 ._text_14qf7_40 {\n      color: #fff;\n      font-family: fans-num, sans-serif !important;\n      font-size: 12px;\n      line-height: 44px;\n      position: absolute;\n      top: 0;\n      right: 40px;\n      transform: scale(0.67);\n      transform-origin: right center;\n    }\n    ._specialDynamicMedal_14qf7_30 ._textMask_14qf7_88 {\n      background-image: url(https://i0.hdslb.com/bfs/activity-plat/static/20240522/6fdde5f06d0b876f68573682fa59da66/BalugIvNR2.png);\n      background-size: contain;\n      background-repeat: no-repeat;\n      background-position: -100% 0;\n      animation: _light_14qf7_1 1.1s linear;\n      color: transparent;\n      background-clip: text;\n      -webkit-background-clip: text;\n    }\n    ._specialDynamicMedal_14qf7_30 ._star_14qf7_99 {\n      position: absolute;\n      top: 5px;\n      right: 3px;\n    }\n    ._backgroundImg_aob6i_1 {\n      background-position: center;\n      background-repeat: no-repeat;\n    }\n    ._bfsImg_aob6i_6 {\n      display: block;\n    }\n    @font-face {\n      font-family: fans-num;\n      src: url(https://activity.hdslb.com/blackboard/static/20240516/6fdde5f06d0b876f68573682fa59da66/v6u7v27Ucs.ttf);\n    }\n    @keyframes _jiggle_1aw9v_1 {\n      0% {\n        transform: rotate(0);\n      }\n      14.3% {\n        transform: rotate(11deg);\n      }\n      28.6% {\n        transform: rotate(0);\n      }\n      35.7% {\n        transform: rotate(-8deg);\n      }\n      46.4% {\n        transform: rotate(0);\n      }\n      46.4% {\n        transform: rotate(0);\n      }\n      53.6% {\n        transform: rotate(3deg);\n      }\n      64.3% {\n        transform: rotate(0);\n      }\n      71.4% {\n        transform: rotate(-1deg);\n      }\n      82.1% {\n        transform: rotate(0);\n      }\n      92.8% {\n        transform: rotate(0.5deg);\n      }\n      to {\n        transform: rotate(0);\n      }\n    }\n    @keyframes _star_1aw9v_61 {\n      0% {\n        background-position: 0 0;\n      }\n      to {\n        background-position: -340px 0;\n      }\n    }\n    ._star_1aw9v_61 {\n      display: inline-block;\n      background-image: url(https://i0.hdslb.com/bfs/activity-plat/static/20240521/6fdde5f06d0b876f68573682fa59da66/a8DG0BREmj.png);\n      background-size: 340px 20px;\n      background-repeat: no-repeat;\n      width: 20px;\n      height: 20px;\n      animation: _star_1aw9v_61 0.85s steps(17);\n    }\n    @keyframes _light_1aw9v_1 {\n      0% {\n        background-position: -100% 0;\n      }\n      to {\n        background-position: 42px 0;\n      }\n    }\n    ._cardBg_1aw9v_13 {\n      display: inline-block;\n      position: relative;\n      user-select: none;\n      height: 48px;\n      max-width: 288px;\n      overflow: hidden;\n    }\n    ._cardBg_1aw9v_13 ._fanTextPosition_1aw9v_21 {\n      position: absolute;\n      right: 0;\n      top: 0;\n    }\n    ._fanText_1aw9v_21 {\n      height: 100%;\n      font-size: 13px;\n      line-height: 16px;\n      transform: scale(0.7);\n      transform-origin: center center;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: flex-start;\n    }\n    ._fanText_1aw9v_21 > span {\n      font-family: fans-num, sans-serif !important;\n    }\n    ._specialMedal_1aw9v_44 {\n      user-select: none;\n      display: flex;\n      align-items: center;\n      position: relative;\n      height: 40px;\n    }\n    ._specialMedal_1aw9v_44 ._fanText_1aw9v_21 {\n      font-size: 8px;\n      line-height: 10px;\n      transform: none;\n    }\n    ._specialMedal_1aw9v_44 ._medalImgAnimation_1aw9v_57 {\n      animation: _jiggle_1aw9v_1 1.4s linear;\n    }\n    ._specialMedal_1aw9v_44 ._star_1aw9v_61 {\n      position: absolute;\n      top: 3px;\n      left: 17px;\n    }\n    ._specialMedal_1aw9v_44 ._fanTextWrap_1aw9v_67 {\n      position: relative;\n    }\n    ._specialMedal_1aw9v_44 ._textMask_1aw9v_71 {\n      position: absolute;\n      left: 0;\n      top: 0;\n      background-image: url(https://i0.hdslb.com/bfs/activity-plat/static/20240522/6fdde5f06d0b876f68573682fa59da66/BalugIvNR2.png);\n      background-size: auto 100%;\n      background-repeat: no-repeat;\n      background-position: -100% 0;\n      animation: _light_1aw9v_1 1.1s linear;\n      color: transparent;\n      background-clip: text;\n      -webkit-background-clip: text;\n    }\n    ._specialMedalPc_1aw9v_86 {\n      padding: 7px 12px;\n      display: inline-block;\n      height: 48px;\n      max-width: 288px;\n      overflow: hidden;\n      box-sizing: border-box;\n    }\n    ._specialMedalPc_1aw9v_86 ._specialMedal_1aw9v_44 {\n      height: 33px;\n    }\n    ._specialMedalPc_1aw9v_86 ._medalImg_1aw9v_57 {\n      width: 33px !important;\n      height: 33px !important;\n    }\n    ._specialMedalPc_1aw9v_86 ._star_1aw9v_61 {\n      transform: scale(0.8);\n      transform-origin: left top;\n      left: 14px;\n      top: 2px;\n    }\n    ._specialMedalPc_1aw9v_86 ._fanText_1aw9v_21 {\n      font-size: 9px;\n      line-height: 11px;\n    }\n  "]))),ng([gn()],ig.prototype,"data",2),ig=ng([mn("bili-comment-user-sailing-card")],ig);var rg=Object.defineProperty,og=Object.getOwnPropertyDescriptor,ag=function(t,e,n,i){for(var r,o=i>1?void 0:i?og(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&rg(e,n,o),o},sg=function(t){function e(){return o(this,e),r(this,e,arguments)}return p(e,t),s(e,[{key:"tag",get:function(){var t={class:"",text:"投票"};switch(this.data.label_kind){case 1:t.class="red",t.text="红方";break;case 2:t.class="blue",t.text="蓝方"}return t}},{key:"render",value:function(){return qe(yc||(yc=g(['<div id="option">\n      <div id="tag" class="','">','</div>\n      <div id="desc">',"</div>\n    </div>"])),this.tag.class,this.tag.text,this.data.desc)}}])}(fn);sg.styles=ve(gc||(gc=g(["\n    :host {\n      display: flex;\n    }\n    #option {\n      display: flex;\n      align-items: center;\n      font-size: 12px;\n    }\n    #tag {\n      box-sizing: border-box;\n      line-height: 16px;\n      padding: 2px 6px;\n      border-radius: 2px;\n      margin-right: 4px;\n      background-color: var(--graph_bg_regular);\n      color: var(--text3);\n    }\n    #tag.red {\n      background-color: var(--Pi1);\n      color: var(--Pi5);\n    }\n    #tag.blue {\n      background-color: var(--brand_blue_thin);\n      color: var(--brand_blue);\n    }\n    #desc {\n      color: var(--text2);\n    }\n  "]))),ag([gn()],sg.prototype,"data",2),ag([wn()],sg.prototype,"tag",1),sg=ag([mn("bili-comment-vote-option")],sg);var lg=Object.defineProperty,cg=Object.getOwnPropertyDescriptor,ug=function(t,e,n,i){for(var r,o=i>1?void 0:i?cg(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&lg(e,n,o),o},dg=function(t){function e(){return o(this,e),r(this,e,arguments)}return p(e,t),s(e,[{key:"handleClick",value:function(){Ud(this.data.id)}},{key:"render",value:function(){return qe(wc||(wc=g(['\n      <div id="card">\n        <div id="head">\n          <bili-icon icon="BDC/vote_line/2" size="40"></bili-icon>\n        </div>\n        <div id="content">\n          <div id="info">\n            <div id="title">','</div>\n            <div id="desc">','人参与</div>\n          </div>\n        </div>\n        <div id="action">\n          <button @click=',">投票</button>\n        </div>\n      </div>\n    "])),this.data.title,this.data.cnt||0,this.handleClick)}}])}(fn);dg.styles=ve(xc||(xc=g(["\n    #card {\n      width: 100%;\n      height: 80px;\n      display: flex;\n      border: 0.5px solid var(--graph_bg_thick);\n      border-radius: 4px;\n      background-color: var(--bg1);\n    }\n\n    #head {\n      width: 80px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      flex-shrink: 0;\n      border-top-left-radius: 4px;\n      border-bottom-left-radius: 4px;\n      background-color: var(--brand_blue_thin);\n      color: var(--brand_blue);\n    }\n\n    #content {\n      flex: 1;\n      overflow: hidden;\n      display: flex;\n      align-items: center;\n      padding-left: 15px;\n    }\n    #info #title {\n      font-size: 14px;\n      color: var(--text1);\n    }\n    #info #desc {\n      margin-top: 10px;\n      font-size: 12px;\n      color: var(--text3);\n    }\n\n    #action {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      flex-shrink: 0;\n      width: 90px;\n    }\n    #action button {\n      width: 54px;\n      height: 28px;\n      font-size: 13px;\n      border-radius: 4px;\n      text-align: center;\n      line-height: 28px;\n      color: var(--text_white);\n      background-color: var(--brand_blue);\n      cursor: pointer;\n      outline: none;\n      border: none;\n    }\n  "]))),ug([gn({type:Object})],dg.prototype,"data",2),dg=ug([mn("bili-comment-vote-renderer")],dg);var pg=function(t){return t&&t.Math===Math&&t},hg=pg("object"==("undefined"==typeof globalThis?"undefined":k(globalThis))&&globalThis)||pg("object"==("undefined"==typeof window?"undefined":k(window))&&window)||pg("object"==("undefined"==typeof self?"undefined":k(self))&&self)||pg("object"==k(xi)&&xi)||pg("object"==k(xi)&&xi)||function(){return this}()||Function("return this")(),fg={},vg=function(t){try{return!!t()}catch(t){return!0}},mg=!vg((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),bg=!vg((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),yg=bg,gg=Function.prototype.call,wg=yg?gg.bind(gg):function(){return gg.apply(gg,arguments)},xg={},kg={}.propertyIsEnumerable,_g=Object.getOwnPropertyDescriptor,Ag=_g&&!kg.call({1:2},1);xg.f=Ag?function(t){var e=_g(this,t);return!!e&&e.enumerable}:kg;var Eg,Cg,Tg=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Sg=bg,Og=Function.prototype,Pg=Og.call,Ig=Sg&&Og.bind.bind(Pg,Pg),Rg=Sg?Ig:function(t){return function(){return Pg.apply(t,arguments)}},jg=Rg,Lg=jg({}.toString),Mg=jg("".slice),Dg=function(t){return Mg(Lg(t),8,-1)},Ng=vg,Bg=Dg,zg=Object,Ug=Rg("".split),Fg=Ng((function(){return!zg("z").propertyIsEnumerable(0)}))?function(t){return"String"===Bg(t)?Ug(t,""):zg(t)}:zg,Vg=function(t){return null==t},Hg=Vg,Wg=TypeError,$g=function(t){if(Hg(t))throw new Wg("Can't call method on "+t);return t},qg=Fg,Gg=$g,Xg=function(t){return qg(Gg(t))},Yg="object"==("undefined"==typeof document?"undefined":k(document))&&document.all,Zg=void 0===Yg&&void 0!==Yg?function(t){return"function"==typeof t||t===Yg}:function(t){return"function"==typeof t},Qg=Zg,Kg=function(t){return"object"==k(t)?null!==t:Qg(t)},Jg=hg,tw=Zg,ew=function(t,e){return arguments.length<2?(n=Jg[t],tw(n)?n:void 0):Jg[t]&&Jg[t][e];var n},nw=Rg({}.isPrototypeOf),iw=hg,rw="undefined"!=typeof navigator&&String(navigator.userAgent)||"",ow=iw.process,aw=iw.Deno,sw=ow&&ow.versions||aw&&aw.version,lw=sw&&sw.v8;lw&&(Cg=(Eg=lw.split("."))[0]>0&&Eg[0]<4?1:+(Eg[0]+Eg[1])),!Cg&&rw&&(!(Eg=rw.match(/Edge\/(\d+)/))||Eg[1]>=74)&&(Eg=rw.match(/Chrome\/(\d+)/))&&(Cg=+Eg[1]);var cw=Cg,uw=vg,dw=hg.String,pw=!!Object.getOwnPropertySymbols&&!uw((function(){var t=Symbol("symbol detection");return!dw(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&cw&&cw<41})),hw=pw&&!Symbol.sham&&"symbol"==k(Symbol.iterator),fw=ew,vw=Zg,mw=nw,bw=Object,yw=hw?function(t){return"symbol"==k(t)}:function(t){var e=fw("Symbol");return vw(e)&&mw(e.prototype,bw(t))},gw=String,ww=Zg,xw=function(t){try{return gw(t)}catch(t){return"Object"}},kw=TypeError,_w=function(t){if(ww(t))return t;throw new kw(xw(t)+" is not a function")},Aw=_w,Ew=Vg,Cw=wg,Tw=Zg,Sw=Kg,Ow=TypeError,Pw={exports:{}},Iw=hg,Rw=Object.defineProperty,jw=function(t,e){try{Rw(Iw,t,{value:e,configurable:!0,writable:!0})}catch(n){Iw[t]=e}return e},Lw=hg,Mw=jw,Dw="__core-js_shared__",Nw=Pw.exports=Lw[Dw]||Mw(Dw,{});(Nw.versions||(Nw.versions=[])).push({version:"3.37.1",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Bw=Pw.exports,zw=Bw,Uw=function(t,e){return zw[t]||(zw[t]=e||{})},Fw=$g,Vw=Object,Hw=function(t){return Vw(Fw(t))},Ww=Hw,$w=Rg({}.hasOwnProperty),qw=Object.hasOwn||function(t,e){return $w(Ww(t),e)},Gw=Rg,Xw=0,Yw=Math.random(),Zw=Gw(1..toString),Qw=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Zw(++Xw+Yw,36)},Kw=Uw,Jw=qw,tx=Qw,ex=pw,nx=hw,ix=hg.Symbol,rx=Kw("wks"),ox=nx?ix.for||ix:ix&&ix.withoutSetter||tx,ax=function(t){return Jw(rx,t)||(rx[t]=ex&&Jw(ix,t)?ix[t]:ox("Symbol."+t)),rx[t]},sx=wg,lx=Kg,cx=yw,ux=function(t,e){var n=t[e];return Ew(n)?void 0:Aw(n)},dx=function(t,e){var n,i;if("string"===e&&Tw(n=t.toString)&&!Sw(i=Cw(n,t)))return i;if(Tw(n=t.valueOf)&&!Sw(i=Cw(n,t)))return i;if("string"!==e&&Tw(n=t.toString)&&!Sw(i=Cw(n,t)))return i;throw new Ow("Can't convert object to primitive value")},px=TypeError,hx=ax("toPrimitive"),fx=function(t,e){if(!lx(t)||cx(t))return t;var n,i=ux(t,hx);if(i){if(void 0===e&&(e="default"),n=sx(i,t,e),!lx(n)||cx(n))return n;throw new px("Can't convert object to primitive value")}return void 0===e&&(e="number"),dx(t,e)},vx=yw,mx=function(t){var e=fx(t,"string");return vx(e)?e:e+""},bx=Kg,yx=hg.document,gx=bx(yx)&&bx(yx.createElement),wx=function(t){return gx?yx.createElement(t):{}},xx=wx,kx=!mg&&!vg((function(){return 7!==Object.defineProperty(xx("div"),"a",{get:function(){return 7}}).a})),_x=mg,Ax=wg,Ex=xg,Cx=Tg,Tx=Xg,Sx=mx,Ox=qw,Px=kx,Ix=Object.getOwnPropertyDescriptor;fg.f=_x?Ix:function(t,e){if(t=Tx(t),e=Sx(e),Px)try{return Ix(t,e)}catch(t){}if(Ox(t,e))return Cx(!Ax(Ex.f,t,e),t[e])};var Rx={},jx=mg&&vg((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Lx=Kg,Mx=String,Dx=TypeError,Nx=function(t){if(Lx(t))return t;throw new Dx(Mx(t)+" is not an object")},Bx=mg,zx=kx,Ux=jx,Fx=Nx,Vx=mx,Hx=TypeError,Wx=Object.defineProperty,$x=Object.getOwnPropertyDescriptor,qx="enumerable",Gx="configurable",Xx="writable";Rx.f=Bx?Ux?function(t,e,n){if(Fx(t),e=Vx(e),Fx(n),"function"==typeof t&&"prototype"===e&&"value"in n&&Xx in n&&!n[Xx]){var i=$x(t,e);i&&i[Xx]&&(t[e]=n.value,n={configurable:Gx in n?n[Gx]:i[Gx],enumerable:qx in n?n[qx]:i[qx],writable:!1})}return Wx(t,e,n)}:Wx:function(t,e,n){if(Fx(t),e=Vx(e),Fx(n),zx)try{return Wx(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new Hx("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Yx=Rx,Zx=Tg,Qx=mg?function(t,e,n){return Yx.f(t,e,Zx(1,n))}:function(t,e,n){return t[e]=n,t},Kx={exports:{}},Jx=mg,tk=qw,ek=Function.prototype,nk=Jx&&Object.getOwnPropertyDescriptor,ik=tk(ek,"name"),rk={EXISTS:ik,PROPER:ik&&"something"===function(){}.name,CONFIGURABLE:ik&&(!Jx||Jx&&nk(ek,"name").configurable)},ok=Zg,ak=Bw,sk=Rg(Function.toString);ok(ak.inspectSource)||(ak.inspectSource=function(t){return sk(t)});var lk,ck,uk,dk=ak.inspectSource,pk=Zg,hk=hg.WeakMap,fk=pk(hk)&&/native code/.test(String(hk)),vk=Qw,mk=Uw("keys"),bk=function(t){return mk[t]||(mk[t]=vk(t))},yk={},gk=fk,wk=hg,xk=Kg,kk=Qx,_k=qw,Ak=Bw,Ek=bk,Ck=yk,Tk="Object already initialized",Sk=wk.TypeError,Ok=wk.WeakMap;if(gk||Ak.state){var Pk=Ak.state||(Ak.state=new Ok);Pk.get=Pk.get,Pk.has=Pk.has,Pk.set=Pk.set,lk=function(t,e){if(Pk.has(t))throw new Sk(Tk);return e.facade=t,Pk.set(t,e),e},ck=function(t){return Pk.get(t)||{}},uk=function(t){return Pk.has(t)}}else{var Ik=Ek("state");Ck[Ik]=!0,lk=function(t,e){if(_k(t,Ik))throw new Sk(Tk);return e.facade=t,kk(t,Ik,e),e},ck=function(t){return _k(t,Ik)?t[Ik]:{}},uk=function(t){return _k(t,Ik)}}var Rk={set:lk,get:ck,has:uk,enforce:function(t){return uk(t)?ck(t):lk(t,{})},getterFor:function(t){return function(e){var n;if(!xk(e)||(n=ck(e)).type!==t)throw new Sk("Incompatible receiver, "+t+" required");return n}}},jk=Rg,Lk=vg,Mk=Zg,Dk=qw,Nk=mg,Bk=rk.CONFIGURABLE,zk=dk,Uk=Rk.enforce,Fk=Rk.get,Vk=String,Hk=Object.defineProperty,Wk=jk("".slice),$k=jk("".replace),qk=jk([].join),Gk=Nk&&!Lk((function(){return 8!==Hk((function(){}),"length",{value:8}).length})),Xk=String(String).split("String"),Yk=Kx.exports=function(t,e,n){"Symbol("===Wk(Vk(e),0,7)&&(e="["+$k(Vk(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Dk(t,"name")||Bk&&t.name!==e)&&(Nk?Hk(t,"name",{value:e,configurable:!0}):t.name=e),Gk&&n&&Dk(n,"arity")&&t.length!==n.arity&&Hk(t,"length",{value:n.arity});try{n&&Dk(n,"constructor")&&n.constructor?Nk&&Hk(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var i=Uk(t);return Dk(i,"source")||(i.source=qk(Xk,"string"==typeof e?e:"")),t};Function.prototype.toString=Yk((function(){return Mk(this)&&Fk(this).source||zk(this)}),"toString");var Zk=Kx.exports,Qk=Zg,Kk=Rx,Jk=Zk,t_=jw,e_={},n_=Math.ceil,i_=Math.floor,r_=Math.trunc||function(t){var e=+t;return(e>0?i_:n_)(e)},o_=r_,a_=function(t){var e=+t;return e!=e||0===e?0:o_(e)},s_=a_,l_=Math.max,c_=Math.min,u_=a_,d_=Math.min,p_=function(t){var e=u_(t);return e>0?d_(e,9007199254740991):0},h_=function(t){return p_(t.length)},f_=Xg,v_=function(t,e){var n=s_(t);return n<0?l_(n+e,0):c_(n,e)},m_=h_,b_=function(t){return function(e,n,i){var r=f_(e),o=m_(r);if(0===o)return!t&&-1;var a,s=v_(i,o);if(t&&n!=n){for(;o>s;)if((a=r[s++])!=a)return!0}else for(;o>s;s++)if((t||s in r)&&r[s]===n)return t||s||0;return!t&&-1}},y_={includes:b_(!0),indexOf:b_(!1)},g_=qw,w_=Xg,x_=y_.indexOf,k_=yk,__=Rg([].push),A_=function(t,e){var n,i=w_(t),r=0,o=[];for(n in i)!g_(k_,n)&&g_(i,n)&&__(o,n);for(;e.length>r;)g_(i,n=e[r++])&&(~x_(o,n)||__(o,n));return o},E_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],C_=A_,T_=E_.concat("length","prototype");e_.f=Object.getOwnPropertyNames||function(t){return C_(t,T_)};var S_={};S_.f=Object.getOwnPropertySymbols;var O_=ew,P_=e_,I_=S_,R_=Nx,j_=Rg([].concat),L_=O_("Reflect","ownKeys")||function(t){var e=P_.f(R_(t)),n=I_.f;return n?j_(e,n(t)):e},M_=qw,D_=L_,N_=fg,B_=Rx,z_=vg,U_=Zg,F_=/#|\.prototype\./,V_=function(t,e){var n=W_[H_(t)];return n===q_||n!==$_&&(U_(e)?z_(e):!!e)},H_=V_.normalize=function(t){return String(t).replace(F_,".").toLowerCase()},W_=V_.data={},$_=V_.NATIVE="N",q_=V_.POLYFILL="P",G_=V_,X_=hg,Y_=fg.f,Z_=Qx,Q_=function(t,e,n,i){i||(i={});var r=i.enumerable,o=void 0!==i.name?i.name:e;if(Qk(n)&&Jk(n,o,i),i.global)r?t[e]=n:t_(e,n);else{try{i.unsafe?t[e]&&(r=!0):delete t[e]}catch(t){}r?t[e]=n:Kk.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},K_=jw,J_=function(t,e,n){for(var i=D_(e),r=B_.f,o=N_.f,a=0;a<i.length;a++){var s=i[a];M_(t,s)||n&&M_(n,s)||r(t,s,o(e,s))}},tA=G_,eA=Dg,nA=Array.isArray||function(t){return"Array"===eA(t)},iA=TypeError,rA=Dg,oA=Rg,aA=function(t){if("Function"===rA(t))return oA(t)},sA=_w,lA=bg,cA=aA(aA.bind),uA=nA,dA=h_,pA=function(t){if(t>9007199254740991)throw iA("Maximum allowed index exceeded");return t},hA=function(t,e){return sA(t),void 0===e?t:lA?cA(t,e):function(){return t.apply(e,arguments)}},fA=function t(e,n,i,r,o,a,s,l){for(var c,u=o,d=0,p=!!s&&hA(s,l);d<r;)d in i&&(c=p?p(i[d],d,n):i[d],a>0&&uA(c)?u=t(e,n,c,dA(c),u,a-1)-1:(pA(u+1),e[u]=c),u++),d++;return u},vA={};vA[ax("toStringTag")]="z";var mA="[object z]"===String(vA),bA=Zg,yA=Dg,gA=ax("toStringTag"),wA=Object,xA="Arguments"===yA(function(){return arguments}()),kA=mA?yA:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=wA(t),gA))?n:xA?yA(e):"Object"===(i=yA(e))&&bA(e.callee)?"Arguments":i},_A=Rg,AA=vg,EA=Zg,CA=kA,TA=dk,SA=function(){},OA=ew("Reflect","construct"),PA=/^\s*(?:class|function)\b/,IA=_A(PA.exec),RA=!PA.test(SA),jA=function(t){if(!EA(t))return!1;try{return OA(SA,[],t),!0}catch(t){return!1}},LA=function(t){if(!EA(t))return!1;switch(CA(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return RA||!!IA(PA,TA(t))}catch(t){return!0}};LA.sham=!0;var MA=!OA||AA((function(){var t;return jA(jA.call)||!jA(Object)||!jA((function(){t=!0}))||t}))?LA:jA,DA=nA,NA=MA,BA=Kg,zA=ax("species"),UA=Array,FA=function(t){var e;return DA(t)&&(e=t.constructor,(NA(e)&&(e===UA||DA(e.prototype))||BA(e)&&null===(e=e[zA]))&&(e=void 0)),void 0===e?UA:e},VA=fA,HA=Hw,WA=h_,$A=a_,qA=function(t,e){return new(FA(t))(0===e?0:e)};(function(t,e){var n,i,r,o,a,s=t.target,l=t.global,c=t.stat;if(n=l?X_:c?X_[s]||K_(s,{}):X_[s]&&X_[s].prototype)for(i in e){if(o=e[i],r=t.dontCallGetSet?(a=Y_(n,i))&&a.value:n[i],!tA(l?i:s+(c?".":"#")+i,t.forced)&&void 0!==r){if(k(o)==k(r))continue;J_(o,r)}(t.sham||r&&r.sham)&&Z_(o,"sham",!0),Q_(n,i,o,t)}})({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=HA(this),n=WA(e),i=qA(e,0);return i.length=VA(i,e,e,n,0,void 0===t?1:$A(t)),i}});var GA={},XA=A_,YA=E_,ZA=Object.keys||function(t){return XA(t,YA)},QA=mg,KA=jx,JA=Rx,tE=Nx,eE=Xg,nE=ZA;GA.f=QA&&!KA?Object.defineProperties:function(t,e){tE(t);for(var n,i=eE(e),r=nE(e),o=r.length,a=0;o>a;)JA.f(t,n=r[a++],i[n]);return t};var iE,rE=ew("document","documentElement"),oE=Nx,aE=GA,sE=E_,lE=yk,cE=rE,uE=wx,dE="prototype",pE="script",hE=bk("IE_PROTO"),fE=function(){},vE=function(t){return"<"+pE+">"+t+"</"+pE+">"},mE=function(t){t.write(vE("")),t.close();var e=t.parentWindow.Object;return t=null,e},bE=function(){try{iE=new ActiveXObject("htmlfile")}catch(t){}var t,e,n;bE="undefined"!=typeof document?document.domain&&iE?mE(iE):(e=uE("iframe"),n="java"+pE+":",e.style.display="none",cE.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(vE("document.F=Object")),t.close(),t.F):mE(iE);for(var i=sE.length;i--;)delete bE[dE][sE[i]];return bE()};lE[hE]=!0;var yE=Object.create||function(t,e){var n;return null!==t?(fE[dE]=oE(t),n=new fE,fE[dE]=null,n[hE]=t):n=bE(),void 0===e?n:aE.f(n,e)},gE=ax,wE=yE,xE=Rx.f,kE=gE("unscopables"),_E=Array.prototype;void 0===_E[kE]&&xE(_E,kE,{configurable:!0,value:wE(null)});(function(t){_E[kE][t]=!0})("flat");var AE=hg,EE=Rg;(function(t,e){EE(AE[t].prototype[e])})("Array","flat");var CE=function(){return s((function t(){o(this,t),this.target=null,this.events={}}),[{key:"addEventListener",value:function(t,e){("undefined"==typeof window?"undefined":k(window))>"u"?console.warn("EventBridge is not supported in server side"):(this.events[t]?this.events[t].push(e):this.events[t]=[e],this.target&&this.target.addEventListener(t,e))}},{key:"removeEventListener",value:function(t,e){if(("undefined"==typeof window?"undefined":k(window))>"u")console.warn("EventBridge is not supported in server side");else if(this.target&&this.target.removeEventListener(t,e),this.events[t].length){var n=this.events[t];this.events[t]=n.filter((function(t){return t!==e}))}}},{key:"connect",value:function(t){var e=this;this.target||t&&(this.target=t,Object.keys(this.events).forEach((function(n){e.events[n].forEach((function(e){t.addEventListener(n,e)}))})))}},{key:"disconnect",value:function(){var t=this;if(this.target){var e=this.target;Object.keys(this.events).forEach((function(n){t.events[n].forEach((function(t){e.removeEventListener(n,t)}))}))}this.events={},this.target=null}}])}(),TE=function(){return s((function t(e){o(this,t),this.el={current:null},this.parent=null,this.props={},this.methods={},this.emits=[],this.dispose=null,this.eventBridge=new CE,e&&(this.props=e)}),[{key:"engine",get:function(){return{core:"custom"}}},{key:"addEventListener",value:function(t,e){!this.emits.length||this.emits.includes(t)?this.eventBridge.addEventListener(t,e):console.warn("Event ".concat(String(t)," is not defined in emits"))}},{key:"removeEventListener",value:function(t,e){this.eventBridge.removeEventListener(t,e)}},{key:"dispatchAction",value:function(t){var e,n=t.type,i=t.args,r=t.callback,o=null==(e=this.methods)?void 0:e[n];if("function"==typeof o){var a=o.apply(void 0,w(null!=i?i:[]));return null==r||r(a),a}console.warn("Action ".concat(String(n)," is undefined or not a function"))}},{key:"update",value:function(t){var e=!!this.el.current,n=this.parent;return e&&this.unmount(),this.props=t,e&&(this.parent=n,this.render()),this}},{key:"mount",value:function(t,e){return this.el.current?(console.warn("Component is already mounted"),this):this.parent?(t===this.parent||console.warn("Component maybe in mounting, please wait mounted, and then use update or unmount first"),this):(this.parent=t,e?this.renderAsync():this.render(),this)}},{key:"unmount",value:function(){var t;if(null==(t=this.dispose)||t.call(this),this.eventBridge.disconnect(),this.props={},this.methods={},this.el.current){var e,n=null!==(e=this.parent)&&void 0!==e?e:this.el.current.parentElement;n!==this.el.current&&null!=n&&n.contains(this.el.current)&&(n.removeChild(this.el.current),this.parent=null),this.el.current=null}}}])}(),SE=function(t){function e(){return o(this,e),r(this,e,arguments)}return p(e,t),s(e,[{key:"_render",value:function(){if(this.parent){var t=this.props,e=t.params,n=t.mode,i=t.spmPrefix,r=t.seekId,o=t.cmFromTrackId,a=document.createElement("bili-comments");a.setAttribute("data-params",e),n&&a.setAttribute("mode",String(n)),i&&a.setAttribute("spm-prefix",i),r&&a.setAttribute("seek-id",String(r)),o&&a.setAttribute("cm-from-track-id",String(o)),this.el.current=a,this.eventBridge.connect(a),this.parent.appendChild(a)}}},{key:"render",value:function(){var t=this;this._render();this.methods={reload:function(e){if(e&&Object.assign(t.props,e),!t.el.current)return t._render();var n=t.props,i=n.params,r=n.mode,o=n.spmPrefix,a=n.seekId,s=y(i.split(","),2),l=s[0],c=s[1];t.el.current.reload({oid:c,type:l,mode:r,seekRpid:a,spmPrefix:o})}}}},{key:"renderToString",value:function(){return""}},{key:"renderAsync",value:function(){return this.render(),Promise.resolve(!0)}}])}(TE);return SE.initCSSVars=function(){getComputedStyle(document.documentElement).getPropertyValue("--brand_pink")||ti("//s1.hdslb.com/bfs/seed/jinkela/short/bili-theme/bili-theme.min.js",{lib:"BiliTheme"}).then((function(t){t.initThemeWithCSR()})).catch((function(){var t=document.createElement("link");t.rel="stylesheet",t.href="//s1.hdslb.com/bfs/seed/jinkela/short/b-style/theme.min.css",document.head.appendChild(t)}))},SE}));
